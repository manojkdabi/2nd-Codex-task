<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Insoil Live Observation Tool v5.70</title>

  <!-- Charts / Data -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>

  <!-- ✅ PDF Export (QC Certificate) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.29/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- Geoapify Geocoder Autocomplete -->
  <script src="https://unpkg.com/@geoapify/geocoder-autocomplete@2/dist/index.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@geoapify/geocoder-autocomplete@2/styles/minimal.css" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>


  <style type="text/css" id="ins-style">
  /* ================================
     STYLESHEET (module-wise sections)
     ================================ */
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

    /* =========================================
   PAGINATION CONTROLS - PROFESSIONAL STYLE
   ========================================= */


    /* Pagination Container */
    .pagination,
    #pg-results-txt,
    #pg-mod-txt {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background: var(--bg-surface);
      border-top: 1px solid var(--border-color);
      justify-content: center;
    }

    /* Pagination Text Info */
    #pg-results-txt,
    #pg-mod-txt {
      font-size: 13px;
      color: var(--text-secondary);
      font-weight: 600;
      margin: 0 12px;
    }

    /* Pagination Arrow Buttons */
    .page-btn,
    button[onclick*="changePage"] {
      min-width: 36px;
      height: 36px;
      padding: 8px;
      background: var(--bg-surface);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-md);
      /* 6px */
      color: var(--text-primary);
      /* Dark text - VISIBLE */
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all var(--transition-fast);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-sm);
    }

    /* Hover State - Teal Highlight */
    .page-btn:hover:not(:disabled),
    button[onclick*="changePage"]:hover:not(:disabled) {
      background: var(--accent-light);
      /* Teal background */
      border-color: var(--accent);
      /* Teal border */
      color: var(--accent);
      /* Teal text */
      transform: translateY(-1px);
      box-shadow: var(--shadow-md);
    }

    /* Active/Press State */
    .page-btn:active,
    button[onclick*="changePage"]:active {
      transform: translateY(0);
      box-shadow: var(--shadow-sm);
    }

    /* Disabled State */
    .page-btn:disabled,
    button[onclick*="changePage"]:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      background: var(--bg-surface);
      color: var(--text-muted);
      border-color: var(--border-color);
      pointer-events: none;
    }

    /* Better Arrow Symbols */
    .page-btn::before,
    button[onclick*="changePage(-1"]::before {
      content: "◀";
      /* Left arrow */
      font-size: 14px;
    }

    .page-btn.next::before,
    button[onclick*="changePage(1"]::before {
      content: "▶";
      /* Right arrow */
      font-size: 14px;
    }

    /* If using text instead of symbols */
    .page-btn,
    button[onclick*="changePage"] {
      font-family: Arial, sans-serif;
      /* Ensures arrows display */
    }



    /* Full Pagination Bar */
    .pagination-wrapper {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 20px;
      background: linear-gradient(to bottom, var(--bg-surface), var(--bg-header));
      border-top: 1px solid var(--border-color);
      border-bottom: 1px solid var(--border-color);
      box-shadow: var(--shadow-sm);
    }

    /* Left side: Info text */
    .pagination-info {
      font-size: 13px;
      color: var(--text-secondary);
      font-weight: 600;
    }

    /* Center: Arrow buttons */
    .pagination-controls {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    /* Right side: Optional actions */
    .pagination-actions {
      display: flex;
      gap: 8px;
    }

    /* ==========================================
   PAGINATION ARROWS - VISIBLE & PROFESSIONAL
   ========================================== */

    /* Target pagination buttons specifically */
    button[onclick*="changePage"] {
      min-width: 36px !important;
      height: 30px !important;
      padding: 0 10px !important;
      background: #ffffff !important;
      border: 2px solid #0078d4 !important;
      /* Blue border */
      color: #0078d4 !important;
      /* Blue arrows */
      font-size: 18px !important;
      /* Big arrows */
      font-weight: 900 !important;
      /* Bold arrows */
      border-radius: 6px !important;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12) !important;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    /* Hover - Blue background */
    button[onclick*="changePage"]:hover {
      background: #0078d4 !important;
      color: white !important;
      border-color: #005a9e !important;
      transform: translateY(-1px);
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2) !important;
    }

    /* Active/Press State */
    button[onclick*="changePage"]:active {
      transform: translateY(0);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12) !important;
    }

    /* Pagination Text - Bold and clear */
    #pg-rgb-txt,
    #pg-qaqc-txt,
    #pg-results-txt {
      font-size: 13px !important;
      color: var(--text-primary) !important;
      font-weight: 700 !important;
      padding: 0 12px !important;
      min-width: 120px;
      text-align: center;
    }


    /* ==========================================
   FIX GREY BUTTONS - MAKE THEM VISIBLE
   (PROTECT POWER BUTTON)
   ========================================== */

    /* Target ONLY plain .btn without specific color classes */
    .btn:not(.btn-teal):not(.btn-slate):not(.btn-indigo):not(.btn-orange):not(.btn-blue):not(.btn-green):not(.btn-plus):not(.btn-red):not(.btn-minus):not(.btn-outline):not(.btn-power):not(.btn-zoom) {
      background: var(--gradient-surface) !important;
      border: 2px solid var(--accent) !important;
      color: var(--accent) !important;
      font-weight: 700 !important;
    }

    .btn:not(.btn-teal):not(.btn-slate):not(.btn-indigo):not(.btn-orange):not(.btn-blue):not(.btn-green):not(.btn-plus):not(.btn-red):not(.btn-minus):not(.btn-outline):not(.btn-power):not(.btn-zoom):hover {
      background: var(--gradient-primary) !important;
      color: white !important;
      border-color: var(--accent-hover) !important;
    }

    /* Fix specific grey buttons with better colors */
    button[onclick*="saveCriteria"],
    button[onclick*="saveSTV"],
    button[onclick*="saveBlanks"],
    button[onclick*="saveDeviceRegistry"],
    button[onclick*="saveQCBatchAssignments"] {
      background: var(--gradient-accent) !important;
      border: 1px solid rgba(20, 184, 166, 0.5) !important;
      color: white !important;
      font-weight: 600 !important;
      height: 30px !important;
    }

    button[onclick*="saveCriteria"]:hover,
    button[onclick*="saveSTV"]:hover,
    button[onclick*="saveBlanks"]:hover,
    button[onclick*="saveDeviceRegistry"]:hover,
    button[onclick*="saveQCBatchAssignments"]:hover {
      opacity: 0.9 !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    }

    /* Override STV button - Orange/Warning color */
    button[onclick*="dbOverrideSTV"] {
      background: linear-gradient(135deg, #f59e0b, #f97316) !important;
      border: 1px solid rgba(245, 158, 11, 0.45) !important;
      color: white !important;
      font-weight: 600 !important;
      height: 30px !important;
    }

    button[onclick*="dbOverrideSTV"]:hover {
      opacity: 0.9 !important;
    }

    /* PROTECT POWER BUTTON - Ensure it stays original */
    .btn-power {
      width: 32px !important;
      height: 32px !important;
      border-radius: 50% !important;
      background-color: #d13438 !important;
      color: white !important;
      border: 2px solid white !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      cursor: pointer !important;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2) !important;
      transition: all 0.2s !important;
      margin-left: auto !important;
      padding: 0 !important;
      min-width: 32px !important;
    }

    .btn-power:hover {
      background-color: #a80000 !important;
      transform: scale(1.1) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3) !important;
    }

    .btn-power svg {
      width: 18px !important;
      height: 18px !important;
      stroke-width: 2.5 !important;
    }




    /* =========================================
       1. DESIGN SYSTEM & VARIABLES
       ========================================= */
    :root {
      --font-sans: "Inter", "Segoe UI", "Roboto", "Helvetica Neue", Arial, sans-serif;
      /* ====== PROFESSIONAL BLUE-GRAY PALETTE ====== */

      /* Primary Colors - Deep Professional Blue */
      --primary: #1e3a8a;
      /* Deep Blue for Sidebar */
      --primary-dark: #1e40af;
      /* Darker Blue */
      --primary-light: #3b82f6;
      /* Lighter Blue */

      --accent: #14b8a6;
      /* Modern Teal (was #0078d4) */
      --accent-hover: #0f766e;
      /* Darker Teal */
      --accent-light: #5eead4;
      /* Light Teal */

      --success: #10b981;
      /* Modern Green */
      --success-hover: #059669;
      --success-light: #d1fae5;

      --danger: #ef4444;
      /* Modern Red */
      --danger-hover: #dc2626;
      --danger-light: #fee2e2;

      --table-row-height: 44px;

      --warning: #f59e0b;
      /* Amber */
      --warning-hover: #d97706;
      --warning-light: #fef3c7;

      --info: #3b82f6;
      /* Blue */
      --info-light: #dbeafe;

      --neutral-gray: #64748b;
      /* Slate Gray */

      /* Backgrounds - Softer & Cleaner */
      --bg-body: #f8fafc;
      /* Lighter background */
      --bg-surface: #ffffff;
      /* Pure white */
      --bg-header: #f1f5f9;
      /* Subtle gray */
      --bg-hover: #f1f5f9;
      /* Hover state */

      /* Borders & Separators */
      --border-color: #e2e8f0;
      /* Softer border */
      --border-dark: #cbd5e1;
      /* Darker border */
      --border-radius-sm: 4px;
      --border-radius-md: 6px;
      --border-radius-lg: 8px;
      --border-radius-xl: 12px;

      /* Shadows - Enhanced Depth */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
      --shadow-header: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
      --shadow-card: 0 1px 3px 0 rgba(0, 0, 0, 0.1);

      /* Text Colors */
      --text-primary: #1e293b;
      /* Dark slate */
      --text-secondary: #64748b;
      /* Medium slate */
      --text-muted: #94a3b8;
      /* Light slate */

      /* Transitions */
      --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-smooth: 200ms cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: 300ms cubic-bezier(0.4, 0, 0.2, 1);

      /* #2c3e50 - Sidebar/Text */
      --primary-dark: hsl(var(--primary-hue), 29%, 18%);

      --accent: #2563eb;
      /* Vivid Blue */
      --accent-hover: #1d4ed8;

      --success: #22c55e;
      /* Lush Green */
      --success-hover: #16a34a;

      --danger: #ef4444;
      /* Bright Red */
      --danger-hover: #dc2626;

      --neutral-gray: #475569;

      /* -- Backgrounds -- */
      --bg-body: #eef2ff;
      /* Soft Indigo wash */
      --bg-surface: #ffffff;
      /* White Cards */
      --bg-header: #f8fafc;
      /* Table Headers */
      --bg-hover: #e0f2fe;

      /* -- Borders & Separators -- */
      --border-color: #e2e8f0;
      --border-radius-sm: 6px;
      --border-radius-md: 10px;
      --border-radius-lg: 14px;

      /* -- Gradients -- */
      --gradient-primary: linear-gradient(135deg, #2563eb, #38bdf8);
      --gradient-accent: linear-gradient(135deg, #14b8a6, #22d3ee);
      --gradient-success: linear-gradient(135deg, #16a34a, #4ade80);
      --gradient-danger: linear-gradient(135deg, #ef4444, #f97316);
      --gradient-surface: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);

      /* -- Shadows (Elevation) -- */
      --shadow-sm: 0 2px 4px rgba(15, 23, 42, 0.08);
      --shadow-md: 0 8px 16px rgba(15, 23, 42, 0.12);
      --shadow-header: 0 8px 20px rgba(15, 23, 42, 0.12);

      /* -- Transitions -- */
      --transition-fast: 0.15s ease;
      --transition-smooth: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* =========================================
       2. GLOBAL RESET & TYPOGRAPHY
       ========================================= */
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: var(--font-sans);
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-primary);
      background: var(--bg-body);
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: var(--font-sans);
      color: var(--text-primary);
      margin: 0 0 0.4rem;
      line-height: 1.2;
    }

    h1 { font-size: 1.4rem; font-weight: 700; }
    h2 { font-size: 1.2rem; font-weight: 700; }
    h3 { font-size: 1.05rem; font-weight: 700; }
    h4 { font-size: 0.95rem; font-weight: 600; }

    small,
    .tag,
    .badge {
      font-size: 0.75rem;
      color: var(--text-secondary);
      font-style: italic;
    }

    .panel-label,
    .module-header .toolbar strong,
    .panel-label span,
    .qaqc-summary-title {
      font-weight: 700;
    }

    /* =========================================
   3. SIDEBAR NAVIGATION (Dynamic Width Fix)
   ========================================= */
    .sidebar {
      /* 1. DYNAMIC WIDTH LOGIC */
      width: max-content;
      /* Grow to fit the longest text */
      min-width: 240px;
      /* Minimum width to look professional */
      max-width: 350px;
      /* Maximum width safety cap */

      background: linear-gradient(180deg, #1e40af 0%, #0f172a 100%);
      color: #ecf0f1;
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
      z-index: 50;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);

      /* Hide overflow to prevent text bleeding */
      overflow-x: hidden;
      white-space: nowrap;

      /* Note: 'max-content' cannot animate smoothly in CSS. 
       This will snap between open/closed, which is required for true dynamic width. */
      transition: width 0.1s;
    }

    .logo {
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 10px;
      background: rgba(0, 0, 0, 0.2);
      /* Softer */
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      /* ADD THIS */
    }

    /* Logo Image Styling */
    .logo-img {
      max-height: 50px;
      max-width: 100%;
      width: auto;
      object-fit: contain;
      transition: opacity 0.2s;
    }

    .sidebar-toggle {
      background: rgba(0, 0, 0, 0.1);
      border: none;
      color: #ccc;
      padding: 5px;
      cursor: pointer;
      text-align: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
      transition: background var(--transition-smooth);
    }

    .sidebar-toggle:hover {
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .user-card {
      margin: 14px 14px 10px;
      padding: 14px;
      background: linear-gradient(160deg, rgba(10, 18, 41, 0.95), rgba(14, 24, 54, 0.92));
      border-radius: 16px;
      box-shadow: 0 12px 26px rgba(2, 6, 23, 0.35);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .user-card-header {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .user-avatar {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      background: #10b981;
      display: grid;
      place-items: center;
      color: #ffffff;
      box-shadow: 0 6px 16px rgba(16, 185, 129, 0.45);
      flex-shrink: 0;
    }

    .user-avatar svg {
      width: 22px;
      height: 22px;
    }

    .user-name {
      font-size: 16px;
      font-weight: 700;
      color: #f8fafc;
      line-height: 1.2;
    }

    .user-role {
      font-size: 13px;
      color: rgba(226, 232, 240, 0.8);
      font-weight: 500;
    }

    .user-logout {
      border: none;
      background: rgba(255, 255, 255, 0.08);
      color: #ffffff;
      padding: 10px 12px;
      border-radius: 12px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .user-logout:hover {
      background: rgba(255, 255, 255, 0.16);
      transform: translateY(-1px);
    }

    .user-logout:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .user-logout svg {
      width: 18px;
      height: 18px;
    }

    .user-power {
      margin: 10px auto 6px;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: none;
      background: #ef4444;
      color: #ffffff;
      display: none;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 18px rgba(239, 68, 68, 0.35);
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .user-power:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(239, 68, 68, 0.45);
    }

    .user-power:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 6px 12px rgba(239, 68, 68, 0.25);
    }

    .user-power svg {
      width: 20px;
      height: 20px;
    }

    /* Navigation Items */
    .nav-item {
      padding: 12px 25px;
      /* Increased side padding for better look */
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 15px;
      /* Space between icon and text */
      color: #bdc3c7;
      font-weight: 500;
      transition: all 0.2s;
      border-left: 4px solid transparent;
      white-space: nowrap;
      overflow: hidden;
      height: 48px;
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.05);
      color: white;
    }

    .nav-item.active {
      background: #fef08a;
      color: #2563eb;
      border-left-color: #2563eb;
      box-shadow: inset 0 0 0 1px rgba(37, 99, 235, 0.15);
    }

    /* Icon Styling - Professional & Larger */
    .nav-icon {
      width: 24px;
      /* Larger size */
      height: 24px;
      min-width: 24px;
      /* Prevent shrinking */
      fill: currentColor;
      flex-shrink: 0;
      transition: transform 0.2s ease, filter 0.2s;
      shape-rendering: geometricPrecision;
      stroke-width: 2.2;
    }

    .nav-item.active .nav-icon {
      color: #2563eb;
    }

    /* Professional Module Colors */
    .nav-item:nth-of-type(2) .nav-icon {
      color: #4fc3f7;
    }

    /* Cyan */
    .nav-item:nth-of-type(3) .nav-icon {
      color: #ffb74d;
    }

    /* Orange */
    .nav-item:nth-of-type(4) .nav-icon {
      color: #81c784;
    }

    /* Green */
    .nav-item:nth-of-type(5) .nav-icon {
      color: #ba68c8;
    }

    /* Purple */
    .nav-item:nth-of-type(6) .nav-icon {
      color: #ffd54f;
    }

    /* Yellow */
    .nav-item:nth-of-type(7) .nav-icon {
      color: #e57373;
    }

    /* Red */
    .nav-item:nth-of-type(8) .nav-icon {
      color: #bdbdbd;
    }

    /* Silver */

    .nav-item:hover .nav-icon {
      filter: brightness(1.2);
      transform: scale(1.1);
    }

    /* --- COLLAPSED STATE (Strict Override) --- */
    .sidebar.collapsed {
      /* Force fixed width to override max-content */
      width: 64px !important;
      min-width: 64px !important;
      max-width: 64px !important;
    }

    /* 1. STRICTLY HIDE TEXT */
    /* Crush font-size to 0 to eliminate any residual text width */
    .sidebar.collapsed .nav-item {
      font-size: 0 !important;
      padding: 12px 0;
      /* Remove side padding to center icon */
      justify-content: center;
      gap: 0;
    }

    /* Hide specific elements */
    .sidebar.collapsed .logo-text,
    .sidebar.collapsed .nav-item span {
      display: none !important;
      opacity: 0;
    }

    /* Hide Logo Image */
    .sidebar.collapsed .logo-img {
      display: none !important;
    }

    .sidebar.collapsed .user-card {
      display: none;
    }

    .sidebar.collapsed .user-power {
      display: flex;
    }

    .sidebar.collapsed .logo {
      padding: 0;
    }

    /* =========================================
       4. MAIN LAYOUT & MODULES
       ========================================= */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: var(--bg-body);
      overflow: hidden;
      position: relative;
    }

    /* Animation for switching modules */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .module-view {
      display: none;
      height: 100%;
      flex-direction: column;
      animation: fadeIn 0.25s ease-out;
    }

    .module-view.active {
      display: flex;
    }

    /* Module Header */
    .module-header {
      background: var(--gradient-surface);
      padding: 16px 24px;
      /* Was 10px 20px - better spacing */
      border-bottom: 1px solid rgba(37, 99, 235, 0.15);
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-header);
      z-index: 20;
    }


    .toolbar {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 100%;
      flex-wrap: wrap;
    }

    /* =========================================
       5. BUTTONS & INPUTS (Modern Style)
       ========================================= */

    /* Make zoom buttons look like a unified control */
    .btn-zoom:not(:last-child) {
      border-right: none;
      /* Remove right border except last */
    }

    .btn-zoom:first-child {
      border-radius: 4px 0 0 4px;
      /* Round left side only */
    }

    .btn-zoom:last-child {
      border-radius: 0 4px 4px 0;
      /* Round right side only */
    }

    /* If zoom label is between buttons, add separators */
    .zoom-controls .zoom-label {
      border-left: 1px solid var(--border-color);
      border-right: 1px solid var(--border-color);
      padding: 0 8px;
      height: 20px;
      display: flex;
      align-items: center;
    }





    /* --- STANDARD BUTTONS --- */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0 14px;
      height: 32px;
      font-size: 0.8rem;
      font-weight: 600;
      border-radius: var(--border-radius-md);
      border: 1px solid var(--btn-border, rgba(37, 99, 235, 0.4));
      cursor: pointer;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast), opacity var(--transition-fast);
      color: var(--btn-text, #f8fafc);
      background: var(--btn-bg, var(--gradient-primary));
      box-shadow: 0 6px 14px rgba(37, 99, 235, 0.2);
    }

    .btn:active {
      transform: translateY(1px);
    }

    .btn:hover {
      opacity: 0.96;
      box-shadow: 0 10px 20px rgba(37, 99, 235, 0.25);
      transform: translateY(-1px);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      box-shadow: none;
    }

    /* Primary/Action Buttons */
    .btn-teal {
      --btn-bg: var(--gradient-accent);
      --btn-border: rgba(20, 184, 166, 0.5);
    }

    .btn-blue {
      --btn-bg: var(--gradient-primary);
      --btn-border: rgba(37, 99, 235, 0.5);
    }

    .btn-slate {
      --btn-bg: linear-gradient(135deg, #64748b, #94a3b8);
      --btn-border: rgba(100, 116, 139, 0.4);
    }

    /* Status Buttons */
    .btn-green,
    .btn-plus {
      --btn-bg: var(--gradient-success);
      --btn-border: rgba(34, 197, 94, 0.45);
    }

    .btn-red,
    .btn-minus {
      --btn-bg: var(--gradient-danger);
      --btn-border: rgba(239, 68, 68, 0.45);
    }

    .btn-orange {
      --btn-bg: linear-gradient(135deg, #f59e0b, #f97316);
      --btn-border: rgba(245, 158, 11, 0.45);
    }

    .btn-indigo {
      --btn-bg: linear-gradient(135deg, #6366f1, #8b5cf6);
      --btn-border: rgba(99, 102, 241, 0.45);
    }



    /* Inputs */
    input[type="text"],
    input[type="date"],
    input[type="number"],
    input[type="password"],
    select {
      height: 32px;
      padding: 6px 12px;
      border: 1px solid rgba(37, 99, 235, 0.25);
      border-radius: var(--border-radius-md);
      font-size: 0.85rem;
      color: #1f2937;
      background: var(--gradient-surface);
      transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
    }

    input:focus,
    select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
    }


    /* Special Input Classes */
    .date-input {
      width: 125px;
    }

    .search-input {
      width: 140px;
    }

    /* Table Inputs (Invisible until focused) */
    .db-input {
      width: 100%;
      border: 1px solid transparent;
      background: transparent;
      padding: 4px;
      border-radius: 2px;
    }

    .db-input:hover {
      border-color: #e5e7eb;
      background: #fff;
    }

    .db-input:focus {
      border-color: var(--accent);
      background: #fff;
      outline: none;
    }

    /* =========================================
       6. TABLES (Clean & Professional)
       ========================================= */
    .table-wrapper {
      flex: 1;
      overflow: auto;
      background: var(--bg-surface);
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      min-width: 100%;
    }

    thead {
      position: sticky;
      top: 0;
      z-index: 10;
      background: var(--bg-header);
    }

    th {
      background: linear-gradient(180deg, rgba(37, 99, 235, 0.12), rgba(248, 250, 252, 0.95));
      color: #0f172a;
      font-weight: 700;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 12px 16px;
      /* BETTER SPACING */
      border-bottom: 2px solid rgba(37, 99, 235, 0.25);
      border-right: 1px solid rgba(226, 232, 240, 0.8);
      text-align: center;
      white-space: nowrap;
    }

    td {
      padding: 10px 14px;
      /* BETTER SPACING */
      border-bottom: 1px solid #e5e7eb;
      border-right: 1px solid #f3f4f6;
      color: #1f2937;
      font-size: 0.85rem;
      text-align: center;
      white-space: nowrap;
      background: var(--bg-surface);
    }

    /* Table Hover & Select */
    tbody tr {
      transition: background 0.1s;
    }

    tbody tr:hover {
      background-color: var(--bg-hover);
    }

    .selectable-table tr {
      cursor: pointer;
    }
    .selectable-table tbody tr {
      min-height: var(--table-row-height);
    }
    .selectable-table td {
      min-height: var(--table-row-height);
    }

    /* Bright Yellow Highlight for Selected Rows */
    .selectable-table tr.selected td {
      background-color: #fff9c4 !important;
      /* Bright Yellow */
      color: #333 !important;
      /* Ensure text is readable */
      border-top: 1px solid #fbc02d;
      /* Golden border */
      border-bottom: 1px solid #fbc02d;
    }

    /* Golden Left Border to mark selection */
    .selectable-table tr.selected td:first-child {
      border-left: 5px solid #f1c40f !important;
    }

    /* Status Colors in Cells */
    .status-pass {
      color: var(--success);
      font-weight: 700;
      background-color: rgba(16, 124, 16, 0.1);
      border-radius: 12px;
      padding: 2px 8px;
      font-size: 0.75rem;
    }

    .status-fail {
      color: var(--danger);
      font-weight: 700;
      background-color: rgba(209, 52, 56, 0.1);
      border-radius: 12px;
      padding: 2px 8px;
      font-size: 0.75rem;
    }

    .val-red {
      color: var(--danger);
      font-weight: 700;
    }

    .text-blue {
      color: var(--accent);
      font-weight: 600;
    }

    /* =========================================
       7. SPLIT PANELS & LAYOUT UTILS
       ========================================= */
    .split-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .panel-upper,
    .panel-lower {
      overflow: auto;
      position: relative;
      background: var(--bg-surface);
    }

    .panel-upper {
      height: 40%;
      border-bottom: 1px solid var(--border-color);
    }

    .panel-lower {
      flex: 1;
    }

    .panel-label {
      position: sticky;
      top: 0;
      left: 0;
      width: 100%;
      background: #f1f5f9;
      /* Slate 100 */
      color: #475569;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      padding: 6px 15px;
      border-bottom: 1px solid var(--border-color);
      z-index: 15;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .resizer {
      height: 8px;
      background: #e2e8f0;
      cursor: row-resize;
      border-top: 1px solid #cbd5e1;
      border-bottom: 1px solid #cbd5e1;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-shrink: 0;
    }

    .resizer::after {
      content: "•••";
      color: #94a3b8;
      font-size: 10px;
      letter-spacing: 2px;
      margin-top: -4px;
    }

    .resizer:hover {
      background: #cbd5e1;
    }


    /* Nutrient Manager split panels: resizable vertical layout */
    #mod-fertilizer .split-container {
      display: flex;
      flex-direction: column;
      /* Adjust this height to fit under your module header */
      height: calc(100vh - 160px);
      min-height: 400px;
    }

    /* Make both panels scrollable when space is tight */
    #mod-fertilizer .panel-upper,
    #mod-fertilizer .panel-lower {
      overflow: auto;
    }

    /* Initial height split: 40% top, 60% bottom */
    #mod-fertilizer .panel-upper {
      flex: 0 0 40%;
      min-height: 150px;
    }

    #mod-fertilizer .panel-lower {
      flex: 1 1 auto;
      min-height: 150px;
    }

    /* Drag handle between panels */
    #mod-fertilizer .panel-divider {
      height: 6px;
      background: var(--border-color);
      cursor: row-resize;
      flex: 0 0 6px;
      transition: background-color 0.15s ease;
    }

    /* Hover + active state to signal drag-ability */
    #mod-fertilizer .panel-divider:hover {
      background: #9ca3af;
      /* slightly darker grey */
    }

    #mod-fertilizer .panel-divider:active {
      background: #6b7280;
    }

    #mod-fertilizer .nm-toolbar {
      display: flex;
      flex-direction: column;
      gap: 10px;
      width: 100%;
    }

    #mod-fertilizer .nm-toolbar-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      width: 100%;
    }

    #mod-fertilizer .nm-advanced {
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-md);
      background: #f8fafc;
      padding: 8px 12px;
    }

    #mod-fertilizer .nm-advanced summary {
      font-size: 0.85rem;
      font-weight: 700;
      color: #475569;
      cursor: pointer;
      list-style: none;
    }

    #mod-fertilizer .nm-advanced summary::-webkit-details-marker {
      display: none;
    }

    #mod-fertilizer .nm-advanced-content {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    #mod-fertilizer .nm-method-info {
      width: 100%;
      font-size: 12px;
      color: #666;
    }

    #mod-fertilizer .nm-content {
      display: flex;
      flex-direction: column;
      flex: 1;
      min-height: 0;
      overflow: hidden;
    }

    #mod-fertilizer .tab-nav {
      border-top: 1px solid var(--border-color);
    }

    #mod-fertilizer .sub-tab-content {
      display: none;
      padding: 16px;
      overflow: auto;
      flex: 1;
      background: var(--bg-body);
    }

    #mod-fertilizer .nm-cost-summary {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 6px;
      padding: 8px 4px 0;
      font-size: 0.85rem;
      font-weight: 600;
      color: #374151;
    }

    #mod-fertilizer .soil-report {
      --report-bg: #f5f6f7;
      --report-card: #ffffff;
      --report-ink: #1f2328;
      --report-muted: #667085;
      --report-line: #e6e8ec;
      --report-shadow: 0 8px 24px rgba(16, 24, 40, 0.08);
      --report-shadow2: 0 4px 14px rgba(16, 24, 40, 0.06);
      --report-chip: #eef2f6;
      --report-chip2: #f1f5f9;
      --report-b1: #ff6b6b;
      --report-b2: #ff9a76;
      --report-b3: #f6c343;
      --report-b4: #cfe86a;
      --report-b5: #7fd36c;
      --report-b6: #4fbf63;
      --report-low: #ff6b6b;
      --report-mid: #f6c343;
      --report-high: #5ac56a;
      --report-radius: 14px;
      font-family: var(--font-sans);
      color: var(--report-ink);
      background: var(--report-bg);
      border-radius: 18px;
      overflow: hidden;
      box-shadow: var(--report-shadow);
    }

    #mod-fertilizer .soil-report * {
      box-sizing: border-box;
    }

    #mod-fertilizer .soil-report .hero {
      height: 160px;
      background:
        linear-gradient(90deg, rgba(0, 0, 0, 0.45), rgba(0, 0, 0, 0.15)),
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1600' height='400'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' x2='0' y1='0' y2='1'%3E%3Cstop stop-color='%235b3a1f' offset='0'/%3E%3Cstop stop-color='%233a2416' offset='1'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='1600' height='400' fill='url(%23g)'/%3E%3Ccircle cx='260' cy='120' r='150' fill='rgba(255,255,255,0.06)'/%3E%3Ccircle cx='1240' cy='80' r='250' fill='rgba(255,255,255,0.05)'/%3E%3C/svg%3E");
      background-size: cover;
      background-position: center;
    }

    #mod-fertilizer .soil-report .hero-inner {
      max-width: 1120px;
      margin: 0 auto;
      padding: 16px;
      height: 100%;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      color: #fff;
    }

    #mod-fertilizer .soil-report .brand {
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }

    #mod-fertilizer .soil-report .brand-mark {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.12);
      border: 1px solid rgba(255, 255, 255, 0.18);
      display: grid;
      place-items: center;
    }

    #mod-fertilizer .soil-report .brand h1 {
      margin: 0;
      font-size: 22px;
      font-weight: 900;
      letter-spacing: 0.2px;
      color: #fff;
    }

    #mod-fertilizer .soil-report .powered {
      margin-top: 3px;
      font-size: 12px;
      opacity: 0.9;
      font-weight: 700;
    }

    #mod-fertilizer .soil-report .hero-title {
      font-size: 16px;
      font-weight: 800;
      opacity: 0.95;
      margin-top: 6px;
    }

    #mod-fertilizer .soil-report .meta-wrap {
      max-width: 1120px;
      margin: -52px auto 14px;
      padding: 0 16px;
    }

    #mod-fertilizer .soil-report .meta {
      background: var(--report-card);
      border: 1px solid var(--report-line);
      border-radius: 16px;
      box-shadow: var(--report-shadow);
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      overflow: hidden;
    }

    #mod-fertilizer .soil-report .meta .cell {
      padding: 14px 16px;
      border-right: 1px solid var(--report-line);
    }

    #mod-fertilizer .soil-report .meta .cell:last-child {
      border-right: none;
    }

    #mod-fertilizer .soil-report .meta .label {
      font-size: 12px;
      color: var(--report-muted);
      font-weight: 800;
      margin-bottom: 4px;
    }

    #mod-fertilizer .soil-report .meta .value {
      font-size: 15px;
      font-weight: 900;
    }

    #mod-fertilizer .soil-report .page {
      max-width: 1120px;
      margin: 0 auto;
      padding: 0 16px 26px;
    }

    #mod-fertilizer .soil-report .section-title {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin: 18px 0 10px;
    }

    #mod-fertilizer .soil-report .section-title h2 {
      margin: 0;
      font-size: 16px;
      font-weight: 900;
    }

    #mod-fertilizer .soil-report .section-title .hint {
      margin: 0;
      font-size: 12px;
      color: var(--report-muted);
      font-weight: 800;
    }

    #mod-fertilizer .soil-report .param-card {
      background: var(--report-card);
      border: 1px solid var(--report-line);
      border-radius: var(--report-radius);
      box-shadow: var(--report-shadow2);
      overflow: hidden;
      margin-bottom: 10px;
    }

    #mod-fertilizer .soil-report .param-row {
      display: grid;
      grid-template-columns: 260px 1fr 320px;
      gap: 12px;
      padding: 10px;
    }

    #mod-fertilizer .soil-report .param-left {
      background: #f2f4f1;
      border: 1px solid #e7eae6;
      border-radius: 12px;
      padding: 12px;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    #mod-fertilizer .soil-report .badge {
      width: 34px;
      height: 34px;
      border-radius: 10px;
      background: #e9f6ee;
      border: 1px solid #d7efdf;
      display: grid;
      place-items: center;
      flex: 0 0 auto;
    }

    #mod-fertilizer .soil-report .pname {
      margin: 0;
      font-weight: 900;
      font-size: 13px;
      line-height: 1.15;
    }

    #mod-fertilizer .soil-report .psub {
      margin: 2px 0 0;
      font-size: 12px;
      color: var(--report-muted);
      font-weight: 800;
    }

    #mod-fertilizer .soil-report .param-mid {
      border: 1px solid var(--report-line);
      border-radius: 12px;
      padding: 12px;
    }

    #mod-fertilizer .soil-report .result-top {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    #mod-fertilizer .soil-report .result-value {
      font-size: 26px;
      font-weight: 900;
      letter-spacing: 0.2px;
    }

    #mod-fertilizer .soil-report .result-chip {
      font-size: 12px;
      padding: 5px 12px;
      border-radius: 999px;
      background: var(--report-chip);
      border: 1px solid var(--report-line);
      font-weight: 900;
      color: #111827;
      white-space: nowrap;
    }

    #mod-fertilizer .soil-report .bar-wrap {
      position: relative;
      padding: 10px 0 4px;
    }

    #mod-fertilizer .soil-report .bar {
      height: 10px;
      border-radius: 999px;
      overflow: hidden;
      border: 1px solid #e6e6e6;
      display: flex;
      width: 100%;
    }

    #mod-fertilizer .soil-report .seg {
      height: 100%;
    }

    #mod-fertilizer .soil-report .seg.low { background: var(--report-low); }
    #mod-fertilizer .soil-report .seg.mid { background: var(--report-mid); }
    #mod-fertilizer .soil-report .seg.high { background: var(--report-high); }
    #mod-fertilizer .soil-report .seg.b1 { background: var(--report-b1); }
    #mod-fertilizer .soil-report .seg.b2 { background: var(--report-b2); }
    #mod-fertilizer .soil-report .seg.b3 { background: var(--report-b3); }
    #mod-fertilizer .soil-report .seg.b4 { background: var(--report-b4); }
    #mod-fertilizer .soil-report .seg.b5 { background: var(--report-b5); }
    #mod-fertilizer .soil-report .seg.b6 { background: var(--report-b6); }

    #mod-fertilizer .soil-report .marker {
      position: absolute;
      top: -2px;
      width: 2px;
      height: 34px;
      background: #111827;
      border-radius: 2px;
      transform: translateX(-1px);
    }

    #mod-fertilizer .soil-report .marker::after {
      content: "";
      position: absolute;
      top: -6px;
      left: 50%;
      transform: translateX(-50%);
      width: 10px;
      height: 10px;
      background: #111827;
      border-radius: 2px;
      rotate: 45deg;
    }

    #mod-fertilizer .soil-report .tickline {
      position: relative;
      height: 18px;
      margin-top: 8px;
    }

    #mod-fertilizer .soil-report .tick {
      position: absolute;
      top: 0;
      transform: translateX(-50%);
      font-size: 11px;
      color: var(--report-muted);
      font-weight: 900;
      white-space: nowrap;
    }

    #mod-fertilizer .soil-report .tick.end {
      left: 100%;
      transform: translateX(-10%);
    }

    #mod-fertilizer .soil-report .zoneWords {
      position: relative;
      height: 16px;
      margin-top: 2px;
    }

    #mod-fertilizer .soil-report .zoneWords span {
      position: absolute;
      top: 0;
      font-size: 11px;
      color: var(--report-muted);
      font-weight: 900;
      white-space: nowrap;
      transform: translateX(-50%);
    }

    #mod-fertilizer .soil-report .zoneWords .zL {
      left: 0%;
      transform: translateX(0);
    }

    #mod-fertilizer .soil-report .zoneWords .zM {
      left: 50%;
    }

    #mod-fertilizer .soil-report .zoneWords .zR {
      left: 100%;
      transform: translateX(-100%);
    }

    #mod-fertilizer .soil-report .param-right {
      border: 1px solid var(--report-line);
      border-radius: 12px;
      padding: 12px;
      background: #fff;
    }

    #mod-fertilizer .soil-report .rtop {
      font-size: 12px;
      color: var(--report-muted);
      font-weight: 900;
      margin-bottom: 6px;
    }

    #mod-fertilizer .soil-report .rtext {
      margin: 0;
      font-size: 12px;
      line-height: 1.45;
      color: #111827;
    }

    #mod-fertilizer .soil-report .info-card {
      background: var(--report-card);
      border: 1px solid var(--report-line);
      border-radius: 16px;
      box-shadow: var(--report-shadow2);
      padding: 12px 14px;
      margin-top: 12px;
    }

    #mod-fertilizer .soil-report .info-card h3 {
      margin: 0 0 8px 0;
      font-size: 13px;
      font-weight: 900;
    }

    #mod-fertilizer .soil-report .info-card ol,
    #mod-fertilizer .soil-report .info-card p {
      margin: 0;
      padding-left: 18px;
      font-size: 12px;
      line-height: 1.45;
      color: #111827;
      font-weight: 700;
    }

    #mod-fertilizer .soil-report .info-card p {
      padding-left: 0;
    }

    #mod-fertilizer .soil-report .info-card .muted {
      color: var(--report-muted);
      font-weight: 800;
    }

    #mod-fertilizer .soil-report .rec-card {
      background: var(--report-card);
      border: 1px solid var(--report-line);
      border-radius: 16px;
      box-shadow: var(--report-shadow);
      overflow: hidden;
      margin-top: 14px;
    }

    #mod-fertilizer .soil-report .rec-head {
      padding: 12px 14px;
      border-bottom: 1px solid var(--report-line);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    #mod-fertilizer .soil-report .rec-head h3 {
      margin: 0;
      font-size: 14px;
      font-weight: 900;
    }

    #mod-fertilizer .soil-report .rec-head .sub {
      font-size: 12px;
      color: var(--report-muted);
      font-weight: 900;
    }

    #mod-fertilizer .soil-report .rec-note {
      padding: 10px 14px;
      border-bottom: 1px solid var(--report-line);
      color: #111827;
      font-size: 12px;
      background: #fafbfc;
      font-weight: 900;
    }

    #mod-fertilizer .soil-report table {
      width: 100%;
      border-collapse: collapse;
    }

    #mod-fertilizer .soil-report th,
    #mod-fertilizer .soil-report td {
      border-bottom: 1px solid var(--report-line);
      padding: 10px 10px;
      vertical-align: top;
      font-size: 12px;
      font-weight: 700;
    }

    #mod-fertilizer .soil-report th {
      text-align: left;
      background: #3c2a21;
      color: #fff;
      font-weight: 900;
      letter-spacing: 0.2px;
    }

    #mod-fertilizer .soil-report td strong {
      font-weight: 900;
    }

    #mod-fertilizer .soil-report .td-day {
      width: 190px;
      font-weight: 900;
      background: #fbfbfb;
    }

    #mod-fertilizer .soil-report .disclaimer {
      margin-top: 16px;
      font-size: 11px;
      color: #3f4856;
      line-height: 1.4;
      padding: 12px 14px;
      background: #fff;
      border: 1px solid var(--report-line);
      border-radius: 14px;
      font-weight: 700;
    }

    #mod-fertilizer .soil-report .report-actions {
      display: flex;
      gap: 10px;
      align-items: center;
      margin: 10px 0 0;
      flex-wrap: wrap;
    }

    #mod-fertilizer .soil-report .pill {
      background: var(--report-chip2);
      border: 1px solid var(--report-line);
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 12px;
      color: #111827;
      font-weight: 900;
    }

    @media (max-width: 980px) {
      #mod-fertilizer .soil-report .meta {
        grid-template-columns: 1fr;
      }

      #mod-fertilizer .soil-report .meta .cell {
        border-right: none;
        border-bottom: 1px solid var(--report-line);
      }

      #mod-fertilizer .soil-report .meta .cell:last-child {
        border-bottom: none;
      }

      #mod-fertilizer .soil-report .param-row {
        grid-template-columns: 1fr;
      }

      #mod-fertilizer .soil-report .td-day {
        width: auto;
      }
    }

    /***** DEVICE QA/QC – LAYOUT (single source of truth) *****/

    #mod-qaqc .qaqc-toolbar {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    #mod-qaqc .qaqc-toolbar-row {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      width: 100%;
    }

    #mod-qaqc .qaqc-toolbar-group {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    #mod-qaqc .qaqc-toolbar-actions {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    #mod-qaqc .qaqc-toolbar-row-secondary {
      justify-content: flex-start;
    }

    #mod-qaqc .qaqc-toolbar-pagination {
      padding-right: 10px;
      border-right: 1px solid var(--border-color);
    }

    #mod-qaqc #pg-qaqc-txt {
      font-size: 0.8rem;
      font-weight: 700;
      min-width: 90px;
      text-align: center;
    }

    #mod-qaqc .qaqc-toolbar-sep {
      font-size: 0.8em;
      color: var(--text-secondary);
    }

    #mod-qaqc .qaqc-controls-status {
      justify-content: flex-start;
    }

    #mod-qaqc #qaqc-split-container {
      height: calc(100vh - 170px);
      min-height: 420px;
      overflow: hidden;
    }

    #mod-qaqc #qaqc-split-container .panel-upper,
    #mod-qaqc #qaqc-split-container .panel-lower,
    #mod-qaqc #qaqc-split-container .panel-third {
      flex: 1 1 auto;
      min-height: 0;
      display: flex;
      flex-direction: column;
      background: #fff;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      overflow: hidden;
    }

    #mod-qaqc #qaqc-results-panel {
      height: auto;
      flex: 1 1 0;
      min-height: 0;
      overflow: hidden;
    }

    #mod-qaqc .panel-label span {
      display: inline-flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    #mod-qaqc .panel-subtext {
      font-size: 0.72rem;
      font-weight: 600;
      text-transform: none;
      color: var(--text-secondary);
    }

    #mod-qaqc .qaqc-table-scroll {
      flex: 1 1 auto;
      min-height: 0;
      overflow: auto;
    }
    #mod-qaqc #qaqc-results-panel .qaqc-table-scroll {
      height: 100%;
      overflow-y: auto;
    }

    #mod-qaqc .qaqc-table-scroll thead th {
      position: sticky;
      top: 0;
      z-index: 3;
      background: #f9fafb;
    }

    #tbl-qaqc-metrics thead th,
    #tbl-qaqc-raw thead th {
      height: 44px;
      padding: 8px 10px;
      vertical-align: middle;
    }

    #qaqc-status-panel {
      overflow: hidden !important;
      min-height: 0 !important;
    }

    #qaqc-status-panel .qaqc-status-container {
      display: flex;
      flex-direction: row;
      height: 100%;
      min-height: 0;
      border-top: none;
    }

    #qaqc-status-panel .qaqc-status-left {
      flex: 1.2 1 0;
      display: flex;
      flex-direction: column;
      min-height: 0;
      overflow: hidden;
      border-right: 1px solid var(--border-color);
    }

    #qaqc-status-panel .qaqc-status-sticky {
      position: sticky;
      top: 0;
      z-index: 2;
      background:
        linear-gradient(180deg, rgba(255, 255, 255, 0.98) 0%, rgba(248, 250, 252, 0.95) 100%),
        radial-gradient(circle at top left, rgba(59, 130, 246, 0.08), transparent 55%),
        radial-gradient(circle at top right, rgba(16, 185, 129, 0.08), transparent 55%);
      border-bottom: 1px solid rgba(99, 102, 241, 0.25);
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.12);
    }

    #qaqc-status-panel .qaqc-status-controls {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 8px 12px 10px;
      font-size: 0.85rem;
      color: #0f172a;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.06), rgba(14, 165, 233, 0.04) 45%, rgba(16, 185, 129, 0.04));
      border-top: 1px solid rgba(59, 130, 246, 0.12);
      border-bottom: 1px solid rgba(16, 185, 129, 0.14);
    }

    #qaqc-status-panel .qaqc-status-controls-main {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    #qaqc-status-panel .qaqc-status-row {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: space-between;
    }

    #qaqc-status-panel .qaqc-status-row-left {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
    }

    #qaqc-status-panel .qaqc-status-filters {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 6px;
    }

    #qaqc-status-panel .qaqc-status-filters label {
      font-size: 0.75rem;
      font-weight: 600;
      color: #4b5563;
    }

    #qaqc-status-panel .qaqc-override-row {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
      padding: 4px 8px;
      border-radius: 999px;
      background: linear-gradient(135deg, rgba(99, 102, 241, 0.12), rgba(14, 165, 233, 0.12));
      border: 1px solid rgba(99, 102, 241, 0.25);
    }

    #qaqc-status-panel #qaqc-override-input {
      text-transform: uppercase;
      width: 160px;
      padding: 4px 6px;
      border: 1px solid rgba(99, 102, 241, 0.35);
      border-radius: 10px;
      background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
      box-shadow: inset 0 1px 2px rgba(15, 23, 42, 0.08);
    }

    #qaqc-status-panel #qaqc-override-note {
      font-size: 0.75rem;
      color: #888;
    }

    #qaqc-status-panel .qaqc-status-controls-right {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    #qaqc-status-panel .qaqc-status-controls .search-input {
      height: 34px;
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid rgba(59, 130, 246, 0.35);
      background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
      box-shadow: inset 0 1px 2px rgba(15, 23, 42, 0.08);
    }

    #qaqc-status-panel .qaqc-status-controls .btn {
      border-radius: 999px;
      padding: 6px 14px;
      font-weight: 600;
      letter-spacing: 0.2px;
      border: 1px solid rgba(59, 130, 246, 0.5);
      background: linear-gradient(135deg, #2563eb, #38bdf8);
      color: #f8fafc;
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.3);
      transition: transform 120ms ease, box-shadow 120ms ease;
    }

    #qaqc-status-panel .qaqc-status-controls .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.2);
    }

    #qaqc-status-panel .qaqc-status-controls .btn:disabled {
      background: linear-gradient(180deg, #e2e8f0 0%, #cbd5f2 100%);
      color: #64748b;
      border-color: rgba(148, 163, 184, 0.45);
      box-shadow: none;
      transform: none;
    }

    #qaqc-status-panel .qaqc-summary-strip {
      border-radius: 16px;
      margin: 10px;
      background:
        linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.95)),
        radial-gradient(circle at top right, rgba(99, 102, 241, 0.08), transparent 50%);
      border: 1px solid rgba(99, 102, 241, 0.2);
      box-shadow: 0 14px 28px rgba(15, 23, 42, 0.12);
    }

    #qaqc-status-panel .qaqc-pill {
      border-radius: 999px;
      border: 1px solid rgba(99, 102, 241, 0.2);
      background: linear-gradient(135deg, #ffffff, #f8fafc);
      padding: 4px 10px;
    }

    #qaqc-status-panel .qaqc-pill.pass {
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.18), rgba(16, 185, 129, 0.22));
      border-color: rgba(16, 185, 129, 0.35);
      color: #0f5132;
    }

    #qaqc-status-panel .qaqc-pill.fail {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.18), rgba(244, 114, 182, 0.2));
      border-color: rgba(244, 114, 182, 0.35);
      color: #9f1239;
    }

    #qaqc-status-panel .qaqc-status-filters label,
    #qaqc-status-panel .qaqc-status-controls span,
    #qaqc-status-panel .qaqc-status-controls label {
      color: #1f2937;
    }

    #qaqc-status-panel .qaqc-status-right {
      flex: 1 1 0;
      height: 100%;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      padding: 10px;
      gap: 8px;
      min-height: 0;
    }

    #qaqc-status-panel .qaqc-status-right .qaqc-hist-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 12px;
    }

    #qaqc-status-panel .qaqc-hist-title-group {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    #qaqc-status-panel #qaqc-hist-meta {
      font-size: 0.75rem;
      color: #666;
    }

    #qaqc-status-panel .qaqc-hist-actions {
      display: flex;
      flex-direction: column;
      gap: 6px;
      align-items: flex-end;
    }

    #qaqc-status-panel .qaqc-hist-actions .btn {
      font-size: 0.75rem;
      padding: 4px 8px;
    }

    #qaqc-status-panel .qaqc-status-right .qaqc-hist-plot {
      flex: 1 1 auto;
      min-height: 0;
      position: relative;
      overflow: hidden;
    }

    #qaqc-status-panel #c-qc-hist {
      display: block;
      width: 100%;
      height: 100%;
    }


    #mod-rgb .rgb-panel {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      min-height: 0;
      padding: 12px;
      gap: 10px;
    }

    #mod-rgb .rgb-panel .panel-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 8px 12px;
      background: var(--gradient-surface);
      border: 1px solid rgba(37, 99, 235, 0.2);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-sm);
    }

    #mod-rgb .rgb-panel-title {
      font-weight: 700;
      color: var(--text-primary);
    }

    #mod-rgb .rgb-table-wrap {
      flex: 1 1 auto;
      min-height: 0;
      overflow: auto;
      border-radius: var(--border-radius-lg);
      border: 1px solid var(--border-color);
      background: var(--bg-surface);
      box-shadow: var(--shadow-sm);
      padding: 6px;
    }

    #mod-rgb .rgb-table-panel {
      display: none;
      min-height: 0;
    }

    #mod-rgb .rgb-table-panel.active {
      display: block;
    }

    #mod-results .results-panel {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      min-height: 0;
      padding: 12px;
      gap: 10px;
    }

    #mod-results .results-panel .panel-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 8px 12px;
      background: var(--gradient-surface);
      border: 1px solid rgba(37, 99, 235, 0.2);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-sm);
    }

    #mod-results .results-panel-title {
      font-weight: 700;
      color: var(--text-primary);
    }

    #mod-results .results-table-wrap {
      flex: 1 1 auto;
      min-height: 0;
      overflow: auto;
      border-radius: var(--border-radius-lg);
      border: 1px solid var(--border-color);
      background: var(--bg-surface);
      box-shadow: var(--shadow-sm);
      padding: 6px;
    }

    #mod-results .results-table-panel {
      display: none;
      min-height: 0;
    }

    #mod-results .results-table-panel.active {
      display: block;
    }

    #mod-results .results-subheader {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 8px 10px;
      background: rgba(37, 99, 235, 0.06);
      border: 1px solid rgba(37, 99, 235, 0.15);
      border-radius: var(--border-radius-md);
      margin-bottom: 10px;
    }




    /* =========================================
       8. TABS & SPECIAL MODULES
       ========================================= */
    /* Tab Navigation */
    .tab-nav {
      display: flex;
      background: var(--bg-surface);
      border-bottom: 1px solid var(--border-color);
      padding: 0 10px;
      align-items: center;
      gap: 4px;
      position: relative;
    }

    .tab-btn {
      padding: 10px 20px;
      background: none;
      border: none;
      border-bottom: 2px solid transparent;
      color: #6b7280;
      font-weight: 600;
      cursor: pointer;
      font-size: 0.9rem;
      transition: color 0.2s;
    }

    .tab-btn:hover {
      color: var(--accent);
    }

    .tab-btn.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
      background: #fef08a;
    }

    .qaqc-switch-group.tab-nav .btn-panel-toggle {
      border: none;
      border-bottom: 2px solid transparent;
      background: none;
      color: #6b7280;
      height: auto;
      padding: 10px 20px;
      border-radius: 0;
      box-shadow: none;
    }

    .qaqc-switch-group.tab-nav .btn-panel-toggle.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
      background: #fef08a;
    }

    .tab-info {
      margin-left: auto;
      display: flex;
      align-items: center;
      position: relative;
    }

    .tab-info-btn {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      border: 1px solid var(--border-color);
      background: #fff;
      color: var(--text-dark);
      font-weight: 700;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .tab-info-panel {
      position: absolute;
      right: 0;
      top: calc(100% + 6px);
      width: 280px;
      background: #fff;
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 10px 12px 12px;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.12);
      display: none;
      z-index: 50;
    }

    .tab-info-panel.active {
      display: block;
    }

    .tab-info-panel .tab-info-close {
      position: absolute;
      top: 6px;
      right: 8px;
      border: none;
      background: transparent;
      font-size: 0.9rem;
      cursor: pointer;
      color: #64748b;
    }

    .tab-info-panel .tab-info-content {
      font-size: 0.78rem;
      color: var(--text-secondary);
      line-height: 1.4;
      padding-right: 16px;
      white-space: pre-wrap;
    }

    .db-edit-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      font-weight: 600;
      color: #475569;
    }

    .db-readonly input,
    .db-readonly select,
    .db-readonly textarea {
      color: #111;
      opacity: 1;
    }

    .db-readonly select:disabled {
      color: #111;
      opacity: 1;
    }

    .tab-content {
      display: none;
      padding: 20px;
      overflow: auto;
      flex: 1;
      background: var(--bg-body);
      /* Slight contrast for content area */
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.2s;
    }

    .device-subtab-nav {
      display: flex;
      gap: 4px;
      padding: 6px 10px;
      border-bottom: 1px solid var(--border-color);
      background: var(--bg-surface);
    }

    .install-subtab-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border-color);
      background: var(--gradient-surface);
    }

    .install-subtab-title {
      font-weight: 700;
      color: var(--text-primary);
    }

    .access-tree {
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-md);
      padding: 10px;
      background: var(--bg-surface);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .access-tree-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      color: var(--text-primary);
    }

    .access-tree-children {
      margin-left: 22px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding-left: 8px;
      border-left: 1px dashed rgba(148, 163, 184, 0.6);
    }

    .device-subtab-content {
      display: none;
      flex: 1;
      flex-direction: column;
      height: 100%;
      min-height: 0;
    }

    .device-subtab-content.active {
      display: flex;
    }

    .registry-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
      background: var(--bg-body);
    }

    .registry-split {
      display: flex;
      flex: 1;
      min-height: 0;
      gap: 12px;
      padding: 8px 12px 12px;
    }

    .registry-split .registry-panel {
      flex: 1 1 auto;
      min-width: 0;
    }

    .registry-split.has-detail .registry-panel {
      flex: 0 0 50%;
    }

    .registry-detail-panel {
      display: none;
      flex: 0 0 50%;
      min-width: 0;
      background: var(--bg-surface);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      flex-direction: column;
      overflow: hidden;
    }

    .registry-detail-panel.active {
      display: flex;
    }

    .registry-detail-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border-color);
      background: #f8fafc;
    }

    .registry-detail-title {
      font-weight: 700;
      font-size: 0.95rem;
    }

    .registry-detail-subtitle {
      font-size: 0.8rem;
      color: #64748b;
    }

    .registry-detail-stats {
      margin-top: 6px;
      display: flex;
      gap: 12px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .registry-detail-stats .stat-pass {
      color: #16a34a;
      font-weight: 700;
    }

    .registry-detail-stats .stat-fail {
      color: #dc2626;
      font-weight: 700;
    }

    .registry-detail-body {
      flex: 1;
      min-height: 0;
      overflow: auto;
      padding: 8px;
    }

    .registry-detail-filters {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      padding: 8px 10px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      border-radius: 10px;
      background: rgba(248, 250, 252, 0.8);
      margin-bottom: 8px;
    }

    .registry-detail-filters label {
      font-size: 0.75rem;
      font-weight: 600;
      color: #475569;
    }

    .registry-detail-actions {
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .registry-detail-toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 0.75rem;
      font-weight: 600;
      color: #475569;
    }

    .registry-detail-toggle input {
      display: none;
    }

    .registry-toggle-slider {
      position: relative;
      width: 40px;
      height: 20px;
      background: #cbd5f5;
      border-radius: 999px;
      transition: background 0.2s ease;
      cursor: pointer;
    }

    .registry-toggle-slider::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 16px;
      height: 16px;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      transition: transform 0.2s ease;
    }

    .registry-detail-toggle input:checked + .registry-toggle-slider {
      background: #93c5fd;
    }

    .registry-detail-toggle input:checked + .registry-toggle-slider::after {
      transform: translateX(20px);
    }

    /* ==================== Inventory Manager ==================== */
    #mod-inventory .inventory-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 8px 12px 0;
    }
    #mod-inventory .module-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 10px 12px 0;
    }
    #mod-inventory .inventory-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    #mod-inventory .inventory-title {
      font-weight: 800;
      font-size: 1rem;
      letter-spacing: 0.3px;
      color: var(--text-dark);
    }
    #mod-inventory .inventory-header-note {
      font-size: 0.8rem;
      color: var(--text-muted);
      font-weight: 600;
    }
    #mod-inventory .inventory-tabs {
      margin-top: 8px;
    }
    #mod-inventory .inventory-subtabs {
      display: flex;
      gap: 8px;
      margin: 10px 0 14px;
    }
    #mod-inventory .inventory-panel {
      background: var(--surface);
      border: 1px solid var(--border-color);
      border-radius: 14px;
      padding: 12px;
      box-shadow: var(--shadow-sm);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    #mod-inventory .inventory-panel.active {
      display: flex;
    }
    #mod-inventory .inventory-panel-header {
      display: flex;
      justify-content: space-between;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }
    #mod-inventory .inventory-panel-title {
      font-weight: 800;
      font-size: 1rem;
      letter-spacing: 0.2px;
    }
    #mod-inventory .inventory-panel-subtitle {
      font-size: 0.78rem;
      color: var(--text-muted);
      font-weight: 600;
    }
    #mod-inventory .inventory-actions {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }
    #mod-inventory .inventory-edit-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      font-weight: 600;
      color: var(--text-muted);
    }
    #mod-inventory .inventory-switch-group {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 6px 12px;
      border-radius: 999px;
      background: #f8fafc;
      border: 1px solid var(--border-color);
    }
    #mod-inventory .inventory-switch {
      display: inline-flex;
      align-items: center;
    }
    #mod-inventory .inventory-switch input {
      display: none;
    }
    #mod-inventory .inventory-switch-slider {
      width: 44px;
      height: 22px;
      background: #cbd5f5;
      border-radius: 999px;
      position: relative;
      transition: background 0.2s ease;
      cursor: pointer;
    }
    #mod-inventory .inventory-switch-slider::after {
      content: "";
      width: 18px;
      height: 18px;
      background: #fff;
      border-radius: 50%;
      position: absolute;
      top: 2px;
      left: 2px;
      transition: transform 0.2s ease;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }
    #mod-inventory .inventory-switch input:checked + .inventory-switch-slider {
      background: #22c55e;
    }
    #mod-inventory .inventory-switch input:checked + .inventory-switch-slider::after {
      transform: translateX(22px);
    }
    #mod-inventory .inventory-switch-label {
      font-size: 0.78rem;
      font-weight: 600;
      color: var(--text-muted);
      transition: color 0.2s ease;
    }
    #mod-inventory .inventory-switch-label.active {
      color: var(--accent-dark);
    }
    #mod-inventory .inv-readonly {
      opacity: 1;
      color: #000;
    }
    #mod-inventory .inventory-table-wrap input:disabled,
    #mod-inventory .inventory-table-wrap select:disabled,
    #mod-inventory .inventory-table-wrap textarea:disabled,
    #mod-inventory .inventory-table-wrap button:disabled {
      opacity: 1;
      color: #000;
    }
    #mod-inventory .inv-input-invalid {
      background: #fef9c3;
      border-color: #f59e0b;
    }
    #mod-inventory .inventory-table-wrap {
      overflow: auto;
      border-radius: 12px;
      border: 1px solid var(--border-color);
      background: #fff;
      max-height: 460px;
    }
    #mod-inventory .inventory-table-wrap table {
      width: max-content;
      min-width: 100%;
      table-layout: fixed;
    }
    #mod-inventory .inventory-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    #mod-inventory .inventory-summary {
      font-weight: 700;
      color: var(--accent-dark);
    }
    #mod-inventory .inventory-note {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    #mod-inventory .inventory-toolbar-right {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    #mod-inventory .inventory-save-status {
      font-size: 0.72rem;
      color: var(--text-muted);
      font-weight: 600;
    }
    #mod-inventory .inventory-chip {
      background: rgba(15, 118, 110, 0.08);
      color: #0f766e;
      border: 1px solid rgba(15, 118, 110, 0.2);
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.72rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.4px;
    }
    #mod-inventory .inventory-status {
      font-weight: 700;
    }
    #mod-inventory .inventory-status.pending {
      color: #d97706;
    }
    #mod-inventory .inventory-status.approved {
      color: #16a34a;
    }
    #mod-inventory .inventory-status.rejected {
      color: #dc2626;
    }

    /* Chart Containers */
    .chart-box {
      background: var(--bg-surface);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-lg);
      padding: 15px;
      margin-bottom: 20px;
      /* NEW: Flex column layout + Fixed Height */
      display: flex;
      flex-direction: column;
      height: 450px;
      box-shadow: var(--shadow-md);
      transition: box-shadow var(--transition-smooth);
    }

    /* Parameter Pills (Analytics) */
    .param-strip {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 5px;
    }

    .param-pill {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 4px 10px;
      border: 1px solid #d1d5db;
      border-radius: 20px;
      font-size: 0.75rem;
      color: #4b5563;
      background: #fff;
      cursor: pointer;
      user-select: none;
      transition: all 0.1s;
    }

    .param-pill:hover {
      background: #f9fafb;
      border-color: #9ca3af;
    }

    .param-pill.active {
      background: #eff6ff;
      border-color: var(--accent);
      color: var(--accent);
      font-weight: 600;
    }

    .param-pill input {
      margin: 0;
    }

    /* Admin Form */
    .admin-form {
      max-width: 400px;
      background: var(--bg-surface);
      padding: 25px;
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-md);
      transition: box-shadow var(--transition-smooth);
      border: 1px solid var(--border-color);
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-group label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
      color: #374151;
      font-size: 0.9rem;
    }

    /* Autocomplete */
    .autocomplete-container {
      position: relative;
      width: 100%;
    }

    .autocomplete-list {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      max-height: 200px;
      overflow-y: auto;
      background: #fff;
      border: 1px solid #d1d5db;
      border-radius: 0 0 var(--border-radius-md) var(--border-radius-md);
      box-shadow: var(--shadow-md);
      z-index: 1000;
    }

    .autocomplete-item {
      padding: 8px 12px;
      cursor: pointer;
      font-size: 0.85rem;
      border-bottom: 1px solid #f3f4f6;
    }

    .autocomplete-item:hover {
      background: #f3f4f6;
    }

    /* Helper for spacing elements */
    .spacer {
      flex: 1;
    }

    .divider-v {
      width: 1px;
      height: 24px;
      background: #d1d5db;
      margin: 0 8px;
    }



    /* --- FORCE MAP TAB LAYOUT --- */
    #tab-dev-map {
      display: flex !important;
      flex-direction: column !important;
      height: 100% !important;
      padding: 0 !important;
      /* Remove padding so map hits edges */
      overflow: hidden !important;
    }

    #tab-dev-map .split-container {
      height: 100% !important;
      flex: 1 !important;
    }

    /* --- MAP VIEW FIXES --- */
    #map-lower {
      flex: 1;
      display: flex;
      flex-direction: column;
      /* Force specific height so it cannot collapse to 0 */
      min-height: 500px;
      position: relative;
    }

    #map-container {
      flex: 1;
      width: 100%;
      /* Absolute necessity for Leaflet: */
      height: 100%;
      min-height: 100%;
      z-index: 1;
      /* Debug color: If you see gray, the div exists! */
      background-color: #e5ecf6;
    }



    /* --- INSTALLATION REGISTRY: SUBTABS LAYOUT --- */
    #tab-install-reg {
      display: flex !important;
      flex-direction: column !important;
      height: 100% !important;
      min-height: 0 !important;
    }

    .device-subtab-body {
      flex: 1;
      min-height: 0;
      display: flex;
      flex-direction: column;
    }

    #install-subtab-installed,
    #install-subtab-map {
      flex: 1;
      min-height: 0;
    }

    #install-upper {
      flex: 1;
      min-height: 0;
      height: auto;
      overflow: hidden;
      border: none;
      display: flex;
      flex-direction: column;
      box-shadow: none;
      background: var(--bg-body);
    }

    .registry-toolbar {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
    }

    .registry-toolbar .search-input {
      flex: 1;
      min-width: 220px;
    }

    .registry-table-wrap {
      flex: 1;
      min-height: 0;
      overflow: auto;
      border: none;
      border-radius: 0;
      box-shadow: none;
    }

    #install-lower {
      flex: 1;
      min-height: 0;
      display: flex;
      flex-direction: column;
      position: relative;
      background: var(--bg-body);
    }

    .device-map-toolbar {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
    }

    .device-map-toolbar .search-input {
      flex: 1;
      min-width: 220px;
      max-width: 420px;
    }

    #map-container {
      flex: 1;
      width: 100%;
      height: 100% !important;
      min-height: 100%;
      background-color: #e5ecf6;
      z-index: 1;
    }

    /* --- ZOOM CONTROLS --- */
    .zoom-controls {
      display: flex;
      gap: 4px;
      /* Increased from 2px for better spacing */
      align-items: center;
      background: var(--bg-surface);
      /* White background */
      padding: 4px;
      /* Increased from 2px */
      border: 1px solid var(--border-color);
      /* Uses theme color */
      border-radius: var(--border-radius-md);
      /* 6px - consistent */
      box-shadow: var(--shadow-sm);
      /* ADD: subtle depth */
    }

    .btn-zoom {
      width: 28px;
      /* Slightly larger: 24px → 28px */
      height: 28px;
      padding: 0;
      font-size: 15px;
      /* Slightly larger: 14px → 15px */
      font-weight: 700;
      /* Bold → 700 */
      background: var(--bg-surface);
      /* White */
      color: var(--text-secondary);
      /* Modern gray */
      border: 1px solid var(--border-color);
      /* Theme border */
      border-radius: var(--border-radius-sm);
      /* 4px */
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
      /* ADD: smooth transition */
    }

    .btn-zoom:hover {
      background: var(--accent-light);
      /* Teal tint */
      color: var(--accent);
      /* Teal text */
      border-color: var(--accent);
      /* Teal border */
      transform: scale(1.05);
      /* ADD: slight grow */
      box-shadow: var(--shadow-sm);
      /* ADD: lift effect */
    }

    .btn-zoom:active {
      transform: scale(0.95);
      /* ADD: press effect */
    }

    .zoom-label {
      font-size: 0.7rem;
      color: var(--text-secondary);
      /* Modern gray */
      margin: 0 6px;
      /* Increased from 4px */
      font-weight: 700;
      /* Bold → 700 */
      user-select: none;
      /* ADD: prevent text selection */
    }


    /* --- FACET CHART GRID --- */
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
      margin-top: 15px;
      height: 600px;
      overflow-y: auto;
      padding-right: 5px;
    }

    .mini-chart-card {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
    }

    .mini-chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.75rem;
      color: #555;
      margin-bottom: 5px;
      border-bottom: 1px solid #eee;
      padding-bottom: 4px;
      font-weight: bold;
    }

    .mini-chart-stats {
      font-size: 0.7rem;
      color: #666;
      margin-top: 4px;
      background: #f8f9fa;
      padding: 2px 5px;
      border-radius: 4px;
      text-align: center;
    }

    .magnify-btn {
      cursor: pointer;
      font-size: 1rem;
      opacity: 0.6;
      transition: transform 0.2s;
      border: 1px solid #eee;
      border-radius: 4px;
      padding: 0 4px;
    }

    .magnify-btn:hover {
      opacity: 1;
      transform: scale(1.2);
      background: #eee;
    }

    /* --- FULL VIEW MODAL --- */
    #chart-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }

    #chart-modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      width: 90%;
      height: 90%;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 10px;
      right: 20px;
      font-size: 2rem;
      cursor: pointer;
      color: #666;
      line-height: 1;
    }


    .nm-stage-separator {
      background: #f3f4f6;
      font-size: 0.78rem;
      color: #4b5563;
      text-align: center;
      font-weight: 600;
    }

    .nm-stage-separator td {
      border-top: 2px solid #374151;
      padding: 4px 0;
    }



    /* =========================================
       9. SERVICE REGISTRY STYLES
       ========================================= */
    /* Section Container */
    .svc-section {
      background: #ffffff;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 35px 20px 20px 20px;
      /* Top padding for label space */
      position: relative;
      box-shadow: var(--shadow-md);
      transition: box-shadow var(--transition-smooth);
      margin-bottom: 20px;
    }

    /* Top Left Label (Bold, Black, Caps) */
    .svc-section-title {
      position: absolute;
      top: 0;
      left: 0;
      background: #000;
      color: #fff;
      padding: 5px 15px;
      font-size: 0.8rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom-right-radius: 6px;
    }

    /* Centered Title "Service Form" */
    .svc-main-title {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background: #fff;
      padding: 0 15px;
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--primary);
      border: 1px solid #ccc;
      border-radius: 4px;
      z-index: 5;
    }

    /* Device Details Grid */
    .svc-form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px 20px;
    }

    .svc-search-row {
      margin-bottom: 20px;
      width: 100%;
      display: flex;
      gap: 15px;
      align-items: flex-end;
      z-index: 100;
      flex-wrap: wrap;
    }

    .svc-summary-row {
      width: 100%;
      margin-bottom: 16px;
    }

    .svc-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
      padding: 12px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: #f8fafc;
    }

    .svc-top-grid {
      display: grid;
      grid-template-columns: minmax(280px, 1fr) minmax(280px, 420px);
      gap: 16px;
      align-items: start;
      margin-bottom: 16px;
    }

    @media (max-width: 900px) {
      .svc-top-grid {
        grid-template-columns: 1fr;
      }
    }

    .svc-summary-item span {
      display: block;
      font-size: 0.72rem;
      color: #64748b;
      text-transform: uppercase;
      letter-spacing: 0.4px;
    }

    .svc-summary-item strong {
      font-size: 0.9rem;
      color: #111827;
    }

    .svc-note-card {
      background: #ffffff;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 16px;
    }

    .svc-note-card label {
      display: block;
      font-size: 0.75rem;
      font-weight: 700;
      color: #475569;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.4px;
    }

    .svc-note-input {
      width: 100%;
      min-height: 34px;
      resize: none;
      overflow: hidden;
      padding: 8px 10px;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      font-size: 0.85rem;
      line-height: 1.4;
    }

    .svc-basket {
      width: 100%;
      max-width: 420px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      background: #fff;
      box-shadow: var(--shadow-sm);
      overflow: hidden;
    }

    .svc-basket-title {
      padding: 10px 12px;
      font-weight: 700;
      font-size: 0.85rem;
      background: #f8fafc;
      border-bottom: 1px solid #e5e7eb;
    }

    .svc-basket table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    .svc-basket th,
    .svc-basket td {
      padding: 6px 8px;
      border-bottom: 1px solid #e5e7eb;
      vertical-align: top;
    }

    .svc-basket-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 12px;
      font-weight: 600;
      background: #f9fafb;
      gap: 10px;
      flex-wrap: wrap;
    }

    .svc-basket-footer button {
      font-size: 0.8rem;
      padding: 6px 10px;
    }

    .svc-otp-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .svc-otp-field {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.7rem;
      color: #475569;
    }

    .svc-otp-field input {
      width: 110px;
      padding: 6px 8px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 0.8rem;
      text-align: center;
      letter-spacing: 0.2em;
    }

    .svc-qr-placeholder {
      width: 54px;
      height: 54px;
      border: 1px dashed #94a3b8;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      color: #64748b;
      background: #f8fafc;
    }

    .svc-history-table {
      margin-top: 8px;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      overflow: hidden;
      max-height: 240px;
      overflow-y: auto;
      background: #fff;
    }

    .svc-history-table table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    .svc-history-table th,
    .svc-history-table td {
      padding: 6px 8px;
      border-bottom: 1px solid #e5e7eb;
    }

    .svc-history-table tr:hover {
      background: #f3f4f6;
      cursor: pointer;
    }

    .svc-closure-toggle {
      margin-top: 8px;
      margin-bottom: 12px;
      font-weight: 600;
      color: #1f2937;
    }

    .svc-closure-body {
      display: none;
      flex-direction: column;
      gap: 15px;
    }

    .svc-closure-body.active {
      display: flex;
    }

    .svc-closure-grid {
      display: flex;
      gap: 20px;
      align-items: flex-end;
      flex-wrap: wrap;
    }

    .svc-footer {
      position: sticky;
      bottom: 0;
      margin-top: 20px;
      padding: 12px 0 4px;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
      background: var(--bg-body);
      border-top: 1px solid #e5e7eb;
    }

    /* Hardware Grid */
    .hw-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
      gap: 12px;
      margin-top: 10px;
    }

    /* Hardware Buttons */
    .hw-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 6px 3px;
      background: #f8f9fa;
      border: 1px solid #999;
      border-radius: 6px;
      font-weight: 600;
      color: #444;
      cursor: pointer;
      transition: all 0.1s;
      box-shadow: 0 3px 0 #ccc;
      /* 3D unpressed look */
      font-size: 0.85rem;
      position: relative;
    }

    .hw-btn:active {
      transform: translateY(3px);
      box-shadow: none;
    }

    /* Hardware Button Pressed/Active State */
    .hw-btn.active {
      background: #e3f2fd;
      border-color: var(--accent);
      color: var(--accent);
      box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.15);
      /* Inset shadow */
      transform: translateY(2px);
    }

    /* Update Callout Menu for Drill-Down */
    .callout-menu {
      position: fixed;
      background: #fff;
      border: 1px solid #666;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      border-radius: 6px;
      z-index: 9999;
      width: 200px;
      /* Slightly wider for sub-items */
      display: none;
      overflow: hidden;
    }

    /* Navigation Items (Branches) */
    .callout-sub-item {
      padding: 10px;
      cursor: pointer;
      border-bottom: 1px solid #f0f0f0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .callout-sub-item:hover {
      background-color: #f9f9f9;
      color: var(--accent);
    }

    /* Add arrow to indicate it's clickable */
    .callout-sub-item::after {
      content: '›';
      font-size: 1.2em;
      color: #999;
    }

    /* Back Button Header */
    .ctx-back-header {
      background: #e9ecef;
      padding: 6px 10px;
      font-size: 0.75rem;
      font-weight: bold;
      color: #555;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      border-bottom: 1px solid #ddd;
    }

    .ctx-back-header:hover {
      background: #dee2e6;
      color: #000;
    }

    /* Leaf Items (Selectable Actions) */
    .callout-action {
      display: block;
      width: 100%;
      text-align: left;
      padding: 8px 10px;
      background: none;
      border: none;
      border-bottom: 1px solid #f0f0f0;
      cursor: pointer;
      font-size: 0.9rem;
    }

    .callout-action:hover {
      background-color: #f0f0f0;
    }


    /* ===== Lab Validation: panel + indicators ===== */
    .lv-panel {
      background: #fff;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      box-shadow: var(--shadow-md);
      transition: box-shadow var(--transition-smooth);
      margin: 12px 12px 0 12px;
      overflow: hidden;
    }

    .lv-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      background: #f8fafc;
      border-bottom: 1px solid #e5e7eb;
      gap: 10px;
    }

    .lv-title {
      font-weight: 800;
      color: #111827;
      letter-spacing: 0.3px;
    }

    .lv-body {
      padding: 12px;
    }

    .lv-collapsed .lv-body {
      display: none;
    }

    .lv-grid-3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 14px;
    }

    @media (max-width: 1100px) {
      .lv-grid-3 {
        grid-template-columns: 1fr;
      }
    }

    .lv-mini {
      font-size: 12px;
      color: #6b7280;
    }

    .traffic {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ef4444;
      /* red default */
      border: 1px solid #9ca3af;
    }

    .dot.ok {
      background: #22c55e;
    }

    .lv-readonly {
      width: 100%;
      height: 30px;
      padding: 4px 10px;
      border: 1px solid #d1d5db;
      border-radius: 4px;
      background: #f9fafb;
      color: #374151;
      font-size: 12px;
    }

    .lv-table td,
    .lv-table th {
      white-space: nowrap;
    }

    .lv-table input {
      height: 28px;
      font-size: 12px;
    }

    .lv-edit-actions {
      display: none;
      gap: 8px;
      align-items: center;
    }

    .lv-edit-on .lv-edit-actions {
      display: flex;
    }

    .lv-corr-toolbar {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    /* correlation grid like your analytics facet grid */
    .lv-chart-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(310px, 1fr));
      gap: 12px;
      margin-top: 10px;
    }

    .lv-mini-card {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 10px;
    }

    .lv-mini-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
      font-weight: 800;
      color: #374151;
      border-bottom: 1px solid #f3f4f6;
      padding-bottom: 6px;
      margin-bottom: 8px;
    }

    .lv-mini-stats {
      font-size: 12px;
      color: #6b7280;
      margin-top: 6px;
      background: #f8fafc;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      padding: 4px 8px;
      text-align: center;
    }

    .lv-zoom {
      cursor: pointer;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      padding: 0 6px;
      opacity: 0.7;
    }

    .lv-zoom:hover {
      opacity: 1;
    }

    .lv-eq {
      font-size: 11px;
      font-weight: 700;
      color: #374151;
      opacity: 0.95;
      margin-left: 10px;
      white-space: nowrap;
    }




    /* =========================
   IMPACT ASSESSMENT UI (UI-only)
   ========================= */
    .ia-wrap {
      display: flex;
      flex-direction: column;
      flex: 1;
      overflow: auto;
      padding: 12px;
      gap: 12px;
    }

    .ia-filterbar {
      position: sticky;
      top: 0;
      z-index: 15;
      background: var(--bg-surface);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 10px;
      box-shadow: var(--shadow-card);
    }

    .ia-filter-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .ia-filter-row:last-child {
      margin-bottom: 0;
    }

    .ia-lbl {
      font-size: 12px;
      color: #475569;
      font-weight: 700;
      margin-right: 2px;
    }

    .ia-inp {
      height: 30px;
      padding: 0 10px;
      border: 1px solid #cbd5e1;
      border-radius: 6px;
      background: #fff;
      font-size: 13px;
      min-width: 120px;
    }

    .ia-inp:focus {
      outline: none;
      border-color: #7aa7ff;
      box-shadow: 0 0 0 2px rgba(122, 167, 255, .25);
    }

    .ia-inp-sm {
      min-width: 160px;
    }

    .ia-status {
      margin-left: auto;
      font-size: 12px;
      color: #64748b;
      font-weight: 600;
    }

    .ia-tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 6px;
    }

    .ia-tab {
      border: 1px solid #cbd5e1;
      background: #fff;
      color: #334155;
      font-weight: 800;
      font-size: 13px;
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
    }

    .ia-tab.active {
      background: #e6f0ff;
      border-color: #7aa7ff;
    }

    .ia-tabpage {
      display: none;
    }

    .ia-tabpage.active {
      display: block;
    }

    .ia-kpi-grid {
      display: grid;
      grid-template-columns: repeat(6, minmax(160px, 1fr));
      gap: 10px;
    }

    @media (max-width: 1200px) {
      .ia-kpi-grid {
        grid-template-columns: repeat(3, minmax(160px, 1fr));
      }
    }

    @media (max-width: 820px) {
      .ia-kpi-grid {
        grid-template-columns: repeat(2, minmax(160px, 1fr));
      }
    }

    .ia-kpi {
      background: #fff;
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 10px 12px;
      box-shadow: var(--shadow-card);
    }

    .ia-kpi-title {
      color: #64748b;
      font-size: 12px;
      font-weight: 800;
    }

    .ia-kpi-val {
      font-size: 24px;
      font-weight: 900;
      color: #0f172a;
      margin-top: 4px;
    }

    .ia-kpi-sub {
      color: #94a3b8;
      font-size: 12px;
      margin-top: 2px;
      font-weight: 600;
    }

    .ia-panel {
      background: #fff;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      box-shadow: var(--shadow-md);
      transition: box-shadow var(--transition-smooth);
      overflow: hidden;
    }

    .ia-panel-head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      background: #f8fafc;
      border-bottom: 1px solid #e2e8f0;
    }

    .ia-panel-title {
      font-weight: 900;
      color: #1f2937;
    }

    .ia-panel-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .ia-panel-body {
      padding: 12px;
    }

    .ia-panel.collapsed .ia-panel-body {
      display: none;
    }

    .ia-panel.collapsed .ia-panel-head {
      border-bottom: none;
    }

    .ia-two-col {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    @media (max-width: 1000px) {
      .ia-two-col {
        grid-template-columns: 1fr;
      }
    }

    .ia-split {
      display: grid;
      grid-template-columns: 1.2fr 1fr;
      gap: 12px;
    }

    @media (max-width: 1100px) {
      .ia-split {
        grid-template-columns: 1fr;
      }
    }

    .ia-metric-list {
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      overflow: hidden;
    }

    .ia-metric {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      border-bottom: 1px solid #eef2f7;
      font-size: 13px;
    }

    .ia-metric:last-child {
      border-bottom: none;
    }

    .ia-metric span {
      color: #475569;
      font-weight: 700;
    }

    .ia-metric b {
      color: #111827;
      font-weight: 900;
    }

    .ia-note {
      margin-top: 10px;
      font-size: 12px;
      color: #64748b;
      font-weight: 600;
    }

    .ia-chart-ph {
      border: 1px dashed #cbd5e1;
      border-radius: 10px;
      height: 220px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #94a3b8;
      font-weight: 800;
      background: #fbfdff;
    }

    .ia-form-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(160px, 1fr));
      gap: 10px;
      align-items: end;
    }

    @media (max-width: 1100px) {
      .ia-form-grid {
        grid-template-columns: repeat(2, minmax(160px, 1fr));
      }
    }

    .ia-form-actions {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
      grid-column: 1 / -1;
    }

    .ia-radio {
      display: flex;
      gap: 14px;
      flex-wrap: wrap;
      font-weight: 700;
      color: #475569;
    }

    .ia-radio input {
      margin-right: 6px;
    }



    /* =========================
   IMPACT INFO (ⓘ) SYSTEM
   Add below your existing Impact CSS
   ========================= */

    .ia-info {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 18px;
      height: 18px;
      margin-left: 6px;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      background: #fff;
      color: #64748b;
      font-size: 12px;
      font-weight: 900;
      cursor: pointer;
      user-select: none;
      line-height: 1;
    }

    .ia-info:hover {
      background: #f1f5f9;
      color: #334155;
      border-color: #94a3b8;
    }

    /* Modal overlay */
    .ia-info-modal {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 18px;
    }

    .ia-info-modal.hidden {
      display: none;
    }

    /* Modal card */
    .ia-info-card {
      width: min(720px, 95vw);
      max-height: 80vh;
      background: #ffffff;
      border-radius: 14px;
      box-shadow: 0 20px 70px rgba(0, 0, 0, 0.25);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      border: 1px solid #e2e8f0;
    }

    .ia-info-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 14px;
      background: #f8fafc;
      border-bottom: 1px solid #e2e8f0;
    }

    #ia-info-title {
      font-weight: 900;
      color: #0f172a;
      font-size: 15px;
    }

    .ia-info-close {
      border: 1px solid #cbd5e1;
      background: #fff;
      color: #334155;
      font-weight: 900;
      border-radius: 10px;
      padding: 6px 10px;
      cursor: pointer;
    }

    .ia-info-close:hover {
      background: #f1f5f9;
    }

    /* Body text */
    .ia-info-body {
      padding: 14px;
      overflow: auto;
      color: #0f172a;
      font-size: 13px;
      line-height: 1.45;
      white-space: pre-wrap;
      /* preserve newlines */
    }

    .ia-info-body h4 {
      margin: 10px 0 6px;
      font-size: 13px;
    }

    .ia-info-body .muted {
      color: #64748b;
      font-weight: 700;
    }

    /* Impact tabs - force horizontal row */
    #mod-impact #impactTabsRow {
      display: flex !important;
      flex-direction: row !important;
      flex-wrap: wrap !important;
      gap: 10px !important;
      align-items: center !important;
      justify-content: flex-start !important;
    }

    #mod-impact #impactTabsRow .ia-tab {
      width: auto !important;
      display: inline-flex !important;
      flex: 0 0 auto !important;
      white-space: nowrap !important;
    }

    /* Impact grid: selected row highlight */
    #ia-fert-lines tr.ia-row-selected td {
      background: #fff3b0 !important;
      /* soft yellow */
    }

    #ia-fert-lines tr {
      cursor: pointer;
    }



    /* ==========================================
   INSTALLATION REGISTRY - STICKY HEADER FIX
   ========================================== */

    /* Container must be scrollable */
    #install-upper {
      flex: 1 !important;
      min-height: 0 !important;
      height: auto !important;
      overflow: hidden !important;
      border: none !important;
      display: flex !important;
      flex-direction: column !important;
      box-shadow: none !important;
      position: relative !important;
    }

    #install-upper .registry-table-wrap {
      flex: 1;
      min-height: 0;
      overflow: auto;
      border: none;
      border-radius: 0;
    }

    /* Table must fill container */
    #tbl-device-registry {
      width: 100% !important;
      border-collapse: separate !important;
      border-spacing: 0 !important;
      display: table !important;
      /* Critical */
    }

    /* STICKY HEADER - Force override */
    #tbl-device-registry thead {
      position: sticky !important;
      top: 0 !important;
      z-index: 100 !important;
      background: var(--bg-header) !important;
    }

    #tbl-device-registry thead th {
      position: sticky !important;
      top: 0 !important;
      background: linear-gradient(180deg, rgba(37, 99, 235, 0.12), rgba(248, 250, 252, 0.95)) !important;
      color: #0f172a !important;
      font-weight: 700 !important;
      font-size: 0.75rem !important;
      padding: 12px 16px !important;
      text-align: center !important;
      white-space: nowrap !important;
      text-transform: uppercase !important;
      letter-spacing: 0.5px !important;
      border-right: 1px solid rgba(226, 232, 240, 0.8) !important;
      box-shadow: none !important;
    }

    /* Body cells */
    #tbl-device-registry tbody td {
      background: var(--bg-surface) !important;
      padding: 10px 14px !important;
      border-bottom: 1px solid #e5e7eb !important;
    }

    .registry-table-wrap {
      width: 100%;
      flex: 1;
      min-height: 0;
      overflow: auto;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      background: #fff;
    }

    .registry-panel:not(.registry-editing) .registry-edit-only {
      display: none !important;
    }

    .registry-panel.registry-editing .registry-edit-only {
      display: table-cell;
    }

    .registry-panel.registry-editing .registry-toolbar .registry-edit-only {
      display: inline-flex;
    }

    .registry-readonly-only {
      display: inline-flex;
    }

    .registry-editing .registry-readonly-only {
      display: none;
    }

    .registry-edit-toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      margin-left: auto;
    }

    .registry-readonly input.db-input {
      background: #f8fafc !important;
      color: #475569 !important;
      border-color: #e2e8f0 !important;
      cursor: default;
    }

    .map-popup-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }

    .map-popup-table th,
    .map-popup-table td {
      padding: 4px 6px;
      border-bottom: 1px solid #e2e8f0;
      text-align: left;
      white-space: nowrap;
    }

    .map-popup-table th {
      font-weight: 700;
      background: #f8fafc;
    }

    /* Fix input field widths - show full placeholder */
    #tbl-device-registry .db-input {
      min-width: 110px !important;
      width: 100% !important;
      font-size: 0.8rem !important;
      padding: 6px 8px !important;
      border: 1px solid transparent !important;
      background: transparent !important;
    }

    #tbl-device-registry .db-textarea {
      resize: none !important;
      overflow: hidden !important;
      min-height: 32px !important;
      line-height: 1.4 !important;
      white-space: pre-wrap !important;
      overflow-wrap: anywhere !important;
    }

    #tbl-device-registry .db-input:hover {
      border-color: #e5e7eb !important;
      background: #fff !important;
    }

    #tbl-device-registry .db-input:focus {
      border-color: var(--accent) !important;
      background: #fff !important;
      outline: none !important;
    }

    /* Column-specific widths */
    #tbl-device-registry .reg-client {
      min-width: 140px !important;
    }

    #tbl-device-registry .reg-company {
      min-width: 150px !important;
    }

    #tbl-device-registry .reg-pan {
      min-width: 110px !important;
    }

    #tbl-device-registry .reg-gstin {
      min-width: 140px !important;
    }

    #tbl-device-registry .reg-address {
      min-width: 200px !important;
    }

    #tbl-device-registry .reg-did {
      min-width: 140px !important;
    }

    #tbl-device-registry .reg-sim {
      min-width: 140px !important;
    }

    #tbl-device-registry .reg-aadhaar {
      min-width: 130px !important;
    }

    #tbl-device-registry .reg-mobile {
      min-width: 130px !important;
    }

    #tbl-device-registry .reg-moName {
      min-width: 140px !important;
    }

    #tbl-device-registry .reg-date {
      min-width: 130px !important;
    }

    #tbl-device-registry .reg-place {
      min-width: 140px !important;
    }

    #tbl-device-registry .reg-gps {
      min-width: 160px !important;
    }

    #tbl-device-registry .reg-pin {
      min-width: 100px !important;
    }

    #tbl-device-registry .reg-block {
      min-width: 120px !important;
    }

    #tbl-device-registry .reg-district {
      min-width: 120px !important;
    }

    #tbl-device-registry .reg-state {
      min-width: 120px !important;
    }



    #toast-container {
      position: fixed;
      top: 16px;
      right: 16px;
      margin: 0;
      padding: 0;
      width: auto;
      max-width: 360px;
      z-index: 2000;
    }


    .toast {
      min-width: 250px;
      padding: 14px 20px;
      margin-bottom: 10px;
      border-radius: 6px;
      color: white;
      font-weight: 600;
      font-size: 0.9rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      animation: slideInRight 0.3s ease;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toast-success {
      background: #27ae60;
    }

    .toast-error {
      background: #e74c3c;
    }

    .toast-warning {
      background: #f39c12;
    }

    .toast-info {
      background: #3498db;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(400px);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes slideOutRight {
      from {
        transform: translateX(0);
        opacity: 1;
      }

      to {
        transform: translateX(400px);
        opacity: 0;
      }
    }



    .skeleton-cell {
      height: 18px;
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: 3px;
    }

    @keyframes shimmer {
      0% {
        background-position: -200% 0;
      }

      100% {
        background-position: 200% 0;
      }
    }


    /* ========================================
   PANEL TOGGLE BUTTONS - SIMPLE & RELIABLE
   ======================================== */

    /* Toggle button styling - matched to standard .btn height */
    .btn-panel-toggle {
      background: transparent;
      border: 1px solid #cbd5e1;
      color: #64748b;
      font-size: 0.75rem;
      font-weight: 700;
      padding: 6px 12px;
      height: 30px;
      line-height: 1;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
      box-sizing: border-box;
    }

    .btn-panel-toggle:hover {
      background: #f1f5f9;
      border-color: #94a3b8;
      color: #334155;
    }

    .btn-panel-toggle.minimize {
      border-color: #f59e0b;
      color: #f59e0b;
    }

    .btn-panel-toggle.maximize {
      border-color: #10b981;
      color: #10b981;
    }

    /* Panel minimized state */
    .panel-upper.minimized,
    .panel-lower.minimized {
      height: auto !important;
      flex: 0 0 auto !important;
      overflow: visible !important;
    }

    .panel-upper.minimized>*:not(.panel-label),
    .panel-lower.minimized>*:not(.panel-label) {
      display: none !important;
    }

    /* Panel maximized state */
    .panel-upper.maximized {
      height: 85% !important;
      flex: 1 !important;
    }

    .panel-lower.maximized {
      height: 85% !important;
      flex: 1 !important;
    }

    /* Hide resizer bars - we don't need them anymore */
    .resizer {
      display: none !important;
    }

    .qaqc-switch-group {
      display: inline-flex;
      gap: 6px;
    }

    /* Default look: green outline/text for all three */
    .qaqc-switch-group .btn-panel-toggle {
      border-color: #10b981;
      /* green */
      color: #10b981;
    }

    /* Active (pressed) view: orange outline/text */
    .qaqc-switch-group .btn-panel-toggle.active {
      border-color: #f59e0b;
      /* orange */
      color: #f59e0b;
    }



    /* ========================================
   PANEL TOGGLE STATES - ROBUST NO-OVERLAP SOLUTION
   ======================================== */

    /* Minimized panel - ONLY header visible, nothing bleeds through */
    .panel-upper.minimized {
      height: 50px !important;
      min-height: 50px !important;
      max-height: 50px !important;
      flex: 0 0 50px !important;
      overflow: hidden !important;
      position: relative !important;
      z-index: 50 !important;
      background: #f1f5f9 !important;
      border-bottom: 3px solid #cbd5e1 !important;
    }

    /* Force header to be fully visible when minimized */
    .panel-upper.minimized .panel-label {
      display: flex !important;
      height: 50px !important;
      line-height: 50px !important;
      position: relative !important;
      z-index: 100 !important;
      background: #f1f5f9 !important;
      margin: 0 !important;
      padding: 0 15px !important;
      border-bottom: none !important;
    }

    /* Hide ALL content except header when minimized */
    .panel-upper.minimized>*:not(.panel-label) {
      display: none !important;
      visibility: hidden !important;
      height: 0 !important;
      opacity: 0 !important;
    }

    /* Normal upper panel */
    #install-upper {
      display: flex !important;
      flex-direction: column !important;
      flex: 1 1 auto !important;
      min-height: 0 !important;
      overflow: hidden !important;
      background: #fff !important;
      position: relative !important;
      z-index: 10 !important;
    }

    /* Normal lower panel (map) */
    #install-lower {
      display: flex !important;
      flex-direction: column !important;
      flex: 1 1 auto !important;
      min-height: 0 !important;
      position: relative !important;
      z-index: 1 !important;
      background: #fff !important;
    }

    /* Map container - contained within its panel */
    #map-container {
      flex: 1 !important;
      width: 100% !important;
      height: 100% !important;
      position: relative !important;
      z-index: 1 !important;
      overflow: hidden !important;
    }

    /* Split container - ensure proper stacking */
    .split-container {
      display: flex !important;
      flex-direction: column !important;
      height: 100% !important;
      overflow: hidden !important;
      position: relative !important;
    }

    /* Panel label styling - always on top */
    .panel-label {
      flex-shrink: 0 !important;
      width: 100% !important;
      background: #f1f5f9 !important;
      color: #475569 !important;
      font-size: 0.75rem !important;
      font-weight: 700 !important;
      text-transform: uppercase !important;
      padding: 12px 15px !important;
      border-bottom: 1px solid #e2e8f0 !important;
      display: flex !important;
      justify-content: space-between !important;
      align-items: center !important;
      position: relative !important;
      z-index: 10 !important;
      min-height: 45px !important;
    }

    /* Table should scroll when not minimized */
    #install-upper table {
      width: 100% !important;
      height: auto !important;
    }

    /* Smooth transitions */
    .panel-upper,
    .panel-lower {
      transition: all 0.3s ease !important;
    }


    /* Maximize/minimize no longer constrain the full-height registry */
    #install-upper.maximized {
      flex: 1 1 auto !important;
      min-height: 0 !important;
      overflow: hidden !important;
    }

    #install-lower.maximized {
      flex: 1 1 auto !important;
      min-height: 0 !important;
    }




    /* QA/QC contextual toolbar: hide all groups by default */
    #mod-qaqc .qaqc-controls {
      display: none !important;
    }

    /* Common always visible */
    #mod-qaqc .qaqc-controls-common {
      display: flex !important;
    }

    /* Show controls based on current QA/QC focus mode */
    #mod-qaqc.qaqc-view-results .qaqc-controls-results {
      display: flex !important;
    }

    #mod-qaqc.qaqc-view-status .qaqc-controls-status {
      display: flex !important;
    }

    .qaqc-panel-label {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .qaqc-toggle-group {
      display: inline-flex;
      align-items: center;
      gap: 10px;
    }

    .qaqc-toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 0.75rem;
      font-weight: 600;
      color: #374151;
    }

    #mod-qaqc .qaqc-toggle-group .btn {
      padding: 4px 10px;
      font-size: 0.75rem;
    }

    .qaqc-toggle input {
      display: none;
    }

    .qaqc-toggle-slider {
      width: 44px;
      height: 22px;
      background: #cbd5f5;
      border-radius: 999px;
      position: relative;
      transition: background 0.2s ease;
    }

    .qaqc-toggle-slider::after {
      content: "";
      width: 18px;
      height: 18px;
      background: #fff;
      border-radius: 50%;
      position: absolute;
      top: 2px;
      left: 2px;
      transition: transform 0.2s ease;
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }

    .qaqc-toggle input:checked + .qaqc-toggle-slider {
      background: #22c55e;
    }

    .qaqc-toggle input:checked + .qaqc-toggle-slider::after {
      transform: translateX(22px);
    }

    #body-qaqc-status tr.row-active {
      outline: 2px solid #999;
      outline-offset: -2px;
    }



    /* Histogram legend + hint */
    #qaqc-hist-legend {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 6px;
      font-size: 0.74rem;
      color: #444;
    }

    #qaqc-hist-legend .lg-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 2px 6px;
      border: 1px solid #e6e6e6;
      border-radius: 8px;
      background: #fafafa;
    }

    #qaqc-hist-legend .lg-swatch {
      width: 18px;
      height: 0;
      border-top: 2px solid #000;
    }

    #qaqc-hist-legend .lg-dash {
      border-top-style: dashed;
      border-top-width: 2px;
    }

    #qaqc-hist-hint {
      margin-top: 6px;
      font-size: 0.78rem;
      line-height: 1.15rem;
      color: #444;
    }

    #qaqc-hist-hint.ok {
      color: #2e7d32;
    }

    #qaqc-hist-hint.bad {
      color: #c62828;
    }

    button.btn-disabled {
      opacity: 0.55;
      cursor: not-allowed;
    }




    /* ✅ QC Status Summary Strip */
    .qaqc-summary-strip {
      display: flex;
      align-items: flex-start;
      justify-content: flex-start;
      gap: 12px;
      padding: 8px 10px;
      background: #fff;
    }

    .qaqc-summary-left {
      display: flex;
      flex-direction: column;
      gap: 2px;
      align-items: flex-start;
    }

    .qaqc-summary-title {
      font-weight: 700;
      color: #222;
    }

    .qaqc-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.78rem;
      border: 1px solid #e6e6e6;
      background: #fafafa;
      color: #333;
    }

    .qaqc-pill.pass {
      border-color: rgba(46, 204, 113, 0.35);
      background: rgba(46, 204, 113, 0.10);
    }

    .qaqc-pill.fail {
      border-color: rgba(231, 76, 60, 0.35);
      background: rgba(231, 76, 60, 0.10);
    }

    .qaqc-summary-row {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      flex-wrap: wrap;
      gap: 8px;
    }

    .qaqc-summary-row.pills-row {
      flex-wrap: wrap;
    }

    /* Optional: slightly emphasize fail rows for scanning */
    #tbl-qaqc-status tbody tr.is-fail {
      background: rgba(231, 76, 60, 0.04);
    }

    .qc-autofilled {
      outline: 2px solid #9bd3ae;
    }



    //----------------------------------------------------------START OF NEW CSS -----------------------------------------------------------

    /* ============================================================
   INSOIL TOOL — MODERN UI THEME (DROP-IN CSS)
   Goals:
   - Clean, modern, legible UI
   - Consistent button themes
   - Search inputs show magnifier icon (no HTML change required)
   - IMPORTANT: Do NOT hide native checkmarks (restores RGB/Abs tick)
   ============================================================ */

    /* ---------- Theme tokens ---------- */
    :root {
      --bg: #0b1220;
      --bg2: #0e1a33;

      --surface: #ffffff;
      --surface2: #f6f8fc;
      --surface3: #eef2fb;

      --text: #0f172a;
      --muted: #475569;

      --border: #d7deea;
      --border2: #c6d0e2;

      --primary: #2563eb;
      /* blue */
      --primary2: #1d4ed8;
      --success: #16a34a;
      /* green */
      --warning: #f59e0b;
      /* amber */

      --table-row-height: 44px;
      --danger: #dc2626;
      /* red */
      --info: #0ea5e9;
      /* sky */

      --ring: rgba(37, 99, 235, .28);

      --radius: 12px;
      --radiusSm: 10px;

      --shadow1: 0 1px 2px rgba(2, 6, 23, .08);
      --shadow2: 0 10px 30px rgba(2, 6, 23, .10);
      --shadow3: 0 18px 50px rgba(2, 6, 23, .12);

      --font: var(--font-sans);

      --rowH: 34px;
    }

    /* ---------- Base ---------- */
    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(1100px 500px at 20% 0%, rgba(14, 165, 233, .25), transparent 60%),
        radial-gradient(900px 450px at 85% 10%, rgba(37, 99, 235, .22), transparent 55%),
        linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* If your app uses a main wrapper/container, these help immediately */
    .container,
    .app,
    #app,
    .main,
    .wrapper {
      max-width: 1400px;
      margin: 0 auto;
      padding: 16px;
    }

    /* ---------- Typography ---------- */
    .module-view {
      font-family: var(--font-sans);
      font-size: 0.9rem;
      line-height: 1.6;
      color: var(--text);
    }

    h1,
    h2,
    h3,
    h4 {
      margin: 0 0 10px 0;
      letter-spacing: -0.01em;
      font-family: var(--font-sans);
      color: var(--text);
      line-height: 1.2;
    }

    h1 {
      font-size: 1.4rem;
      font-weight: 700;
    }

    h2 {
      font-size: 1.2rem;
      font-weight: 700;
    }

    h3 {
      font-size: 1.05rem;
      font-weight: 700;
    }

    small,
    .small,
    .help-text,
    .tag,
    .badge {
      font-size: 0.75rem;
      color: var(--muted);
      font-style: italic;
    }

    /* ---------- Surfaces / Panels ---------- */
    .card,
    .panel,
    .module,
    .section,
    .box {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow1);
    }

    .card,
    .module,
    .section,
    .box {
      padding: 14px;
    }

    .panel {
      overflow: hidden;
    }

    .panel-label,
    .panel-title,
    .header-strip {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 12px 14px;
      background: linear-gradient(180deg, var(--surface2) 0%, #ffffff 100%);
      border-bottom: 1px solid var(--border);
      font-weight: 800;
      color: #0b1220;
    }

    /* Subheader rows / toolbars */
    .toolbar,
    .subtoolbar,
    .controls-row,
    .filters,
    .topbar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
    }

    /* ---------- Inputs (global) ---------- */
    input,
    select,
    textarea {
      font-family: var(--font);
      font-size: 13px;
      color: var(--text);
      background: #fff;
      border: 1px solid var(--border2);
      border-radius: var(--radiusSm);
      padding: 5px 5px;
      outline: none;
      transition: box-shadow .15s ease, border-color .15s ease, transform .08s ease;
    }

    input:focus,
    select:focus,
    textarea:focus {
      border-color: rgba(37, 99, 235, .65);
      box-shadow: 0 0 0 4px var(--ring);
    }

    input[disabled],
    select[disabled],
    textarea[disabled] {
      background: #f1f5f9;
      color: #64748b;
      cursor: not-allowed;
    }

    textarea {
      min-height: 80px;
      resize: vertical;
    }

    /* Make forms more consistent */
    .form-group label,
    label {
      font-size: 12px;
      font-weight: 700;
      color: #0b1220;
    }

    /* ---------- Search inputs with magnifier icon (no HTML change needed) ---------- */
    /* Targets:
   - input[type="search"]
   - ids/classes containing "search"
   - typical toolbars */
    input[type="search"],
    input[id*="search"i],
    input[class*="search"i],
    .search input,
    .search-bar input,
    .toolbar input[type="text"][id*="search"i],
    .toolbar input[type="text"][class*="search"i] {
      padding-left: 38px;
      background-repeat: no-repeat;
      background-position: 12px 50%;
      background-size: 16px 16px;
      /* inline SVG magnifier */
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%2364758b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'/%3E%3C/svg%3E");
    }

    /* ---------- Buttons (consistent themes) ---------- */
    button,
    .btn {
      appearance: none;
      border: 1px solid transparent;
      border-radius: 10px;
      padding: 8px 12px;
      height: 34px;
      line-height: 1;
      font-weight: 750;
      font-size: 13px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: transform .08s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease, color .15s ease;
      user-select: none;
      white-space: nowrap;
    }

    button:active,
    .btn:active {
      transform: translateY(1px);
    }

    .btn-primary,
    button.primary,
    button.btn-primary {
      background: linear-gradient(180deg, rgba(37, 99, 235, 1) 0%, rgba(29, 78, 216, 1) 100%);
      color: #fff;
      box-shadow: 0 10px 25px rgba(37, 99, 235, .18);
    }

    .btn-primary:hover,
    button.primary:hover,
    button.btn-primary:hover {
      box-shadow: 0 14px 35px rgba(37, 99, 235, .24);
    }

    .btn-secondary,
    button.secondary,
    button.btn-secondary {
      background: #fff;
      color: #0f172a;
      border-color: var(--border2);
    }

    .btn-secondary:hover,
    button.secondary:hover,
    button.btn-secondary:hover {
      background: var(--surface2);
      border-color: var(--border);
    }

    .btn-success,
    button.success,
    button.btn-success {
      background: linear-gradient(180deg, #22c55e 0%, #16a34a 100%);
      color: #fff;
    }

    .btn-warning,
    button.warning,
    button.btn-warning {
      background: linear-gradient(180deg, #fbbf24 0%, #f59e0b 100%);
      color: #1f2937;
    }

    .btn-danger,
    button.danger,
    button.btn-danger {
      background: linear-gradient(180deg, #ef4444 0%, #dc2626 100%);
      color: #fff;
    }

    .btn-ghost,
    button.ghost,
    button.btn-ghost {
      background: transparent;
      border-color: var(--border2);
      color: #0f172a;
    }

    .btn-ghost:hover,
    button.ghost:hover,
    button.btn-ghost:hover {
      background: rgba(15, 23, 42, .04);
    }

    /* ---------- Existing tool-specific buttons (keep class names; modernize look) ---------- */
    .btn-panel-toggle {
      background: #ffffff;
      border: 1px solid var(--border2);
      color: #0f172a;
      font-weight: 800;
      padding: 6px 12px;
      height: 34px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.18s ease;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      box-shadow: var(--shadow1);
    }

    .btn-panel-toggle:hover {
      background: var(--surface2);
      border-color: var(--border);
      box-shadow: var(--shadow2);
    }

    /* Your earlier semantics preserved: minimize=warning outline, maximize=success outline */
    .btn-panel-toggle.minimize {
      border-color: rgba(245, 158, 11, .85);
      color: var(--warning);
    }

    .btn-panel-toggle.maximize {
      border-color: rgba(22, 163, 74, .85);
      color: var(--success);
    }

    /* Switch groups */
    .qaqc-switch-group {
      display: inline-flex;
      gap: 8px;
      background: rgba(15, 23, 42, .03);
      padding: 6px;
      border-radius: 12px;
      border: 1px solid rgba(2, 6, 23, .06);
    }

    .qaqc-switch-group .btn-panel-toggle {
      box-shadow: none;
      background: #fff;
    }

    /* Default look for three: primary outline */
    .qaqc-switch-group .btn-panel-toggle {
      border-color: rgba(37, 99, 235, .85);
      color: var(--primary);
    }

    /* Active (pressed) view: warning outline */
    .qaqc-switch-group .btn-panel-toggle.active {
      border-color: rgba(245, 158, 11, .9);
      color: var(--warning);
      background: rgba(245, 158, 11, .08);
    }

    /* ---------- Tables ---------- */
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      font-size: 12.5px;
    }

    th,
    td {
      padding: 8px 10px;
      border-bottom: 1px solid #e9eef7;
      vertical-align: middle;
    }

    th {
      position: sticky;
      top: 0;
      z-index: 2;
      text-align: left;
      background: linear-gradient(180deg, rgba(37, 99, 235, 0.12), rgba(248, 250, 252, 0.95));
      font-size: 12px;
      color: #0f172a;
      border-bottom: 1px solid rgba(37, 99, 235, 0.25);
    }

    tr:hover td {
      background: rgba(37, 99, 235, .04);
    }

    /* If you use data grids with fixed heights */
    .table-wrap,
    .table-container {
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: auto;
      background: #fff;
    }

    /* ---------- Pills / badges ---------- */
    .badge,
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 9px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 800;
      border: 1px solid rgba(2, 6, 23, .10);
      background: rgba(2, 6, 23, .03);
    }

    /* ---------- IMPORTANT: Checkboxes / tick marks (RESTORE VISIBILITY) ---------- */
    /* The RGB/Abs tick disappearing is typically caused by `appearance: none` or
   pseudo-element overrides. These rules force native checkmarks back. */

    input[type="checkbox"] {
      /* Force native rendering (tick visible) */
      -webkit-appearance: checkbox;
      appearance: auto;
      accent-color: var(--primary);
      width: 16px;
      height: 16px;
      vertical-align: middle;
      margin: 0 6px 0 0;
    }

    /* Do not allow global pseudo-elements to cover checkboxes */
    input[type="checkbox"]::before,
    input[type="checkbox"]::after {
      content: none !important;
    }

    /* Checkboxes used as "toggle" can still be styled if they have a specific class.
   This avoids breaking standard checkboxes (and preserves tick marks). */
    input[type="checkbox"].ui-toggle {
      -webkit-appearance: none;
      appearance: none;
      width: 44px;
      height: 24px;
      border-radius: 999px;
      border: 1px solid var(--border2);
      background: #e8eef8;
      position: relative;
      margin-right: 8px;
      cursor: pointer;
      transition: background .18s ease, border-color .18s ease, box-shadow .18s ease;
      box-shadow: inset 0 1px 2px rgba(2, 6, 23, .12);
    }

    input[type="checkbox"].ui-toggle:focus {
      box-shadow: 0 0 0 4px var(--ring);
      border-color: rgba(37, 99, 235, .55);
    }

    input[type="checkbox"].ui-toggle::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 3px;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: #fff;
      transform: translateY(-50%);
      box-shadow: 0 6px 16px rgba(2, 6, 23, .18);
      transition: left .18s ease;
    }

    input[type="checkbox"].ui-toggle:checked {
      background: rgba(37, 99, 235, .25);
      border-color: rgba(37, 99, 235, .65);
    }

    input[type="checkbox"].ui-toggle:checked::after {
      left: 22px;
    }

    /* ---------- Radios ---------- */
    input[type="radio"] {
      accent-color: var(--primary);
    }

    /* ---------- Autocomplete / dropdown lists (common pattern) ---------- */
    .autocomplete-list,
    .dropdown-list,
    .suggestions {
      position: absolute;
      top: calc(100% + 6px);
      left: 0;
      right: 0;
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: var(--shadow3);
      max-height: 260px;
      overflow: auto;
      z-index: 50;
    }

    .autocomplete-list>div,
    .dropdown-list>div,
    .suggestions>div {
      padding: 10px 12px;
      cursor: pointer;
      border-bottom: 1px solid #eef2f7;
    }

    .autocomplete-list>div:hover,
    .dropdown-list>div:hover,
    .suggestions>div:hover {
      background: rgba(37, 99, 235, .06);
    }

    /* ---------- Panel maximize/minimize behavior (keep existing class names) ---------- */
    .panel-upper.minimized,
    .panel-lower.minimized {
      height: auto !important;
      flex: 0 0 auto !important;
      overflow: visible !important;
    }

    .panel-upper.minimized>*:not(.panel-label),
    .panel-lower.minimized>*:not(.panel-label) {
      display: none !important;
    }

    .panel-upper.maximized,
    .panel-lower.maximized {
      height: 85% !important;
      flex: 1 !important;
    }

    /* If you intentionally hid resizers earlier */
    .resizer {
      display: none !important;
    }

    /* ---------- Misc helpers ---------- */
    .hr,
    hr {
      border: none;
      height: 1px;
      background: rgba(2, 6, 23, .10);
      margin: 12px 0;
    }

    .muted {
      color: var(--muted);
    }

    .right {
      margin-left: auto;
    }

    .hidden {
      display: none !important;
    }

    /* Make small icons (if any) align better */
    svg,
    img.icon {
      vertical-align: middle;
    }

    /* ---------- Optional: improve scrollbars (non-breaking) ---------- */
    *::-webkit-scrollbar {
      height: 10px;
      width: 10px;
    }

    *::-webkit-scrollbar-thumb {
      background: rgba(100, 116, 139, .35);
      border-radius: 999px;
    }

    *::-webkit-scrollbar-thumb:hover {
      background: rgba(100, 116, 139, .55);
    }

    *::-webkit-scrollbar-track {
      background: rgba(2, 6, 23, .04);
    }





    //--------------------------------------------------------- END OF NEW CSS --------------------------------------------------------------

</style>


</head>

<body>
  <!-- InsoilTool version: 2026-01-16a (single-file UI) -->

  <div id="login-overlay"
    style="position:fixed; top:0; left:0; width:100%; height:100%; background:#2c3e50; z-index:10000; display:flex; justify-content:center; align-items:center; color:white; flex-direction:column;">
    <div
      style="background:white; padding:40px; border-radius:8px; width:350px; color:#333; box-shadow:0 10px 25px rgba(0,0,0,0.5);">
      <h2 style="margin-top:0; text-align:center; color:#2c3e50;">Insoil Tool</h2>
      <p style="text-align:center; color:#666; font-size:0.9rem; margin-bottom:20px;">Restricted Access</p>

      <div class="form-group">
        <label style="font-weight:600; font-size:0.85rem;">Username</label>
        <input type="text" id="login-user" placeholder="Employee ID or Email" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:4px; margin-top:5px;">
      </div>

      <div class="form-group" style="margin-top:15px;">
        <label style="font-weight:600; font-size:0.85rem;">Password</label>
        <input type="password" id="login-pass" placeholder="Enter Password" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:4px; margin-top:5px;">
      </div>

      <button onclick="attemptLogin()" style="width:100%; margin-top:25px; background:#0078d4; color:white; padding:10px; border:none; border-radius:4px; font-weight:bold; cursor:pointer;">LOGIN</button>
      <div id="login-msg" style="margin-top:15px; color:#d13438; text-align:center; font-size:0.85rem; height:20px;">
      </div>
    </div>
    <div style="margin-top:20px; font-size:0.8rem; opacity:0.6;">© Absolute.ag | Internal Use Only</div>
  </div>


  <div class="sidebar">
    <div class="logo">
      <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAmYAAAEICAYAAAD1Ojg9AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsEAAA7BAbiRa+0AAALNaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49J++7vycgaWQ9J1c1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCc/Pg0KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyI+PHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj48ZXhpZjpEYXRlVGltZU9yaWdpbmFsPjIwMjUtMTItMTBUMjA6MjI6Mzg8L2V4aWY6RGF0ZVRpbWVPcmlnaW5hbD48L3JkZjpEZXNjcmlwdGlvbj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+PHhtcDpDcmVhdGVEYXRlPjIwMjUtMTItMTBUMjA6MjI6Mzg8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24geG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPjx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KPD94cGFja2V0IGVuZD0ndyc/PrDzSOcAAAAhdEVYdENyZWF0aW9uIFRpbWUAMjAyNToxMjoxMCAyMDoyMjozOJSBOwkAAPyfSURBVHheVP3Lz3Xbct6HPVVjjDnX+23ykNTFlqJEF8uBjdgCEgdO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" alt="Insoil Tool" class="logo-img">
    </div>

    <button class="sidebar-toggle" onclick="toggleSidebar()" title="Collapse / expand menu">
        <span class="toggle-icon">◀</span>
    </button>

    <div class="nav-item" onclick="nav('devices', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#8b5cf6" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <rect x="3" y="3" width="7" height="7" rx="1" />
        <rect x="14" y="3" width="7" height="7" rx="1" />
        <rect x="3" y="14" width="7" height="7" rx="1" />
        <rect x="14" y="14" width="7" height="7" rx="1" />
      </svg>
      Devices
    </div>

    <div class="nav-item" onclick="nav('rgb', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M4 6h7v7H4V6z" />
        <path d="M13 6h7v7h-7V6z" />
        <path d="M4 15h7v3H4v-3z" />
        <path d="M13 15h7v3h-7v-3z" />
      </svg>
      RGB / Abs
    </div>

    <div class="nav-item" onclick="nav('qaqc', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M12 2l8 4v6c0 5-3.5 9.5-8 10-4.5-.5-8-5-8-10V6l8-4z" />
        <path d="M9 12l2 2 4-4" />
      </svg>
      Device QA/QC
    </div>

    <div class="nav-item active" onclick="nav('results', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z" />
        <path d="M14 2v6h6" />
        <path d="M8 13h8" />
        <path d="M8 17h8" />
        <path d="M8 9h3" />
      </svg>
      Soil Test Results
    </div>

    <div class="nav-item" onclick="nav('stv-direct', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#0891b2" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M4 4h16v16H4z" />
        <path d="M8 8h8" />
        <path d="M8 12h8" />
        <path d="M8 16h5" />
      </svg>
      STV Direct
    </div>

    <div class="nav-item" onclick="nav('labval', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M10 2h4" />
        <path d="M12 2v6l5 8a4 4 0 0 1-3.4 6H10.4A4 4 0 0 1 7 16l5-8V2" />
        <path d="M9 16h6" />
      </svg>
      <span>Lab Validation</span>
    </div>

    <div class="nav-item" onclick="nav('analytics', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M3 3v18h18" />
        <path d="M7 15v3" />
        <path d="M12 11v7" />
        <path d="M17 7v11" />
      </svg>
      Analytics
    </div>

    <div class="nav-item" onclick="nav('fertilizer', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M8 7c0-1.7 1.3-3 3-3h2c1.7 0 3 1.3 3 3" />
        <path d="M7 7h10l-1 14H8L7 7z" />
        <path d="M12 12c2.6-1.4 4.6-.6 5.7 1.3-2.7 1.7-4.9 2.4-7 1.9-.9-.2-1.4-.7-1.7-1.3" />
        <path d="M11.3 14.9c.2-1.8 1-3.1 2.4-4.3" />
      </svg>
      Nutrient Manager
    </div>

    <div class="nav-item" onclick="nav('fertilizer2', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#16a34a" stroke-width="2">
        <path d="M12 2v20M8 7c0-1.7 1.3-3 3-3h2c1.7 0 3 1.3 3 3" />
        <path d="M7 7h10l-1 14H8L7 7z" />
        <circle cx="12" cy="14" r="2" />
      </svg>
      Nutrient Manager-2
    </div>

    <div class="nav-item" onclick="nav('inventory', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#0f766e" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M3 7l9 4 9-4" />
        <path d="M3 7v10l9 4 9-4V7" />
        <path d="M12 11v10" />
      </svg>
      Inventory Manager
    </div>

    <div class="nav-item" onclick="nav('impact', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#7c3aed" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <circle cx="12" cy="12" r="8" />
        <circle cx="12" cy="12" r="4" />
        <path d="M12 12l4-4" />
      </svg>
      Impact Assess.
    </div>

    <div class="nav-item" onclick="nav('feedback', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M21 15a4 4 0 0 1-4 4H8l-5 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z" />
        <path d="M7.5 9h9" />
        <path d="M7.5 12h6" />
      </svg>
      User Feedback
    </div>

    <div class="nav-item" onclick="nav('db', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <ellipse cx="12" cy="5" rx="7" ry="3" />
        <path d="M5 5v6c0 1.7 3.1 3 7 3s7-1.3 7-3V5" />
        <path d="M5 11v6c0 1.7 3.1 3 7 3s7-1.3 7-3v-6" />
      </svg>
      Database
    </div>

    <div class="nav-item" onclick="nav('admin', event)">
      <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2" stroke-linecap="round"
        stroke-linejoin="round" aria-hidden="true">
        <path d="M12 2l8 4v6c0 5-3.5 9.5-8 10-4.5-.5-8-5-8-10V6l8-4z" />
        <path d="M12 11a2.3 2.3 0 1 0 .01 0z" />
        <path d="M8.6 17c1-1.7 2.3-2.5 3.4-2.5S14.4 15.3 15.4 17" />
      </svg>
      Admin
    </div>

    <div class="user-card" id="user-card">
      <div class="user-card-header">
        <div class="user-avatar" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21a8 8 0 0 0-16 0" />
            <circle cx="12" cy="9" r="4" />
          </svg>
        </div>
        <div class="user-info">
          <div class="user-name" id="user-display-name">Not signed in</div>
          <div class="user-role" id="user-display-role">—</div>
        </div>
      </div>
      <button class="user-logout" id="user-logout-btn" onclick="logout()" title="Logout" disabled>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
          <polyline points="16 17 21 12 16 7" />
          <line x1="21" y1="12" x2="9" y2="12" />
        </svg>
        Logout
      </button>
    </div>
    <button class="user-power" id="user-power-btn" onclick="logout()" title="Logout" disabled>
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
        <path d="M18.36 6.64a9 9 0 1 1-12.73 0" />
        <line x1="12" y1="2" x2="12" y2="12" />
      </svg>
    </button>

    <!-- Toasts appear in the sidebar under Admin -->
    <div id="toast-container" class="toast-in-sidebar"></div>

  </div>

  <div class="main">

    <!-- RGB / Abs Module -->
    <!-- ==================== RGB Module ==================== -->
    <div id="mod-rgb" class="module-view">
      <div class="module-header">
        <div class="toolbar">
          <div class="toolbar-row" style="display:flex; align-items:center; gap:8px; flex-wrap:wrap; width:100%;">
            <button class="btn btn-orange" onclick="downloadCSVTemplate()" title="Download CSV import template">📄 Template</button>
            <button class="btn btn-slate" onclick="exportExcel('rgb')">Export</button>
            <button class="btn btn-red" onclick="resetData()">Reset</button>

            <div class="divider-v"></div>

            <button class="btn btn-outline" onclick="refreshRgbCalculatedMetrics()">Refresh Metrics</button>
            <button class="btn btn-indigo" onclick="moveDataToQC()">Move to QC ➔</button>
          </div>

          <div class="toolbar-row" style="display:flex; align-items:center; gap:8px; flex-wrap:wrap; width:100%;">
            <button class="btn btn-outline" onclick="changePage('rgb', -1)">❮</button>
            <span id="pg-rgb-txt">Loading...</span>
            <button class="btn btn-outline" onclick="changePage('rgb', 1)">❯</button>

            <input type="date" id="date-rgb-from" class="date-input" onchange="renderTable('rgb')">
            <input type="date" id="date-rgb-to" class="date-input" onchange="renderTable('rgb')">

            <input type="text" id="search-rgb-dev" class="search-input" placeholder="Device ID" onkeyup="renderTable('rgb')">
            <input type="text" id="search-rgb-test" class="search-input" placeholder="Test ID" onkeyup="renderTable('rgb')">

            <button class="btn btn-teal" onclick="document.getElementById('csvImport').click()">Import CSV</button>
          </div>

          <input type="file" id="csvImport" accept=".csv" style="display:none;" onchange="client_ImportCSV_CreateRGBData(this)">
        </div>
      </div>

      <div class="rgb-panel">
        <div class="panel-label">
          <span class="rgb-panel-title" id="rgb-panel-title">CALCULATED METRICS</span>
          <label class="qaqc-toggle">
            <span class="qaqc-toggle-label">Calculated</span>
            <input id="rgb-view-toggle" type="checkbox" onchange="setRgbFocus(this.checked ? 'raw' : 'metrics')">
            <span class="qaqc-toggle-slider" aria-hidden="true"></span>
            <span class="qaqc-toggle-label">Raw RGB</span>
          </label>
        </div>
        <div class="rgb-table-wrap">
          <div class="rgb-table-panel active" id="rgb-metrics-panel">
            <table id="tbl-rgb-metrics" class="selectable-table">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="rgb-table-panel" id="rgb-raw-panel" hidden>
            <table id="tbl-rgb-raw">
              <thead></thead>
              <tbody id="body-rgb-raw"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>


    <!-- QA/QC Module -->
    <!-- ==================== QA/QC Module ==================== -->
    <div id="mod-qaqc" class="module-view">
      <div class="tab-nav">
        <button class="tab-btn active" data-qaqc-mode="results" onclick="setQaqcFocus('results')">Quarantine Data</button>
        <button class="tab-btn" data-qaqc-mode="status" onclick="setQaqcFocus('status')">QC Status View</button>
      </div>

      <div class="module-header">
        <div class="toolbar qaqc-toolbar" id="qaqc-toolbar">
          <div class="qaqc-controls qaqc-controls-results qaqc-toolbar-row">
            <div class="qaqc-toolbar-group qaqc-toolbar-pagination">
              <button class="btn btn-outline" onclick="changePage('qaqc', -1)">❮</button>
              <span id="pg-qaqc-txt">Loading...</span>
              <button class="btn btn-outline" onclick="changePage('qaqc', 1)">❯</button>
            </div>

            <div class="qaqc-toolbar-group">
              <input type="date" id="date-qaqc-from" class="date-input" onchange="resetPageAndRender('qaqc')">
              <span class="qaqc-toolbar-sep">to</span>
              <input type="date" id="date-qaqc-to" class="date-input" onchange="resetPageAndRender('qaqc')">
            </div>

            <input type="text" id="search-qaqc-dev" class="search-input" placeholder="Device ID" onkeyup="resetPageAndRender('qaqc')">
            <input type="text" id="search-qaqc-test" class="search-input" placeholder="Test ID" onkeyup="resetPageAndRender('qaqc')">
          </div>

          <div class="qaqc-controls qaqc-controls-results qaqc-toolbar-row">
            <div class="qaqc-toolbar-actions">
              <button id="btn-qaqc-move" class="btn btn-indigo" onclick="moveDataToRGB()">
                Move to RGB/Abs <span id="qaqc-move-count"></span>
              </button>
              <label class="qaqc-toggle">
                <span class="qaqc-toggle-label">Quarantine</span>
                <input id="qaqc-raw-toggle" type="checkbox" onchange="setQaqcRawView(this.checked)">
                <span class="qaqc-toggle-slider" aria-hidden="true"></span>
                <span class="qaqc-toggle-label">Raw RGB</span>
              </label>
            </div>
          </div>

        </div>
      </div>

      <!-- ✅ PANELS MUST LIVE HERE, NOT INSIDE TOOLBAR -->
      <div id="tab-qaqc-results" class="tab-content active" style="padding:0; display:flex; flex-direction:column; height:100%;">
        <div class="split-container" id="qaqc-split-container">

          <!-- QUARANTINE -->
          <div class="panel-upper" id="qaqc-results-panel">
            <div class="panel-label qaqc-panel-label">
              <span>
                Quarantined Data
                <span class="panel-subtext">Select up to 15 Test IDs to compare</span>
              </span>
              <div class="qaqc-toggle-group">
                <span class="qaqc-toggle-label">Quarantine</span>
              </div>
            </div>

            <!-- ✅ Scroll wrapper (this is what scrolls) -->
            <div class="qaqc-table-scroll">
              <table id="tbl-qaqc-metrics" class="selectable-table">
                <thead></thead>
                <tbody></tbody>
              </table>
            </div>
          </div>

          <div class="resizer" id="drag-qaqc"></div>

          <!-- RAW -->
          <div class="panel-lower" id="qaqc-raw-panel">
            <div class="panel-label">
              <span>
                Raw RGB Data
                <span class="panel-subtext">Shows all selected Test IDs</span>
              </span>
              <div class="qaqc-toggle-group">
                <span class="qaqc-toggle-label">Raw RGB</span>
              </div>
            </div>

            <div class="qaqc-table-scroll">
              <table id="tbl-qaqc-raw">
                <thead></thead>
                <tbody id="body-qaqc-raw"></tbody>
              </table>
            </div>
          </div>

          <div class="resizer" id="drag-qaqc2"></div>
        </div>
      </div>

      <div id="tab-qaqc-status" class="tab-content" style="padding:0; display:flex; flex-direction:column; height:100%;">
        <!-- STATUS -->
        <div class="panel-third" id="qaqc-status-panel">
          <div class="panel-label">
            <span>
              Quality Control Status
              <span class="panel-subtext">Review QC results and diagnostics</span>
            </span>
          </div>

          <div class="qaqc-status-container">
            <!-- LEFT: Table + Summary + Override -->
            <div class="qaqc-status-left">
              <div class="qaqc-status-sticky">
                <div id="qaqc-status-summary" class="qaqc-summary-strip" hidden>
                  <div class="qaqc-summary-left">
                    <div class="qaqc-summary-row pills-row">
                      <span class="qaqc-summary-title">QC Summary</span>
                      <span class="qaqc-pill overall-pill">Overall: FAIL</span>
                      <span class="qaqc-pill pass">PASS: 2</span>
                      <span class="qaqc-pill fail">FAIL: 11</span>
                      <span class="qaqc-pill">TOTAL: 13</span>
                    </div>

                    <div class="qaqc-summary-row">
                      <span>Batch: <b>Default</b></span>
                    </div>

                    <div class="qaqc-summary-row">
                      <span>Device: <b>862211073283558</b></span>
                      <span>Test: <b>18597</b></span>
                    </div>
                  </div>
                </div>

                <div class="qaqc-status-controls">
                  <div class="qaqc-status-controls-main">
                    <div class="qaqc-status-row">
                      <div class="qaqc-status-row-left">
                        <span>Overall QC status:</span>

                        <div class="qaqc-override-row">
                          <input id="qaqc-override-toggle" type="checkbox" onchange="toggleQCOverrideMode()"
                             title="Enable manual override">
                          <label for="qaqc-override-toggle">Manual override</label>

                          <input id="qaqc-override-input" type="text" placeholder="PASS / FAIL"
                             onblur="applyQCOverride()" disabled>

                          <button id="qaqc-override-save" class="btn btn-outline"
                            type="button" onclick="applyQCOverride()" disabled>
                            Save
                          </button>
                        </div>

                        <span id="qaqc-override-note">
                          Mode: Automatic (from parameter QC)
                        </span>
                      </div>
                    </div>

                    <div class="qaqc-status-row">
                      <div class="qaqc-status-row-left">
                        <div class="qaqc-status-filters">
                          <label for="qaqc-status-device">Device ID</label>
                          <select id="qaqc-status-device" class="search-input" onchange="onQaqcStatusDeviceChange()"></select>
                          <label for="qaqc-status-test">Test ID</label>
                          <select id="qaqc-status-test" class="search-input" onchange="onQaqcStatusTestChange()"></select>
                        </div>
                      </div>

                      <div class="qaqc-status-controls-right">
                        <button id="btn-qc-export-pdf" class="btn btn-outline"
                            onclick="exportQCCertificatePDF()" disabled
                            title="Export QC Certificate (PDF)">Export PDF</button>

                        <button id="btn-qc-export-csv" class="btn btn-outline"
                            onclick="exportQCCertificateCSV()" disabled
                            title="Export QC Certificate (CSV)">Export CSV</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="qaqc-table-scroll">
                <table id="tbl-qaqc-status">
                  <thead>
                    <tr>
                      <th>Parameter</th>
                      <th>QC Status</th>
                      <th>Value</th>
                      <th>Min Limit</th>
                      <th>Max Limit</th>
                    </tr>
                  </thead>
                  <tbody id="body-qaqc-status"></tbody>
                </table>
              </div>
            </div>

            <!-- RIGHT: Histogram + AI diagnostics -->
            <div class="qaqc-status-right">
              <div class="qaqc-hist-header">
                <div class="qaqc-hist-title-group">
                  <span id="qaqc-hist-title">QC Histogram</span>
                  <span id="qaqc-hist-meta"></span>

                  <div id="qaqc-hist-legend"></div>
                  <div id="qaqc-hist-hint"></div>
                </div>

                <div class="qaqc-hist-actions">
                  <select id="qaqc-hist-param" class="search-input"
                      title="QC Parameter" onchange="onQCHistParamChange()"></select>

                  <button type="button" class="btn btn-teal"
                      onclick="requestQcDiagnostics(window.currentQCRowForCert)">
                    AI QC Diagnostics
                  </button>
                </div>
              </div>

              <div class="qaqc-hist-plot">
                <canvas id="c-qc-hist"></canvas>
              </div>

              <div id="qaqc-ai-box"
                style="margin-top:8px; padding:8px 10px; border:1px solid #e5e7eb; border-radius:6px; background:#f9fafb; font-size:0.78rem; max-height:160px; overflow:auto;">
                <div style="font-weight:700; margin-bottom:4px;">AI Diagnostics</div>
                <div id="qaqc-ai-content" style="white-space:pre-line; color:#374151;">
                  Run “AI QC Diagnostics” after selecting a QC row.
                </div>
              </div>
            </div>

          </div>
        </div>

      </div>
    </div>





    <!-- Soil Test Results Module -->
    <!-- ==================== Results Module ==================== -->
    <div id="mod-results" class="module-view active">
      <div class="module-header">
        <div class="toolbar">
          <div class="toolbar-row" style="display:flex; align-items:center; gap:8px; flex-wrap:wrap; width:100%;">
            <button class="btn" onclick="renderResults()">Refresh Results</button>
            <span id="stv-version-tag" style="font-size:0.8rem; color:#555; margin-left:8px;"></span>
          </div>

          <div class="toolbar-row" style="display:flex; align-items:center; gap:8px; flex-wrap:wrap; width:100%;">
            <div
              style="display:flex; align-items:center; gap:2px; margin-right:10px; border-right:1px solid #ddd; padding-right:10px;">
              <button class="btn btn-outline" style="padding:4px 8px;" onclick="changePage('results', -1)">❮</button>
              <span id="pg-results-txt" style="font-size:0.8rem; font-weight:bold; min-width:90px; text-align:center;">Loading...</span>
              <button class="btn btn-outline" style="padding:4px 8px;" onclick="changePage('results', 1)">❯</button>
            </div>

            <input type="date" id="date-results-from" class="date-input" onchange="resetPageAndRender('results')">
            <span style="font-size:0.8em;">to</span>
            <input type="date" id="date-results-to" class="date-input" onchange="resetPageAndRender('results')">

            <input type="text" id="search-results-dev" class="search-input" placeholder="Device ID" onkeyup="resetPageAndRender('results')">
            <input type="text" id="search-results-test" class="search-input" placeholder="Test ID" onkeyup="resetPageAndRender('results')">
          </div>
        </div>
      </div>
      <div class="results-panel">
        <div class="panel-label">
          <span class="results-panel-title" id="results-panel-title">RESULTS TABLE</span>
          <label class="qaqc-toggle">
            <span class="qaqc-toggle-label">Results</span>
            <input id="results-view-toggle" type="checkbox" onchange="setResultsFocus(this.checked ? 'success' : 'table')">
            <span class="qaqc-toggle-slider" aria-hidden="true"></span>
            <span class="qaqc-toggle-label">Success/Abs</span>
          </label>
        </div>
        <div class="results-table-wrap">
          <div class="results-table-panel active" id="results-table-panel">
            <table id="tbl-results" class="selectable-table">

              <thead>
                <tr>
                  <th>#</th>
                  <th>Test Status</th>
                  <th>Report</th>
                  <th>Client ID</th>
                  <th>Farm ID</th>
                  <th>Crop</th>
                  <th>Test ID</th>
                  <th>Device ID</th>
                  <th class="col-date">Test Date-Time</th>
                  <th>pH <br><small>(-)</small></th>
                  <th>EC <br><small>(dS/m)</small></th>
                  <th>Org Carbon <br><small>(%)</small></th>
                  <th>Nitrogen <br><small>(kg/ha)</small></th>
                  <th>Phosphorus <br><small>(kg/ha)</small></th>
                  <th>Potassium <br><small>(kg/ha)</small></th>
                  <th>Sulphur <br><small>(mg/kg)</small></th>
                  <th>Zinc <br><small>(mg/kg)</small></th>
                  <th>Copper <br><small>(mg/kg)</small></th>
                  <th>Iron <br><small>(mg/kg)</small></th>
                  <th>Manganese <br><small>(mg/kg)</small></th>
                  <th>Boron <br><small>(mg/kg)</small></th>
                </tr>
              </thead>
              <tbody id="body-results"></tbody>
            </table>
          </div>
          <div class="results-table-panel" id="results-success-panel" hidden>
            <div class="results-subheader">
              <span>SUCCESS/ABS VIEW</span>
              <div style="display:flex;align-items:center;gap:8px;">
                <select id="results-lower-mode"
                  style="font-size:0.78rem;padding:2px 4px"
                  onchange="updateResultsLowerView()">
                  <option value="details">Test Success Details</option>
                  <option value="rgb">RGB Data</option>
                </select>
              </div>
            </div>

            <div id="results-details-container">
              <table id="tbl-results-details">
                <thead>
                  <tr>
                    <th>Device ID</th>
                    <th>Parameter</th>
                    <th>Abs/Val</th>
                    <th>Val-Blank</th>
                    <th>Cal (C)</th>
                    <th>Test (T)</th>
                    <th>Status</th>
                    <th>Issue</th>
                    <th>Suggested Action</th>
                  </tr>
                </thead>
                <tbody id="body-results-details">
                  <tr>
                    <td colspan="9" style="padding:20px;text-align:center;">Select a result row to view details</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div id="results-rgb-container" style="display:none;">
              <table id="tbl-results-rgb">
                <thead></thead>
                <tbody id="body-results-rgb"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- STV Direct Module -->
    <div id="mod-stv-direct" class="module-view">
      <div class="module-header">
        <div class="toolbar">
          <button class="btn btn-teal" onclick="document.getElementById('stvDirectModuleImport').click()">Import CSV</button>
          <button class="btn btn-outline" onclick="refreshSTVDirect()">Refresh</button>
          <button class="btn" onclick="exportSTVDirectReport()">Export Report (CSV)</button>
          <button class="btn btn-outline" onclick="exportSTVDirectSvgPrint()">Export SVG (4-page print)</button>
          <button class="btn btn-indigo" onclick="exportSTVDirectBulkPdf()">Bulk Export</button>
          <input type="file" id="stvDirectModuleImport" accept=".csv" style="display:none;" onchange="client_ImportCSV_STVDirect(this)">
          <span id="stv-direct-status" style="font-size:0.85rem; color:#64748b;"></span>
        </div>
      </div>

      <div class="split-container">
        <div class="panel-upper" id="stv-direct-upper">
          <div class="panel-label">STV DIRECT RESULTS (FINAL VALUES)</div>
          <table id="tbl-stv-direct" class="selectable-table">
            <thead>
              <tr>
                <th>
                  <input type="checkbox" id="stv-direct-select-all" onclick="toggleSTVDirectSelectAll(this)">
                </th>
                <th>Report</th>
                <th>Client ID</th>
                <th>Farm ID</th>
                <th>Crop</th>
                <th>Test ID</th>
                <th>Device ID</th>
                <th class="col-date">Test Date-Time</th>
                <th>pH (-)</th>
                <th>EC (dS/m)</th>
                <th>Org Carbon (%)</th>
                <th>Nitrogen (kg/ha)</th>
                <th>Phosphorus (kg/ha)</th>
                <th>Potassium (kg/ha)</th>
                <th>Sulphur (mg/kg)</th>
                <th>Zinc (mg/kg)</th>
                <th>Copper (mg/kg)</th>
                <th>Iron (mg/kg)</th>
                <th>Manganese (mg/kg)</th>
                <th>Boron (mg/kg)</th>
              </tr>
            </thead>
            <tbody id="body-stv-direct">
              <tr>
                <td colspan="20" style="padding:20px;text-align:center;">Import a CSV to view STV Direct records.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Database Module -->
    <!-- ==================== Database Module ==================== -->
    <div id="mod-db" class="module-view">
      <div class="module-header">
      </div>

      <div class="tab-nav">
        <button class="tab-btn active" onclick="tab('criteria', event)">Success Criteria</button>
        <button class="tab-btn" onclick="tab('stv', event)">STV Logic</button>
        <button class="tab-btn" onclick="tab('qc-criteria', event)">Device QA/QC Criteria</button>
        <button class="tab-btn" onclick="tab('blanks', event)">Blank Values</button>

        <!-- NEW -->
        <button class="tab-btn" onclick="tab('qc-batch', event)">QC Batch</button>
        <div class="tab-info">
          <button class="tab-info-btn" onclick="toggleTabInfo(this, 'db')" title="About Database">i</button>
          <div class="tab-info-panel">
            <button class="tab-info-close" onclick="closeTabInfo(this)">×</button>
            <div class="tab-info-content"></div>
          </div>
        </div>
      </div>

      <!-- Success Criteria tab -->
      <div id="tab-criteria" class="tab-content active">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <h3>Test Success Criteria</h3>
          <div style="display:flex; gap:6px; align-items:center;">
            <button class="btn btn-green" onclick="addCriteriaRow()">+ Row</button>
            <button class="btn btn-outline btn-red" onclick="deleteCriteriaRow()">− Row</button>
            <button class="btn" onclick="saveCriteria()">Save &amp; Refresh</button>
            <label class="db-edit-toggle">
              <input type="checkbox" data-db-edit-toggle="true" onchange="toggleDbEdit('criteria', this.checked)">
              Edit Table
            </label>
          </div>
        </div>

        <table id="tbl-criteria-editable">
          <thead>
            <tr>
              <th>Spectro</th>
              <th>Parameter</th>
              <th>Metric</th>
              <th>L.Limit</th>
              <th>Relation</th>
              <th>U.Limit</th>
              <th>Reason</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="body-criteria"></tbody>
        </table>
      </div>

      <!-- STV Logic tab -->
      <div id="tab-stv" class="tab-content">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <h3>STV Equations</h3>
          <div style="display:flex; gap:6px; align-items:center;">
            <button class="btn btn-green" onclick="addSTVRow()">+ Row</button>
            <button class="btn btn-outline btn-red" onclick="deleteSTVRow()">− Row</button>
            <button class="btn" onclick="saveSTV()">Save STV Logic</button>
            <button class="btn btn-outline" onclick="dbOverrideSTV()">Override STV (recompute all tests)</button>
            <label class="db-edit-toggle">
              <input type="checkbox" data-db-edit-toggle="true" onchange="toggleDbEdit('stv', this.checked)">
              Edit Table
            </label>
          </div>
        </div>

        <table id="tbl-stv-editable">
          <thead>
            <tr>
              <th>Parameter</th>
              <th>a</th>
              <th>b</th>
              <th>df1</th>
              <th>df2</th>
              <th>df3</th>
              <th>df4</th>
            </tr>
          </thead>
          <tbody id="body-stv"></tbody>
        </table>
      </div>

      <!-- Device QA/QC Criteria tab -->
      <div id="tab-qc-criteria" class="tab-content">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <h3>Device QA/QC Criteria (per QC Solution Batch)</h3>
          <div style="display:flex; gap:6px; align-items:center;">
            <button class="btn btn-green" onclick="addQCCriteriaRow()">+ Row</button>
            <button class="btn btn-outline btn-red" onclick="deleteQCCriteriaRow()">− Row</button>
            <button id="btn-qc-autofill"
          class="btn btn-secondary"
          onclick="autoSuggestQCCriteriaUI()"
          title="Compute mean ± 2SD from QC history for this batch">
          Auto-suggest criteria
        </button>

            <button class="btn" onclick="saveQCCriteria()">Save Criteria</button>
            <label class="db-edit-toggle">
              <input type="checkbox" data-db-edit-toggle="true" onchange="toggleDbEdit('qc-criteria', this.checked)">
              Edit Table
            </label>
          </div>
        </div>

        <div id="qc-criteria-toolbar" style="display:flex; align-items:center; gap:10px; margin:10px 0 12px; flex-wrap:wrap;">
          <label style="font-weight:800;">QCBatch_ID:</label>

          <select id="qc-criteria-batch" class="db-input" style="min-width:220px;" onchange="applyQCCriteriaBatchToRows()">
        <!-- options filled in JS -->
      </select>

          <label class="qaqc-toggle" style="font-weight:700;">
            <span class="qaqc-toggle-label">±1σ</span>
            <input id="qc-criteria-sd-toggle" type="checkbox" checked>
            <span class="qaqc-toggle-slider" aria-hidden="true"></span>
            <span class="qaqc-toggle-label">±2σ</span>
          </label>

          <!-- <button class="btn" type="button" onclick="applyQCCriteriaBatchToRows()">
        Apply to all rows
      </button> -->

          <span id="qc-criteria-batch-note" style="font-size:0.85rem; color:#666;"></span>
        </div>

        <table id="tbl-qc-criteria">
          <thead>
            <tr>
              <th>QC Batch ID</th>
              <th>Parameter</th>
              <th>QC_Abs_min</th>
              <th>QC_Abs_max</th>
              <th>QC_Abs_mean</th>
              <th>QC_Abs_SD</th>
            </tr>
          </thead>
          <tbody id="body-qc-criteria"></tbody>
        </table>
      </div>

      <!-- Blank Values tab -->
      <div id="tab-blanks" class="tab-content">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <h3>Blank Values</h3>
          <div style="display:flex; gap:6px; align-items:center;">
            <button class="btn btn-green" onclick="addBlankRow()">+ Row</button>
            <button class="btn btn-red" onclick="deleteBlankRow()">− Row</button>
            <button class="btn" onclick="saveBlanks()">Save Blanks</button>
            <label class="db-edit-toggle">
              <input type="checkbox" data-db-edit-toggle="true" onchange="toggleDbEdit('blanks', this.checked)">
              Edit Table
            </label>
          </div>
        </div>

        <table id="tbl-blanks">
          <thead>
            <tr>
              <th>Parameter</th>
              <th>Blank Value</th>
            </tr>
          </thead>
          <tbody id="body-blanks"></tbody>
        </table>
      </div>

      <!-- NEW: QC Batch master tab -->
      <div id="tab-qc-batch" class="tab-content">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <h3>QC Batch (Master)</h3>
          <div style="display:flex; gap:6px; align-items:center;">
            <button class="btn btn-green" onclick="dbAddRow('qc')">+ Row</button>
            <button class="btn btn-outline btn-red" onclick="dbRemoveRows('qc')">− Row</button>
            <button class="btn" onclick="dbSaveMaster('qc')">Save QC Batch</button>
            <label class="db-edit-toggle">
              <input type="checkbox" data-db-edit-toggle="true" onchange="toggleDbEdit('qc-batch', this.checked)">
              Edit Table
            </label>
          </div>
        </div>

        <table id="tbl-db-qc-batch">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>

    </div>





    <!-- Devices Module (with Installation, Service, and Map View tabs) -->
    <!-- ==================== Devices Module ==================== -->
    <div id="mod-devices" class="module-view">

      <div class="tab-nav">
        <button class="tab-btn active" onclick="tab('install-reg', event)">Installation Registry</button>
        <button class="tab-btn" onclick="tab('service-reg', event)">Service Registry</button>
        <div class="tab-info">
          <button class="tab-info-btn" onclick="toggleTabInfo(this, 'devices')" title="About Devices">i</button>
          <div class="tab-info-panel">
            <button class="tab-info-close" onclick="closeTabInfo(this)">×</button>
            <div class="tab-info-content"></div>
          </div>
        </div>
      </div>

      <!-- Installation Registry Tab -->
      <div id="tab-install-reg" class="tab-content active"
        style="padding:0; display:flex; flex-direction:column; height:100%;">
        <div class="install-subtab-header">
          <span class="install-subtab-title" id="install-subtab-title">INSTALLED DEVICES</span>
          <label class="qaqc-toggle">
            <span class="qaqc-toggle-label">Installed</span>
            <input id="install-view-toggle" type="checkbox" onchange="setInstallSubtab(this.checked ? 'map' : 'installed')">
            <span class="qaqc-toggle-slider" aria-hidden="true"></span>
            <span class="qaqc-toggle-label">Map View</span>
          </label>
        </div>

        <div class="device-subtab-body">
          <div id="install-subtab-installed" class="device-subtab-content active">
            <div class="registry-split">
              <div class="registry-panel" id="install-upper">
              <div class="registry-toolbar">
                <div style="flex:1; display:flex; align-items:center; gap:8px;">
                  <input type="text" id="registry-search-installed" class="search-input"
                    placeholder="Search Client / Device ID / Mobile / MO Name / Place"
                    oninput="filterRegistryTable(this.value)">
                  <button class="btn btn-green registry-edit-only" onclick="addRegistryRow()">+ Row</button>
                  <button class="btn btn-outline btn-red registry-edit-only" onclick="removeRegistryRows()">− Row</button>
                  <button class="btn registry-edit-only" onclick="saveDeviceRegistry()">Save</button>
                </div>
                <label class="registry-edit-toggle" style="margin-left:auto;">
                  <input type="checkbox" id="registry-edit-toggle" onchange="toggleRegistryEditMode(this)">
                  Edit Table
                </label>
              </div>
              <div class="registry-table-wrap">
                <table id="tbl-device-registry" class="selectable-table">
                  <thead></thead>
                  <tbody id="body-device-registry"></tbody>
                </table>
              </div>
            </div>
              <div id="registry-detail-panel" class="registry-detail-panel">
                <div class="registry-detail-header">
                  <div>
                    <div class="registry-detail-title">Device Results</div>
                    <div class="registry-detail-subtitle" id="registry-detail-subtitle"></div>
                    <div class="registry-detail-stats" id="registry-detail-stats"></div>
                  </div>
                  <div class="registry-detail-actions">
                    <label class="registry-detail-toggle">
                      <span>Results</span>
                      <input type="checkbox" id="registry-detail-toggle" onchange="toggleRegistryDetailView(this)">
                      <span class="registry-toggle-slider"></span>
                      <span>Quarantine</span>
                    </label>
                    <button class="btn btn-outline" onclick="closeRegistryDetailPanel()">✕</button>
                  </div>
                </div>
                <div class="registry-detail-body">
                  <div class="registry-detail-filters">
                    <label for="registry-results-date-from">From</label>
                    <input type="date" id="registry-results-date-from" class="date-input"
                      onchange="applyRegistryDetailFilters()">
                    <label for="registry-results-date-to">To</label>
                    <input type="date" id="registry-results-date-to" class="date-input"
                      onchange="applyRegistryDetailFilters()">
                    <input type="text" id="registry-results-test-search" class="search-input"
                      placeholder="Test ID" oninput="applyRegistryDetailFilters()">
                  </div>
                  <table id="tbl-device-results" class="selectable-table">
                    <thead></thead>
                    <tbody id="body-device-results"></tbody>
                  </table>
                  <div id="device-results-success-panel" class="results-table-panel" hidden>
                    <div class="results-subheader">
                      <span>SUCCESS/ABS VIEW</span>
                      <div style="display:flex;align-items:center;gap:8px;">
                        <select id="device-results-lower-mode"
                          style="font-size:0.78rem;padding:2px 4px"
                          onchange="updateDeviceResultsLowerView()">
                          <option value="details">Test Success Details</option>
                          <option value="rgb">RGB Data</option>
                        </select>
                      </div>
                    </div>

                    <div id="device-results-details-container">
                      <table id="tbl-device-results-details">
                        <thead>
                          <tr>
                            <th>Device ID</th>
                            <th>Parameter</th>
                            <th>Abs/Val</th>
                            <th>Val-Blank</th>
                            <th>Cal (C)</th>
                            <th>Test (T)</th>
                            <th>Status</th>
                            <th>Issue</th>
                            <th>Suggested Action</th>
                          </tr>
                        </thead>
                        <tbody id="body-device-results-details">
                          <tr>
                            <td colspan="9" style="padding:20px;text-align:center;">Select a result row to view details</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <div id="device-results-rgb-container" style="display:none;">
                      <table id="tbl-device-results-rgb">
                        <thead></thead>
                        <tbody id="body-device-results-rgb"></tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="install-subtab-map" class="device-subtab-content">
            <div id="install-lower">
              <div class="device-map-toolbar">
                <input type="text" id="registry-search-map" class="search-input"
                  placeholder="Search Client / Device ID / Mobile / MO Name / Place"
                  oninput="filterRegistryMap(this.value)">
                <button class="btn btn-blue" onclick="renderMapView()">Refresh Map</button>
              </div>
              <div id="map-container"></div>
            </div>
          </div>
        </div>
      </div>

      <div id="tab-service-reg" class="tab-content"
        style="padding: 20px; display:none; flex-direction:column; height:100%; overflow-y:auto; position:relative;">

        <div class="svc-search-row">
          <div style="flex:0 0 320px; position:relative;">
            <label style="font-size: 0.75rem; font-weight: bold; color: #333; margin-bottom: 5px; display:block;">SEARCH DEVICE / CLIENT / MOBILE / MO</label>
            <div class="autocomplete-container">
              <input type="text" id="svc-device-search" class="search-input" style="width: 100%; height: 35px; border: 2px solid var(--primary); font-weight:bold;" placeholder="Type to search..." autocomplete="off">
              <div id="svc-device-list" class="autocomplete-list"></div>
            </div>
          </div>

          <div style="display:flex; gap:10px;">
            <button class="btn btn-outline" style="height:35px;" onclick="clearServiceSearch()">Clear</button>
            <button id="btn-new-ticket" class="btn btn-blue" style="height:35px; opacity:0.5; pointer-events:none;" onclick="createNewTicket()">+ New Ticket</button>
          </div>
        </div>

        <div id="service-form-container" class="svc-form-container" style="display:none; flex-direction: column;">

          <div class="svc-summary-row">
            <div id="svc-summary" class="svc-summary">
              <div class="svc-summary-item"><span>Device ID</span><strong id="svc-summary-did">-</strong></div>
              <div class="svc-summary-item"><span>Owner</span><strong id="svc-summary-owner">-</strong></div>
              <div class="svc-summary-item"><span>Status</span><strong id="svc-summary-status">-</strong></div>
              <div class="svc-summary-item"><span>Last Ticket</span><strong id="svc-summary-ticket">-</strong></div>
            </div>
          </div>

          <div class="svc-top-grid">
            <div class="svc-note-card">
              <label for="svc-cutometer-note">Customer Statement</label>
              <textarea id="svc-cutometer-note" class="svc-note-input" rows="1"
                placeholder="Describe the customer statement..." oninput="autoResizeSvcNote(this)"></textarea>
            </div>

            <div class="svc-basket" id="svc-basket">
              <div class="svc-basket-title">Selected Items</div>
              <table>
                <thead>
                  <tr>
                    <th>Item</th>
                    <th>Unit</th>
                    <th>Cost</th>
                  </tr>
                </thead>
                <tbody id="svc-basket-body"></tbody>
              </table>
              <div class="svc-basket-footer">
                <div>Total: ₹<span id="svc-basket-total">0</span></div>
                <div class="svc-otp-group">
                  <div class="svc-otp-field">
                    <label for="svc-otp-input">OTP</label>
                    <input id="svc-otp-input" type="text" maxlength="6" placeholder="6-digit OTP">
                  </div>
                  <div class="svc-qr-placeholder" aria-hidden="true">QR</div>
                </div>
                <button id="svc-basket-accept" class="btn btn-green" onclick="acceptServiceBasket()">I understand and accept</button>
              </div>
            </div>
          </div>

          <div class="svc-section">
            <div class="svc-section-title">DEVICE DETAILS</div>
            <div class="svc-main-title">Service Form</div>

            <div class="svc-form-grid">
              <div class="form-group">
                <label>Ticket ID</label>
                <input type="text" id="svc-ticket-id" readonly style="background:#f0f0f0; font-weight:bold; color:var(--accent);">
              </div>

              <div class="form-group">
                <label>Status</label>
                <div id="svc-status-display"
                  style="border: 2px solid #ccc; padding: 4px 10px; border-radius: 4px; font-weight: bold; text-align: center; background: #f9fafb; color: #666;">
                  -</div>
                <input type="hidden" id="svc-status" value="OPEN">
              </div>

              <div class="form-group"><label>Device ID</label><input type="text" id="svc-meta-did" readonly style="background:#f9fafb;">
              </div>
              <div class="form-group"><label>Owner</label><input type="text" id="svc-meta-owner" readonly style="background:#f9fafb;">
              </div>
              <div class="form-group" style="grid-column: span 2;"><label>Address</label><input type="text" id="svc-meta-addr" readonly style="width:100%; background:#f9fafb;">
              </div>
              <div class="form-group"><label>MO Mobile</label><input type="text" id="svc-meta-mobile" readonly style="background:#f9fafb;">
              </div>

              <div class="form-group">
                <label>Service History</label>
                <div style="display:flex; gap:5px; align-items:center;">
                  <select id="svc-history-list" style="display:none;"></select>
                  <button class="btn btn-sm btn-blue" onclick="fetchServiceHistoryPDF()">Fetch Selected</button>
                </div>
                <div class="svc-history-table">
                  <table>
                    <thead>
                      <tr><th>Date</th><th>Ticket</th><th>Status</th></tr>
                    </thead>
                    <tbody id="svc-history-table"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <div class="svc-section">
            <div class="svc-section-title">HARDWARE</div>
            <div id="svc-grid-Hardware" class="hw-grid"></div>
          </div>
          <div class="svc-section">
            <div class="svc-section-title">SOFTWARE</div>
            <div id="svc-grid-Software" class="hw-grid"></div>
          </div>
          <div class="svc-section">
            <div class="svc-section-title">SOIL REPORT</div>
            <div id="svc-grid-Soil_Report" class="hw-grid"></div>
          </div>
          <div class="svc-section">
            <div class="svc-section-title">UPCOMING</div>
            <div id="svc-grid-Upcoming" class="hw-grid"></div>
          </div>

          <div class="svc-section" style="background:#fdfdfe; border-top: 4px solid #eee;">
            <div class="svc-section-title" style="background:#444;">CLOSURE</div>

            <div class="svc-closure-toggle">
              <label>
                <input type="checkbox" id="svc-close-toggle" onchange="toggleSvcClosureSection(this)">
                Ready to close ticket
              </label>
            </div>

            <div class="svc-closure-body" id="svc-closure-body">
              <label style="display:flex; gap:10px; align-items:flex-start; cursor:pointer; background:#f4f4f4; padding:10px; border-radius:4px;">
                <input type="checkbox" id="svc-declaration" style="margin-top:3px;" onchange="updateMainActionButton()">
                <span style="font-size:0.85rem; line-height:1.4;">I hereby declare that I have implemented all required updates in the device<br>and the user grievances are addressed.</span>
              </label>

              <div class="svc-closure-grid">
                <div class="form-group" style="margin-bottom:0; flex:1; min-width:200px;">
                  <label>Employee ID</label>
                  <input type="text" id="svc-emp-id" placeholder="Enter ID..." oninput="updateMainActionButton()" style="width:100%;">
                </div>

                <div class="form-group" style="margin-bottom:0; flex:1.5; min-width:250px;">
                  <label>Upload Customer Feedback Form</label>
                  <div style="display:flex; gap:5px;">
                    <input type="file" id="svc-feedback-file" accept=".pdf,.jpg,.png" onchange="updateMainActionButton()" style="font-size:0.8rem;">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="svc-footer">
            <button id="svc-btn-export" class="btn btn-outline" onclick="exportServiceFormPDF()" disabled>
              Export Form
            </button>
            <button id="svc-main-btn" class="btn btn-green" onclick="submitServiceForm()">
              Draft
            </button>
          </div>

        </div>

        <div id="hw-callout" class="callout-menu" style="display:none; flex-direction:column;">
          <div class="callout-header">
            <span id="callout-title">Options</span>
            <span style="cursor:pointer; font-weight:bold; padding:0 5px;" onclick="closeCallout()">×</span>
          </div>

          <div class="callout-body" style="flex:1; overflow-y:auto;"></div>
        </div>

      </div>
    </div>


    <!-- =========================
     LAB VALIDATION MODULE
     ========================= -->
    <div id="mod-labval" class="module-view">
      <div class="module-header">
        <div class="toolbar">
          <strong>Lab Validation</strong>
          <span class="lv-mini">Reference lab vs Insoil cross-validation</span>
        </div>
      </div>

      <div class="table-wrapper" style="background: var(--bg-body); overflow:auto;">
        <!-- Panel 1: Lab Data Info -->
        <div id="lv-panel-info" class="lv-panel">
          <div class="lv-head">
            <div class="lv-title">Lab Data Info</div>
            <button class="btn btn-orange" onclick="lvTogglePanel('lv-panel-info', this)">Minimize</button>
          </div>

          <div class="lv-body">
            <div class="lv-grid-3">
              <!-- Left column -->
              <div>
                <div class="form-group">
                  <label>Lab name</label>
                  <input id="lv-lab-name" type="text" class="form-control" style="width:100%;" placeholder="Type lab name">
                </div>
                <div class="form-group">
                  <label>Lab address</label>
                  <input id="lv-lab-address" type="text" class="form-control" style="width:100%;" placeholder="Type address">
                </div>
                <div class="form-group">
                  <label>Lab Location</label>
                  <div class="autocomplete-container">
                    <input id="lv-location-input" type="text" class="search-input" style="width:100%;"
                    placeholder="Search city / place..."
                    autocomplete="off"
                    oninput="lvGeoSearch()">
                    <div id="lv-location-list" class="autocomplete-list" style="display:none;"></div>
                  </div>
                  <input id="lv-lab-location" type="hidden">
                  <input id="lv-lab-gps" type="hidden">
                </div>

              </div>

              <!-- Middle column -->
              <div>
                <div class="form-group">
                  <label>Device ID</label>
                  <div class="autocomplete-container">
                    <input type="text" id="lv-device-id" class="search-input" style="width:100%;"
                       placeholder="Type device..."
                       autocomplete="off"
                       oninput="lvOnDeviceInput()"
                       onclick="lvShowDeviceList()">
                    <div id="lv-device-list" class="autocomplete-list" style="display:none;"></div>
                  </div>
                </div>

                <div class="form-group">
                  <label>Test ID</label>
                  <div class="autocomplete-container">
                    <input type="text" id="lv-test-id" class="search-input" style="width:100%;"
                       placeholder="Type test..."
                       autocomplete="off"
                       oninput="lvOnTestInput()"
                       onclick="lvShowTestList()">
                    <div id="lv-test-list" class="autocomplete-list" style="display:none;"></div>
                  </div>
                </div>
              </div>

              <!-- Right column -->
              <div>
                <div class="form-group">
                  <label>Sheet Connection</label>
                  <div class="traffic">
                    <span id="lv-dot" class="dot"></span>
                    <input id="lv-status" class="lv-readonly" type="text" readonly value="Not loaded">
                  </div>
                  <div class="lv-mini" id="lv-counts" style="margin-top:6px;">Tests = 0, Devices = 0</div>
                </div>

                <div class="form-group">
                  <label>Bulk Lab Data Import</label>
                  <div style="display:flex; gap:10px; align-items:center;">
                    <input id="lv-filepath" class="lv-readonly" type="text" readonly placeholder="No file selected">
                    <label class="btn btn-indigo" style="cursor:pointer;">
                  CSV
                  <input id="lv-csv" type="file" accept=".csv,text/csv" style="display:none;" onchange="lvHandleCsv(this)">
                </label>
                  </div>
                  <div class="lv-mini" style="margin-top:6px;">
                    CSV will be loaded into the Enter Lab Data table (you can still edit before saving).
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Panel 2: Enter Lab Data -->
        <div id="lv-panel-entry" class="lv-panel">
          <div class="lv-head" id="lv-entry-head">
            <div class="lv-title">Enter Lab Data</div>

            <div style="display:flex; gap:12px; align-items:center;">
              <label style="font-size:12px; font-weight:700; color:#374151;">
            <input type="checkbox" id="lv-edit-toggle" onchange="lvToggleEditTable()"> Edit Table
          </label>

              <div class="lv-edit-actions" id="lv-edit-actions">
                <button class="btn btn-green" onclick="lvAddRow()">+ row</button>
                <button class="btn btn-red" onclick="lvRemoveRow()">- row</button>
              </div>

              <button class="btn btn-orange" onclick="lvTogglePanel('lv-panel-entry', this)">Minimize</button>

            </div>
          </div>

          <div class="lv-body">
            <div class="table-wrapper" style="max-height: 320px; border:1px solid #e5e7eb; border-radius:6px;">
              <table class="lv-table">
                <thead>
                  <tr>
                    <th>Parameter</th>
                    <th>Unit</th>
                    <th>Lab value</th>
                    <th>Insoil value (auto)</th>
                    <th>Notes</th>
                  </tr>
                </thead>
                <tbody id="lv-tbody"></tbody>
              </table>
            </div>

            <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:10px;">
              <input id="lv-method-notes" type="text" class="form-control" style="flex:1;"
                 placeholder="Method / notes (optional)">
              <button class="btn btn-blue" onclick="lvSaveTable()">Save Table</button>
            </div>
          </div>
        </div>

        <!-- Panel 3: Correlations -->
        <div id="lv-panel-corr" class="lv-panel" style="margin-bottom:12px;">
          <div class="lv-head">
            <div class="lv-title">Correlations</div>

            <div class="lv-corr-toolbar">
              <label style="font-size:12px; font-weight:700; color:#374151;">
            <input type="checkbox" id="lv-outliers" onchange="lvRenderCorrelations()">
            Remove outliers (1.5×IQR)
          </label>
              <button class="btn btn-blue" onclick="lvExportCharts()">Export Charts</button>
              <button class="btn btn-orange" onclick="lvTogglePanel('lv-panel-corr', this)">Minimize</button>

            </div>
          </div>

          <div class="lv-body">
            <div id="lv-corr-grid" class="lv-chart-grid"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal for expanded chart -->
    <div id="lv-modal"
      style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.7); z-index:3000; justify-content:center; align-items:center;">
      <div
        style="background:#fff; width:92%; height:92%; border-radius:10px; padding:14px; position:relative; display:flex; flex-direction:column;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
          <strong id="lv-modal-title">Chart</strong>
          <div style="display:flex; gap:8px; align-items:center;">
            <button class="btn btn-slate" onclick="lvCloseModal()">Close</button>
          </div>
        </div>
        <div style="flex:1; position:relative;">
          <canvas id="lv-modal-canvas"></canvas>
        </div>
      </div>
    </div>



    <!-- Analytics Module -->
    <!-- ==================== Analytics Module ==================== -->
    <div id="mod-analytics" class="module-view">
      <div class="module-header">
        <div class="toolbar">
          <select id="an-device" onchange="updateAnalyticsCharts()" style="min-width:150px;">
                <option value="">Loading devices...</option>
            </select>
          <input type="date" id="an-date-from" class="date-input" onchange="syncAnalyticsDateRange()">
          <span style="font-size:0.8em;">to</span>
          <input type="date" id="an-date-to" class="date-input" onchange="syncAnalyticsDateRange()">
          <button class="btn btn-outline" onclick="setDateRange(7)">Last 7 Days</button>
          <button class="btn btn-outline" onclick="setDateRange(30)">Last 30 Days</button>
          <button class="btn btn-outline" onclick="setDateRange('month')">This Month</button>
          <button class="btn btn-blue" onclick="updateAnalyticsCharts()">Refresh Graphs</button>
        </div>
      </div>
      <div class="panel-lower" style="flex: 1; overflow-y: auto; height: 100%; padding: 20px;">
        <div id="stats-box"
          style="display:none; background:#fff; padding:10px; margin-bottom:10px; border:1px solid #ddd;">
          <strong>Statistics:</strong> <span id="stats-content"></span>
        </div>

        <div class="chart-box">
          <div style="display:flex; justify-content:space-between; margin-bottom:5px; align-items:center;">
            <div style="display:flex; gap:10px; align-items:center;">
              <strong>Absorbance Trend</strong>
              <span style="font-size:0.8rem; color:#666;">
            (Scroll to zoom, Drag + **Shift** to select area, Drag + **Ctrl/Cmd** to pan)
        </span>
            </div>
            <div style="display:flex; gap:8px;">
              <button class="btn btn-zoom" onclick="chartObjs.trend.resetZoom()" style="width:auto; padding:0 6px; margin-left:4px;">Reset Zoom</button>
              <button class="btn btn-sm btn-slate" onclick="downloadChart('c-trend')" style="height:24px; font-size:12px;">Download</button>
            </div>
          </div>
          <div id="an-param-strip" class="param-strip"></div>
          <div style="flex: 1; position: relative; min-height: 0;">
            <canvas id="c-trend"></canvas>
          </div>
        </div>

        <div class="chart-box">
          <div style="display:flex; justify-content:space-between; margin-bottom:10px; align-items:center;">
            <div style="display:flex; gap:10px; align-items:center;">
              <strong>S1 &amp; S2 Health (P, OC, K, Fe, Cu Cal)</strong>
              <span style="font-size:0.8rem; color:#666;">
                        (Scroll to zoom, Drag + <strong>Shift</strong> to select area, Drag + <strong>Ctrl/Cmd</strong> to pan)
                    </span>
            </div>
            <div style="display:flex; gap:8px;">
              <button class="btn btn-zoom" onclick="s1ChartInstance.resetZoom()" style="width:auto; padding:0 6px;">Reset Zoom</button>
              <button class="btn btn-sm btn-slate" onclick="downloadChart('c-s1')" style="height:24px; font-size:12px;">Download</button>
            </div>
          </div>
          <div style="flex: 1; position: relative; min-height: 0;">
            <canvas id="c-s1"></canvas>
          </div>
        </div>

        <div class="chart-box" style="height:auto;">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
            <div style="display:flex; gap:10px; align-items:center;">
              <strong>Multi-Parameter Correlation</strong>
              <span style="font-size:0.9rem;">X Axis:</span>
              <select id="scatter-x" onchange="scheduleAnalyticsUpdate()" class="search-input"></select>

              <label style="font-size:0.8rem; margin-left:10px;">
                        <input type="checkbox" id="scatter-exclude-outliers" onchange="scheduleAnalyticsUpdate()"> Exclude Outliers
                    </label>
              <button class="btn btn-teal" onclick="updateAnalyticsCharts()">Plot</button>
            </div>
          </div>
          <div id="scatter-grid" class="chart-grid"></div>
        </div>

        <div class="chart-box">
          <strong>Device QC vs Field Success</strong>
          <div style="flex: 1; position: relative; min-height: 0;">
            <canvas id="c-qc-vs-test"></canvas>
          </div>
        </div>
      </div>
    </div>


    <!-- Nutrient Manager Module -->
    <!-- ==================== Fertilizer Module ==================== -->
    <div id="mod-fertilizer" class="module-view">
      <div class="module-header">
        <div class="nm-toolbar">
          <div class="nm-toolbar-row nm-toolbar-primary">
            <select id="nm-client" class="search-input" style="min-width: 150px;">
              <option value="Default">Default Client</option>
            </select>
            <span style="font-size:0.8rem; color:#6b7280;">Client</span>

            <select id="nm-rating-scheme" class="search-input" style="min-width: 180px;">
              <option value="">Rating scheme...</option>
            </select>
            <span style="font-size:0.8rem; color:#6b7280;">Scheme</span>

            <span class="divider-v"></span>

            <div class="autocomplete-container" style="width:140px;">
              <input type="text" id="nm-device-id" class="search-input"
                placeholder="Device ID"
                autocomplete="off"
                oninput="nmOnDeviceInput()"
                onclick="nmShowDeviceList()">
              <div id="nm-device-list" class="autocomplete-list" style="display:none;"></div>
            </div>

            <div class="autocomplete-container" style="width:140px;">
              <input type="text" id="nm-test-id" class="search-input"
                placeholder="Test ID"
                autocomplete="off"
                oninput="nmOnTestInput()"
                onclick="nmShowTestList()">
              <div id="nm-test-list" class="autocomplete-list" style="display:none;"></div>
            </div>

            <span class="divider-v"></span>

            <select id="nm-crop" class="search-input" style="min-width: 180px;">
              <option value="">Select crop...</option>
            </select>
          </div>

          <details class="nm-advanced">
            <summary>Calculation settings</summary>
            <div class="nm-advanced-content">
              <input type="number" id="nm-target-yield" class="date-input"
                placeholder="Target yield" style="width:110px;">
              <span id="nm-yield-unit" style="font-size:0.8rem; color:#6b7280;">t/ha</span>

              <span class="divider-v"></span>

              <label style="font-size:0.8rem; display:flex; align-items:center; gap:4px;">
                <input type="checkbox" id="nm-method-soil" checked> Soil
              </label>
              <label style="font-size:0.8rem; display:flex; align-items:center; gap:4px;">
                <input type="checkbox" id="nm-method-fert" checked> Fertigation
              </label>
              <label style="font-size:0.8rem; display:flex; align-items:center; gap:4px;">
                <input type="checkbox" id="nm-method-foliar"> Foliar
              </label>

              <span style="font-size:0.8rem; color:#6b7280;">Calc method</span>

              <select id="nm-method" onchange="onMethodChange()">
                <option value="">Select method...</option>
                <option value="RDF">RDF</option>
                <option value="STCR">STCR</option>
              </select>

              <div id="nm-method-info" class="nm-method-info"></div>
            </div>
          </details>

          <div class="nm-toolbar-row nm-toolbar-actions">
            <button type="button" onclick="recalculateNutrientPlan()" class="btn btn-slate">
              Recalculate Plan
            </button>

            <button type="button" onclick="nmExportPlan()" class="btn btn-slate">
              Export Plan (PDF)
            </button>

            <div class="spacer"></div>
          </div>
        </div>
        <!-- Context strip -->
        <div style="padding:4px 20px 8px 20px; font-size:0.78rem; color:#6b7280;
                display:flex; gap:16px; border-top:1px solid var(--border-color);">
          <span>Field: <span id="nm-field-context" style="font-weight:600;">–</span></span>
          <span>Soil type: <span id="nm-soil-type" style="font-weight:600;">–</span></span>
          <span>Scheme: <span id="nm-scheme-label" style="font-weight:600;">–</span></span>
          <span>Mode: <span id="nm-mode-label" style="font-weight:600;">Standard (no yield)</span></span>
        </div>
      </div>

      <div class="nm-content">
        <div class="tab-nav">
          <button class="tab-btn active" onclick="subTab('nm-summary', event)">Soil Test Summary</button>
          <button class="tab-btn" onclick="subTab('nm-schedule', event)">Nutrient Schedule</button>
          <button class="tab-btn" onclick="subTab('nm-export', event)">Export Report</button>
          <div class="tab-info">
            <button class="tab-info-btn" onclick="toggleTabInfo(this, 'fertilizer')" title="About Nutrient Manager">i</button>
            <div class="tab-info-panel">
              <button class="tab-info-close" onclick="closeTabInfo(this)">×</button>
              <div class="tab-info-content"></div>
            </div>
          </div>
        </div>

        <div id="tab-nm-summary" class="sub-tab-content" style="display:block;">
          <div class="panel-label">Soil test summary</div>
          <div style="padding:10px; display:flex; gap:12px; flex-wrap:wrap; align-items:flex-start;">
            <div style="flex:1; min-width:260px;">
              <div style="font-size:0.8rem; font-weight:600; color:#4b5563; margin-bottom:4px;">
                Parameter-wise soil test values
              </div>
              <table class="selectable-table" style="width:100%; font-size:0.78rem;">
                <thead>
                  <tr>
                    <th>Parameter</th>
                    <th>Value</th>
                    <th>Unit</th>
                    <th>Rating</th>
                    <th>Nutrient requirement (kg/ha)</th>
                  </tr>
                </thead>
                <tbody id="nm-fertility-body">
                  <!-- populated when DeviceID + TestID resolved -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <div id="tab-nm-schedule" class="sub-tab-content">
          <div class="panel-label">
            Stage-wise nutrient plan
            <span style="font-weight:normal; font-size:0.78rem; margin-left:auto;">
              Per stage &amp; method (soil / fertigation / foliar)
            </span>
          </div>

          <div style="padding:8px 10px; display:flex; align-items:center; gap:10px;">
            <label class="qaqc-toggle">
              <span class="qaqc-toggle-label">Nutrient Schedule</span>
              <input id="nm-schedule-toggle" type="checkbox" onchange="nmToggleScheduleView(this.checked)">
              <span class="qaqc-toggle-slider" aria-hidden="true"></span>
              <span class="qaqc-toggle-label">Fertilizer Schedule</span>
            </label>
          </div>

          <div id="nm-schedule-nutrient">
            <div class="table-wrapper">
              <table id="tbl-nm-nutrient-schedule" class="selectable-table">
                <thead>
                  <tr>
                    <th>Stage</th>
                    <th>Nutrient</th>
                    <th>Dose (kg/ha)</th>
                  </tr>
                </thead>
                <tbody id="body-nm-nutrient-schedule">
                  <tr>
                    <td colspan="3" style="text-align:center; padding:10px;">No plan calculated.</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div id="nm-schedule-fertilizer" style="display:none;">
            <div class="table-wrapper">
              <table id="tbl-nm-fertilizer-schedule" class="selectable-table">
                <thead>
                  <tr>
                    <th>Stage</th>
                    <th>Nutrient</th>
                    <th>Dose (kg/ha)</th>
                    <th>Method</th>
                    <th>Source mix</th>
                    <th>Product qty / ha</th>
                    <th>Cost / ha</th>
                    <th>Delivery details</th>
                    <th>Flags</th>
                  </tr>
                </thead>
                <tbody id="body-nm-fertilizer-schedule">
                  <tr>
                    <td colspan="9" style="text-align:center; padding:10px;">No plan calculated.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="nm-cost-summary">
              <span>Total cost / ha:</span>
              <span id="nm-total-cost">—</span>
            </div>
          </div>
        </div>

        <div id="tab-nm-export" class="sub-tab-content">
          <div class="panel-label">Export report</div>
          <div style="padding:10px; color:#4b5563;">
            The preview below updates when you recalculate the nutrient plan. Use “Export Plan (PDF)” to generate the final report.
          </div>
          <div class="soil-report">
            <div class="hero">
              <div class="hero-inner">
                <div class="brand">
                  <div class="brand-mark" aria-hidden="true">
                    <svg width="26" height="26" viewBox="0 0 24 24" fill="none">
                      <path d="M12 20c0-4 0-12 0-12" stroke="rgba(255,255,255,.92)" stroke-width="2" stroke-linecap="round"></path>
                      <path d="M12 8c-2.8 0-5-2.2-5-5 2.8 0 5 2.2 5 5Z" fill="rgba(255,255,255,.85)"></path>
                      <path d="M12 10c2.8 0 5-2.2 5-5-2.8 0-5 2.2-5 5Z" fill="rgba(255,255,255,.65)"></path>
                    </svg>
                  </div>
                  <div>
                    <h1>Insoil</h1>
                    <div class="powered">Powered by upaj</div>
                  </div>
                </div>
                <div class="hero-title">Soil Analysis Report</div>
              </div>
            </div>

            <div class="meta-wrap">
              <div class="meta">
                <div class="cell">
                  <div class="label">Report ID</div>
                  <div class="value" id="metaReportId">—</div>
                </div>
                <div class="cell">
                  <div class="label">Report Generation Date &amp; Time</div>
                  <div class="value" id="metaReportDt">—</div>
                </div>
                <div class="cell">
                  <div class="label">Name</div>
                  <div class="value" id="metaName">—</div>
                </div>
              </div>

              <div class="report-actions">
                <span class="pill">Preview updates with selected test data.</span>
                <button class="btn btn-slate" type="button" onclick="nmExportPlan()">Export Plan (PDF)</button>
              </div>
            </div>

            <div class="page">
              <div class="section-title">
                <h2>Physico-chemical properties</h2>
                <p class="hint">Result Value (Ideal Range)</p>
              </div>

              <div class="param-card" data-key="pH" data-type="cuts" data-min="0" data-max="10" data-cut1="6.5" data-cut2="7.5" data-dp="2">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">pH</p>
                      <p class="psub">Soil Reaction</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg low" style="width:65%"></div>
                        <div class="seg mid" style="width:10%"></div>
                        <div class="seg high" style="width:25%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:65.00%">6.5</span>
                        <span class="tick" style="left:75.00%">7.5</span>
                      </div>
                      <div class="zoneWords">
                        <span class="zL">Acidic</span>
                        <span class="zM">Neutral</span>
                        <span class="zR">Alkaline</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">pH affects nutrient absorption and promotes healthy root growth.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="EC" data-type="cuts" data-min="0" data-max="1.5" data-cut1="0.5" data-cut2="1.0" data-dp="2">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">EC (dS/m)</p>
                      <p class="psub">Salinity</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg low" style="width:33.3333%"></div>
                        <div class="seg mid" style="width:33.3333%"></div>
                        <div class="seg high" style="width:33.3334%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:33.33%">0.5</span>
                        <span class="tick" style="left:66.67%">1.0</span>
                      </div>
                      <div class="zoneWords">
                        <span class="zL">Low</span>
                        <span class="zM">Medium</span>
                        <span class="zR">High</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">EC influences water and nutrient uptake, affecting growth and quality.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="OC" data-type="cuts" data-min="0" data-max="1.2" data-cut1="0.5" data-cut2="0.75" data-dp="2">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">OC (w%)</p>
                      <p class="psub">Organic Carbon</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg low" style="width:41.6667%"></div>
                        <div class="seg mid" style="width:20.8333%"></div>
                        <div class="seg high" style="width:37.5%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:41.67%">0.5</span>
                        <span class="tick" style="left:62.50%">0.75</span>
                      </div>
                      <div class="zoneWords">
                        <span class="zL">Low</span>
                        <span class="zM">Medium</span>
                        <span class="zR">High</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Organic carbon enriches soil, supports organisms, and improves fruit development.</p>
                  </div>
                </div>
              </div>

              <div class="section-title">
                <h2>Macronutrients</h2>
                <p class="hint">Result Value (Ideal Range)</p>
              </div>

              <div class="param-card" data-key="N" data-type="cuts" data-min="0" data-max="800" data-cut1="240" data-cut2="480" data-dp="0">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">N (kg/ha)</p>
                      <p class="psub">Available Nitrogen</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg low" style="width:35%"></div>
                        <div class="seg mid" style="width:35%"></div>
                        <div class="seg high" style="width:30%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:35.00%">280</span>
                        <span class="tick" style="left:70.00%">560</span>
                      </div>
                      <div class="zoneWords">
                        <span class="zL">Low</span>
                        <span class="zM">Medium</span>
                        <span class="zR">High</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Nitrogen promotes growth, photosynthesis, fruit size and vigor.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="P" data-type="cuts" data-min="0" data-max="260" data-cut1="11" data-cut2="22" data-dp="0">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">P (kg/ha)</p>
                      <p class="psub">Available Phosphorus</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg low" style="width:4.6154%"></div>
                        <div class="seg mid" style="width:4.6154%"></div>
                        <div class="seg high" style="width:90.7692%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:4.62%">12</span>
                        <span class="tick" style="left:9.23%">24</span>
                      </div>
                      <div class="zoneWords">
                        <span class="zL">Low</span>
                        <span class="zM">Medium</span>
                        <span class="zR">High</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Phosphorus supports root and flower development, improving fruit quality.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="K" data-type="cuts" data-min="0" data-max="400" data-cut1="110" data-cut2="280" data-dp="0">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">K (kg/ha)</p>
                      <p class="psub">Available Potassium</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg low" style="width:29%"></div>
                        <div class="seg mid" style="width:29.5%"></div>
                        <div class="seg high" style="width:41.5%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:29.00%">116</span>
                        <span class="tick" style="left:58.50%">234</span>
                      </div>
                      <div class="zoneWords">
                        <span class="zL">Low</span>
                        <span class="zM">Medium</span>
                        <span class="zR">High</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Potassium regulates water usage, enhances disease resistance, and improves fruit.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="S" data-type="cuts" data-min="0" data-max="40" data-cut1="10" data-cut2="20" data-dp="1">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">S (mg/kg)</p>
                      <p class="psub">Available Sulphur</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg low" style="width:25%"></div>
                        <div class="seg mid" style="width:25%"></div>
                        <div class="seg high" style="width:50%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:25.00%">10</span>
                        <span class="tick" style="left:50.00%">20</span>
                      </div>
                      <div class="zoneWords">
                        <span class="zL">Low</span>
                        <span class="zM">Medium</span>
                        <span class="zR">High</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Sulphur contributes to amino acid production, photosynthesis, and enhances oil synthesis.</p>
                  </div>
                </div>
              </div>

              <div class="section-title">
                <h2>Micronutrients</h2>
                <p class="hint">Result Value (Ideal Range)</p>
              </div>

              <div class="param-card" data-key="Cu" data-type="bands" data-bands="0,0.2,0.4,0.6,0.8,1.0,1.01" data-dp="1" data-endmark="1">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">Cu (mg/kg)</p>
                      <p class="psub">Available Copper</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg b1" style="width:16.6667%"></div>
                        <div class="seg b2" style="width:16.6667%"></div>
                        <div class="seg b3" style="width:16.6667%"></div>
                        <div class="seg b4" style="width:16.6667%"></div>
                        <div class="seg b5" style="width:16.6667%"></div>
                        <div class="seg b6" style="width:16.6665%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:0%">0</span>
                        <span class="tick" style="left:16.67%">0.2</span>
                        <span class="tick" style="left:33.33%">0.4</span>
                        <span class="tick" style="left:50.00%">0.6</span>
                        <span class="tick" style="left:66.67%">0.8</span>
                        <span class="tick" style="left:83.33%">1.0</span>
                        <span class="tick" style="left:100%">1.2</span>
                        <span class="tick end">&lt;</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Copper aids enzyme activity and influences pollen formation &amp; fertilization.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="Fe" data-type="bands" data-bands="0,2.5,4.5,6.5,8.5,10.5,10.51" data-dp="1" data-endmark="1">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">Fe (mg/kg)</p>
                      <p class="psub">Available Iron</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg b1" style="width:20%"></div>
                        <div class="seg b2" style="width:16%"></div>
                        <div class="seg b3" style="width:16%"></div>
                        <div class="seg b4" style="width:16%"></div>
                        <div class="seg b5" style="width:16%"></div>
                        <div class="seg b6" style="width:16%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:0%">0</span>
                        <span class="tick" style="left:20.00%">2.5</span>
                        <span class="tick" style="left:36.00%">4.5</span>
                        <span class="tick" style="left:52.00%">6.5</span>
                        <span class="tick" style="left:68.00%">8.5</span>
                        <span class="tick" style="left:84.00%">10.5</span>
                        <span class="tick" style="left:100%">12.5</span>
                        <span class="tick end">&lt;</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Iron ensures healthy green leaves and improves photosynthesis and growth.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="Zn" data-type="bands" data-bands="0,0.3,0.6,0.9,1.2,1.5,1.51" data-dp="2" data-endmark="1">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">Zn (mg/kg)</p>
                      <p class="psub">Available Zinc</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg b1" style="width:16.6667%"></div>
                        <div class="seg b2" style="width:16.6667%"></div>
                        <div class="seg b3" style="width:16.6667%"></div>
                        <div class="seg b4" style="width:16.6667%"></div>
                        <div class="seg b5" style="width:16.6667%"></div>
                        <div class="seg b6" style="width:16.6665%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:0%">0</span>
                        <span class="tick" style="left:16.67%">0.3</span>
                        <span class="tick" style="left:33.33%">0.6</span>
                        <span class="tick" style="left:50.00%">0.9</span>
                        <span class="tick" style="left:66.67%">1.2</span>
                        <span class="tick" style="left:83.33%">1.5</span>
                        <span class="tick" style="left:100%">1.8</span>
                        <span class="tick end">&lt;</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Zinc supports hormone production, growth, fruit development and yield.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="Mn" data-type="bands" data-bands="0,1.0,3.0,5.0,7.0,9.0,9.01" data-dp="2" data-endmark="1">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">Mn (mg/kg)</p>
                      <p class="psub">Available Manganese</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg b1" style="width:9.0909%"></div>
                        <div class="seg b2" style="width:18.1818%"></div>
                        <div class="seg b3" style="width:18.1818%"></div>
                        <div class="seg b4" style="width:18.1818%"></div>
                        <div class="seg b5" style="width:18.1818%"></div>
                        <div class="seg b6" style="width:18.1819%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:0%">0</span>
                        <span class="tick" style="left:9.09%">1.0</span>
                        <span class="tick" style="left:27.27%">3.0</span>
                        <span class="tick" style="left:45.45%">5.0</span>
                        <span class="tick" style="left:63.64%">7.0</span>
                        <span class="tick" style="left:81.82%">9.0</span>
                        <span class="tick" style="left:100%">11</span>
                        <span class="tick end">&lt;</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Manganese aids photosynthesis, nutrient absorption, and in the movement of iron.</p>
                  </div>
                </div>
              </div>

              <div class="param-card" data-key="B" data-type="bands" data-bands="0,0.2,0.4,0.6,0.8,1.0,1.01" data-dp="2" data-endmark="1">
                <div class="param-row">
                  <div class="param-left">
                    <div class="badge"></div>
                    <div>
                      <p class="pname">B (mg/kg)</p>
                      <p class="psub">Available Boron</p>
                    </div>
                  </div>
                  <div class="param-mid">
                    <div class="result-top">
                      <div class="result-value" data-role="value">—</div>
                      <div class="result-chip" data-role="rating">—</div>
                    </div>
                    <div class="bar-wrap">
                      <div class="bar">
                        <div class="seg b1" style="width:15.3846%"></div>
                        <div class="seg b2" style="width:23.0769%"></div>
                        <div class="seg b3" style="width:15.3846%"></div>
                        <div class="seg b4" style="width:15.3846%"></div>
                        <div class="seg b5" style="width:15.3846%"></div>
                        <div class="seg b6" style="width:15.3847%"></div>
                      </div>
                      <div class="marker" data-role="marker" style="left:50%"></div>
                      <div class="tickline">
                        <span class="tick" style="left:0%">0</span>
                        <span class="tick" style="left:15.38%">0.2</span>
                        <span class="tick" style="left:38.46%">0.5</span>
                        <span class="tick" style="left:53.85%">0.7</span>
                        <span class="tick" style="left:69.23%">0.9</span>
                        <span class="tick" style="left:84.62%">1.1</span>
                        <span class="tick" style="left:100%">1.3</span>
                        <span class="tick end">&lt;</span>
                      </div>
                    </div>
                  </div>
                  <div class="param-right">
                    <div class="rtop">What It Means?</div>
                    <p class="rtext">Boron enhances pollen formation, pollen tube growth and flowering.</p>
                  </div>
                </div>
              </div>

              <div class="info-card">
                <h3>Testing Methodology</h3>
                <ol>
                  <li>Soil Sample Preparation is conducted using Chemical Extraction Methods.</li>
                  <li>Macro and micro-nutrient parameters testing is conducted using Multiple-Photo spectrometry.</li>
                </ol>
              </div>

              <div class="info-card">
                <h3>Source/References</h3>
                <p>Fertilizer recommendations and their respective dosages are derived from Govt sources such as ICAR bodies/State Agriculture Universities/KVK and Agriculture departments.</p>
                <p class="muted" style="margin-top:8px;">
                  Note - Report users may peruse either chemical fertilizer recommendation (Option 1) or biofertilizer with chemical fertilizer recommendation (Option 2) as per their discretion
                </p>
              </div>

              <div class="disclaimer">
                <strong>Disclaimer:</strong>
                Upaj and /its affiliates shall not be liable in any manner whatsoever in relation to the laboratory results and recommendations due to improper sample handling, testing procedures etc. The recommendations are on advisory basis only.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Inventory Manager Module -->
    <!-- ==================== Inventory Module ==================== -->
    <div id="mod-inventory" class="module-view">
      <div class="module-header">
        <div class="toolbar">
          <button class="btn btn-blue" onclick="refreshInventoryData()">Refresh Inventory</button>
        </div>
      </div>
      <div class="tab-nav inventory-tabs">
        <button class="tab-btn active" onclick="inventoryTab('stock', event)">Stock</button>
        <button class="tab-btn" onclick="inventoryTab('constitution', event)">Device Constitution</button>
        <button class="tab-btn" onclick="inventoryTab('approvals', event)">Approvals</button>
        <button class="tab-btn" onclick="inventoryTab('liquidation', event)">Liquidation</button>
        <button class="tab-btn" onclick="inventoryTab('prod-batch', event)">Prod Batch</button>
        <button class="tab-btn" onclick="inventoryTab('refill', event)">Refill Batch</button>
        <div class="tab-info">
          <button class="tab-info-btn" onclick="toggleTabInfo(this, 'inventory')" title="About Inventory">i</button>
          <div class="tab-info-panel">
            <button class="tab-info-close" onclick="closeTabInfo(this)">×</button>
            <div class="tab-info-content"></div>
          </div>
        </div>
      </div>

      <!-- Device Constitution -->
      <div id="inv-tab-constitution" class="tab-content">
        <div class="inventory-panel">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Device Constitution (BOM)</div>
              <div class="inventory-panel-subtitle">Defines component usage and device cost model.</div>
            </div>
            <div class="inventory-actions">
              <label class="inventory-edit-toggle">
                <input type="checkbox" onchange="toggleInventoryEdit('constitution', this.checked)"> Edit
              </label>
              <button class="btn btn-green" onclick="addInventoryRow('constitution')">+ Row</button>
              <button class="btn btn-outline" onclick="triggerInventoryCsv('constitution')">Import CSV</button>
              <button class="btn btn-outline btn-red" onclick="deleteInventoryRows('constitution')">Delete Selected</button>
              <button class="btn btn-blue btn-sm" onclick="saveInventoryTable('constitution')">Save</button>
              <input id="inv-constitution-csv" type="file" accept=".csv,text/csv" style="display:none" onchange="importInventoryCsv('constitution', this)">
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="inv-constitution-table" class="selectable-table">
              <thead>
                <tr>
                  <th><input type="checkbox" onclick="toggleInventorySelectAll('constitution', this)"></th>
                  <th>Category</th>
                  <th>Item Class</th>
                  <th>Item</th>
                  <th>Unit</th>
                  <th>Units/Device</th>
                  <th>Cost (Rs)/Unit</th>
                  <th>Version</th>
                  <th>Effective Date</th>
                  <th>Cost/Device</th>
                </tr>
              </thead>
              <tbody id="inv-constitution-body"></tbody>
            </table>
          </div>
          <div class="inventory-footer">
            <div class="inventory-summary">
              Total estimated cost/device: ₹<span id="inv-constitution-total">0</span>
            </div>
            <div class="inventory-note">Tip: update Version/Effective Date when BOM changes.</div>
          </div>
        </div>
      </div>

      <!-- Stock -->
      <div id="inv-tab-stock" class="tab-content active">
        <div class="inventory-switch-group inventory-subtabs">
          <span class="inventory-switch-label active" data-inv-subtab="parts">Parts</span>
          <label class="inventory-switch">
            <input type="checkbox" id="inv-stock-toggle" onchange="inventorySubtab('stock', this.checked ? 'built' : 'parts')">
            <span class="inventory-switch-slider"></span>
          </label>
          <span class="inventory-switch-label" data-inv-subtab="built">Built Units</span>
        </div>

        <div id="inv-stock-parts" class="inventory-panel active">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Parts Stock</div>
              <div class="inventory-panel-subtitle">Issue/Sale requests are created at row add.</div>
            </div>
            <div class="inventory-actions">
              <label class="inventory-edit-toggle">
                <input type="checkbox" onchange="toggleInventoryEdit('parts', this.checked)"> Edit
              </label>
              <button class="btn btn-green" onclick="addInventoryRow('parts')">+ Row</button>
              <button class="btn btn-outline" onclick="triggerInventoryCsv('parts')">Import CSV</button>
              <button class="btn btn-outline btn-red" onclick="deleteInventoryRows('parts')">Delete Selected</button>
              <button class="btn btn-blue btn-sm" onclick="saveInventoryTable('parts')">Save</button>
              <input id="inv-parts-csv" type="file" accept=".csv,text/csv" style="display:none" onchange="importInventoryCsv('parts', this)">
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="inv-parts-table" class="selectable-table">
              <thead>
                <tr>
                  <th><input type="checkbox" onclick="toggleInventorySelectAll('parts', this)"></th>
                  <th>Category</th>
                  <th>Item Class</th>
                  <th>Item</th>
                  <th>Unit</th>
                  <th>In-stock Qty</th>
                  <th>Cost (Rs)/Unit</th>
                  <th>Movement Type</th>
                  <th>Date of Movement</th>
                  <th>Delivery Date</th>
                  <th>PO number</th>
                  <th>Confirmed by</th>
                  <th>Issued to</th>
                  <th>Request ID</th>
                </tr>
              </thead>
              <tbody id="inv-parts-body"></tbody>
            </table>
          </div>
        </div>

        <div id="inv-stock-built" class="inventory-panel" style="display:none;">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Built Units</div>
              <div class="inventory-panel-subtitle">New builds consume BOM items and create a stock entry.</div>
            </div>
            <div class="inventory-actions">
              <label class="inventory-edit-toggle">
                <input type="checkbox" onchange="toggleInventoryEdit('built', this.checked)"> Edit
              </label>
              <button class="btn btn-green" onclick="addInventoryRow('built')">+ Row</button>
              <button class="btn btn-outline btn-red" onclick="deleteInventoryRows('built')">Delete Selected</button>
              <button class="btn btn-blue btn-sm" onclick="saveInventoryTable('built')">Save</button>
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="inv-built-table" class="selectable-table">
              <thead>
                <tr>
                  <th><input type="checkbox" onclick="toggleInventorySelectAll('built', this)"></th>
                  <th>Serial</th>
                  <th>Device ID</th>
                  <th>Count</th>
                  <th>Date of Manufacture</th>
                  <th>Date of Sale</th>
                  <th>Sold/Issued To</th>
                  <th>Movement</th>
                  <th>Confirmed</th>
                  <th>Request ID</th>
                </tr>
              </thead>
              <tbody id="inv-built-body"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Liquidation -->
      <div id="inv-tab-liquidation" class="tab-content">
        <div class="inventory-switch-group inventory-liquidation-tabs">
          <span class="inventory-switch-label active" data-inv-subtab="requests">Liquidation</span>
          <label class="inventory-switch">
            <input type="checkbox" id="inv-liquidation-toggle" onchange="inventoryLiquidationSubtab(this.checked ? 'clients' : 'requests')">
            <span class="inventory-switch-slider"></span>
          </label>
          <span class="inventory-switch-label" data-inv-subtab="clients">Clients</span>
        </div>

        <div id="inv-liquidation-requests" class="inventory-panel active">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Liquidation</div>
              <div class="inventory-panel-subtitle">Stock changes only after approval and acknowledgment.</div>
            </div>
            <div class="inventory-actions">
              <label class="inventory-edit-toggle">
                <input type="checkbox" onchange="toggleInventoryEdit('liquidation', this.checked)"> Edit
              </label>
              <button class="btn btn-green" onclick="addInventoryRow('liquidation')">+ Issue/Sale</button>
              <button class="btn btn-outline btn-red" onclick="deleteInventoryRows('liquidation')">Delete Selected</button>
              <button class="btn btn-blue btn-sm" onclick="saveInventoryTable('liquidation')">Save</button>
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="inv-liquidation-table" class="selectable-table">
              <thead>
                <tr>
                  <th><input type="checkbox" onclick="toggleInventorySelectAll('liquidation', this)"></th>
                  <th>Request ID</th>
                  <th>Item</th>
                  <th>Issue/Sale</th>
                  <th>Issued/Sold To</th>
                  <th>Units Before</th>
                  <th>Units After</th>
                  <th>Units Issued</th>
                  <th>Date Issued</th>
                  <th>Acknowledged</th>
                  <th>Evidence (PDF)</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="inv-liquidation-body"></tbody>
            </table>
          </div>
        </div>

        <div id="inv-liquidation-clients" class="inventory-panel" style="display:none;">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Clients</div>
              <div class="inventory-panel-subtitle">Manage client/vendor records for liquidation.</div>
            </div>
            <div class="inventory-actions">
              <label class="inventory-edit-toggle">
                <input type="checkbox" onchange="toggleInventoryEdit('clients', this.checked)"> Edit
              </label>
              <button class="btn btn-green" onclick="addInventoryRow('clients')">+ Client</button>
              <button class="btn btn-outline btn-red" onclick="deleteInventoryRows('clients')">Delete Selected</button>
              <button class="btn btn-blue btn-sm" onclick="saveInventoryTable('clients')">Save</button>
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="inv-clients-table" class="selectable-table">
              <thead>
                <tr>
                  <th><input type="checkbox" onclick="toggleInventorySelectAll('clients', this)"></th>
                  <th>Client type</th>
                  <th>Client name</th>
                  <th>Client address</th>
                  <th>Client contact</th>
                  <th>Client email</th>
                  <th>Item</th>
                  <th>GSTIN</th>
                </tr>
              </thead>
              <tbody id="inv-clients-body"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Prod Batch -->
      <div id="inv-tab-prod-batch" class="tab-content">
        <div class="inventory-panel">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Prod Batch (Master)</div>
              <div class="inventory-panel-subtitle">Maintain production batch definitions for Inventory workflows.</div>
            </div>
            <div class="inventory-actions">
              <button class="btn btn-green" onclick="dbAddRow('prod')">+ Row</button>
              <button class="btn btn-outline btn-red" onclick="dbRemoveRows('prod')">− Row</button>
              <button class="btn btn-blue btn-sm" onclick="dbSaveMaster('prod')">Save Prod Batch</button>
              <label class="db-edit-toggle">
                <input type="checkbox" data-db-edit-toggle="true" onchange="toggleDbEdit('prod-batch', this.checked)">
                Edit Table
              </label>
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="tbl-db-prod-batch" class="selectable-table">
              <thead></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Refill Batch -->
      <div id="inv-tab-refill" class="tab-content">
        <div class="inventory-panel">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Refill Batch</div>
              <div class="inventory-panel-subtitle">Track refill lots, sizes, and manufacturer details.</div>
            </div>
            <div class="inventory-actions">
              <label class="inventory-edit-toggle">
                <input type="checkbox" onchange="toggleInventoryEdit('refill', this.checked)"> Edit
              </label>
              <button class="btn btn-green" onclick="addInventoryRow('refill')">+ Row</button>
              <button class="btn btn-outline btn-red" onclick="deleteInventoryRows('refill')">Delete Selected</button>
              <button class="btn btn-blue btn-sm" onclick="saveInventoryTable('refill')">Save</button>
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="inv-refill-table" class="selectable-table">
              <thead>
                <tr>
                  <th><input type="checkbox" onclick="toggleInventorySelectAll('refill', this)"></th>
                  <th>Refill Box ID</th>
                  <th>Lot size</th>
                  <th>Refill lot ID</th>
                  <th>Manufacturer name</th>
                  <th>Manufacture date</th>
                  <th>Expiry Date</th>
                  <th>Delivery Date</th>
                  <th>PO number</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody id="inv-refill-body"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Approvals -->
      <div id="inv-tab-approvals" class="tab-content">
        <div class="inventory-panel">
          <div class="inventory-panel-header">
            <div>
              <div class="inventory-panel-title">Approvals</div>
              <div class="inventory-panel-subtitle">Approve requests before liquidation applies to stock.</div>
            </div>
            <div class="inventory-actions">
              <label class="inventory-edit-toggle">
                <input type="checkbox" onchange="toggleInventoryEdit('approvals', this.checked)"> Edit
              </label>
              <button class="btn btn-outline" onclick="refreshInventoryApprovals()">Refresh</button>
              <button class="btn btn-blue btn-sm" onclick="saveInventoryTable('approvals')">Save</button>
            </div>
          </div>
          <div class="inventory-table-wrap">
            <table id="inv-approvals-table" class="selectable-table">
              <thead>
                <tr>
                  <th>Request ID</th>
                  <th>Requested By</th>
                  <th>TAT (days)</th>
                  <th>Due Date</th>
                  <th>Status</th>
                  <th>Approver</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="inv-approvals-body"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Nutrient Manager-2 Module -->
    <!-- ==================== Fertilizer Module 2 ==================== -->
    <div id="mod-fertilizer2" class="module-view">
      <div class="module-header">

        <!-- Row 1: Context selectors (Client, Device, Test, Agronomy) -->
        <div class="toolbar" style="border-bottom:1px solid var(--border-color); padding-bottom:8px;">

          <select id="nm2-client" class="search-input" style="min-width:150px;">
        <option value="Default">Default Client</option>
      </select>
          <span style="font-size:0.8rem; color:#6b7280;">Client</span>

          <select id="nm2-rating-scheme" class="search-input" style="min-width:180px;">
        <option value="">Rating scheme...</option>
      </select>
          <span style="font-size:0.8rem; color:#6b7280;">Scheme</span>

          <span class="divider-v"></span>

          <!-- Device ID autocomplete -->
          <div class="autocomplete-container" style="width:140px;">
            <input type="text" id="nm2-device-id" class="search-input"
               placeholder="Device ID" autocomplete="off"
               oninput="nm2OnDeviceInput()" onclick="nm2ShowDeviceList()">
            <div id="nm2-device-list" class="autocomplete-list" style="display:none;"></div>
          </div>

          <!-- Test ID autocomplete -->
          <div class="autocomplete-container" style="width:140px;">
            <input type="text" id="nm2-test-id" class="search-input"
               placeholder="Test ID" autocomplete="off"
               oninput="nm2OnTestInput()" onclick="nm2ShowTestList()">
            <div id="nm2-test-list" class="autocomplete-list" style="display:none;"></div>
          </div>

          <span class="divider-v"></span>

          <!-- Crop + Target Yield -->
          <select id="nm2-crop" class="search-input" style="min-width:180px;">
        <option value="">Select crop...</option>
      </select>

          <input type="number" id="nm2-target-yield" class="date-input"
             placeholder="Target yield" style="width:110px;">
          <span id="nm2-yield-unit" style="font-size:0.8rem; color:#6b7280;">t/ha</span>

          <span class="divider-v"></span>

          <!-- Method + Calc Method -->
          <label style="font-size:0.8rem; display:flex; align-items:center; gap:4px;">
        <input type="checkbox" id="nm2-method-soil" checked> Soil
      </label>
          <label style="font-size:0.8rem; display:flex; align-items:center; gap:4px;">
        <input type="checkbox" id="nm2-method-fert" checked> Fertigation
      </label>
          <label style="font-size:0.8rem; display:flex; align-items:center; gap:4px;">
        <input type="checkbox" id="nm2-method-foliar"> Foliar
      </label>

          <span style="font-size:0.8rem; color:#6b7280;">Calc method</span>
          <select id="nm2-method" onchange="nm2MethodChange()">
        <option value="">Select method...</option>
        <option value="RDF">RDF</option>
        <option value="STCR">STCR</option>
      </select>

          <div class="spacer"></div>
        </div>

        <!-- Row 2: Empty for now (future Stage override UI) -->

        <!-- Row 3: Action buttons + Bulk Export -->
        <div style="display:flex; align-items:center; gap:8px; flex-wrap:wrap; padding:8px 0;">

          <!-- Primary actions -->
          <button type="button" onclick="nm2RecalculatePlan()" class="btn btn-blue">
        Recalculate Plan
      </button>
          <button type="button" onclick="nm2ExportPlan()" class="btn btn-slate">
        Export Plan PDF
      </button>
          <button type="button" onclick="nm2ToggleAdvanced()" class="btn btn-outline">
        Advanced Overrides
      </button>

          <span class="divider-v"></span>

          <!-- Bulk Export controls -->
          <span style="font-size:0.8rem; color:#6b7280; font-weight:600;">Bulk Export:</span>

          <input type="date" id="nm2-bulk-from" class="date-input" style="width:130px;">
          <span style="font-size:0.8rem; color:#6b7280;">to</span>
          <input type="date" id="nm2-bulk-to" class="date-input" style="width:130px;">

          <input type="number" id="nm2-bulk-limit" class="date-input"
             style="width:70px;" placeholder="Limit" value="50" min="1" max="500">

          <label style="font-size:0.8rem; display:flex; align-items:center; gap:4px;">
        <input type="checkbox" id="nm2-bulk-success-only" checked>
        SUCCESS only
      </label>

          <button type="button" onclick="nm2BulkPreview()" class="btn btn-outline"
              style="padding:4px 10px; font-size:0.85rem;">
        Preview Count
      </button>

          <button type="button" onclick="nm2BulkExport()" class="btn btn-teal"
              style="padding:4px 12px; font-size:0.85rem;">
        📦 Bulk Export (Drive)
      </button>

          <span id="nm2-bulk-status" style="font-size:0.75rem; color:#888; margin-left:6px;">
        Ready
      </span>

        </div>

        <!-- Context strip (read-only info) -->
        <div style="padding:4px 20px 8px 20px; font-size:0.78rem; color:#6b7280; 
                display:flex; gap:16px; border-top:1px solid var(--border-color);">
          <span>Field: <span id="nm2-field-context" style="font-weight:600;">—</span></span>
          <span>Soil type: <span id="nm2-soil-type" style="font-weight:600;">—</span></span>
          <span>Scheme: <span id="nm2-scheme-label" style="font-weight:600;">—</span></span>
          <span>Mode: <span id="nm2-mode-label" style="font-weight:600;">Standard (no yield)</span></span>
        </div>

      </div>

      <!-- Advanced Override Panel (collapsible, default hidden) -->
      <div id="nm2-advanced-panel"
        style="display:none; padding:10px 20px; background:#f8f9fa; border-bottom:1px solid var(--border-color);">
        <strong style="font-size:0.85rem; color:#374151;">Advanced P-Source Override</strong>
        <div
          style="display:grid; grid-template-columns: 200px 150px auto; gap:10px; margin-top:8px; align-items:center;">

          <label style="font-size:0.8rem; font-weight:600;">P Source 1:</label>
          <select id="nm2-p-source-1" class="search-input" style="width:100%;">
        <option value="">DAP (18:46:0)</option>
      </select>
          <select id="nm2-p-stage-1" class="search-input" style="width:150px;">
        <option value="BASAL">BASAL</option>
        <option value="VEG">VEG</option>
        <option value="FLOWERING">FLOWERING</option>
      </select>

          <label style="font-size:0.8rem; font-weight:600;">P Source 2 (optional):</label>
          <select id="nm2-p-source-2" class="search-input" style="width:100%;">
        <option value="">—</option>
      </select>
          <select id="nm2-p-stage-2" class="search-input" style="width:150px;">
        <option value="BASAL">BASAL</option>
        <option value="VEG">VEG</option>
      </select>

          <div></div>
          <button type="button" onclick="nm2ApplyOverride()" class="btn btn-green" style="padding:4px 12px; font-size:0.85rem;">
        Apply Override
      </button>
          <span id="nm2-override-status" style="font-size:0.75rem; color:#888;">No override active</span>

        </div>
      </div>

      <!-- Upper panel: Nutrient summary + Soil fertility -->
      <div class="split-container">
        <div class="panel-upper" id="nm2-upper">
          <div class="panel-label">NUTRIENT SUMMARY & SOIL FERTILITY</div>
          <div style="padding:10px; display:flex; gap:12px; flex-wrap:wrap; align-items:flex-start;">

            <!-- Soil fertility table (right) -->
            <div style="flex:1; min-width:260px;">
              <div style="font-size:0.8rem; font-weight:600; color:#4b5563; margin-bottom:4px;">
                Soil Test & Rating
              </div>
              <table class="selectable-table" style="width:100%; font-size:0.78rem;">
                <thead>
                  <tr>
                    <th>Parameter</th>
                    <th>Value</th>
                    <th>Unit</th>
                    <th>Rating</th>
                  </tr>
                </thead>
                <tbody id="nm2-fertility-body">
                  <!-- Populated when DeviceID + TestID resolved -->
                </tbody>
              </table>
            </div>

          </div>
        </div>

        <!-- Drag handle between upper and lower panels -->
        <div id="nm2-divider" class="panel-divider"></div>

        <!-- Lower panel: Stage-wise plan -->
        <div class="panel-lower" id="nm2-lower">
          <div class="panel-label">
            STAGE-WISE NUTRIENT PLAN
            <span style="font-weight:normal; font-size:0.78rem; margin-left:auto;">
          Per stage & method (soil / fertigation / foliar)
        </span>
          </div>
          <div class="table-wrapper">
            <table id="tbl-fert2-stages" class="selectable-table">
              <thead>
                <tr>
                  <th>Stage</th>
                  <th>Nutrient</th>
                  <th>Days / Years</th>
                  <th>Method</th>
                  <th>Dose (kg/ha)</th>
                  <th>Source mix</th>
                  <th>Product qty / ha</th>
                  <th>Cost / ha</th>
                  <th>Delivery details</th>
                  <th>Flags</th>
                </tr>
              </thead>
              <tbody id="body-fert2-stages">
                <tr>
                  <td colspan="10" style="text-align:center; padding:10px;">No plan calculated.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>



    <!-- Impact Module -->
    <!-- ==================== Impact Module ==================== -->
    <div id="mod-impact" class="module-view">
      <div class="module-header">
        <div class="toolbar">
          <span style="font-weight:bold; font-size:1.1rem; color:var(--primary);">Impact Assessment</span>

          <div class="divider-v"></div>

          <!-- Sticky filters are implemented inside module body to keep layout consistent with your other modules -->
          <button class="btn btn-blue" id="ia-refresh">Refresh</button>
          <button class="btn btn-indigo" id="ia-export">Export</button>

          <span style="margin-left:auto; color:#64748b; font-size:12px;">
        UI-only (no backend wiring yet)
      </span>
        </div>
      </div>

      <div class="ia-wrap">

        <!-- Sticky Filter Bar -->
        <div class="ia-filterbar">
          <div class="ia-filter-row">
            <label class="ia-lbl">Season</label>
            <select class="ia-inp" id="ia-season">
          <option value="ALL">All</option>
          <option value="RABI_2025_26">Rabi 2025–26</option>
          <option value="KHARIF_2025">Kharif 2025</option>
        </select>

            <label class="ia-lbl">Crop</label>
            <select class="ia-inp" id="ia-crop">
          <option value="ALL">All</option>
          <option value="WHEAT">Wheat</option>
          <option value="RICE">Rice</option>
          <option value="POTATO">Potato</option>
        </select>

            <label class="ia-lbl">Client</label>
            <select class="ia-inp" id="ia-client">
          <option value="Default">Default</option>
        </select>

            <label class="ia-lbl">State</label>
            <select class="ia-inp" id="ia-state">
          <option value="ALL">All</option>
        </select>

            <label class="ia-lbl">District</label>
            <select class="ia-inp" id="ia-district">
          <option value="ALL">All</option>
        </select>

            <label class="ia-lbl">Block</label>
            <select class="ia-inp" id="ia-block">
          <option value="ALL">All</option>
        </select>
          </div>

          <div class="ia-filter-row">
            <label class="ia-lbl">Farm ID</label>
            <input class="ia-inp" id="ia-farm" placeholder="Type..." />

            <label class="ia-lbl">Device ID</label>
            <input class="ia-inp" id="ia-device" placeholder="Type..." />

            <label class="ia-lbl">Test ID</label>
            <input class="ia-inp" id="ia-test" placeholder="Type..." />

            <button class="btn btn-teal" id="ia-apply">Apply</button>
            <button class="btn btn-outline" id="ia-clear">Clear</button>

            <span class="ia-status" id="ia-status">Filters ready</span>
          </div>
        </div>

        <!-- Tabs -->
        <div class="ia-tabs" id="impactTabsRow">
          <button type="button" class="ia-tab active" data-ia-tab="dash">
    Dashboard <span class="ia-info" data-info="tab-dashboard">ⓘ</span>
  </button>

          <button type="button" class="ia-tab" data-ia-tab="fert">
    Fertilizer Usage <span class="ia-info" data-info="tab-fertilizer">ⓘ</span>
  </button>

          <button type="button" class="ia-tab" data-ia-tab="yield">
    Yield Records <span class="ia-info" data-info="tab-yield">ⓘ</span>
  </button>

          <button type="button" class="ia-tab" data-ia-tab="soil">
    Soil Change <span class="ia-info" data-info="tab-soil">ⓘ</span>
  </button>

          <button type="button" class="ia-tab" data-ia-tab="cov">
    Coverage <span class="ia-info" data-info="tab-coverage">ⓘ</span>
  </button>
        </div>



        <!-- TAB: Dashboard -->
        <div class="ia-tabpage active" id="ia-tab-dash">

          <!-- SUMMARY CARDS -->
          <div class="ia-kpi-grid">
            <div class="ia-kpi">
              <div class="ia-kpi-title">Farms</div>
              <div class="ia-kpi-val" id="ia-kpi-farms">—</div>
              <div class="ia-kpi-sub">With any record</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Area (acres)</div>
              <div class="ia-kpi-val" id="ia-kpi-area">—</div>
              <div class="ia-kpi-sub">Filtered scope</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Soil Samples</div>
              <div class="ia-kpi-val" id="ia-kpi-tests">—</div>
              <div class="ia-kpi-sub">Baseline + follow-up</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Repeat Tests</div>
              <div class="ia-kpi-val" id="ia-kpi-repeat">—</div>
              <div class="ia-kpi-sub">% farms with ≥2 tests</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Fertilizer Data</div>
              <div class="ia-kpi-val" id="ia-kpi-fert">—</div>
              <div class="ia-kpi-sub">Farms with usage lines</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Yield Data</div>
              <div class="ia-kpi-val" id="ia-kpi-yield">—</div>
              <div class="ia-kpi-sub">Farms with yield entries</div>
            </div>
          </div>

          <!-- ECONOMIC IMPACT PANEL -->
          <div class="ia-panel" id="ia-panel-econ">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Economic Impact (₹)
                <span class="ia-info" data-info="panel-economic">ⓘ</span>
              </div>
              <div class="ia-panel-actions">
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-econ">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="ia-two-col">
                <div class="ia-metric-list">
                  <div class="ia-metric"><span>Avg Fertilizer Cost / acre (Baseline)</span><b id="ia-econ-cb">—</b>
                  </div>
                  <div class="ia-metric"><span>Avg Fertilizer Cost / acre (Follow-up)</span><b id="ia-econ-cf">—</b>
                  </div>
                  <div class="ia-metric"><span>Avg Cost Change / acre</span><b id="ia-econ-dc">—</b></div>
                  <div class="ia-metric"><span>Total Cost Change (Filtered)</span><b id="ia-econ-tc">—</b></div>
                </div>

                <div class="ia-metric-list">
                  <div class="ia-metric"><span>Avg Yield (kg/acre)</span><b id="ia-econ-y">—</b></div>
                  <div class="ia-metric"><span>Avg Yield Change (kg/acre)</span><b id="ia-econ-dy">—</b></div>
                  <div class="ia-metric"><span>Avg Revenue Change / acre (if priced)</span><b id="ia-econ-dr">—</b>
                  </div>
                  <div class="ia-metric"><span>Net Benefit / acre (if priced)</span><b id="ia-econ-net">—</b></div>
                </div>
              </div>

              <div class="ia-note">
                Note: These fields will populate after backend wiring (Baseline vs Follow-up).
              </div>
            </div>
          </div>

          <!-- BOTTOM SPLIT: Nutrients + Yield -->
          <div class="ia-split">
            <!-- Nutrient Use Impact -->
            <div class="ia-panel" id="ia-panel-nutr">
              <div class="ia-panel-head">
                <div class="ia-panel-title">
                  Nutrient Use Impact
                  <span class="ia-info" data-info="panel-nutrient">ⓘ</span>
                </div>

                <div class="ia-panel-actions">
                  <button class="btn btn-orange ia-collapse" data-target="ia-panel-nutr">Minimize</button>
                </div>
              </div>
              <div class="ia-panel-body">
                <div class="ia-chart-ph">[Chart placeholder: N / P2O5 / K2O Baseline vs Follow-up]</div>
                <div class="table-wrapper" style="margin-top:10px;">
                  <table class="selectable-table">
                    <thead>
                      <tr>
                        <th>Nutrient</th>
                        <th>Baseline (kg/acre)</th>
                        <th>Follow-up (kg/acre)</th>
                        <th>Change</th>
                        <th>#Farms</th>
                        <th>Area</th>
                      </tr>
                    </thead>
                    <tbody id="ia-nutr-tbody">
                      <tr>
                        <td colspan="6" style="text-align:center; padding:10px; color:#777;">No data (UI-only)</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Yield Impact -->
            <div class="ia-panel" id="ia-panel-yimp">
              <div class="ia-panel-head">
                <div class="ia-panel-title">
                  Yield Impact
                  <span class="ia-info" data-info="panel-yieldimpact">ⓘ</span>
                </div>

                <div class="ia-panel-actions">
                  <button class="btn btn-orange ia-collapse" data-target="ia-panel-yimp">Minimize</button>
                </div>
              </div>
              <div class="ia-panel-body">
                <div class="ia-chart-ph">[Chart placeholder: Yield distribution + ΔYield distribution]</div>
                <div class="table-wrapper" style="margin-top:10px;">
                  <table class="selectable-table">
                    <thead>
                      <tr>
                        <th>Crop</th>
                        <th>#Farms</th>
                        <th>Area</th>
                        <th>Avg Yield</th>
                        <th>Avg ΔYield</th>
                        <th>Price Used?</th>
                      </tr>
                    </thead>
                    <tbody id="ia-yield-tbody">
                      <tr>
                        <td colspan="6" style="text-align:center; padding:10px; color:#777;">No data (UI-only)</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- RECENT TABLE -->
          <div class="ia-panel" id="ia-panel-recent">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Recent Tests
                <span class="ia-info" data-info="panel-recent">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-recent">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="table-wrapper">
                <table class="selectable-table">
                  <thead>
                    <tr>
                      <th>Test ID</th>
                      <th>Device ID</th>
                      <th>Date</th>
                      <th>District</th>
                      <th>Status</th>
                    </tr>
                  </thead>
                  <tbody id="ia-recent-tbody">
                    <tr>
                      <td colspan="5" style="text-align:center; padding:10px; color:#777;">No data (UI-only)</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

        </div>

        <!-- TAB: Fertilizer Usage -->
        <div class="ia-tabpage" id="ia-tab-fert">

          <div class="ia-panel" id="ia-panel-fert-entry">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Fertilizer Usage Entry
                <span class="ia-info" data-info="panel-fert-entry">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-fert-entry">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="ia-form-grid">
                <div>
                  <label class="ia-lbl">ClientID</label>
                  <select class="ia-inp">
                <option>Default</option>
              </select>
                </div>
                <div>
                  <label class="ia-lbl">Farm_ID</label>
                  <input class="ia-inp" placeholder="autosuggest later" />
                </div>
                <div>
                  <label class="ia-lbl">Device_ID</label>
                  <input class="ia-inp" placeholder="autosuggest later" />
                </div>
                <div>
                  <label class="ia-lbl">Test_ID</label>
                  <input class="ia-inp" placeholder="autosuggest later" />
                </div>

                <div>
                  <label class="ia-lbl">Season</label>
                  <select class="ia-inp">
                <option>Rabi 2025–26</option>
                <option>Kharif 2025</option>
              </select>
                </div>
                <div>
                  <label class="ia-lbl">Crop</label>
                  <input class="ia-inp" placeholder="auto-fill later" />
                </div>
                <div>
                  <label class="ia-lbl">Area (acre)</label>
                  <input class="ia-inp" placeholder="0.0" />
                </div>
                <div>
                  <label class="ia-lbl">
  Type <span class="ia-info" data-info="field-baseline-followup">ⓘ</span>
</label>

                  <select class="ia-inp">
                <option>Baseline</option>
                <option>Follow-up</option>
              </select>
                </div>

                <div>
                  <label class="ia-lbl">
  Method <span class="ia-info" data-info="field-yield-method">ⓘ</span>
</label>

                  <select class="ia-inp">
                <option>SOIL</option>
                <option>FERTIGATION</option>
              </select>
                </div>
                <div>
                  <label class="ia-lbl">
  Evidence <span class="ia-info" data-info="field-evidence">ⓘ</span>
</label>

                  <select class="ia-inp">
                <option>Farmer recall</option>
                <option>Bill</option>
                <option>FPO record</option>
              </select>
                </div>

                <div style="grid-column: 1 / span 2;">
                  <label class="ia-lbl">Notes</label>
                  <input class="ia-inp" placeholder="Optional notes..." />
                </div>

                <div class="ia-form-actions">
                  <button class="btn btn-green" type="button">Save Entry</button>
                  <button class="btn btn-outline" type="button">Clear</button>
                </div>
              </div>
            </div>
          </div>

          <div class="ia-panel" id="ia-panel-fert-grid">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Line Item Grid
                <span class="ia-info" data-info="panel-fert-grid">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <button class="btn btn-green" type="button" data-ia-action="add-row">+ Add Row</button>
                <button class="btn btn-red" type="button" data-ia-action="remove-row">- Remove Row</button>
                <button class="btn btn-orange ia-collapse" type="button" data-target="ia-panel-fert-grid">Minimize</button>
              </div>


            </div>
            <div class="ia-panel-body">
              <div class="table-wrapper">
                <table class="selectable-table">
                  <thead>
                    <tr>
                      <th>Stage</th>
                      <th>SourceID</th>
                      <th>SourceName</th>
                      <th>Qty</th>
                      <th>Unit</th>
                      <th>UnitSize</th>
                      <th>Price/Unit</th>
                      <th>Cost</th>
                      <th>Notes</th>
                    </tr>
                  </thead>
                  <tbody id="ia-fert-lines">
                    <tr>
                      <td>
                        <select class="ia-inp"><option>BASAL</option><option>VEG</option><option>FLOWERING</option><option>FRUITING</option><option>OTHER</option></select>
                      </td>
                      <td><input class="ia-inp" placeholder="DAP" /></td>
                      <td><input class="ia-inp" placeholder="auto later" disabled /></td>
                      <td><input class="ia-inp" placeholder="0.0" /></td>
                      <td><select class="ia-inp"><option>bag</option><option>kg</option></select></td>
                      <td><input class="ia-inp" placeholder="50" disabled /></td>
                      <td><input class="ia-inp" placeholder="1400" disabled /></td>
                      <td><input class="ia-inp" placeholder="auto" disabled /></td>
                      <td><input class="ia-inp" placeholder="..." /></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="ia-note">Source dropdown will be wired to NutrientSources later.</div>
            </div>
          </div>

          <div class="ia-panel" id="ia-panel-fert-table">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Saved Fertilizer Usage Records
                <span class="ia-info" data-info="panel-fert-table">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <input class="ia-inp ia-inp-sm" placeholder="Search..." />
                <button class="btn btn-indigo">Export CSV</button>
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-fert-table">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="table-wrapper">
                <table class="selectable-table">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Farm_ID</th>
                      <th>Device_ID</th>
                      <th>Test_ID</th>
                      <th>Season</th>
                      <th>Crop</th>
                      <th>Type</th>
                      <th>Stage</th>
                      <th>SourceID</th>
                      <th>Qty</th>
                      <th>Unit</th>
                      <th>Cost</th>
                      <th>Entered_By</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="13" style="text-align:center; padding:10px; color:#777;">No data (UI-only)</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

        </div>

        <!-- TAB: Yield Records -->
        <div class="ia-tabpage" id="ia-tab-yield">

          <div class="ia-panel" id="ia-panel-yield-entry">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Yield Entry
                <span class="ia-info" data-info="panel-yield-entry">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-yield-entry">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="ia-form-grid">
                <div><label class="ia-lbl">ClientID</label><select class="ia-inp"><option>Default</option></select>
                </div>
                <div><label class="ia-lbl">Farm_ID</label><input class="ia-inp" placeholder="autosuggest later" /></div>
                <div><label class="ia-lbl">Device_ID</label><input class="ia-inp" placeholder="autosuggest later" />
                </div>
                <div><label class="ia-lbl">Test_ID</label><input class="ia-inp" placeholder="autosuggest later" /></div>

                <div>
                  <label class="ia-lbl">Season</label><select class="ia-inp"><option>Rabi 2025–26</option><option>Kharif 2025</option></select>
                </div>
                <div><label class="ia-lbl">Crop</label><input class="ia-inp" placeholder="auto-fill later" /></div>
                <div><label class="ia-lbl">Area (acre)</label><input class="ia-inp" placeholder="0.0" /></div>
                <div><label class="ia-lbl">Yield (kg/acre)</label><input class="ia-inp" placeholder="0" /></div>

                <div>
                  <label class="ia-lbl">Method</label><select class="ia-inp"><option>Farmer recall</option><option>Weighment</option><option>Trader slip</option></select>
                </div>
                <div><label class="ia-lbl">Price (₹/kg)</label><input class="ia-inp" placeholder="optional" /></div>
                <div style="grid-column: 1 / span 2;"><label class="ia-lbl">Notes</label><input class="ia-inp" placeholder="Optional notes..." />
                </div>

                <div class="ia-form-actions">
                  <button class="btn btn-green" type="button">Save Yield</button>
                  <button class="btn btn-outline" type="button">Clear</button>
                </div>
              </div>
            </div>
          </div>

          <div class="ia-panel" id="ia-panel-yield-table">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Yield Records
                <span class="ia-info" data-info="panel-yield-table">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <input class="ia-inp ia-inp-sm" placeholder="Search..." />
                <button class="btn btn-indigo">Export CSV</button>
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-yield-table">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="table-wrapper">
                <table class="selectable-table">
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Farm_ID</th>
                      <th>Device_ID</th>
                      <th>Test_ID</th>
                      <th>Season</th>
                      <th>Crop</th>
                      <th>Area</th>
                      <th>Yield kg/acre</th>
                      <th>Method</th>
                      <th>Price</th>
                      <th>Revenue</th>
                      <th>Entered_By</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="12" style="text-align:center; padding:10px; color:#777;">No data (UI-only)</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

        </div>

        <!-- TAB: Soil Change -->
        <div class="ia-tabpage" id="ia-tab-soil">

          <div class="ia-panel" id="ia-panel-pair">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Pairing Rule
                <span class="ia-info" data-info="panel-pairing">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-pair">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="ia-form-grid">
                <div style="grid-column: 1 / span 2;">
                  <label class="ia-lbl">
  Compare <span class="ia-info" data-info="field-pairing-compare">ⓘ</span>
</label>
                  <div class="ia-radio">
                    <label><input type="radio" name="ia-pair" checked> Same Farm_ID within Season</label>
                    <label><input type="radio" name="ia-pair"> Previous Test_ID for same Device_ID</label>
                  </div>
                </div>
                <div>
                  <label class="ia-lbl">Window</label>
                  <select class="ia-inp">
                <option>0–18 months</option>
                <option>0–12 months</option>
                <option>0–24 months</option>
              </select>
                </div>
              </div>
              <div class="ia-note">Soil change analytics will be computed after backend wiring.</div>
            </div>
          </div>

          <div class="ia-split">
            <div class="ia-panel" id="ia-panel-soilsum">
              <div class="ia-panel-head">
                <div class="ia-panel-title">
                  Soil Change Summary
                  <span class="ia-info" data-info="panel-soil-summary">ⓘ</span>
                </div>

                <div class="ia-panel-actions">
                  <button class="btn btn-orange ia-collapse" data-target="ia-panel-soilsum">Minimize</button>
                </div>
              </div>
              <div class="ia-panel-body">
                <div class="ia-metric-list">
                  <div class="ia-metric"><span>% farms with OC improvement</span><b>—</b></div>
                  <div class="ia-metric"><span>% farms moved into optimal pH</span><b>—</b></div>
                  <div class="ia-metric"><span># deficiencies corrected (Low→Med)</span><b>—</b></div>
                </div>
                <div class="ia-chart-ph" style="margin-top:10px;">[Chart placeholder: parameter-wise improvement]</div>
              </div>
            </div>

            <div class="ia-panel" id="ia-panel-trans">
              <div class="ia-panel-head">
                <div class="ia-panel-title">
                  Class Transitions
                  <span class="ia-info" data-info="panel-soil-transition">ⓘ</span>
                </div>

                <div class="ia-panel-actions">
                  <button class="btn btn-orange ia-collapse" data-target="ia-panel-trans">Minimize</button>
                </div>
              </div>
              <div class="ia-panel-body">
                <div class="ia-chart-ph">[Chart placeholder: Low → Medium → High transitions]</div>
              </div>
            </div>
          </div>

          <div class="ia-panel" id="ia-panel-matrix">
            <div class="ia-panel-head">
              <div class="ia-panel-title">
                Parameter Transition Table
                <span class="ia-info" data-info="panel-soil-matrix">ⓘ</span>
              </div>

              <div class="ia-panel-actions">
                <button class="btn btn-orange ia-collapse" data-target="ia-panel-matrix">Minimize</button>
              </div>
            </div>
            <div class="ia-panel-body">
              <div class="table-wrapper">
                <table class="selectable-table">
                  <thead>
                    <tr>
                      <th>Parameter</th>
                      <th>Low→Med</th>
                      <th>Med→High</th>
                      <th>No change</th>
                      <th>Worse</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="5" style="text-align:center; padding:10px; color:#777;">No data (UI-only)</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

        </div>

        <!-- TAB: Coverage -->
        <div class="ia-tabpage" id="ia-tab-cov">

          <div class="ia-kpi-grid" style="margin-top:0;">
            <div class="ia-kpi">
              <div class="ia-kpi-title">States</div>
              <div class="ia-kpi-val">—</div>
              <div class="ia-kpi-sub">Covered</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Districts</div>
              <div class="ia-kpi-val">—</div>
              <div class="ia-kpi-sub">Covered</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Farmers</div>
              <div class="ia-kpi-val">—</div>
              <div class="ia-kpi-sub">Unique</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Area</div>
              <div class="ia-kpi-val">—</div>
              <div class="ia-kpi-sub">Acres</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Devices</div>
              <div class="ia-kpi-val">—</div>
              <div class="ia-kpi-sub">Unique</div>
            </div>
            <div class="ia-kpi">
              <div class="ia-kpi-title">Tests</div>
              <div class="ia-kpi-val">—</div>
              <div class="ia-kpi-sub">Total</div>
            </div>
          </div>

          <div class="ia-split">
            <div class="ia-panel" id="ia-panel-map">
              <div class="ia-panel-head">
                <div class="ia-panel-title">
                  Coverage Map
                  <span class="ia-info" data-info="panel-coverage-map">ⓘ</span>
                </div>

                <div class="ia-panel-actions">
                  <button class="btn btn-orange ia-collapse" data-target="ia-panel-map">Minimize</button>
                </div>
              </div>
              <div class="ia-panel-body">
                <div class="ia-chart-ph" style="height:320px;">[Map placeholder]</div>
              </div>
            </div>

            <div class="ia-panel" id="ia-panel-covtable">
              <div class="ia-panel-head">
                <div class="ia-panel-title">
                  Coverage by District
                  <span class="ia-info" data-info="panel-coverage-table">ⓘ</span>
                </div>

                <div class="ia-panel-actions">
                  <button class="btn btn-orange ia-collapse" data-target="ia-panel-covtable">Minimize</button>
                </div>
              </div>
              <div class="ia-panel-body">
                <div class="table-wrapper" style="max-height:360px;">
                  <table class="selectable-table">
                    <thead>
                      <tr>
                        <th>District</th>
                        <th>Farmers</th>
                        <th>Tests</th>
                        <th>Area</th>
                        <th>Avg ΔCost</th>
                        <th>Avg ΔYield</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td colspan="6" style="text-align:center; padding:10px; color:#777;">No data (UI-only)</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

        </div>

      </div>

      <!-- Impact Info Modal (one-time) -->
      <div id="ia-info-modal" class="ia-info-modal hidden">
        <div class="ia-info-card">
          <div class="ia-info-header">
            <span id="ia-info-title"></span>
            <button type="button" class="ia-info-close" onclick="iaCloseInfo()">✕</button>
          </div>
          <div id="ia-info-body" class="ia-info-body"></div>
        </div>
      </div>



    </div>



    <!-- User Feedback Module -->

    <!-- ==================== User Feedback Module ==================== -->
    <div id="mod-feedback" class="module-view">
      <div class="module-header">
        <div class="toolbar">
          <span style="font-weight:bold; font-size:1.1rem; color:var(--primary);">User Feedback</span>
        </div>
      </div>
      <div style="display:flex; flex:1; align-items:center; justify-content:center; color:#999; flex-direction:column;">
        <svg style="width:64px; height:64px; opacity:0.2;" viewBox="0 0 24 24" fill="none" stroke="currentColor"
          stroke-width="1">
          <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z" />
        </svg>
        <h2 style="margin-top:10px; font-weight:normal;">Module will be populated later</h2>
      </div>
    </div>





    <!-- Admin Module -->
    <!-- ==================== Admin Module ==================== -->
    <div id="mod-admin" class="module-view">
      <div class="module-header"></div>

      <div class="tab-nav">
        <button class="tab-btn active" onclick="adminTab('create', event)">Create New User</button>
        <button class="tab-btn" onclick="adminTab('manage', event)">Manage Existing Permissions</button>
      </div>

      <div style="padding:20px; overflow-y:auto; display:flex; flex-direction:column; gap:30px;">

        <div id="tab-admin-create" class="tab-content active" style="display:block;">
          <div class="admin-form" style="max-width:600px;">
          <h3 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">Create New User</h3>

          <div style="display:flex; gap:20px;">
            <div style="flex:1;">
              <div class="form-group">
                <label>User Role</label>
                <select id="adm-type" style="width:100%; font-weight:bold;">
                                <option>QC</option>
                                <option>Technician</option>
                                <option>Manager</option>
                                <option>Demo</option>
                                <option>Admin</option>
                            </select>
              </div>
              <div class="form-group">
                <label>Employee ID</label>
                <input type="text" id="adm-user" style="width:100%;">
              </div>
              <div class="form-group">
                <label>Password</label>
                <input type="password" id="adm-pass" style="width:100%;">
              </div>
            </div>

            <div style="flex:1; border-left:1px solid #eee; padding-left:20px;">
              <label style="font-weight:600; margin:0 0 6px; display:block;">Access Hierarchy</label>
              <div id="adm-new-access-tree" class="access-tree"></div>
              <div style="margin-top:10px; font-size:0.75rem; color:#666;">
                * If none selected, default Role permissions apply.
              </div>
            </div>
          </div>

          <div style="margin-top:20px; text-align:right;">
            <button class="btn btn-green" onclick="createUser()">Create User</button>
          </div>
          </div>
        </div>


        <div id="tab-admin-manage" class="tab-content" style="display:none;">
          <div class="admin-form" style="max-width:600px; border-left: 4px solid var(--accent);">
          <h3 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px; color:var(--accent);">Manage
            Existing Permissions</h3>

          <div class="form-group">
            <label>Select User</label>
            <div style="display:flex; gap:10px;">
              <select id="adm-existing-list" style="flex:1;" onchange="loadUserPermissions()">
                            <option value="">Loading users...</option>
                        </select>
              <button class="btn btn-sm btn-blue" onclick="refreshUserList()">Refresh List</button>
            </div>
          </div>

          <div id="adm-edit-container"
            style="display:none; margin-top:20px; background:#f9f9f9; padding:15px; border-radius:4px;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
              <strong>Role:</strong>
              <span id="adm-edit-role" style="font-size:0.8rem; background:#ddd; padding:2px 6px; border-radius:4px;"></span>
            </div>
            <div style="margin-top:14px;">
              <label style="font-weight:600; margin-bottom:6px; display:block;">Access Hierarchy</label>
              <div id="adm-edit-access-tree" class="access-tree"></div>
            </div>

            <div style="margin-top:15px;">
              <label style="font-weight:600; display:block; margin-bottom:6px;">Reset Password</label>
              <div style="display:flex; gap:10px;">
                <input type="password" id="adm-reset-pass" style="flex:1;" placeholder="New password">
                <button class="btn btn-outline" onclick="adminResetPassword()">Reset</button>
              </div>
            </div>

            <div style="margin-top:20px; text-align:right;">
              <button class="btn btn-blue" onclick="saveUserPermissions()">Update Permissions</button>
            </div>
          </div>
          </div>
        </div>

      </div>
    </div>

  </div>

  <!-- Version info footer (visible at bottom of page) -->
  <div id="version-info"
    style="position:fixed; bottom:5px; right:10px; font-size:0.7rem; color:#888; background:rgba(255,255,255,0.9); padding:3px 8px; border-radius:3px; z-index:1000;">
    Loading version...
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.2/html2pdf.bundle.min.js"></script>

    <script>
  // ================================
  // SCRIPTS (module-wise sections)
  // ================================
  // PAGINATION STATE (Missing Variables)
let currentPage = {
  rgb: 1,
  qaqc: 1,
  registry: 1
};
let rowsPerPage = 50; 


    // --- Load version info AFTER DOM is ready ---
    google.script.run.withSuccessHandler(v => {
    document.getElementById('version-info').textContent = 
      `${v.version} (Built: ${v.buildTime})`;
  }).getAppVersion();


  
    // --- PERMISSIONS CONFIGURATION ---
// Define which modules each role can see.
// ID matching HTML ids: 'rgb', 'qaqc', 'results', 'stv-direct', 'db', 'devices', 'analytics', 'admin'
const ROLE_PERMISSIONS = {
    'Admin':      ['all'], 
    'QC':         ['rgb', 'qaqc', 'results', 'stv-direct'],
    'Manager':    ['rgb', 'results', 'stv-direct', 'analytics', 'devices', 'fertilizer','fertilizer2', 'impact', 'feedback'], // Added new modules
    'Technician': ['devices', 'rgb', 'feedback'], // Added feedback
    'Demo':       ['analytics', 'results', 'stv-direct', 'fertilizer','fertilizer2']
};;

let currentUserRole = null;
let currentUser = null;

function updateUserCard(userInfo) {
    const nameEl = document.getElementById('user-display-name');
    const roleEl = document.getElementById('user-display-role');
    const logoutBtn = document.getElementById('user-logout-btn');
    const powerBtn = document.getElementById('user-power-btn');
    if (!nameEl || !roleEl || !logoutBtn) return;

    if (!userInfo) {
        nameEl.textContent = 'Not signed in';
        roleEl.textContent = '—';
        logoutBtn.disabled = true;
        if (powerBtn) powerBtn.disabled = true;
        return;
    }

    const displayName = userInfo.user || userInfo.empId || userInfo.email || 'User';
    nameEl.textContent = displayName;
    roleEl.textContent = userInfo.role || '';
    logoutBtn.disabled = false;
    if (powerBtn) powerBtn.disabled = false;
}

function attemptLogin() {
    const u = document.getElementById('login-user').value.trim();
    const p = document.getElementById('login-pass').value.trim();
    const msg = document.getElementById('login-msg');
    
    if(!u || !p) { msg.innerText = "Please fill all fields."; return; }
    
    msg.innerText = "Verifying...";
    
    google.script.run.withSuccessHandler(res => {
        if(res.success) {
            document.getElementById('login-overlay').style.display = 'none';
            currentUserRole = res.role;
            currentUser = res;
            updateUserCard(res);
            console.log("Logged in as " + res.role);
            
            // APPLY PERMISSIONS
            // If user has specific modules assigned, use them. Otherwise fallback to Role.
            const userModules = res.modules && res.modules.length > 0 ? res.modules : null;
            applyPermissions(res.role, userModules);
            
            // If admin, load user list
            if(res.role === 'Admin') refreshUserList();

        } else {
            msg.innerText = res.msg || "Login Failed";
        }
    }).withFailureHandler(err => {
        msg.innerText = "Connection Error";
    }).checkLogin(u, p);
}

function applyPermissions(role, customModules) {
    // 1. Determine allowed list
    let allowed = [];
    
    if (customModules) {
        allowed = customModules; // Use custom overrides
    } else {
        allowed = ROLE_PERMISSIONS[role] || []; // Use Role defaults
    }

    allowed = normalizeAccessList(allowed);

    const allNavItems = document.querySelectorAll('.nav-item');
    const allowedSet = new Set(allowed);
    
    // 2. Hide all tabs initially
    allNavItems.forEach(el => el.style.display = 'none');
    
    // 3. Show allowed tabs
    allNavItems.forEach(el => {
        const clickAttr = el.getAttribute('onclick'); 
        
        if (allowed.includes('all')) {
            el.style.display = 'flex';
        } else {
            // Check if any allowed ID is present in the onclick string
            // Modules IDs: rgb, qaqc, results, db, devices, analytics, admin
            const isAllowed = allowed.some(id => clickAttr.includes(`'${id}'`));
            if (isAllowed) el.style.display = 'flex';
        }
    });

    applyAccessControls(allowedSet);

    // 4. Automatically open the preferred tab (Results) if available; else first visible
    const preferred = Array.from(allNavItems).find(el => {
        const clickAttr = el.getAttribute('onclick') || '';
        return clickAttr.includes("'results'") && el.style.display === 'flex';
    });
    const firstVisible = document.querySelector('.nav-item[style="display: flex;"]');
    if (preferred) {
        preferred.click();
    } else if (firstVisible) {
        firstVisible.click();
    } else {
        alert("No modules assigned to this user.");
    }
}

function hasPermission(allowedSet, id) {
    if (allowedSet.has('all')) return true;
    if (allowedSet.has(id)) return true;
    for (const entry of allowedSet) {
        if (entry.startsWith(id + '.')) return true;
    }
    const parts = id.split('.');
    while (parts.length > 1) {
        parts.pop();
        const parent = parts.join('.');
        if (allowedSet.has(parent)) return true;
    }
    return false;
}

function applyAccessControls(allowedSet) {
    const allow = (id) => hasPermission(allowedSet, id);

    const devicesInstallBtn = document.querySelector('#mod-devices .tab-btn[onclick*="install-reg"]');
    const devicesServiceBtn = document.querySelector('#mod-devices .tab-btn[onclick*="service-reg"]');
    if (devicesInstallBtn) devicesInstallBtn.style.display = allow('devices.install-reg') ? '' : 'none';
    if (devicesServiceBtn) devicesServiceBtn.style.display = allow('devices.service-reg') ? '' : 'none';

    const installToggle = document.getElementById('install-view-toggle');
    const allowInstalled = allow('devices.install-reg.installed');
    const allowMap = allow('devices.install-reg.map');
    if (installToggle) installToggle.disabled = !(allowInstalled && allowMap);
    if (allowInstalled && !allowMap) setInstallSubtab('installed');
    if (allowMap && !allowInstalled) setInstallSubtab('map');

    const dbTabMap = [
        { id: 'criteria', perm: 'db.criteria' },
        { id: 'stv', perm: 'db.stv' },
        { id: 'qc-criteria', perm: 'db.qc-criteria' },
        { id: 'blanks', perm: 'db.blanks' },
        { id: 'qc-batch', perm: 'db.qc-batch' }
    ];
    dbTabMap.forEach(({ id, perm }) => {
        const btn = document.querySelector(`#mod-db .tab-btn[onclick*="tab('${id}'"]`);
        const content = document.getElementById(`tab-${id}`);
        const visible = allow(perm);
        if (btn) btn.style.display = visible ? '' : 'none';
        if (content && !visible) content.style.display = 'none';
    });

    const rgbToggle = document.getElementById('rgb-view-toggle');
    if (rgbToggle) {
        const allowRaw = allow('rgb.raw');
        const allowMetrics = allow('rgb.metrics');
        rgbToggle.disabled = !(allowRaw && allowMetrics);
        if (allowMetrics && !allowRaw) setRgbFocus('metrics');
        if (allowRaw && !allowMetrics) setRgbFocus('raw');
    }

    const resultsToggle = document.getElementById('results-view-toggle');
    if (resultsToggle) {
        const allowSuccess = allow('results.success');
        const allowTable = allow('results.table');
        resultsToggle.disabled = !(allowSuccess && allowTable);
        if (allowTable && !allowSuccess) setResultsFocus('table');
        if (allowSuccess && !allowTable) setResultsFocus('success');
    }

    const qaqcStatusBtn = document.querySelector('#mod-qaqc .qaqc-switch-group .btn-panel-toggle[data-qaqc-mode="status"]');
    if (qaqcStatusBtn) qaqcStatusBtn.style.display = allow('qaqc.status') ? '' : 'none';
    const qaqcResultsBtn = document.querySelector('#mod-qaqc .qaqc-switch-group .btn-panel-toggle[data-qaqc-mode="results"]');
    if (qaqcResultsBtn) qaqcResultsBtn.style.display = allow('qaqc.results') ? '' : 'none';
    if (allow('qaqc.results') && !allow('qaqc.status')) setQaqcFocus('results');
    if (allow('qaqc.status') && !allow('qaqc.results')) setQaqcFocus('status');

    const inventoryNav =
      document.querySelector('.nav-item[onclick="nav(\'inventory\', event)"]') ||
      document.querySelector('.nav-item[onclick*="nav(\'inventory\'"]') ||
      document.querySelector('.nav-item[onclick*="nav(\\\'inventory\\\'"]');
    if (inventoryNav) {
      inventoryNav.style.display = allow('inventory') ? '' : 'none';
    }

    const invTabMap = [
        { id: 'constitution', perm: 'inventory.constitution' },
        { id: 'stock', perm: 'inventory.stock' },
        { id: 'liquidation', perm: 'inventory.liquidation' },
        { id: 'approvals', perm: 'inventory.approvals' },
        { id: 'prod-batch', perm: 'inventory.prod-batch' },
        { id: 'refill', perm: 'inventory.refill' }
    ];
    invTabMap.forEach(({ id, perm }) => {
        const btn = document.querySelector(`#mod-inventory .tab-btn[onclick*="inventoryTab('${id}'"]`);
        const content = document.getElementById(`inv-tab-${id}`);
        const visible = allow(perm);
        if (btn) btn.style.display = visible ? '' : 'none';
        if (content && !visible) content.style.display = 'none';
    });

    const invStockPartsLabel = document.querySelector('#mod-inventory .inventory-subtabs [data-inv-subtab="parts"]');
    const invStockBuiltLabel = document.querySelector('#mod-inventory .inventory-subtabs [data-inv-subtab="built"]');
    const invStockToggle = document.getElementById('inv-stock-toggle');
    const allowParts = allow('inventory.stock.parts');
    const allowBuilt = allow('inventory.stock.built');
    if (invStockPartsLabel) invStockPartsLabel.style.display = allowParts ? '' : 'none';
    if (invStockBuiltLabel) invStockBuiltLabel.style.display = allowBuilt ? '' : 'none';
    if (invStockToggle) {
        invStockToggle.disabled = !(allowParts && allowBuilt);
        if (allowParts && !allowBuilt) invStockToggle.checked = false;
        if (allowBuilt && !allowParts) invStockToggle.checked = true;
    }
    if (allowParts && !allowBuilt) inventorySubtab('stock', 'parts');
    if (allowBuilt && !allowParts) inventorySubtab('stock', 'built');
}

// =========================
// INVENTORY MANAGER (UI-only)
// =========================
const inventoryState = {
    constitution: [],
    parts: [],
    built: [],
    liquidation: [],
    clients: [],
    approvals: [],
    refill: [],
    stock: {},
    initialized: false,
    dirty: false
};

const inventoryEditState = {
    constitution: false,
    parts: false,
    built: false,
    liquidation: false,
    approvals: false,
    clients: false,
    refill: false
};

const inventoryTableIds = {
    constitution: 'inv-constitution-table',
    parts: 'inv-parts-table',
    built: 'inv-built-table',
    liquidation: 'inv-liquidation-table',
    approvals: 'inv-approvals-table',
    clients: 'inv-clients-table',
    refill: 'inv-refill-table'
};

function applyInventoryEditState(type) {
    const tableId = inventoryTableIds[type];
    if (!tableId) return;
    const table = document.getElementById(tableId);
    if (!table) return;
    const enabled = !!inventoryEditState[type];
    table.querySelectorAll('input, select, textarea').forEach(el => {
        if (el.type === 'file' || el.type === 'checkbox' || el.tagName === 'SELECT' || el.type === 'date' || el.type === 'datetime-local') {
            el.disabled = !enabled;
        } else {
            el.readOnly = !enabled;
        }
        el.classList.toggle('inv-readonly', !enabled);
    });
    table.querySelectorAll('button').forEach(el => {
        el.disabled = !enabled;
        el.classList.toggle('inv-readonly', !enabled);
    });
}

function toggleInventoryEdit(type, enabled) {
    inventoryEditState[type] = !!enabled;
    applyInventoryEditState(type);
}

const inventoryCsvConfig = {
    constitution: {
        fields: ['category', 'itemClass', 'item', 'unit', 'unitsPerDevice', 'costPerUnit', 'version', 'effectiveDate'],
        defaults: { unit: 'unit', version: 'v1' },
        headerAliases: {
            itemClass: ['itemclass'],
            unit: ['unit', 'uom'],
            unitsPerDevice: ['unitsdevice', 'unitsperdevice'],
            costPerUnit: ['costrsunit', 'costperunit', 'priceperunit']
        }
    },
    parts: {
        fields: ['category', 'itemClass', 'item', 'unit', 'qty', 'costPerUnit', 'movement', 'date', 'deliveryDate', 'poNumber', 'confirmedBy', 'issuedTo'],
        defaults: { unit: 'unit', movement: 'Inbound', confirmedBy: '', issuedTo: '' },
        headerAliases: {
            itemClass: ['itemclass'],
            unit: ['unit', 'uom'],
            qty: ['instockqty', 'qty', 'quantity'],
            costPerUnit: ['costrsunit', 'costperunit', 'priceperunit'],
            movement: ['movementtype', 'movement'],
            date: ['dateofmovement', 'date', 'datetime'],
            deliveryDate: ['deliverydate', 'delivery_date'],
            poNumber: ['ponumber', 'po_number', 'po'],
            confirmedBy: ['confirmedby', 'confirmed_by'],
            issuedTo: ['issuedto', 'issued_to']
        }
    }
};

function triggerInventoryCsv(type) {
    const inputId = type === 'constitution' ? 'inv-constitution-csv' : 'inv-parts-csv';
    const input = document.getElementById(inputId);
    if (!input) return;
    input.value = '';
    input.click();
}

function parseInventoryCsv(text) {
    const rows = [];
    let row = [];
    let cell = '';
    let inQuotes = false;

    for (let i = 0; i < text.length; i += 1) {
        const char = text[i];
        if (char === '"') {
            if (inQuotes && text[i + 1] === '"') {
                cell += '"';
                i += 1;
            } else {
                inQuotes = !inQuotes;
            }
        } else if (char === ',' && !inQuotes) {
            row.push(cell);
            cell = '';
        } else if ((char === '\n' || char === '\r') && !inQuotes) {
            if (char === '\r' && text[i + 1] === '\n') {
                i += 1;
            }
            row.push(cell);
            if (row.some(value => String(value).trim() !== '')) {
                rows.push(row);
            }
            row = [];
            cell = '';
        } else {
            cell += char;
        }
    }

    row.push(cell);
    if (row.some(value => String(value).trim() !== '')) {
        rows.push(row);
    }
    return rows;
}

function normalizeInventoryHeader(value) {
    return String(value || '')
        .toLowerCase()
        .replace(/[^a-z0-9]/g, '');
}

function parseInventoryFloat(value) {
    if (value === '' || value === null || value === undefined) return '';
    const num = Number(String(value).trim());
    return Number.isFinite(num) ? num : value;
}

function parseInventoryDateTime(value) {
    if (!value) return '';
    if (value instanceof Date && !Number.isNaN(value.getTime())) {
        const year = value.getFullYear();
        const month = String(value.getMonth() + 1).padStart(2, '0');
        const day = String(value.getDate()).padStart(2, '0');
        const hours = String(value.getHours()).padStart(2, '0');
        const minutes = String(value.getMinutes()).padStart(2, '0');
        return `${year}-${month}-${day}T${hours}:${minutes}`;
    }
    const text = String(value).trim();
    if (!text) return '';
    const istMatch = text.match(/^(\d{1,2})-(\d{1,2})-(\d{4}),\s*(\d{1,2}):(\d{2})/i);
    if (istMatch) {
        const [, day, month, year, hours, minutes] = istMatch;
        return `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}T${hours.padStart(2, '0')}:${minutes}`;
    }
    const legacyMatch = text.match(/^(\d{1,2})-(\d{1,2})-(\d{4})[; ](\d{1,2}):(\d{2})$/);
    if (legacyMatch) {
        const [, day, month, year, hours, minutes] = legacyMatch;
        return `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}T${hours.padStart(2, '0')}:${minutes}`;
    }
    const dateOnlyMatch = text.match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);
    if (dateOnlyMatch) {
        const [, day, month, year] = dateOnlyMatch;
        return `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}T00:00`;
    }
    const isoMatch = text.match(/^(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2}))?$/);
    if (isoMatch) {
        const [, year, month, day, hours = '00', minutes = '00'] = isoMatch;
        return `${year}-${month}-${day}T${hours}:${minutes}`;
    }
    return text;
}

function inventoryActionCode(action) {
    const normalized = String(action || '').toLowerCase();
    if (normalized === 'issue') return 'ISS';
    if (normalized === 'sale') return 'SAL';
    if (normalized === 'transfer') return 'TRA';
    return String(action || '').slice(0, 3).toUpperCase() || 'REQ';
}

function formatInventoryRequestId(action, createdAt) {
    const iso = parseInventoryDateTime(createdAt) || combineDateWithCurrentIstTime(formatDateToIso(new Date()));
    const match = String(iso).match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})/);
    if (!match) return `${inventoryActionCode(action)}-${Date.now()}`;
    const [, year, month, day, hours, minutes] = match;
    return `${inventoryActionCode(action)}-${day}${month}${year}-${hours}${minutes}`;
}

function formatInventoryDateTimeDisplay(value) {
    if (!value) return '';
    const text = String(value).trim();
    const match = text.match(/^(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2}))?$/);
    if (!match) return text;
    const [, year, month, day, hours = '00', minutes = '00'] = match;
    return `${day}-${month}-${year}, ${hours}:${minutes} IST`;
}

function formatInventoryDateTimeForInput(value) {
    if (!value) return '';
    const text = String(value).trim();
    const match = text.match(/^(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2}))?/);
    if (match) {
        const [, year, month, day, hours = '00', minutes = '00'] = match;
        return `${year}-${month}-${day}T${hours}:${minutes}`;
    }
    const legacyMatch = text.match(/^(\d{2})-(\d{2})-(\d{4}),\s*(\d{1,2}):(\d{2})/i);
    if (legacyMatch) {
        const [, day, month, year, hours, minutes] = legacyMatch;
        return `${year}-${month}-${day}T${String(hours).padStart(2, '0')}:${minutes}`;
    }
    return '';
}

function formatInventoryDateForInput(value) {
    const dt = formatInventoryDateTimeForInput(value);
    return dt ? dt.split('T')[0] : '';
}

function buildRefillLotId(row) {
    if (!row) return '';
    const size = row.lotSize === '' || row.lotSize == null ? '' : String(row.lotSize).trim();
    const dateIso = formatInventoryDateForInput(row.deliveryDate || row.manufactureDate);
    const dateTag = dateIso ? dateIso.replace(/-/g, '') : '';
    const parts = [size, dateTag].filter(Boolean);
    return parts.length ? `REF${parts.join('')}` : '';
}

function getCurrentIstTimeParts() {
    const now = new Date();
    const formatter = new Intl.DateTimeFormat('en-US', {
        timeZone: 'Asia/Kolkata',
        hour: '2-digit',
        minute: '2-digit',
        hour12: false
    });
    const parts = formatter.formatToParts(now);
    const hours = parts.find(part => part.type === 'hour')?.value || '00';
    const minutes = parts.find(part => part.type === 'minute')?.value || '00';
    return { hours, minutes };
}

function combineDateWithCurrentIstTime(dateValue) {
    if (!dateValue) return '';
    const { hours, minutes } = getCurrentIstTimeParts();
    return `${dateValue}T${hours}:${minutes}`;
}

function formatDateToIso(date) {
    if (!(date instanceof Date) || Number.isNaN(date.getTime())) return '';
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}

function getInventoryRow(type, id) {
    const rows = inventoryState[type] || [];
    if (type === 'approvals') return rows.find(r => r.requestId === id);
    return rows.find(r => r.id === id);
}

function inventoryDateTimeFocus(input, type, id, field) {
    if (!input || input.readOnly || input.disabled) return;
    const row = getInventoryRow(type, id);
    input.type = 'datetime-local';
    input.value = formatInventoryDateTimeForInput(row?.[field]);
}

function inventoryDateTimeChange(input, type, id, field) {
    const dateValue = input?.value ? String(input.value).split('T')[0] : '';
    if (!dateValue) return;
    const isoValue = combineDateWithCurrentIstTime(dateValue);
    updateInventoryFieldInline(type, id, field, isoValue);
    input.type = 'text';
    input.value = formatInventoryDateTimeDisplay(isoValue);
}

function inventoryDateTimeBlur(input, type, id, field) {
    if (!input) return;
    if (input.type === 'datetime-local' && input.value) {
        inventoryDateTimeChange(input, type, id, field);
        return;
    }
    if (input.type === 'datetime-local') {
        input.type = 'text';
    }
    const row = getInventoryRow(type, id);
    input.value = formatInventoryDateTimeDisplay(row?.[field]);
}

function isValidEmail(value) {
    if (!value) return true;
    return /^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(String(value).trim());
}

function isValidDeviceId15(value) {
    return /^\\d{15}$/.test(String(value || '').trim());
}

function validateInventoryBuiltIds() {
    let invalidFound = false;
    document.querySelectorAll('[data-built-device-id]').forEach(input => {
        const isValid = isValidDeviceId15(input.value);
        input.classList.toggle('inv-input-invalid', !isValid);
        if (!isValid) invalidFound = true;
    });
    return !invalidFound;
}

function validateInventoryBuiltInput(input) {
    if (!input) return;
    const isValid = isValidDeviceId15(input.value);
    input.classList.toggle('inv-input-invalid', !isValid);
}

function movementCode(value) {
    if (value === 'Inbound') return 'INB';
    if (value === 'Issue') return 'ISS';
    if (value === 'Sale') return 'SAL';
    return 'MOV';
}

function generatePartsRequestId(row) {
    const code = movementCode(row.movement);
    const dateValue = row.date ? formatInventoryDateTimeDisplay(row.date) : '';
    return dateValue ? `${code}-${dateValue.replace(/[^0-9]/g, '')}` : `${code}-${Date.now()}`;
}

function getInventoryPartsOptions(field, currentValue) {
    const values = new Set();
    (inventoryState.parts || []).forEach(row => {
        const value = row?.[field];
        if (value) values.add(String(value));
    });
    if (currentValue) values.add(String(currentValue));
    const sorted = Array.from(values).sort((a, b) => a.localeCompare(b));
    const blankOption = '<option value=""></option>';
    const options = sorted.map(value => {
        const selected = String(currentValue || '') === value ? 'selected' : '';
        return `<option value="${escapeHtml(value)}" ${selected}>${escapeHtml(value)}</option>`;
    }).join('');
    return `${blankOption}${options}`;
}

function getInventoryClientOptions(currentValue) {
    const values = new Set();
    (inventoryState.clients || []).forEach(row => {
        const value = row?.clientName;
        if (value) values.add(String(value));
    });
    if (currentValue) values.add(String(currentValue));
    const sorted = Array.from(values).sort((a, b) => a.localeCompare(b));
    const blankOption = '<option value=""></option>';
    const options = sorted.map(value => {
        const selected = String(currentValue || '') === value ? 'selected' : '';
        return `<option value="${escapeHtml(value)}" ${selected}>${escapeHtml(value)}</option>`;
    }).join('');
    return `${blankOption}${options}`;
}


function normalizeInventoryRow(type, row) {
    if (!row) return row;
    if (type === 'constitution') {
        return {
            ...row,
            unitsPerDevice: parseInventoryFloat(row.unitsPerDevice),
            costPerUnit: parseInventoryFloat(row.costPerUnit),
            costPerDevice: parseInventoryFloat(row.costPerDevice),
            effectiveDate: parseInventoryDateTime(row.effectiveDate)
        };
    }
    if (type === 'parts') {
        return {
            ...row,
            qty: parseInventoryFloat(row.qty),
            costPerUnit: parseInventoryFloat(row.costPerUnit),
            date: parseInventoryDateTime(row.date),
            deliveryDate: parseInventoryDateTime(row.deliveryDate)
        };
    }
    if (type === 'built') {
        return {
            ...row,
            count: parseInventoryFloat(row.count),
            mfgDate: parseInventoryDateTime(row.mfgDate),
            saleDate: parseInventoryDateTime(row.saleDate)
        };
    }
    if (type === 'liquidation') {
        const createdAt = row.requestCreatedAt || row.date || combineDateWithCurrentIstTime(formatDateToIso(new Date()));
        const normalizedCreatedAt = parseInventoryDateTime(createdAt);
        return {
            ...row,
            unitsBefore: parseInventoryFloat(row.unitsBefore),
            unitsAfter: parseInventoryFloat(row.unitsAfter),
            unitsIssued: parseInventoryFloat(row.unitsIssued),
            date: parseInventoryDateTime(row.date),
            requestCreatedAt: normalizedCreatedAt,
            requestId: formatInventoryRequestId(row.action, normalizedCreatedAt)
        };
    }
    if (type === 'approvals') {
        return {
            ...row,
            dueDate: parseInventoryDateTime(row.dueDate)
        };
    }
    if (type === 'clients') {
        return {
            ...row
        };
    }
    if (type === 'refill') {
        return {
            ...row,
            manufactureDate: parseInventoryDateTime(row.manufactureDate),
            expiryDate: parseInventoryDateTime(row.expiryDate),
            deliveryDate: parseInventoryDateTime(row.deliveryDate),
            lotSize: parseInventoryFloat(row.lotSize)
        };
    }
    return row;
}

function normalizeInventoryRows(type, rows) {
    return (rows || []).map(row => normalizeInventoryRow(type, row));
}

function importInventoryCsv(type, input) {
    if (!inventoryCsvConfig[type]) return;
    const file = input?.files?.[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = () => {
        const rows = parseInventoryCsv(String(reader.result || ''));
        if (!rows.length) {
            alert('CSV appears to be empty.');
            return;
        }

        const config = inventoryCsvConfig[type];
        const normalizedFields = config.fields.map(field => normalizeInventoryHeader(field));
        const header = rows[0].map(cell => normalizeInventoryHeader(cell));
        const hasHeader = header.some(cell => normalizedFields.includes(cell));
        const startIndex = hasHeader ? 1 : 0;
        const fieldIndexes = config.fields.map((field, index) => {
            if (!hasHeader) return index;
            const normalizedField = normalizeInventoryHeader(field);
            const aliases = config.headerAliases?.[field] || [];
            const headerIndex = header.findIndex(cell => cell === normalizedField || aliases.includes(cell));
            return headerIndex >= 0 ? headerIndex : -1;
        });

        const today = new Date().toISOString().slice(0, 10);
        rows.slice(startIndex).forEach(row => {
            if (!row || row.every(value => String(value).trim() === '')) return;
            const entry = { id: `inv-${Date.now()}-${Math.floor(Math.random() * 10000)}` };
            Object.assign(entry, config.defaults);

            config.fields.forEach((field, idx) => {
                const colIndex = fieldIndexes[idx];
                if (colIndex < 0) return;
                const rawValue = row[colIndex] ?? '';
                const value = String(rawValue).trim();
                if (!value) return;
                if (field === 'unitsPerDevice' || field === 'costPerUnit' || field === 'qty') {
                    const numeric = Number(value);
                    if (Number.isFinite(numeric)) entry[field] = numeric;
                    return;
                }
                if (field === 'confirmed') {
                    entry.confirmed = ['true', 'yes', '1'].includes(value.toLowerCase());
                    return;
                }
                if (field === 'movement') {
                    entry.movement = ['Inbound', 'Issue', 'Sale'].includes(value) ? value : 'Inbound';
                    return;
                }
                if (field === 'effectiveDate') {
                    entry[field] = parseInventoryDateTime(value || today);
                    return;
                }
                if (field === 'date' || field === 'deliveryDate') {
                    entry[field] = parseInventoryDateTime(value || today);
                    return;
                }
                entry[field] = value;
            });

            if (type === 'constitution' && !entry.effectiveDate) entry.effectiveDate = combineDateWithCurrentIstTime(today);
            if (type === 'parts' && !entry.date) entry.date = parseInventoryDateTime(today);

            const normalized = normalizeInventoryRow(type, entry);
            if (type === 'parts' && !normalized.requestId) {
                normalized.requestId = generatePartsRequestId(normalized);
            }
            inventoryState[type].push(normalized);
        });

        setInventoryDirty(true);
        renderInventoryAll();
    };
    reader.readAsText(file);
}

function initInventoryModule() {
    if (inventoryState.initialized) {
        renderInventoryAll();
        return;
    }
    inventoryState.initialized = true;
    initInventoryTableAutoResize();
    inventoryTab('stock');
    inventorySubtab('stock', 'parts');
    inventoryLiquidationSubtab('requests');
    loadInventoryData();
}

function inventoryTab(tabId, e) {
    document.querySelectorAll('#mod-inventory .tab-content').forEach(el => {
        el.classList.remove('active');
        el.style.cssText = 'display: none !important';
    });
    document.querySelectorAll('#mod-inventory .inventory-tabs .tab-btn').forEach(el => el.classList.remove('active'));
    const content = document.getElementById(`inv-tab-${tabId}`);
    if (content) {
        content.classList.add('active');
        content.style.cssText = 'display: block !important';
    }
    if (e && e.currentTarget) e.currentTarget.classList.add('active');
    if (tabId === 'approvals') refreshInventoryApprovals();
    if (tabId === 'liquidation') inventoryLiquidationSubtab('requests');
    if (tabId === 'prod-batch' && typeof dbRenderMaster === 'function') dbRenderMaster('prod');
}

function refreshInventoryData() {
    if (!inventoryState.initialized) {
        initInventoryModule();
        return;
    }
    loadInventoryData();
}

function inventorySubtab(group, sub, e) {
    if (group !== 'stock') return;
    const partsPanel = document.getElementById('inv-stock-parts');
    const builtPanel = document.getElementById('inv-stock-built');
    if (partsPanel) partsPanel.style.display = sub === 'parts' ? '' : 'none';
    if (builtPanel) builtPanel.style.display = sub === 'built' ? '' : 'none';
    const toggle = document.getElementById('inv-stock-toggle');
    if (toggle) toggle.checked = sub === 'built';
    document.querySelectorAll('#mod-inventory .inventory-subtabs [data-inv-subtab]').forEach(label => {
        label.classList.toggle('active', label.dataset.invSubtab === sub);
    });
}

function inventoryLiquidationSubtab(sub, e) {
    const requestsPanel = document.getElementById('inv-liquidation-requests');
    const clientsPanel = document.getElementById('inv-liquidation-clients');
    if (requestsPanel) requestsPanel.style.display = sub === 'requests' ? '' : 'none';
    if (clientsPanel) clientsPanel.style.display = sub === 'clients' ? '' : 'none';
    const toggle = document.getElementById('inv-liquidation-toggle');
    if (toggle) toggle.checked = sub === 'clients';
    document.querySelectorAll('#mod-inventory .inventory-liquidation-tabs [data-inv-subtab]').forEach(label => {
        label.classList.toggle('active', label.dataset.invSubtab === sub);
    });
}

function resetInventoryDemo() {
    if (!confirm('Reset Inventory Manager demo data?')) return;
    inventoryState.constitution = [];
    inventoryState.parts = [];
    inventoryState.built = [];
    inventoryState.liquidation = [];
    inventoryState.clients = [];
    inventoryState.approvals = [];
    inventoryState.refill = [];
    inventoryState.stock = {};
    setInventoryDirty(true);
    renderInventoryAll();
}

function renderInventoryAll() {
    renderInventoryConstitution();
    renderInventoryParts();
    renderInventoryBuilt();
    renderInventoryLiquidation();
    renderInventoryClients();
    renderInventoryRefillBatch();
    refreshInventoryApprovals();
}

function setInventoryDirty(isDirty) {
    inventoryState.dirty = isDirty;
    const status = document.getElementById('inventory-save-status');
    if (!status) return;
    status.textContent = isDirty ? 'Unsaved changes' : 'All changes saved';
}

const inventoryTextMeasureCanvas = document.createElement('canvas');
const inventoryTextMeasureContext = inventoryTextMeasureCanvas.getContext('2d');

function getTextWidth(text, font) {
    if (!inventoryTextMeasureContext) return 0;
    inventoryTextMeasureContext.font = font || '14px Arial';
    return inventoryTextMeasureContext.measureText(text || '').width;
}

function getInventoryCellContent(cell) {
    if (!cell) return '';
    const input = cell.querySelector('input, select, textarea');
    if (input) {
        if (input.tagName === 'SELECT') {
            return input.options[input.selectedIndex]?.text || '';
        }
        if (input.type === 'checkbox' || input.type === 'file') {
            return '';
        }
        return input.value || input.placeholder || '';
    }
    return (cell.textContent || '').trim();
}

function getInventoryCellFont(cell) {
    if (!cell) return '14px Arial';
    const target = cell.querySelector('input, select, textarea') || cell;
    const style = window.getComputedStyle(target);
    return `${style.fontWeight} ${style.fontSize} ${style.fontFamily}`;
}

function adjustInventoryTableWidths(tableId) {
    const table = document.getElementById(tableId);
    if (!table) return;
    const headerCells = Array.from(table.querySelectorAll('thead th'));
    if (!headerCells.length) return;
    const columnCount = headerCells.length;
    const widths = new Array(columnCount).fill(0);

    headerCells.forEach((cell, index) => {
        widths[index] = getTextWidth((cell.textContent || '').trim(), getInventoryCellFont(cell)) + 32;
    });

    const rows = Array.from(table.querySelectorAll('tbody tr'));
    rows.forEach(row => {
        const cells = Array.from(row.children);
        cells.forEach((cell, index) => {
            if (index >= columnCount) return;
            const content = getInventoryCellContent(cell);
            const font = getInventoryCellFont(cell);
            const width = getTextWidth(content, font) + 32;
            widths[index] = Math.max(widths[index], width);
        });
    });

    let colgroup = table.querySelector('colgroup');
    if (!colgroup) {
        colgroup = document.createElement('colgroup');
        table.prepend(colgroup);
    }
    if (colgroup.children.length !== columnCount) {
        colgroup.innerHTML = '';
        for (let i = 0; i < columnCount; i += 1) {
            colgroup.appendChild(document.createElement('col'));
        }
    }

    widths.forEach((width, index) => {
        const col = colgroup.children[index];
        if (col) {
            col.style.width = `${Math.max(width, 90)}px`;
        }
    });
}

let inventoryResizeListenersReady = false;

function initInventoryTableAutoResize() {
    if (inventoryResizeListenersReady) return;
    inventoryResizeListenersReady = true;
    Object.values(inventoryTableIds).forEach(tableId => {
        const table = document.getElementById(tableId);
        if (!table) return;
        table.addEventListener('focusout', event => {
            if (event.target && event.target.matches('input, select, textarea')) {
                requestAnimationFrame(() => adjustInventoryTableWidths(tableId));
            }
        });
        table.addEventListener('change', event => {
            if (event.target && event.target.matches('select')) {
                requestAnimationFrame(() => adjustInventoryTableWidths(tableId));
            }
        });
    });
}

let globalRowHeightSyncReady = false;

function syncGlobalTableRowHeight() {
    const sampleRow =
        document.querySelector('#tbl-rgb-metrics tbody tr') ||
        document.querySelector('#tbl-qaqc-metrics tbody tr') ||
        document.querySelector('.selectable-table tbody tr');
    if (!sampleRow) return;
    const height = Math.round(sampleRow.getBoundingClientRect().height || 0);
    if (height > 0) {
        document.documentElement.style.setProperty('--table-row-height', `${height}px`);
    }
}

function initGlobalRowHeightSync() {
    if (globalRowHeightSyncReady) return;
    globalRowHeightSyncReady = true;

    const observer = new MutationObserver(() => {
        requestAnimationFrame(syncGlobalTableRowHeight);
    });

    const watchTargets = [
        document.querySelector('#tbl-rgb-metrics tbody'),
        document.querySelector('#tbl-qaqc-metrics tbody')
    ].filter(Boolean);

    watchTargets.forEach(target => {
        observer.observe(target, { childList: true, subtree: true });
    });

    window.addEventListener('resize', () => requestAnimationFrame(syncGlobalTableRowHeight));
    requestAnimationFrame(syncGlobalTableRowHeight);
}

function toggleTabInfo(button, moduleId) {
  const nav = button?.closest('.tab-nav');
  if (!nav) return;
  const panel = nav.querySelector('.tab-info-panel');
  const content = nav.querySelector('.tab-info-content');
  if (!panel || !content) return;

  const moduleText = {
    db: 'Manage master data like success criteria, STV logic, and QC/Prod batch lists used by the Insoil system.',
    devices: 'Register installed devices and service activity, and view device details used across the Insoil system.',
    fertilizer: 'Build nutrient recommendations from soil tests and export fertilizer plans for the Insoil system.',
    inventory: 'Track parts, built units, liquidations, and approvals that drive inventory updates in the Insoil system.'
  };

  const text = moduleText[moduleId] || 'This module supports the Insoil system workflow.';

  document.querySelectorAll('.tab-info-panel.active').forEach(active => {
    if (active !== panel) active.classList.remove('active');
  });

  if (panel.classList.contains('active')) {
    panel.classList.remove('active');
    return;
  }

  content.textContent = text;
  panel.classList.add('active');
}

function closeTabInfo(button) {
  const panel = button?.closest('.tab-info-panel');
  if (panel) panel.classList.remove('active');
}

function addInventoryRow(type) {
    const today = new Date().toISOString().slice(0, 10);
    const nowDateTime = combineDateWithCurrentIstTime(today);
    const id = `inv-${Date.now()}-${Math.floor(Math.random() * 10000)}`;
    if (type === 'constitution') {
        inventoryState.constitution.push({
            id, category: '', itemClass: '', item: '', unit: 'unit', unitsPerDevice: 1,
            costPerUnit: 0, version: 'v1', effectiveDate: nowDateTime
        });
    } else if (type === 'parts') {
        inventoryState.parts.push({
            id, category: '', itemClass: '', item: '', unit: 'unit', qty: 0,
            costPerUnit: 0, movement: 'Inbound', date: nowDateTime,
            deliveryDate: '', poNumber: '', confirmedBy: '', issuedTo: '', requestId: ''
        });
    } else if (type === 'built') {
        inventoryState.built.push({
            id, serial: '', deviceId: '', count: 1, mfgDate: nowDateTime,
            saleDate: '', soldTo: '', movement: 'Inbound', confirmed: false, requestId: ''
        });
    } else if (type === 'liquidation') {
        const requestCreatedAt = nowDateTime;
        const requestId = formatInventoryRequestId('Issue', requestCreatedAt);
        inventoryState.liquidation.push({
            id, requestId, requestCreatedAt, item: '', action: 'Issue', issuedTo: '', unitsBefore: 0,
            unitsAfter: 0, unitsIssued: 0, date: nowDateTime, acknowledged: false,
            evidence: '', status: 'Pending', applied: false
        });
        ensureInventoryApproval(requestId, 'Inventory');
    } else if (type === 'clients') {
        inventoryState.clients.push({
            id, clientType: 'Manufacturer', clientName: '', clientAddress: '',
            clientContact: '', clientEmail: '', item: '', gstin: ''
        });
    } else if (type === 'refill') {
        inventoryState.refill.push({
            id, refillId: '', lotSize: '', refillLotId: '', manufacturerName: '',
            manufactureDate: '', expiryDate: '', deliveryDate: '', poNumber: '', notes: ''
        });
    }
    setInventoryDirty(true);
    renderInventoryAll();
}

function deleteInventoryRows(type) {
    if (!isInventoryAdmin()) {
        alert('Admin login required to delete rows.');
        return;
    }
    const rows = inventoryState[type] || [];
    let selectedIds = new Set(rows.filter(r => r._selected).map(r => r.id));
    if (!selectedIds.size) {
        const table = document.querySelector(`#inv-${type}-table`);
        const checks = table ? Array.from(table.querySelectorAll('tbody input[type="checkbox"][data-row-id]:checked')) : [];
        selectedIds = new Set(checks.map(c => c.dataset.rowId));
    }
    if (!selectedIds.size) {
        alert('Select at least one row to delete.');
        return;
    }
    inventoryState[type] = rows.filter(r => !selectedIds.has(r.id));
    setInventoryDirty(true);
    renderInventoryAll();
}

function toggleInventorySelectAll(type, source) {
    const rows = inventoryState[type] || [];
    rows.forEach(r => { r._selected = !!source.checked; });
    renderInventoryAll();
}

function updateInventoryField(type, id, field, value) {
    const rows = inventoryState[type] || [];
    const row = rows.find(r => r.id === id) || (type === 'approvals' ? rows.find(r => r.requestId === id) : null);
    if (!row) return;
    row[field] = value;
    if (field === 'movement' && (value === 'Issue' || value === 'Sale')) {
        const confirmed = confirm(`Confirm ${value.toLowerCase()} request for this row?`);
        if (!confirmed) {
            row.movement = 'Inbound';
            row.confirmedBy = '';
        } else {
            const issuedTo = prompt('Issued/Sold to (name/team):', row.soldTo || row.issuedTo || '') || '';
            if (type === 'built') row.soldTo = issuedTo;
            if (type === 'parts') row.issuedTo = issuedTo;
            const item = type === 'built' ? (row.deviceId || row.serial || 'Built Device') : (row.item || 'Part');
            const qty = Number(row.count || row.qty || 0) || 0;
            ensureInventoryRequest(row, item, qty, issuedTo, value);
        }
    }
    if (type === 'liquidation' && field === 'action') {
        const createdAt = row.requestCreatedAt || row.date || combineDateWithCurrentIstTime(formatDateToIso(new Date()));
        row.requestCreatedAt = parseInventoryDateTime(createdAt);
        const previousId = row.requestId;
        row.requestId = formatInventoryRequestId(value, row.requestCreatedAt);
        if (previousId && previousId !== row.requestId) {
            const approval = inventoryState.approvals.find(a => a.requestId === previousId);
            if (approval) approval.requestId = row.requestId;
        }
    }
    if (type === 'parts' && field === 'movement') {
        row.requestId = generatePartsRequestId(row);
    }
    if (type === 'approvals' && field === 'tatDays') {
        const tat = Number(value || 0);
        const due = new Date();
        due.setDate(due.getDate() + (Number.isFinite(tat) ? tat : 0));
        const dueDate = formatDateToIso(due);
        row.dueDate = combineDateWithCurrentIstTime(dueDate);
    }
    setInventoryDirty(true);
    renderInventoryAll();
}

function updateInventoryCheckbox(type, id, field, checked) {
    updateInventoryField(type, id, field, !!checked);
}

function updateInventoryFieldInline(type, id, field, value) {
    const rows = inventoryState[type] || [];
    const row = rows.find(r => r.id === id) || (type === 'approvals' ? rows.find(r => r.requestId === id) : null);
    if (!row) return;
    if (type === 'parts' && (field === 'confirmedBy' || field === 'issuedTo') && !isValidEmail(value)) {
        alert('Please enter a valid email address.');
        return;
    }
    if (type === 'clients' && field === 'clientType') {
        if (value === 'In-house deptt') {
            row.gstin = '';
        }
        renderInventoryClients();
    }
    if (type === 'parts' && field === 'deliveryDate') {
        row[field] = parseInventoryDateTime(value);
    } else if (type === 'refill' && (field === 'manufactureDate' || field === 'expiryDate' || field === 'deliveryDate')) {
        row[field] = parseInventoryDateTime(value);
    } else if (type === 'refill' && field === 'lotSize') {
        row[field] = parseInventoryFloat(value);
    } else {
        row[field] = value;
    }

    if (type === 'approvals' && field === 'tatDays') {
        const tat = Number(value || 0);
        const due = new Date();
        due.setDate(due.getDate() + (Number.isFinite(tat) ? tat : 0));
        const dueDate = formatDateToIso(due);
        row.dueDate = combineDateWithCurrentIstTime(dueDate);
        const dueEl = document.querySelector(`[data-approval-due="${row.requestId}"]`);
        if (dueEl) dueEl.value = formatInventoryDateTimeDisplay(row.dueDate);
    }

    if (type === 'constitution' && (field === 'unitsPerDevice' || field === 'costPerUnit')) {
        updateInventoryConstitutionRow(row.id);
    } else if (type === 'constitution' && field === 'item') {
        updateInventoryConstitutionRow(row.id);
    } else if (type === 'parts' && (field === 'movement' || field === 'date')) {
        row.requestId = generatePartsRequestId(row);
    } else if (type === 'liquidation' && field === 'unitsIssued') {
        const afterEl = document.querySelector(`[data-liquidation-after="${row.id}"]`);
        if (afterEl) {
            const issued = Number(row.unitsIssued || 0);
            const before = Number(row.unitsBefore || 0);
            row.unitsAfter = row.status === 'Approved' && row.acknowledged ? before - issued : before;
            afterEl.textContent = Number(row.unitsAfter || 0);
        }
    }
    if (type === 'refill' && (field === 'lotSize' || field === 'deliveryDate')) {
        row.refillLotId = buildRefillLotId(row);
    }

    setInventoryDirty(true);
}

function updateInventoryConstitutionRow(rowId) {
    const row = inventoryState.constitution.find(r => r.id === rowId);
    if (!row) return;
    const cost = (Number(row.unitsPerDevice) || 0) * (Number(row.costPerUnit) || 0);
    row.costPerDevice = Number.isFinite(cost) ? cost : '';
    const cell = document.querySelector(`[data-constitution-cost="${rowId}"]`);
    if (cell) cell.textContent = `₹${cost.toFixed(2)}`;
    updateInventoryConstitutionTotal();
}

function updateInventoryConstitutionTotal() {
    const total = inventoryState.constitution.reduce((sum, row) => {
        return sum + ((Number(row.unitsPerDevice) || 0) * (Number(row.costPerUnit) || 0));
    }, 0);
    const totalEl = document.getElementById('inv-constitution-total');
    if (totalEl) totalEl.textContent = total.toFixed(2);
    applyInventoryEditState('constitution');
    requestAnimationFrame(() => adjustInventoryTableWidths('inv-constitution-table'));
}

function loadInventoryData() {
    if (typeof google === 'undefined' || !google.script?.run) {
        renderInventoryAll();
        return;
    }
    google.script.run
        .withSuccessHandler((res) => {
            inventoryState.constitution = normalizeInventoryRows('constitution', res?.constitution || []);
            inventoryState.parts = normalizeInventoryRows('parts', res?.parts || []);
            inventoryState.built = normalizeInventoryRows('built', res?.built || []);
            const liquidationRaw = res?.liquidation || [];
            const liquidationMap = new Map();
            const normalizedLiquidation = liquidationRaw.map(row => {
                const createdAt = row.requestCreatedAt || row.date || combineDateWithCurrentIstTime(formatDateToIso(new Date()));
                const newRequestId = formatInventoryRequestId(row.action, createdAt);
                if (row.requestId && row.requestId !== newRequestId) {
                    liquidationMap.set(row.requestId, newRequestId);
                }
                return normalizeInventoryRow('liquidation', {
                    ...row,
                    requestCreatedAt: createdAt,
                    requestId: newRequestId
                });
            });
            inventoryState.liquidation = normalizedLiquidation;
            inventoryState.clients = normalizeInventoryRows('clients', res?.clients || []);
            inventoryState.approvals = normalizeInventoryRows('approvals', res?.approvals || []).map(row => {
                const updated = { ...row };
                if (liquidationMap.has(updated.requestId)) {
                    updated.requestId = liquidationMap.get(updated.requestId);
                }
                return updated;
            });
            inventoryState.refill = normalizeInventoryRows('refill', res?.refill || []);
            setInventoryDirty(false);
            renderInventoryAll();
        })
        .withFailureHandler((err) => {
            console.error(err);
            alert('Failed to load inventory data: ' + (err?.message || err));
            renderInventoryAll();
        })
        .getInventoryData();
}

function validateInventoryTable(type) {
    if (type === 'parts') {
        const invalidEmailRow = inventoryState.parts.find(row => !isValidEmail(row.confirmedBy) || !isValidEmail(row.issuedTo));
        if (invalidEmailRow) {
            return { valid: false, title: 'Parts Stock', message: 'Please enter valid email IDs for Confirmed by and Issued to.' };
        }
    }
    if (type === 'built') {
        if (!validateInventoryBuiltIds()) {
            return { valid: false, title: 'Built Units', message: 'Device ID must be exactly 15 digits.' };
        }
    }
    if (type === 'clients') {
        const invalidClientEmail = inventoryState.clients.find(row => !isValidEmail(row.clientEmail));
        if (invalidClientEmail) {
            return { valid: false, title: 'Clients', message: 'Please enter valid client email IDs.' };
        }
        const invalidClientContact = inventoryState.clients.find(row => {
            if (!row.clientContact) return false;
            const core = String(row.clientContact).replace(/^\\+/, '');
            return core.length > 10;
        });
        if (invalidClientContact) {
            return { valid: false, title: 'Clients', message: 'Client contact cannot exceed 10 characters (excluding +).' };
        }
        const invalidGstin = inventoryState.clients.find(row => row.clientType !== 'In-house deptt' && row.gstin && !/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z][0-9][A-Z0-9]$/.test(String(row.gstin).trim().toUpperCase()));
        if (invalidGstin) {
            return { valid: false, title: 'Clients', message: 'Please enter a valid GSTIN for Manufacturer or Customer clients.' };
        }
    }
    return { valid: true };
}

function saveInventoryTable(type) {
    const result = validateInventoryTable(type);
    if (!result.valid) {
        alert(`${result.title}: ${result.message}`);
        return;
    }
    saveInventoryData(type);
}

function saveInventoryData(type) {
    if (typeof google === 'undefined' || !google.script?.run) {
        alert('Inventory save is only available in the Apps Script deployment.');
        return;
    }
    const tablesToValidate = type ? [type] : ['constitution', 'parts', 'built', 'liquidation', 'clients', 'approvals', 'refill'];
    for (const tableType of tablesToValidate) {
        const result = validateInventoryTable(tableType);
        if (!result.valid) {
            alert(`${result.title}: ${result.message}`);
            return;
        }
    }
    const constitutionPayload = inventoryState.constitution.map(row => {
        const costPerDevice = (Number(row.unitsPerDevice) || 0) * (Number(row.costPerUnit) || 0);
        return {
            ...row,
            costPerDevice: Number.isFinite(costPerDevice) ? costPerDevice : row.costPerDevice
        };
    });
    const partsPayload = inventoryState.parts.map(row => ({
        ...row,
        requestId: row.requestId || generatePartsRequestId(row)
    }));
    const payload = {
        constitution: constitutionPayload,
        parts: partsPayload,
        built: inventoryState.built,
        liquidation: inventoryState.liquidation,
        clients: inventoryState.clients,
        approvals: inventoryState.approvals,
        refill: inventoryState.refill
    };
    google.script.run
        .withSuccessHandler((res) => {
            setInventoryDirty(false);
            alert(res?.msg || 'Inventory saved.');
        })
        .withFailureHandler((err) => {
            console.error(err);
            alert('Failed to save inventory data: ' + (err?.message || err));
        })
        .saveInventoryData(payload);
}

function ensureInventoryRequest(row, item, qty, issuedTo, action) {
    if (!row.requestCreatedAt) row.requestCreatedAt = combineDateWithCurrentIstTime(formatDateToIso(new Date()));
    row.requestId = formatInventoryRequestId(action, row.requestCreatedAt);
    const existing = inventoryState.liquidation.find(l => l.requestId === row.requestId);
    if (!existing) {
        inventoryState.liquidation.push({
            id: `liq-${Date.now()}-${Math.floor(Math.random() * 10000)}`,
            requestId: row.requestId,
            requestCreatedAt: row.requestCreatedAt,
            item,
            action,
            issuedTo,
            unitsBefore: 0,
            unitsAfter: 0,
            unitsIssued: qty,
            date: combineDateWithCurrentIstTime(formatDateToIso(new Date())),
            acknowledged: false,
            evidence: '',
            status: 'Pending',
            applied: false
        });
    }
    ensureInventoryApproval(row.requestId, item);
}

function ensureInventoryApproval(requestId, itemLabel) {
    const existing = inventoryState.approvals.find(a => a.requestId === requestId);
    if (existing) return;
    const tatDays = 3;
    const due = new Date();
    due.setDate(due.getDate() + tatDays);
    inventoryState.approvals.push({
        requestId,
        requestedBy: inventoryRequestedBy(),
        tatDays,
        dueDate: combineDateWithCurrentIstTime(formatDateToIso(due)),
        status: 'Pending',
        approver: '',
        item: itemLabel
    });
}

function inventoryRequestedBy() {
    return (currentUser && (currentUser.user || currentUser.empId || currentUser.email))
        ? (currentUser.user || currentUser.empId || currentUser.email)
        : 'Operator';
}

function generateInventoryRequestId(action, createdAt) {
    return formatInventoryRequestId(action, createdAt);
}

function isInventoryAdmin() {
    return String(currentUserRole || '').toLowerCase() === 'admin';
}

function renderInventoryConstitution() {
    const tbody = document.getElementById('inv-constitution-body');
    if (!tbody) return;
    tbody.innerHTML = '';
    let total = 0;
    inventoryState.constitution.forEach(row => {
        const costPerDevice = (Number(row.unitsPerDevice) || 0) * (Number(row.costPerUnit) || 0);
        row.costPerDevice = Number.isFinite(costPerDevice) ? costPerDevice : '';
        total += costPerDevice;
        const categoryOptions = getInventoryPartsOptions('category', row.category);
        const itemClassOptions = getInventoryPartsOptions('itemClass', row.itemClass);
        const itemOptions = getInventoryPartsOptions('item', row.item);
        const unitOptions = getInventoryPartsOptions('unit', row.unit);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" data-row-id="${row.id}" data-inv-type="constitution" ${row._selected ? 'checked' : ''} onchange="updateInventoryCheckbox('constitution','${row.id}','_selected',this.checked)"></td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('constitution','${row.id}','category',this.value)">
              ${categoryOptions}
            </select>
          </td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('constitution','${row.id}','itemClass',this.value)">
              ${itemClassOptions}
            </select>
          </td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('constitution','${row.id}','item',this.value)">
              ${itemOptions}
            </select>
          </td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('constitution','${row.id}','unit',this.value)">
              ${unitOptions}
            </select>
          </td>
          <td><input type="number" class="db-input" value="${row.unitsPerDevice ?? ''}" oninput="updateInventoryFieldInline('constitution','${row.id}','unitsPerDevice',this.value)"></td>
          <td><input type="number" class="db-input" value="${row.costPerUnit ?? ''}" oninput="updateInventoryFieldInline('constitution','${row.id}','costPerUnit',this.value)"></td>
          <td><input class="db-input" value="${row.version || ''}" oninput="updateInventoryFieldInline('constitution','${row.id}','version',this.value)"></td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.effectiveDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'constitution', '${row.id}', 'effectiveDate')"
              onchange="inventoryDateTimeChange(this, 'constitution', '${row.id}', 'effectiveDate')"
              onblur="inventoryDateTimeBlur(this, 'constitution', '${row.id}', 'effectiveDate')">
          </td>
          <td data-constitution-cost="${row.id}">₹${costPerDevice.toFixed(2)}</td>
        `;
        tbody.appendChild(tr);
    });
    const totalEl = document.getElementById('inv-constitution-total');
    if (totalEl) totalEl.textContent = total.toFixed(2);
    applyInventoryEditState('constitution');
}

function renderInventoryParts() {
    const tbody = document.getElementById('inv-parts-body');
    if (!tbody) return;
    tbody.innerHTML = '';
    inventoryState.parts.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" data-row-id="${row.id}" data-inv-type="parts" ${row._selected ? 'checked' : ''} onchange="updateInventoryCheckbox('parts','${row.id}','_selected',this.checked)"></td>
          <td><input class="db-input" value="${row.category || ''}" oninput="updateInventoryFieldInline('parts','${row.id}','category',this.value)"></td>
          <td><input class="db-input" value="${row.itemClass || ''}" oninput="updateInventoryFieldInline('parts','${row.id}','itemClass',this.value)"></td>
          <td><input class="db-input" value="${row.item || ''}" oninput="updateInventoryFieldInline('parts','${row.id}','item',this.value)"></td>
          <td><input class="db-input" value="${row.unit || ''}" oninput="updateInventoryFieldInline('parts','${row.id}','unit',this.value)"></td>
          <td><input type="number" class="db-input" value="${row.qty ?? ''}" oninput="updateInventoryFieldInline('parts','${row.id}','qty',this.value)"></td>
          <td><input type="number" class="db-input" value="${row.costPerUnit ?? ''}" oninput="updateInventoryFieldInline('parts','${row.id}','costPerUnit',this.value)"></td>
          <td>
            <select class="db-input" onchange="updateInventoryField('parts','${row.id}','movement',this.value)">
              <option value="Inbound" ${row.movement === 'Inbound' ? 'selected' : ''}>Inbound</option>
              <option value="Issue" ${row.movement === 'Issue' ? 'selected' : ''}>Issue</option>
              <option value="Sale" ${row.movement === 'Sale' ? 'selected' : ''}>Sale</option>
            </select>
          </td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.date) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'parts', '${row.id}', 'date')"
              onchange="inventoryDateTimeChange(this, 'parts', '${row.id}', 'date')"
              onblur="inventoryDateTimeBlur(this, 'parts', '${row.id}', 'date')">
          </td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.deliveryDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'parts', '${row.id}', 'deliveryDate')"
              onchange="inventoryDateTimeChange(this, 'parts', '${row.id}', 'deliveryDate')"
              onblur="inventoryDateTimeBlur(this, 'parts', '${row.id}', 'deliveryDate')">
          </td>
          <td><input class="db-input" value="${row.poNumber || ''}" oninput="updateInventoryFieldInline('parts','${row.id}','poNumber',this.value)"></td>
          <td><input class="db-input" value="${row.confirmedBy || ''}" oninput="updateInventoryFieldInline('parts','${row.id}','confirmedBy',this.value)"></td>
          <td><input class="db-input" value="${row.issuedTo || ''}" oninput="updateInventoryFieldInline('parts','${row.id}','issuedTo',this.value)"></td>
          <td>${row.requestId || '-'}</td>
        `;
        tbody.appendChild(tr);
    });
    applyInventoryEditState('parts');
    requestAnimationFrame(() => adjustInventoryTableWidths('inv-parts-table'));
}

function renderInventoryBuilt() {
    const tbody = document.getElementById('inv-built-body');
    if (!tbody) return;
    tbody.innerHTML = '';
    inventoryState.built.forEach(row => {
        const clientOptions = getInventoryClientOptions(row.soldTo);
        const invalidDeviceId = row.deviceId && !isValidDeviceId15(row.deviceId);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" data-row-id="${row.id}" data-inv-type="built" ${row._selected ? 'checked' : ''} onchange="updateInventoryCheckbox('built','${row.id}','_selected',this.checked)"></td>
          <td><input class="db-input" value="${row.serial || ''}" oninput="updateInventoryFieldInline('built','${row.id}','serial',this.value)"></td>
          <td><input class="db-input ${invalidDeviceId ? 'inv-input-invalid' : ''}" maxlength="15" inputmode="numeric" data-built-device-id value="${row.deviceId || ''}" oninput="updateInventoryFieldInline('built','${row.id}','deviceId',this.value); validateInventoryBuiltInput(this)"></td>
          <td><input type="number" class="db-input" value="${row.count ?? ''}" oninput="updateInventoryFieldInline('built','${row.id}','count',this.value)"></td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.mfgDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'built', '${row.id}', 'mfgDate')"
              onchange="inventoryDateTimeChange(this, 'built', '${row.id}', 'mfgDate')"
              onblur="inventoryDateTimeBlur(this, 'built', '${row.id}', 'mfgDate')">
          </td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.saleDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'built', '${row.id}', 'saleDate')"
              onchange="inventoryDateTimeChange(this, 'built', '${row.id}', 'saleDate')"
              onblur="inventoryDateTimeBlur(this, 'built', '${row.id}', 'saleDate')">
          </td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('built','${row.id}','soldTo',this.value)">
              ${clientOptions}
            </select>
          </td>
          <td>
            <select class="db-input" onchange="updateInventoryField('built','${row.id}','movement',this.value)">
              <option value="Inbound" ${row.movement === 'Inbound' ? 'selected' : ''}>Inbound</option>
              <option value="Issue" ${row.movement === 'Issue' ? 'selected' : ''}>Issue</option>
              <option value="Sale" ${row.movement === 'Sale' ? 'selected' : ''}>Sale</option>
            </select>
          </td>
          <td><input type="checkbox" ${row.confirmed ? 'checked' : ''} onchange="updateInventoryCheckbox('built','${row.id}','confirmed',this.checked)"></td>
          <td>${row.requestId || '-'}</td>
        `;
        tbody.appendChild(tr);
    });
    applyInventoryEditState('built');
    requestAnimationFrame(() => adjustInventoryTableWidths('inv-built-table'));
}

function computeInventoryStock() {
    const stock = {};
    const addStock = (item, qty) => {
        if (!item) return;
        stock[item] = (stock[item] || 0) + qty;
    };

    inventoryState.parts.forEach(row => {
        if (row.movement === 'Inbound') {
            addStock(row.item, Number(row.qty || 0));
        }
    });

    inventoryState.built.forEach(row => {
        if (row.movement === 'Inbound') {
            const deviceKey = row.deviceId || row.serial || 'Built Device';
            addStock(deviceKey, Number(row.count || 0));
            inventoryState.constitution.forEach(bom => {
                const item = bom.item || '';
                const perDevice = Number(bom.unitsPerDevice || 0);
                if (item && perDevice) {
                    addStock(item, -perDevice * Number(row.count || 0));
                }
            });
        }
    });

    inventoryState.liquidation.forEach(row => {
        const before = stock[row.item] || 0;
        row.unitsBefore = before;
        if (row.status === 'Approved' && row.acknowledged) {
            const issued = Number(row.unitsIssued || 0);
            row.unitsAfter = before - issued;
            stock[row.item] = row.unitsAfter;
        } else {
            row.unitsAfter = before;
        }
    });

    inventoryState.stock = stock;
}

function renderInventoryLiquidation() {
    computeInventoryStock();
    const tbody = document.getElementById('inv-liquidation-body');
    if (!tbody) return;
    tbody.innerHTML = '';
    inventoryState.liquidation.forEach(row => {
        const statusClass = row.status ? row.status.toLowerCase() : 'pending';
        const itemOptions = getInventoryPartsOptions('item', row.item);
        const clientOptions = getInventoryClientOptions(row.issuedTo);
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" data-row-id="${row.id}" data-inv-type="liquidation" ${row._selected ? 'checked' : ''} onchange="updateInventoryCheckbox('liquidation','${row.id}','_selected',this.checked)"></td>
          <td>${row.requestId || '-'}</td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('liquidation','${row.id}','item',this.value)">
              ${itemOptions}
            </select>
          </td>
          <td>
            <select class="db-input" onchange="updateInventoryField('liquidation','${row.id}','action',this.value)">
              <option value="Issue" ${row.action === 'Issue' ? 'selected' : ''}>Issue</option>
              <option value="Sale" ${row.action === 'Sale' ? 'selected' : ''}>Sale</option>
              <option value="Transfer" ${row.action === 'Transfer' ? 'selected' : ''}>Transfer</option>
            </select>
          </td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('liquidation','${row.id}','issuedTo',this.value)">
              ${clientOptions}
            </select>
          </td>
          <td>${Number(row.unitsBefore || 0)}</td>
          <td data-liquidation-after="${row.id}">${Number(row.unitsAfter || 0)}</td>
          <td><input type="number" class="db-input" value="${row.unitsIssued ?? ''}" oninput="updateInventoryFieldInline('liquidation','${row.id}','unitsIssued',this.value)"></td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.date) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'liquidation', '${row.id}', 'date')"
              onchange="inventoryDateTimeChange(this, 'liquidation', '${row.id}', 'date')"
              onblur="inventoryDateTimeBlur(this, 'liquidation', '${row.id}', 'date')">
          </td>
          <td><input type="checkbox" ${row.acknowledged ? 'checked' : ''} onchange="toggleInventoryAcknowledged('${row.id}', this.checked)"></td>
          <td><input type="file" class="db-input" accept="application/pdf"></td>
          <td><span class="inventory-status ${statusClass}">${row.status || 'Pending'}</span></td>
        `;
        tbody.appendChild(tr);
    });
    applyInventoryEditState('liquidation');
    requestAnimationFrame(() => adjustInventoryTableWidths('inv-liquidation-table'));
}

function renderInventoryClients() {
    const tbody = document.getElementById('inv-clients-body');
    if (!tbody) return;
    tbody.innerHTML = '';
    inventoryState.clients.forEach(row => {
        const itemOptions = getInventoryPartsOptions('item', row.item);
        const gstinValue = row.clientType === 'In-house deptt' ? '' : (row.gstin || '');
        const gstinReadonly = row.clientType === 'In-house deptt' ? 'readonly' : '';
        const gstinDisabled = row.clientType === 'In-house deptt' ? 'disabled' : '';
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" data-row-id="${row.id}" data-inv-type="clients" ${row._selected ? 'checked' : ''} onchange="updateInventoryCheckbox('clients','${row.id}','_selected',this.checked)"></td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('clients','${row.id}','clientType',this.value)">
              <option value="Manufacturer" ${row.clientType === 'Manufacturer' ? 'selected' : ''}>Manufacturer</option>
              <option value="Customer" ${row.clientType === 'Customer' ? 'selected' : ''}>Customer</option>
              <option value="In-house deptt" ${row.clientType === 'In-house deptt' ? 'selected' : ''}>In-house deptt</option>
            </select>
          </td>
          <td><input class="db-input" value="${row.clientName || ''}" oninput="updateInventoryFieldInline('clients','${row.id}','clientName',this.value)"></td>
          <td><input class="db-input" value="${row.clientAddress || ''}" oninput="updateInventoryFieldInline('clients','${row.id}','clientAddress',this.value)"></td>
          <td><input class="db-input" value="${row.clientContact || ''}" oninput="clientContactInput(this, '${row.id}')"></td>
          <td><input class="db-input" value="${row.clientEmail || ''}" oninput="updateInventoryFieldInline('clients','${row.id}','clientEmail',this.value)"></td>
          <td>
            <select class="db-input" onchange="updateInventoryFieldInline('clients','${row.id}','item',this.value)">
              ${itemOptions}
            </select>
          </td>
          <td><input class="db-input" value="${gstinValue}" ${gstinReadonly} ${gstinDisabled} oninput="updateInventoryFieldInline('clients','${row.id}','gstin',this.value.toUpperCase())"></td>
        `;
        tbody.appendChild(tr);
    });
    applyInventoryEditState('clients');
    requestAnimationFrame(() => adjustInventoryTableWidths('inv-clients-table'));
}

function renderInventoryRefillBatch() {
    const tbody = document.getElementById('inv-refill-body');
    if (!tbody) return;
    tbody.innerHTML = '';
    inventoryState.refill.forEach(row => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="checkbox" data-row-id="${row.id}" data-inv-type="refill" ${row._selected ? 'checked' : ''} onchange="updateInventoryCheckbox('refill','${row.id}','_selected',this.checked)"></td>
          <td><input class="db-input" value="${row.refillId || ''}" oninput="updateInventoryFieldInline('refill','${row.id}','refillId',this.value)"></td>
          <td><input type="number" class="db-input" value="${row.lotSize ?? ''}" oninput="updateInventoryFieldInline('refill','${row.id}','lotSize',this.value)"></td>
          <td><input class="db-input" value="${row.refillLotId || ''}" readonly></td>
          <td><input class="db-input" value="${row.manufacturerName || ''}" oninput="updateInventoryFieldInline('refill','${row.id}','manufacturerName',this.value)"></td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.manufactureDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'refill', '${row.id}', 'manufactureDate')"
              onchange="inventoryDateTimeChange(this, 'refill', '${row.id}', 'manufactureDate')"
              onblur="inventoryDateTimeBlur(this, 'refill', '${row.id}', 'manufactureDate')">
          </td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.expiryDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'refill', '${row.id}', 'expiryDate')"
              onchange="inventoryDateTimeChange(this, 'refill', '${row.id}', 'expiryDate')"
              onblur="inventoryDateTimeBlur(this, 'refill', '${row.id}', 'expiryDate')">
          </td>
          <td>
            <input class="db-input" type="text" value="${formatInventoryDateTimeDisplay(row.deliveryDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'refill', '${row.id}', 'deliveryDate')"
              onchange="inventoryDateTimeChange(this, 'refill', '${row.id}', 'deliveryDate')"
              onblur="inventoryDateTimeBlur(this, 'refill', '${row.id}', 'deliveryDate')">
          </td>
          <td><input class="db-input" value="${row.poNumber || ''}" oninput="updateInventoryFieldInline('refill','${row.id}','poNumber',this.value)"></td>
          <td><input class="db-input" value="${row.notes || ''}" oninput="updateInventoryFieldInline('refill','${row.id}','notes',this.value)"></td>
        `;
        tbody.appendChild(tr);
    });
    applyInventoryEditState('refill');
    requestAnimationFrame(() => adjustInventoryTableWidths('inv-refill-table'));
}

function clientContactInput(input, rowId) {
    const row = inventoryState.clients.find(r => r.id === rowId);
    if (!row) return;
    const value = limitPhoneInput(input);
    row.clientContact = value;
    setInventoryDirty(true);
}

function limitPhoneInput(input) {
    if (!input) return '';
    let value = String(input.value || '');
    const hasPlus = value.startsWith('+');
    const core = hasPlus ? value.slice(1) : value;
    const trimmed = core.slice(0, 10);
    value = hasPlus ? `+${trimmed}` : trimmed;
    input.value = value;
    return value;
}

function toggleInventoryAcknowledged(id, checked) {
    const row = inventoryState.liquidation.find(r => r.id === id);
    if (!row) return;
    if (checked && row.status !== 'Approved') {
        alert('Approval required before acknowledgment.');
        row.acknowledged = false;
    } else {
        row.acknowledged = !!checked;
    }
    setInventoryDirty(true);
    renderInventoryLiquidation();
}

function refreshInventoryApprovals() {
    const tbody = document.getElementById('inv-approvals-body');
    if (!tbody) return;
    tbody.innerHTML = '';
    inventoryState.approvals.forEach(row => {
        const statusClass = row.status ? row.status.toLowerCase() : 'pending';
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${row.requestId}</td>
          <td>${row.requestedBy || '-'}</td>
          <td><input type="number" class="db-input" value="${row.tatDays ?? 3}" oninput="updateInventoryFieldInline('approvals','${row.requestId}','tatDays',this.value)"></td>
          <td>
            <input class="db-input" type="text" data-approval-due="${row.requestId}" value="${formatInventoryDateTimeDisplay(row.dueDate) || ''}"
              onfocus="inventoryDateTimeFocus(this, 'approvals', '${row.requestId}', 'dueDate')"
              onchange="inventoryDateTimeChange(this, 'approvals', '${row.requestId}', 'dueDate')"
              onblur="inventoryDateTimeBlur(this, 'approvals', '${row.requestId}', 'dueDate')">
          </td>
          <td><span class="inventory-status ${statusClass}">${row.status}</span></td>
          <td>${row.approver || '-'}</td>
          <td>
            <button class="btn btn-green btn-sm" onclick="approveInventoryRequest('${row.requestId}','Approved')">Approve</button>
            <button class="btn btn-outline btn-red btn-sm" onclick="approveInventoryRequest('${row.requestId}','Rejected')">Reject</button>
          </td>
        `;
        tbody.appendChild(tr);
    });
    applyInventoryEditState('approvals');
    requestAnimationFrame(() => adjustInventoryTableWidths('inv-approvals-table'));
}

function approveInventoryRequest(requestId, status) {
    const approval = inventoryState.approvals.find(a => a.requestId === requestId);
    if (approval) {
        approval.status = status;
        approval.approver = inventoryRequestedBy();
    }
    const liquidation = inventoryState.liquidation.find(l => l.requestId === requestId);
    if (liquidation) {
        liquidation.status = status;
    }
    setInventoryDirty(true);
    renderInventoryLiquidation();
    refreshInventoryApprovals();
}

function applyAutoFitScale() {
    document.body.style.zoom = '1';
}

window.addEventListener('resize', () => {
    applyAutoFitScale();
});

// Allow Enter key to login
document.addEventListener('DOMContentLoaded', () => {
    const passInput = document.getElementById('login-pass');
    updateUserCard(null);
    if(passInput) {
        passInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') attemptLogin();
        });
    }
    initGlobalRowHeightSync();
    applyAutoFitScale();
});


function logout() {
    if(!confirm("Are you sure you want to logout?")) return;

    // 1. Show Login Overlay
    const overlay = document.getElementById('login-overlay');
    if(overlay) {
        overlay.style.display = 'flex';
        
        // 2. Clear Credentials fields for security
        document.getElementById('login-user').value = '';
        document.getElementById('login-pass').value = '';
        document.getElementById('login-msg').innerText = '';
    }

    // 3. Reset Role
    currentUserRole = null;
    currentUser = null;
    updateUserCard(null);
    console.log("User logged out.");
}




const MAX_MULTI_SELECT = 15;

const cols = [
    {k:'ammonium',  n:'Ammonium-N',  t:'Abs', b:'B', csvT:'Amnm_n',      csvC:'Amnm_n_cal'},
    {k:'phosphorus',n:'Phosphorus', t:'Abs', b:'B', csvT:'Phprs',       csvC:'Phprs_cal'},
    {k:'sulphur',   n:'Sulphur',    t:'Abs', b:'B', csvT:'Slpr',        csvC:'Slpr_cal'},
    {k:'oc',        n:'Organic Carbon', t:'Abs', b:'G', csvT:'Org_crbn', csvC:'Org_crbn_cal'},
    {k:'nitrate',   n:'Nitrate-N',  t:'Abs', b:'G', csvT:'Ntrt_n',      csvC:'Ntrt_n_cal'},
    {k:'boron',     n:'Boron',      t:'Abs', b:'B', csvT:'Brn',         csvC:'Brn_cal'},
    {k:'potassium', n:'Potassium',  t:'Abs', b:'B', csvT:'Potsm',       csvC:'Potsm_cal'},
    {k:'copper',    n:'Copper',     t:'Abs', b:'R', csvT:'Cpr',         csvC:'Cpr_cal'},
    {k:'zinccopper',n:'ZincCopper', t:'Abs', b:'R', csvT:'Znc',         csvC:'Znc_cal'},
    {k:'iron',      n:'Iron',       t:'Abs', b:'G', csvT:'Irn',         csvC:'Irn_cal'},
    {k:'manganese', n:'Manganese',  t:'Abs', b:'G', csvT:'Mgns',        csvC:'Mgns_cal'},
    {k:'ec',        n:'EC',         t:'Val', b:'K', csvT:'Ec',          csvC:'Ec_cal'},
    {k:'ph',        n:'pH',         t:'Val', b:'K', csvT:'Ph',          csvC:'Ph_cal'}
];


// =========================
// Metric calculation helpers
// =========================

// Set true only when debugging; keep false in production to avoid console spam.
window.DEBUG_METRIC = window.DEBUG_METRIC || false;

function getColSpecByKey(key) {
  try {
    if (!Array.isArray(cols)) return null;
    return cols.find(c => c && c.k === key) || null;
  } catch (e) {
    return null;
  }
}

function bandIndexFromCode(bandCode) {
  const b = String(bandCode || '').toUpperCase();
  if (b === 'R') return 0;
  if (b === 'G') return 1;
  if (b === 'B') return 2;
  return null; // 'K' or unknown
}

function numberFromTripletOrNumber(val, bandCode) {
  if (val == null) return null;

  // Already numeric
  if (typeof val === 'number') return Number.isFinite(val) ? val : null;

  // Numeric string or triplet string
  if (typeof val === 'string') {
    const s = val.trim();
    if (!s) return null;

    // Triplet "R,G,B"
    if (s.includes(',')) {
      const parts = s.split(',').map(x => x.trim());
      const idx = bandIndexFromCode(bandCode);
      const pick = (idx != null && parts[idx] != null) ? parts[idx] : parts[0];
      const n = Number(pick);
      return Number.isFinite(n) ? n : null;
    }

    // Plain numeric string
    const n = Number(s);
    return Number.isFinite(n) ? n : null;
  }

  // Unexpected type
  return null;
}

/**
 * Calculates a display/export metric for a given parameter key.
 * - For Val columns (pH, EC): returns value/100 (as per your backend recalculation).
 * - For Abs columns: returns 1 - (t/c) using raw[key].t and raw[key].c
 *   (supports numbers OR triplet strings in t/c as fallback).
 *
 * Returns: number OR null
 */
// ===================== METRIC (GLOBAL) =====================
// Always install on window so it can be called from anywhere safely.
window.calcMetric = function (raw, key) {
  try {
    if (!raw || !key) return 0;

    // Prefer your existing key→colSpec logic if present
    const spec = (typeof getColSpecByKey === 'function') ? getColSpecByKey(key) : null;
    const node = raw[key];
    if (node == null) return 0;

    // If backend/UI already stored a number directly
    if (typeof node === 'number') return Number.isFinite(node) ? node : 0;

    // If backend/UI stored numeric as string
    if (typeof node === 'string' && !node.includes(',')) {
      const n = Number(node.trim());
      return Number.isFinite(n) ? n : 0;
    }

    // Determine metric type (Abs/Val)
    const metricType = spec && spec.t ? String(spec.t).toUpperCase() : null;
    const band = spec ? spec.b : null;

    // Helper: parse triplet or scalar
    const parse = (x) => (
      (typeof numberFromTripletOrNumber === 'function')
        ? numberFromTripletOrNumber(x, band)
        : Number(x)
    );

    // VAL columns: shown as t/100 in your UI convention
    if (metricType === 'VAL') {
      // accept any of these shapes
      const base = (node && typeof node === 'object')
        ? (node.v ?? node.val ?? node.value ?? node.t)
        : node;

      const v = parse(base);
      return Number.isFinite(v) ? (v / 100) : 0;
    }

    // ABS columns: 1 - t/c (preferred), else accept a stored abs-like value if present
    if (node && typeof node === 'object') {
      const t = parse(node.t);
      const c = parse(node.c);

      if (Number.isFinite(t) && Number.isFinite(c) && c !== 0) {
        return 1 - (t / c);
      }

      const abs = parse(node.abs ?? node.Abs ?? node.metric);
      if (Number.isFinite(abs)) return abs;
    }

    if (window.DEBUG_METRIC) console.warn('[calcMetric] cannot compute', { key, spec, node });
    return 0;
  } catch (e) {
    if (window.DEBUG_METRIC) console.error('[calcMetric] exception', { key, e });
    return 0;
  }
};

// Legacy global binding for code paths that call calcMetric(...)
var calcMetric = window.calcMetric;




let dbCriteria = [];
let stvData        = [];
let qcCriteriaData = [];
let blankData      = [];
let deviceRegistry = [];
let globalData     = [];
let rgbData        = [];
let qcData         = [];
let selectedRowId  = null;
let isHeavyDataLoaded = false;



// --- PAGINATION STATE ---
const ROWS_PER_PAGE = 50; 
// ============================================================================
// METRIC COMPUTATION (Global + Safe)
// Ensures both window.calcMetric(...) AND calcMetric(...) exist.
// Returns: number | null (never throws)
// ============================================================================

window.calcMetric = function (raw, key) {
  try {
    if (!raw || !key) return null;

    // Allow callers to pass either row.raw OR full row object
    const base = (raw && raw.raw && typeof raw.raw === 'object') ? raw.raw : raw;

    // Prefer your existing key→colSpec logic if present
    const spec = (typeof getColSpecByKey === 'function') ? getColSpecByKey(key) : null;

    const node = base[key];
    if (node == null) return null;

    // If stored as a number already
    if (typeof node === 'number') return Number.isFinite(node) ? node : null;

    // If stored as numeric string
    if (typeof node === 'string' && !node.includes(',')) {
      const n = Number(node.trim());
      return Number.isFinite(n) ? n : null;
    }

    // Determine metric type (Abs/Val)
    const metricType = spec && spec.t ? String(spec.t).toUpperCase() : null;
    const band = spec ? spec.b : null;

    // Helper: parse triplet or scalar
    const parse = (x) => (
      (typeof numberFromTripletOrNumber === 'function')
        ? numberFromTripletOrNumber(x, band)
        : Number(x)
    );

    // VAL columns: shown as t/100 in your UI convention
    if (metricType === 'VAL') {
      const baseVal = (node && typeof node === 'object')
        ? (node.v ?? node.val ?? node.value ?? node.t)
        : node;

      const v = parse(baseVal);
      return Number.isFinite(v) ? (v / 100) : null;
    }

    // ABS columns: 1 - t/c, else accept stored abs-like if present
    if (node && typeof node === 'object') {
      const t = parse(node.t);
      const c = parse(node.c);

      if (Number.isFinite(t) && Number.isFinite(c) && c !== 0) {
        return 1 - (t / c);
      }

      const abs = parse(node.abs ?? node.Abs ?? node.metric);
      if (Number.isFinite(abs)) return abs;
    }

    if (window.DEBUG_METRIC) console.warn('[calcMetric] cannot compute', { key, spec, node });
    return null;
  } catch (e) {
    if (window.DEBUG_METRIC) console.error('[calcMetric] exception', { key, e });
    return null;
  }
};

// Legacy/global binding: many parts of your UI call calcMetric(...) directly.
function calcMetric(raw, key) {
  return window.calcMetric(raw, key);
}

// --------------------------------------------------------------------------
// Safe formatting helpers (prevents null.toFixed crashes)
// --------------------------------------------------------------------------
function toNumberOrNull(v) {
  const n = (typeof v === 'number') ? v : Number(v);
  return Number.isFinite(n) ? n : null;
}

function fmtFixed(v, dp) {
  const n = toNumberOrNull(v);
  return (n == null) ? '' : n.toFixed(dp);
}

function sumMaybe(a, b) {
  const na = toNumberOrNull(a);
  const nb = toNumberOrNull(b);
  if (na == null && nb == null) return null;
  return (na ?? 0) + (nb ?? 0);
}

function diffStrict(a, b) {
  const na = toNumberOrNull(a);
  const nb = toNumberOrNull(b);
  if (na == null || nb == null) return null;
  return na - nb;
}



let pageState = {
    rgb: 1,
    qaqc: 1,
    results: 1
};

// --- PAGINATION FUNCTIONS ---
function changePage(mod, delta) {
    pageState[mod] += delta;
    if (pageState[mod] < 1) pageState[mod] = 1;
    
    if (mod === 'results') renderResults();
    else renderTable(mod);
}

function resetPageAndRender(mod) {
  pageState[mod] = 1;
  if (mod === 'results') {
    renderResults();
  } else {
    renderTable(mod);
  }

  // ✅ NEW: keep QA/QC action buttons in sync after any render
  if (mod === 'qaqc' && typeof updateQaqcActionButtons === 'function') {
    setTimeout(updateQaqcActionButtons, 0);
  }
}

function setPaginationText(mod, startIdx, endIdx, totalRows) {
  const id = (mod === 'results') ? 'pg-results-txt' : `pg-${mod}-txt`;
  const infoSpan = document.getElementById(id);
  if (!infoSpan) return;

  if (totalRows === 0) infoSpan.textContent = "No data";
  else infoSpan.textContent = `Showing ${startIdx + 1}-${endIdx} of ${totalRows}`;
}


let multiSelect = { rgb: [], qaqc: [], results: [] }; // Yellow Highlights (View)
var checkedRows = window.checkedRows = window.checkedRows || { rgb: [], qaqc: [] };
let qcManualStatus          = {};
let qcManualOverrideEnabled = {};
let currentQCBatchId        = 'Default';
let chartObjs               = {};


// Global master list cache (client-side)
window.masterLists = window.masterLists || {
  qcBatchIds: ['Default'],
  prodBatchIds: ['Default'],
  loaded: false,
  lastLoadedAt: 0
};

window.__masterListsPromise = null;


// === DB ROW NORMALIZERS (support header-based objects from Sheets) ===
function normalizeKey_(key) {
  return String(key || '')
    .toLowerCase()
    .replace(/[^a-z0-9]/g, '');
}

function pickField_(row, candidates, fallback = '') {
  if (!row || typeof row !== 'object') return fallback;
  const map = {};
  Object.keys(row).forEach(k => {
    map[normalizeKey_(k)] = row[k];
  });
  for (const candidate of candidates) {
    const v = map[normalizeKey_(candidate)];
    if (v !== undefined) return v;
  }
  return fallback;
}

function rowHasValues_(row) {
  return Object.values(row || {}).some(v => String(v ?? '').trim() !== '');
}

function normalizeCriteriaRows(rows) {
  return (Array.isArray(rows) ? rows : [])
    .map(r => ({
      s: pickField_(r, ['spectro', 's'], ''),
      p: pickField_(r, ['parameter', 'param', 'p'], ''),
      m: pickField_(r, ['metric', 'm'], ''),
      l: pickField_(r, ['llimit', 'l.limit', 'l_limit', 'l limit', 'lowerlimit'], ''),
      rel: pickField_(r, ['relation', 'rel', 'operator'], 'between'),
      u: pickField_(r, ['ulimit', 'u.limit', 'u_limit', 'u limit', 'upperlimit'], ''),
      re: pickField_(r, ['reason', 're'], ''),
      ac: pickField_(r, ['action', 'ac'], '')
    }))
    .filter(rowHasValues_);
}

function normalizeStvRows(rows) {
  return (Array.isArray(rows) ? rows : [])
    .map(r => ({
      p: pickField_(r, ['parameter', 'param', 'p'], ''),
      a: pickField_(r, ['a'], ''),
      b: pickField_(r, ['b'], ''),
      df1: pickField_(r, ['df1'], ''),
      df2: pickField_(r, ['df2'], ''),
      df3: pickField_(r, ['df3'], ''),
      df4: pickField_(r, ['df4'], '')
    }))
    .filter(rowHasValues_);
}

function normalizeQcCriteriaRows(rows) {
  return (Array.isArray(rows) ? rows : [])
    .map(r => ({
      batch: pickField_(r, ['qcbatch_id', 'qc_batch', 'qcbatch', 'qcbatchid', 'batch'], 'Default'),
      p: pickField_(r, ['parameter', 'param', 'p'], ''),
      min: pickField_(r, ['qcabsmin', 'qc_abs_min', 'min'], ''),
      max: pickField_(r, ['qcabsmax', 'qc_abs_max', 'max'], ''),
      mean: pickField_(r, ['qcabsmean', 'qc_abs_mean', 'mean'], ''),
      sd: pickField_(r, ['qcabs_sd', 'qc_abs_sd', 'qcsd', 'sd', 'sd_level'], '')
    }))
    .filter(rowHasValues_);
}

function normalizeBlankRows(rows) {
  return (Array.isArray(rows) ? rows : [])
    .map(r => ({
      p: pickField_(r, ['parameter', 'param', 'p'], ''),
      val: pickField_(r, ['blankvalue', 'blank_value', 'blank value', 'value', 'val'], '')
    }))
    .filter(rowHasValues_);
}


// === Load lookup tables + any server-provided data from Google Sheets ===
// --- INITIAL LOAD ---
function loadInitialData() {
  const traceId = 'CFG-' + new Date().toISOString() + '-' + Math.floor(Math.random() * 1e6);

  console.log('🚀 loadInitialData START', {
    traceId,
    href: (typeof location !== 'undefined' ? location.href : '')
  });

  // Local / offline mode
  if (typeof google === 'undefined' || !google.script || !google.script.run) {
    console.warn('Local Mode: Skipping server calls.', { traceId });

    serviceConfig = [
      { section: 'Hardware', name: 'Spectro', options: 'Repair,Replace,Clean' },
      { section: 'Hardware', name: 'Pump',    options: 'Repair,Replace,Clog' },
      { section: 'Software', name: 'Firmware', options: 'Update,Re-flash' },
      { section: 'Soil_Report', name: 'Email', options: 'Resend,Edit' }
    ];
    renderServiceButtons();
    return;
  }

  // 1) UI loading state
  showLoadingState();

  // 2) Build info (separate call; do not chain into getInitialData)
  console.log('🔖 Requesting build info...', { traceId });
  google.script.run
    .withSuccessHandler(info => {
      console.log('🔖 Build info from server:', info, { traceId });
    })
    .withFailureHandler(err => {
      console.error('❌ getBuildInfo failed:', err, { traceId });
    })
    .getBuildInfo();

  // 3) Config
  const t0 = performance.now();
  console.log('🚀 Requesting Config (getInitialData)...', { traceId, t0: Math.round(t0) });

  google.script.run
    .withSuccessHandler(res => {
      const ms = (performance.now() - t0);
      console.log('✅ Config Loaded (summary):', { type: typeof res, value: res }, { traceId, ms: ms.toFixed(1) });

      // Hard guard: null means server returned undefined
      if (!res || typeof res !== 'object') {
        console.error('❌ getInitialData returned null/invalid', { traceId, res });
        alert('Config load failed: getInitialData returned null/invalid.\nTrace: ' + traceId +
              '\nCheck Apps Script Executions log for traceId starting with SRV-.');
        return;
      }

      // Backend envelope errors
      if (res.__status === 'ERROR' || res.__error) {
        console.error('❌ getInitialData reported ERROR', { traceId, res });
        alert('Config load failed: ' + (res.__error || 'Unknown error') +
              '\nServer trace: ' + (res.__traceId || 'n/a') +
              '\nClient trace: ' + traceId);
        return;
      }

      // Optional meta visibility
      console.log('🧾 Config Meta', {
        traceId,
        serverTraceId: res.__traceId,
        missingSheets: res.__missingSheets,
        info: res.__info
      });

      // Assigns (safe)
      const rawCriteria = Array.isArray(res.criteria) ? res.criteria : [];
      const rawStv = Array.isArray(res.stv) ? res.stv : [];
      const rawQcCriteria = Array.isArray(res.qcCriteria) ? res.qcCriteria : [];
      const rawBlanks = Array.isArray(res.blanks) ? res.blanks : [];

      dbCriteria     = normalizeCriteriaRows(rawCriteria);
      stvData        = normalizeStvRows(rawStv);
      qcCriteriaData = normalizeQcCriteriaRows(rawQcCriteria);
      blankData      = normalizeBlankRows(rawBlanks);

      deviceRegistry = Array.isArray(res.registry)
        ? res.registry.map(r => mapRegistryRow(r))
        : [];

      window.recipeConfig = (res.recipeConfig && typeof res.recipeConfig === 'object')
        ? res.recipeConfig
        : {};

      window.currentStvInfo = (res.stvInfo && typeof res.stvInfo === 'object')
        ? res.stvInfo
        : null;

      const stvTag = document.getElementById('stv-version-tag');
      if (stvTag) {
        if (window.currentStvInfo?.version) {
          const run = window.currentStvInfo.runId ? ` • ${window.currentStvInfo.runId}` : '';
          stvTag.textContent = `STV: ${window.currentStvInfo.version}${run}`;
        } else {
          stvTag.textContent = '';
        }
      }

      // Service config
      if (Array.isArray(res.serviceConfig)) {
        processServiceConfig(res.serviceConfig);
      } else {
        console.warn('Using fallback service config', { traceId });
        const mock = [
          { section: 'Hardware', btn: 'Spectro', sub: 'Glass Tube', act: 'Clean,Replace',  subActions: '' },
          { section: 'Hardware', btn: 'Pump',    sub: 'Motor',      act: 'Replace,Oiling', subActions: '' }
        ];
        processServiceConfig(mock);
      }

      // Render
      renderDeviceRegistry();
      renderCriteria();
      renderSTV();
      renderQCCriteria();
      renderBlanks();
      refreshQCBatchOptions();

      // Ensure DB master tabs are loaded from sheets on initial load
      if (typeof dbLoadMasters === 'function') {
        dbLoadMasters({ force: true, silent: true });
      }

      // Load recent data fast (last 30 days) on launch, then warm full dataset
      window.__opDataPending = true;
      if (typeof loadOperationalDataRecent === 'function') {
        loadOperationalDataRecent({ days: 30, mode: 'full', warmFull: true });
      }
    })
    .withFailureHandler(err => {
      console.error('❌ getInitialData failed:', err, { traceId });

      const msg = (err && err.message) ? err.message : String(err);
      const details = (err && err.details) ? ('\n' + err.details) : '';
      alert('getInitialData failed:\n' + msg + details + '\nTrace: ' + traceId);

      const tbody = document.querySelector('#tbl-rgb-metrics tbody');
      if (tbody) tbody.innerHTML = '<tr><td colspan="15">Config Load Failed</td></tr>';
    })
    .getInitialData();
}

// ===============================
// SINGLE-FLIGHT SERVER CALL GUARD
// ===============================
window.__opDataInFlight = false;
window.__opDataLastAt = 0;

function fetchOperationalDataOnce(options = {}) {
  const {
    reason = 'unknown',
    onSuccess = null,
    onFailure = null
  } = options;

  const hasServer = (typeof google !== 'undefined' && google.script?.run);
  if (!hasServer) return;

  // Prevent overlapping server calls (this is the main fix)
  if (window.__opDataInFlight) {
    // console.log(`⏳ getOperationalData skipped (in-flight) [${reason}]`);
    return;
  }

  window.__opDataInFlight = true;

  google.script.run
    .withSuccessHandler(function (res) {
      try {
        if (res && res.rgbData) rgbData = res.rgbData;
        if (res && res.qcData) qcData = res.qcData;

        window.__opDataLastAt = Date.now();

        if (typeof onSuccess === 'function') onSuccess(res);
      } finally {
        window.__opDataInFlight = false;
      }
    })
    .withFailureHandler(function (err) {
      try {
        console.error(`getOperationalData failed [${reason}]:`, err);
        if (typeof onFailure === 'function') onFailure(err);
      } finally {
        window.__opDataInFlight = false;
      }
    })
    .getOperationalData();
}

/**
 * Load QC/Prod batch master lists ONCE (dedup concurrent calls).
 * Memory-first (dbMasters), then server (srvr_getMasterLists).
 */
function loadMasterListsOnce(force = false) {
  // ✅ Safe init (prevents undefined access)
  window.masterLists = window.masterLists || {
    qcBatchIds: ['Default'],
    prodBatchIds: ['Default'],
    loaded: false,
    lastLoadedAt: 0
  };

  const now = Date.now();

  // 0) If already loaded recently and not forced, return immediately (TTL = 60s)
  if (!force && window.masterLists.loaded && (now - (window.masterLists.lastLoadedAt || 0) < 60 * 1000)) {
    return Promise.resolve(window.masterLists);
  }

  // 1) MEMORY-FIRST: build lists from dbMasters (no server call)
  try {
    const qcRows = window.dbMasters?.qc?.rows;
    const prRows = window.dbMasters?.prod?.rows;

    const qcFromMem = Array.isArray(qcRows)
      ? qcRows.map(r => String(r?.QCBatch_ID ?? '').trim()).filter(Boolean)
      : [];

    const prFromMem = Array.isArray(prRows)
      ? prRows.map(r => String(r?.ProdBatch_ID ?? '').trim()).filter(Boolean)
      : [];

    if (!force && (qcFromMem.length || prFromMem.length)) {
      const qc = qcFromMem.length ? qcFromMem : (window.masterLists.qcBatchIds || []);
      const pr = prFromMem.length ? prFromMem : (window.masterLists.prodBatchIds || []);

      window.masterLists.qcBatchIds = normalizeMasterIdList_(qc, 'Default');
      window.masterLists.prodBatchIds = normalizeMasterIdList_(pr, 'Default');
      window.masterLists.loaded = true;
      window.masterLists.lastLoadedAt = Date.now();

      return Promise.resolve(window.masterLists);
    }
  } catch (e) {
    // swallow; will fall back to server
  }

  // 2) Local/offline mode: keep defaults and mark loaded
  const hasServer = typeof google !== "undefined" && google.script?.run;
  if (!hasServer) {
    window.masterLists.qcBatchIds = normalizeMasterIdList_(window.masterLists.qcBatchIds, 'Default');
    window.masterLists.prodBatchIds = normalizeMasterIdList_(window.masterLists.prodBatchIds, 'Default');
    window.masterLists.loaded = true;
    window.masterLists.lastLoadedAt = Date.now();
    return Promise.resolve(window.masterLists);
  }

  // 3) Single-flight de-dup (prevents concurrency explosion)
  if (!force && window.__masterListsPromise) return window.__masterListsPromise;

  window.__masterListsPromise = new Promise((resolve) => {
    google.script.run
      .withSuccessHandler(function (res) {
        try {
          const qc = (res && Array.isArray(res.qcBatchIds)) ? res.qcBatchIds : window.masterLists.qcBatchIds;
          const pr = (res && Array.isArray(res.prodBatchIds)) ? res.prodBatchIds : window.masterLists.prodBatchIds;

          window.masterLists.qcBatchIds = normalizeMasterIdList_(qc, 'Default');
          window.masterLists.prodBatchIds = normalizeMasterIdList_(pr, 'Default');
          window.masterLists.loaded = true;
          window.masterLists.lastLoadedAt = Date.now();
        } finally {
          window.__masterListsPromise = null;
          resolve(window.masterLists);
        }
      })
      .withFailureHandler(function (err) {
        console.error("srvr_getMasterLists failed:", err);

        // IMPORTANT: no retries here.
        window.masterLists.qcBatchIds = normalizeMasterIdList_(window.masterLists.qcBatchIds, 'Default');
        window.masterLists.prodBatchIds = normalizeMasterIdList_(window.masterLists.prodBatchIds, 'Default');
        window.masterLists.loaded = true;
        window.masterLists.lastLoadedAt = Date.now();

        window.__masterListsPromise = null;
        resolve(window.masterLists);
      })
      .srvr_getMasterLists();
  });

  return window.__masterListsPromise;
}

/** internal helper: de-dup, ensure default, sort Default first */
function normalizeMasterIdList_(list, defaultValue) {
  let arr = Array.isArray(list) ? list : [];
  arr = arr.map(x => String(x).trim()).filter(Boolean);
  if (!arr.includes(defaultValue)) arr.unshift(defaultValue);
  arr = Array.from(new Set(arr));
  arr.sort((a, b) => (a === defaultValue ? -1 : b === defaultValue ? 1 : a.localeCompare(b)));
  return arr;
}



// -------------------------------
// SAFE ACTION BUTTON WRAPPERS
// -------------------------------
function safeUpdateRgbActionButtons() {
  try {
    if (typeof updateRgbActionButtons === 'function') updateRgbActionButtons();
  } catch (e) {
    console.warn('safeUpdateRgbActionButtons failed:', e);
  }
}

function safeUpdateQaqcActionButtons() {
  try {
    if (typeof updateQaqcActionButtons === 'function') updateQaqcActionButtons();
  } catch (e) {
    console.warn('safeUpdateQaqcActionButtons failed:', e);
  }
}

// -------------------------------
// RGB DEFAULT NORMALIZER (LOAD STAGE)
// Ensures Client/Farm/ProdBatch/QCBatch are never blank in rgbData.
// -------------------------------
function normalizeRgbDefaults_(rows) {
  if (!Array.isArray(rows)) return rows;

  const normStr = (v) => String(v ?? '').trim();
  const pick = (obj, keys) => {
    for (const k of keys) {
      if (obj && obj[k] !== undefined && obj[k] !== null) {
        const s = normStr(obj[k]);
        if (s !== '') return s;
      }
    }
    return '';
  };
  const setIfBlank = (obj, k, val) => {
    if (!obj) return;
    if (obj[k] === undefined || obj[k] === null || normStr(obj[k]) === '') obj[k] = val;
  };

  rows.forEach(r => {
    if (!r) return;

    const client = pick(r, ['Client_ID','client_id','clientId']) || 'Default';
    const farm   = pick(r, ['Farm_ID','farm_id','farmId']) || 'Default';
    const prod   = pick(r, ['ProdBatch_ID','prodbatch_id','prodBatchId']) || 'Default';

    // For RGB stage, keep QCBatch_ID defaulted if missing (helps UI + movement)
    const qcb    = pick(r, ['QCBatch_ID','qcbatch_id','qcBatchId','QC_Batch','qcBatch']) || 'Default';

    // Canonical (what your tables now use)
    setIfBlank(r, 'Client_ID', client);
    setIfBlank(r, 'Farm_ID', farm);
    setIfBlank(r, 'ProdBatch_ID', prod);
    setIfBlank(r, 'QCBatch_ID', qcb);

    // Optional: keep aliases consistent if other parts of the app read them
    setIfBlank(r, 'client_id', client);
    setIfBlank(r, 'farm_id', farm);
    setIfBlank(r, 'prodbatch_id', prod);
    setIfBlank(r, 'qcbatch_id', qcb);
  });

  return rows;
}

function normalizeMetaDefaults_(rows) {
  if (!Array.isArray(rows)) return;
  rows.forEach(r => {
    if (!r) return;

    const get = (a, b, c) => (r[a] ?? r[b] ?? r[c]);
    const set = (k, v) => { if (r[k] == null || String(r[k]).trim() === "") r[k] = v; };

    // fill *both* common casings if you sometimes use snake_case in other flows
    const client = get("Client_ID", "client_id", "clientId");
    const farm   = get("Farm_ID", "farm_id", "farmId");
    const prod   = get("ProdBatch_ID", "prodbatch_id", "prodBatchId");
    const qcb    = get("QCBatch_ID", "qcbatch_id", "qcBatchId");

    if (!client) { set("Client_ID", "Default"); set("client_id", "Default"); }
    if (!farm)   { set("Farm_ID", "Default");   set("farm_id", "Default"); }
    if (!prod)   { set("ProdBatch_ID", "Default"); set("prodbatch_id", "Default"); }
    if (!qcb)    { set("QCBatch_ID", "Default"); set("qcbatch_id", "Default"); set("qcBatchId", "Default"); }
  });
}


// -------------------------------
// DROP-IN: loadOperationalData()
// -------------------------------
function loadOperationalData(opts = {}) {
  // ============================
  // OPTIONS (all optional)
  // ============================
  const mode = opts.mode || 'full'; 
  // mode: 'full' (default) -> render rgb + qaqc + results
  //       'results'        -> render results only (safe for auto-refresh)
  //       'none'           -> just update arrays, no renders

  const refreshMasters = !!opts.refreshMasters;   // force master loads now
  const mastersMinIntervalMs = opts.mastersMinIntervalMs || 120000; // 2 minutes default
  const minIntervalMs = opts.minIntervalMs || 120000; // 2 minutes cache window
  const force = !!opts.force;

  // ============================
  // MOVE GUARD (you already had)
  // ============================
  if (window.__moveBusy) {
    console.log('⏸️ loadOperationalData skipped: move in progress');
    return;
  }

  // ============================
  // SINGLE-FLIGHT GUARD (critical)
  // ============================
  if (window.__opDataInFlight) {
    // Prevent overlapping getOperationalData calls
    // console.log('⏳ loadOperationalData skipped: operational fetch in-flight');
    return;
  }

  if (window.isHeavyDataLoaded && !force) {
    const last = window.__opDataLastAt || 0;
    if (Date.now() - last < minIntervalMs) {
      if (mode === 'full') {
        if (typeof renderTable === 'function') renderTable('rgb');
        if (typeof setRgbFocus === 'function') setRgbFocus('metrics');
        if (typeof renderTable === 'function') renderTable('qaqc');
        if (typeof setQaqcFocus === 'function') setQaqcFocus('results');
        if (typeof renderResults === 'function') renderResults();
      } else if (mode === 'results') {
        if (typeof renderResults === 'function') renderResults();
      }
      return;
    }
  }

  console.log('🔄 Fetching Heavy Data (UNLIMITED)...');

  // ✅ Local-only / offline mode guard
  if (typeof google === 'undefined' || !google.script?.run) {
    console.warn('Local Mode: Skipping server calls.');
    try {
      if (Array.isArray(rgbData)) {
        normalizeRgbDefaults_(rgbData);
        if (typeof buildNutrientManagerIndices === 'function') buildNutrientManagerIndices();
      }
      if (typeof initNutrientManagerConfig === 'function') initNutrientManagerConfig('Default');

      if (Array.isArray(qcData) && typeof normalizeQCBatchField_ === 'function') {
        normalizeQCBatchField_(qcData);
      }

      // ✅ Default date range only if user hasn't set it
      const fromEl = document.getElementById('date-rgb-from');
      const toEl   = document.getElementById('date-rgb-to');
      const hasUserDate = !!(fromEl?.value || toEl?.value);
      if (!hasUserDate) {
        const applied = (typeof setDateRangeFromData === 'function')
          ? setDateRangeFromData(rgbData || [], 30)
          : false;
        if (!applied && typeof setDateRange === 'function') setDateRange(30);
      }

      // Renders (local mode)
      if (mode === 'full') {
        if (typeof renderTable === 'function') renderTable('rgb');
        if (typeof setRgbFocus === 'function') setRgbFocus('metrics');

        if (typeof renderTable === 'function') renderTable('qaqc');
        if (typeof setQaqcFocus === 'function') setQaqcFocus('results');

        if (typeof renderResults === 'function') renderResults();
      } else if (mode === 'results') {
        if (typeof renderResults === 'function') renderResults();
      }

      window.isHeavyDataLoaded = true;

      // IMPORTANT: in local mode, do NOT spam dropdown refreshes
      // (leave as-is; local mode usually doesn't need server-based master lists)
      safeUpdateQaqcActionButtons();
      safeUpdateRgbActionButtons();

    } catch (e) {
      console.error(e);
      alert('Local mode render failed: ' + (e.message || e));
    }
    return;
  }

  // ============================
  // THROTTLE MASTERS (critical)
  // ============================
  if (!window.__mastersLastAt) window.__mastersLastAt = 0;
  if (!window.__mastersInFlight) window.__mastersInFlight = false;

  function shouldRefreshMastersNow_() {
    if (refreshMasters) return true;
    if (!window.isHeavyDataLoaded) return true; // first load
    return (Date.now() - window.__mastersLastAt) >= mastersMinIntervalMs;
  }

  function refreshMastersSafely_() {
    if (!shouldRefreshMastersNow_()) return;
    if (window.__mastersInFlight) return;

    window.__mastersInFlight = true;

    try {
      // NEW: load master lists (for dropdowns) + load DB master tables
      // These MUST NOT be called every 5s / every refresh.
      if (typeof loadMasterListsAndRerenderRGB === "function") loadMasterListsAndRerenderRGB();
      if (typeof dbLoadMasters === "function") dbLoadMasters();

      // If you still need these, run them after master load, but ONLY on this cadence
      requestAnimationFrame(() => {
        if (typeof refreshQCBatchOptions === 'function') refreshQCBatchOptions();
        if (typeof refreshQCCriteriaBatchOptions === 'function') refreshQCCriteriaBatchOptions();
        if (typeof populateQCHistParamDropdown === 'function') populateQCHistParamDropdown();
      });

      window.__mastersLastAt = Date.now();
    } finally {
      // release after a short delay to avoid bursts of concurrent scripts
      setTimeout(() => { window.__mastersInFlight = false; }, 1000);
    }
  }

  // ============================
  // SERVER CALL (single-flight)
  // ============================
  window.__opDataInFlight = true;

  google.script.run
    .withSuccessHandler(function (res) {
      try {
        // If move started after request was sent but before response arrived, ignore response
        if (window.__moveBusy) {
          console.log('⏸️ loadOperationalData response ignored: move in progress');
          return;
        }

        // Assign, but filter out any rows that are pending-moved (if those helpers exist)
        if (res && res.rgbData) {
          rgbData = (typeof _filterOutPendingMovesRGB === 'function')
            ? _filterOutPendingMovesRGB(res.rgbData)
            : res.rgbData;
        } else {
          rgbData = Array.isArray(rgbData) ? rgbData : [];
        }

        if (res && res.qcData) {
          qcData = (typeof _filterOutPendingMovesQC === 'function')
            ? _filterOutPendingMovesQC(res.qcData)
            : res.qcData;
        } else {
          qcData = Array.isArray(qcData) ? qcData : [];
        }

        normalizeMetaDefaults_(rgbData);
        normalizeMetaDefaults_(qcData);

        // ✅ Normalize RGB defaults at LOAD stage
        if (Array.isArray(rgbData)) normalizeRgbDefaults_(rgbData);

        if (Array.isArray(rgbData) && typeof buildNutrientManagerIndices === 'function') {
          buildNutrientManagerIndices();
        }
        if (typeof initNutrientManagerConfig === 'function') {
          initNutrientManagerConfig('Default');
        }

        // ✅ Normalize QC batch field
        if (Array.isArray(qcData)) {
          if (typeof normalizeQCBatchField_ === 'function') {
            normalizeQCBatchField_(qcData);
          } else {
            qcData.forEach(r => {
              if (!r) return;
              if (!r.qcBatchId) {
                const b = (r.QC_Batch ?? r.qcBatch ?? r.batch ?? '').toString().trim();
                if (b) r.qcBatchId = b;
              }
              if (!r.qcBatchId) r.qcBatchId = 'Default';
            });
          }
        }

        // Populate Analytics device dropdown (robust device id extraction)
        const sel = document.getElementById('an-device');
        if (sel && Array.isArray(rgbData) && rgbData.length > 0) {
          const current = sel.value;
          const devs = [...new Set(rgbData
            .map(d => (d?.Device_ID ?? d?.did ?? d?.device_id ?? '').toString().trim())
            .filter(Boolean)
          )].sort();

          sel.innerHTML =
            '<option value="">All devices</option>' +
            devs.map(d => `<option value="${escapeHtml(d)}">${escapeHtml(d)}</option>`).join('');

          if (devs.includes(current)) sel.value = current;
        }

        // ✅ Default RGB/Abs date range only if user hasn't set it
        const fromEl = document.getElementById('date-rgb-from');
        const toEl   = document.getElementById('date-rgb-to');
        const hasUserDate = !!(fromEl?.value || toEl?.value);
        if (!hasUserDate) {
          const applied = (typeof setDateRangeFromData === 'function')
            ? setDateRangeFromData(rgbData || [], 30)
            : false;
          if (!applied && typeof setDateRange === 'function') setDateRange(30);
        }

        // ============================
        // RENDER (based on mode)
        // ============================
        if (mode === 'full') {
          if (typeof renderTable === 'function') renderTable('rgb');
          if (typeof setRgbFocus === 'function') setRgbFocus('metrics');

          if (typeof renderTable === 'function') renderTable('qaqc');
          if (typeof setQaqcFocus === 'function') setQaqcFocus('results');

          if (typeof renderResults === 'function') renderResults();
        } else if (mode === 'results') {
          if (typeof renderResults === 'function') renderResults();
        } else {
          // mode === 'none' -> no renders
        }

        // ============================
        // MASTERS (throttled)
        // ============================
        // This is the key fix to stop getQCBatchOptions/getProdBatchOptions storms.
        refreshMastersSafely_();

        window.isHeavyDataLoaded = true;
        window.__opDataLastAt = Date.now();

        // ✅ Safe button refresh
        requestAnimationFrame(() => {
          safeUpdateQaqcActionButtons();
          safeUpdateRgbActionButtons();
        });

        // Analytics charts refresh if visible
        const anMod = document.getElementById('mod-analytics');
        if (anMod && anMod.classList.contains('active')) {
          if (typeof updateAnalyticsCharts === 'function') updateAnalyticsCharts();
        }

        console.log(`✅ Loaded ${rgbData?.length || 0} RGB rows.`);
        console.log(`✅ Loaded ${qcData?.length || 0} QC rows.`);

      } finally {
        window.__opDataInFlight = false;
      }
    })
    .withFailureHandler(err => {
      window.__opDataInFlight = false;
      console.error('Data Load Error:', err);
      alert('Heavy data load failed. Check Apps Script logs / execution transcript.');
    })
    .getOperationalData();
}

// -------------------------------
// QUICK LOAD: last N days only
// -------------------------------
function loadOperationalDataRecent(opts = {}) {
  const days = Number(opts.days || 30);
  const mode = opts.mode || 'full';
  const warmFull = !!opts.warmFull;

  if (window.__moveBusy || window.__opDataInFlight) return;
  if (typeof google === 'undefined' || !google.script?.run) return;

  window.__opDataInFlight = true;
  console.log(`⚡ Loading recent data (last ${days} days)...`);

  google.script.run
    .withSuccessHandler(function (res) {
      try {
        if (res && res.rgbData) rgbData = res.rgbData;
        if (res && res.qcData) qcData = res.qcData;

        normalizeMetaDefaults_(rgbData);
        normalizeMetaDefaults_(qcData);

        if (Array.isArray(rgbData)) normalizeRgbDefaults_(rgbData);
        if (Array.isArray(rgbData) && typeof buildNutrientManagerIndices === 'function') {
          buildNutrientManagerIndices();
        }
        if (typeof initNutrientManagerConfig === 'function') {
          initNutrientManagerConfig('Default');
        }
        if (Array.isArray(qcData) && typeof normalizeQCBatchField_ === 'function') {
          normalizeQCBatchField_(qcData);
        }

        if (mode === 'full') {
          if (typeof renderTable === 'function') renderTable('rgb');
          if (typeof setRgbFocus === 'function') setRgbFocus('metrics');
          if (typeof renderTable === 'function') renderTable('qaqc');
          if (typeof setQaqcFocus === 'function') setQaqcFocus('results');
          if (typeof renderResults === 'function') renderResults();
        } else if (mode === 'results') {
          if (typeof renderResults === 'function') renderResults();
        }

        window.isHeavyDataLoaded = true;
        window.__opDataLastAt = Date.now();

        if (warmFull) {
          setTimeout(() => {
            loadOperationalData({ mode: 'none', force: true, minIntervalMs: 0, reason: 'warm-full' });
          }, 1500);
        }
      } finally {
        window.__opDataInFlight = false;
      }
    })
    .withFailureHandler(err => {
      window.__opDataInFlight = false;
      console.error('Recent data load failed:', err);
    })
    .getOperationalDataRecent(days);
}



/**
 * ✅ Internal helper (kept local to this file) to standardize batch field.
 * IMPORTANT: does NOT remove existing fields; only ensures r.qcBatchId is present.
 */
function normalizeQCBatchField_(rows) {
  rows.forEach(r => {
    if (!r) return;

    // if already present, keep it
    let b = (r.qcBatchId ?? '').toString().trim();

    // otherwise try common alternates
    if (!b) b = (r.QC_Batch ?? '').toString().trim();
    if (!b) b = (r.qcBatch ?? '').toString().trim();
    if (!b) b = (r.batch ?? '').toString().trim();

    r.qcBatchId = b || 'Default';
  });
}

// --- DEVICE DROPDOWN FIX ---
function updateDeviceDropdown() {
  const sel = document.getElementById('an-device');
  if (!sel) return;

  const currentVal = (sel.value || '').trim(); // capture before overwrite

  // Unique, trimmed, sorted device IDs
  const devices = [...new Set(
    (rgbData || [])
      .map(d => String(d?.did || '').trim())
      .filter(d => d !== '')
  )].sort();

  if (devices.length === 0) {
    sel.innerHTML = '<option value="">No devices found</option>';
    return;
  }

  sel.innerHTML =
    `<option value="">All devices</option>` +
    devices.map(d => `<option value="${d}">${d}</option>`).join('');

  // Preserve selection if still valid; otherwise reset to All devices
  if (currentVal && devices.includes(currentVal)) sel.value = currentVal;
  else sel.value = '';
}


// --- ZOOM LOGIC (Manual Buttons) ---
// factor > 1 zooms IN (smaller range), factor < 1 zooms OUT (larger range)
function zoomChart(chartName, axis, factor) {
    let chart;
    if (chartName === 'trend') chart = trendChart;
    if (chartName === 'modal') chart = modalChart;
    
    if (!chart) return;

    const scales = [];
    if (axis.includes('x')) scales.push(chart.scales.x);
    if (axis.includes('y')) scales.push(chart.scales.y);

    scales.forEach(scale => {
        const min = scale.min;
        const max = scale.max;
        
        // If range is invalid (auto), try to derive from data limits
        if (min === undefined || max === undefined) return;

        const range = max - min;
        const newRange = range / factor; // Zoom In = smaller range
        const center = min + (range / 2);

        scale.options.min = center - (newRange / 2);
        scale.options.max = center + (newRange / 2);
    });

    chart.update();
}

function resetZoom(chartName) {
    let chart;
    if (chartName === 'trend') chart = trendChart;
    if (chartName === 'modal') chart = modalChart;
    
    if (!chart) return;

    // Resetting to null forces Chart.js to re-calculate auto limits
    if (chart.options.scales.x) {
        chart.options.scales.x.min = null;
        chart.options.scales.x.max = null;
    }
    if (chart.options.scales.y) {
        chart.options.scales.y.min = null;
        chart.options.scales.y.max = null;
    }
    chart.update();
}





function showLoadingState() {
    const loadingRow = `<tr><td colspan="15" style="padding:40px; text-align:center; color:#666;">
        <div style="font-size:1.2rem; font-weight:bold; margin-bottom:10px;">Loading Tool...</div>
        <div>Connecting to database...</div>
    </td></tr>`;
    
    const tables = ['#tbl-rgb-metrics tbody', '#tbl-qaqc-metrics tbody', '#body-results'];
    tables.forEach(sel => {
        const el = document.querySelector(sel);
        if(el) el.innerHTML = loadingRow;
    });
}


// Registry Helper to match array from sheet to object
function mapRegistryRow(row) {
    if (!row) return {};

    if (Array.isArray(row)) {
      // FIX: Wrap values in String() to ensure .toLowerCase() always works
      return {
          client: String(row[0] ?? ''), 
          company: String(row[1] ?? ''), 
          pan: String(row[2] ?? ''), 
          gstin: String(row[3] ?? ''), 
          address: String(row[4] ?? ''),
          did: String(row[5] ?? ''), // <--- Critical Fix: Forces Device ID to be a string
          sim: String(row[6] ?? ''), 
          aadhaar: String(row[7] ?? ''), 
          mobile: String(row[8] ?? ''), 
          moName: String(row[9] ?? ''),
          date: (row[10] ?? '') ? formatDateForInput(row[10]) : '', 
          place: String(row[11] ?? ''), 
          gps: String(row[12] ?? ''),
          pin: String(row[13] ?? ''), 
          block: String(row[14] ?? ''), 
          district: String(row[15] ?? ''), 
          state: String(row[16] ?? ''),
          prodBatchId: String(row[17] ?? '')
      };
    }

    if (typeof row === 'object') {
      const pick = (keys) => pickField_(row, keys, '');
      const lat = pick(['lat', 'latitude', 'gps_lat', 'gpslat']);
      const lng = pick(['lng', 'lon', 'longitude', 'gps_lng', 'gpslng']);
      let gps = pick(['gps', 'coordinates', 'latlong', 'latlon', 'lat_lon']);
      if (!gps && lat && lng) {
        gps = `${lat}, ${lng}`;
      }
      return {
        client: String(pick(['client', 'client_name', 'clientname', 'owner']) ?? ''),
        company: String(pick(['company', 'company_name', 'companyname']) ?? ''),
        pan: String(pick(['pan']) ?? ''),
        gstin: String(pick(['gstin', 'gst']) ?? ''),
        address: String(pick(['address', 'addr']) ?? ''),
        did: String(pick(['device_id', 'deviceid', 'did']) ?? ''),
        sim: String(pick(['sim', 'sim_no', 'simno']) ?? ''),
        aadhaar: String(pick(['aadhaar', 'aadhar']) ?? ''),
        mobile: String(pick(['mobile', 'mobile_no', 'phone']) ?? ''),
        moName: String(pick(['mo_name', 'moname', 'officer']) ?? ''),
        date: (pick(['date', 'install_date', 'installation_date', 'registration_date']) ?? '') ? formatDateForInput(pick(['date', 'install_date', 'installation_date', 'registration_date'])) : '',
        place: String(pick(['place', 'location']) ?? ''),
        gps: String(gps ?? ''),
        pin: String(pick(['pin', 'pincode']) ?? ''),
        block: String(pick(['block']) ?? ''),
        district: String(pick(['district']) ?? ''),
        state: String(pick(['state']) ?? ''),
        prodBatchId: String(pick(['prodbatch_id', 'prodbatchid', 'prod_batch_id', 'prod_batch', 'prodBatchId']) ?? '')
      };
    }

    return {};
}


// 🔁 AUTO-LOAD when page opens
document.addEventListener('DOMContentLoaded', function () {
    console.log('DOM ready...');

    console.log('🔎 Metric bindings:', {
  typeof_calcMetric: (typeof calcMetric),
  typeof_window_calcMetric: (typeof window.calcMetric)
});


    // 1. Setup Analytics Dropdowns & Toggles (NEW)
    // This fills the "All devices" and "X Axis" lists immediately
    if (typeof initAnalyticsUI === 'function') {
        initAnalyticsUI(); 
    }

    // 2. Load Data from Server
    loadInitialData();
});





function getAllQCBatches() {
  const set = new Set();

  // A) From QC_Batch master in memory (Database module master table)
  try {
    const rows = window.dbMasters?.qc?.rows;
    if (Array.isArray(rows)) {
      rows.forEach(r => {
        const b = String(r?.QCBatch_ID ?? '').trim();
        if (b) set.add(b);
      });
    }
  } catch (e) {}

  // B) From masterLists cache in memory (if already loaded)
  try {
    const ml = window.masterLists;
    if (ml && Array.isArray(ml.qcBatchIds)) {
      ml.qcBatchIds.forEach(x => {
        const b = String(x || '').trim();
        if (b) set.add(b);
      });
    }
  } catch (e) {}

  // C) From QC criteria table (Database -> QC_Criteria)
  if (Array.isArray(qcCriteriaData)) {
    qcCriteriaData.forEach(r => {
      const b = String(r?.batch ?? r?.qcBatchId ?? r?.QC_Batch ?? '').trim();
      if (b) set.add(b);
    });
  }

  // D) From actual QC rows (QC_Data loaded into qcData)
  if (Array.isArray(qcData)) {
    qcData.forEach(r => {
      const b = (typeof readQCBatch === 'function')
        ? String(readQCBatch(r) || '').trim()
        : String(r?.qcBatchId ?? r?.QC_Batch ?? r?.QCBatch_ID ?? '').trim();
      if (b) set.add(b);
    });
  }

  // Always include Default
  set.add('Default');

  // Default first, then alpha
  const arr = Array.from(set).map(x => String(x).trim()).filter(Boolean);
  arr.sort((a, b) => (a === 'Default' ? -1 : b === 'Default' ? 1 : a.localeCompare(b)));
  return arr;
}




function formatDate(str) {
    if (!str) return "2025-01-01 | 12:00 AM";
    let s = str.trim().replace(/['"]/g, '');
    let match = s.match(/(\d{1,2})[-/](\d{1,2})[-/](\d{4})/);
    let matchISO = s.match(/(\d{4})[-/](\d{1,2})[-/](\d{1,2})/);
    let yyyy, mm, dd;
    if (matchISO) {
        yyyy = matchISO[1]; mm = matchISO[2].padStart(2,'0'); dd = matchISO[3].padStart(2,'0');
    } else if (match) {
        dd = match[1].padStart(2,'0'); mm = match[2].padStart(2,'0'); yyyy = match[3];
    } else {
        return s;
    }
    let timePart = "12:00 AM";
    let timeMatch = s.match(/(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?/i);
    if (timeMatch) {
        let hh = parseInt(timeMatch[1]);
        let min = timeMatch[2];
        let ampm = timeMatch[4] ? timeMatch[4].toUpperCase() : (hh >= 12 ? 'PM' : 'AM');
        if(!timeMatch[4] && hh > 12) { hh -= 12; ampm = 'PM'; }
        if(hh === 0) hh = 12;
        timePart = `${String(hh).padStart(2,'0')}:${min} ${ampm}`;
    }
    return `${yyyy}-${mm}-${dd} | ${timePart}`;
}
function parseDateObj(dateStr) {
    if(!dateStr) return null;
    let parts = dateStr.split('|')[0].trim().split('-');
    if(parts.length < 3) return null;
    return new Date(`${parts[0]}-${parts[1]}-${parts[2]}`);
}

function getParamBand(key) {
    const c = cols.find(c => c.k === key);
    return c ? c.b : 'K';
}

function getBandColor(paramKeyOrBand, alpha) {
    const a = (alpha === undefined ? 1 : alpha);
    let band;
    if (['R','G','B','K'].includes(paramKeyOrBand)) band = paramKeyOrBand;
    else band = getParamBand(paramKeyOrBand);
    if (band === 'R') return `rgba(231, 76, 60, ${a})`;
    if (band === 'G') return `rgba(39, 174, 96, ${a})`;
    if (band === 'B') return `rgba(52, 152, 219, ${a})`;
    return `rgba(44, 62, 80, ${a})`;
}

/* Quantile helper for IQR */
function quantile(sortedArr, q) {
    if (!sortedArr.length) return NaN;
    const pos = (sortedArr.length - 1) * q;
    const base = Math.floor(pos);
    const rest = pos - base;
    if (sortedArr[base + 1] !== undefined) {
        return sortedArr[base] + rest * (sortedArr[base + 1] - sortedArr[base]);
    }
    return sortedArr[base];
}


function formatDateForInput(dateVal) {
    if (!dateVal) return '';
    // If it's already a YYYY-MM-DD string, return it as-is
    if (typeof dateVal === 'string') {
        const trimmed = dateVal.trim();
        if (/^\d{4}-\d{2}-\d{2}$/.test(trimmed)) return trimmed;
        const parsed = new Date(trimmed);
        if (!Number.isNaN(parsed.getTime())) {
            const y = parsed.getFullYear();
            const m = String(parsed.getMonth() + 1).padStart(2, '0');
            const d = String(parsed.getDate()).padStart(2, '0');
            return `${y}-${m}-${d}`;
        }
        return trimmed.substring(0, 10);
    }
    // If it's a Date object from Google Sheets
    try {
        const d = new Date(dateVal);
        if (Number.isNaN(d.getTime())) return '';
        const y = d.getFullYear();
        const m = String(d.getMonth() + 1).padStart(2, '0');
        const day = String(d.getDate()).padStart(2, '0');
        return `${y}-${m}-${day}`;
    } catch (e) {
        return '';
    }
}





/* Plugins */

/* Absorbance trend red zones: Abs < 0.015 (faint), Abs < 0 (darker) */
const redZonePlugin = {
    id: 'redZonePlugin',
    beforeDraw(chart, args, opts) {
        const yScale = chart.scales.y;
        const ca = chart.chartArea;
        if (!yScale || !ca) return;
        const {top, bottom, left, right} = ca;
        let y0, y015;
        try {
            y0 = yScale.getPixelForValue(0);
            y015 = yScale.getPixelForValue(0.015);
        } catch (e) { return; }

        const ctx = chart.ctx;
        ctx.save();

        if (!isNaN(y0) && !isNaN(y015)) {
            const yTop = Math.min(y0, y015);
            const yBot = Math.max(y0, y015);
            if (yTop < bottom && yBot > top) {
                ctx.fillStyle = 'rgba(231, 76, 60, 0.08)';
                ctx.fillRect(left, Math.max(top, yTop), right - left, Math.min(bottom, yBot) - Math.max(top, yTop));
            }
        }

        if (!isNaN(y0)) {
            const yStart = Math.max(y0, top);
            if (yStart < bottom) {
                ctx.fillStyle = 'rgba(231, 76, 60, 0.16)';
                ctx.fillRect(left, yStart, right - left, bottom - yStart);
            }
        }

        ctx.restore();
    }
};

/* Vertical lines for QC histogram */
const verticalLinesPlugin = {
    id: 'verticalLinesPlugin',
    afterDraw(chart, args, opts) {
        const options = opts || {};
        const values = options.values || [];
        const colors = options.colors || [];
        const widths = options.widths || [];
        const dashes = options.dashes || [];
        const xScale = chart.scales.x;
        const ca = chart.chartArea;
        if (!xScale || !ca) return;
        const {top, bottom} = ca;
        const ctx = chart.ctx;
        ctx.save();
        values.forEach((v, i) => {
            if (v == null || isNaN(v)) return;
            const xPos = xScale.getPixelForValue(v);
            if (xPos < ca.left || xPos > ca.right) return;
            ctx.beginPath();
            const dash = dashes[i] || [4,4];
            ctx.setLineDash(dash);
            ctx.lineWidth = widths[i] || 1;
            ctx.strokeStyle = colors[i] || 'rgba(52, 73, 94, 0.9)';
            ctx.moveTo(xPos, top);
            ctx.lineTo(xPos, bottom);
            ctx.stroke();
        });
        ctx.restore();
    }
};

// CSV IMPORT
/**
 * client_ImportCSV_CreateRGBData
 * 
 * Handles CSV file selection and upload to the server.
 * Connects directly to backend: srvr_CreateRGBData_ImportCSV_appendtoRGB_dedup
 */
function client_ImportCSV_CreateRGBData(fileInput) {
    const file = fileInput && fileInput.files && fileInput.files[0];
    if (!file) return;

    // Optional: UI feedback (safe even if elements don't exist)
    const statusEl = document.getElementById('importStatus') || null;
    const setStatus = (msg) => { if (statusEl) statusEl.textContent = msg; };

    setStatus('Reading CSV...');

    const reader = new FileReader();
    reader.onload = () => {
        try {
            const csvText = String(reader.result || '');
            if (!csvText.trim()) {
                alert('CSV file appears empty.');
                setStatus('');
                return;
            }

            setStatus('Uploading & importing (server)...');

            google.script.run
                .withSuccessHandler((res) => {
                    // res is expected to be: { addedCount, skippedCount, errorCount, errors? }
                    const added = (res && res.addedCount) || 0;
                    const skipped = (res && res.skippedCount) || 0;
                    const errCount = (res && res.errorCount) || 0;

                    const msg = `Import complete. Added: ${added}, Skipped (dedup): ${skipped}, Errors: ${errCount}`;
                    setStatus(msg);

                    // Clear file input so same file can be re-selected if needed
                    try { fileInput.value = ''; } catch (e) {}

                    // Refresh operational data and redraw tables (matches your 1b flow)
                    if (typeof loadOperationalData === 'function') {
                        loadOperationalData();
                    } else if (typeof renderTable === 'function') {
                        renderTable('rgb');
                    }
                })
                .withFailureHandler((err) => {
                    console.error('Import failed:', err);
                    alert('Import failed: ' + (err && err.message ? err.message : err));
                    setStatus('Import failed.');
                })
                .srvr_CreateRGBData_ImportCSV_appendtoRGB_dedup({ csvText: csvText });
        } catch (e) {
            console.error(e);
            alert('Import error: ' + e.message);
            setStatus('Import error.');
        }
    };

    reader.onerror = () => {
        alert('Failed to read CSV file.');
        setStatus('Failed to read file.');
    };

    reader.readAsText(file);
}

function refreshRgbCalculatedMetrics() {
    if (typeof loadOperationalData === 'function') {
        loadOperationalData();
    }
    if (typeof renderTable === 'function') {
        renderTable('rgb');
    }
    if (typeof setRgbFocus === 'function') {
        setRgbFocus('metrics');
    }
}

function buildCsv(headers, rows) {
  const headerLine = headers.map(v => `"${String(v).replaceAll('"','""')}"`).join(',');
  const lines = rows.map(row => row.map(v => `"${String(v ?? '').replaceAll('"','""')}"`).join(','));
  return [headerLine, ...lines].join('\\n');
}

function escapeHtml(value) {
  return String(value ?? '')
    .replaceAll('&', '&amp;')
    .replaceAll('<', '&lt;')
    .replaceAll('>', '&gt;')
    .replaceAll('"', '&quot;')
    .replaceAll("'", '&#39;');
}


function fmt3(x) {
  const n = Number(x);
  return Number.isFinite(n) ? n.toFixed(3) : '0.000';
}



function getSTV(rowOrRaw, key) {
  // Accept either row.raw OR row object OR raw object
  const raw = (rowOrRaw && rowOrRaw.raw && typeof rowOrRaw.raw === 'object')
    ? rowOrRaw.raw
    : rowOrRaw;

  const metricVal = calcMetric(raw, key);
  if (metricVal == null) return null;

  const stv = stvData.find(s => s.p === key);
  if (!stv) return metricVal;

  // Keep your existing scaling logic
  const a = Number(stv.a);
  const b = Number(stv.b);

  if (Number.isFinite(a) && Number.isFinite(b)) {
    return (metricVal * a) + b;
  }

  return metricVal;
}



function getBandClass(b) {
    if(b==='R') return 'text-red';
    if(b==='G') return 'text-green';
    if(b==='K') return 'text-black';
    return 'text-blue';
}

// QC CRITERIA / STATUS
function getQCCriteriaForParam(paramKey, batchId) {
    const targetBatch = String(batchId || currentQCBatchId || 'Default').trim() || 'Default';
    const candidates = qcCriteriaData.filter(q => q.p === paramKey);
    if (candidates.length === 0) return null;
    const byBatch = candidates.find(q =>
      String(q.batch || q.qcBatchId || q.QCBatch_ID || 'Default').trim() === targetBatch
    );
    return byBatch || candidates[0];
}


function computeAutoQCStatus(row) {
    let status = 'PASS';
    const batchId = getQCBatchIdFromRow(row);
    cols.forEach(c => {
        const val = parseFloat(calcMetric(row.raw, c.k));
        const criteria = getQCCriteriaForParam(c.k, batchId);
        if (criteria) {
            if (val < criteria.min || val > criteria.max) status = 'FAIL';
        }
    });
    return status;
}


function getEffectiveQCStatusForDevice(deviceId, autoStatus) {
    if (qcManualOverrideEnabled[deviceId] && qcManualStatus[deviceId]) {
        return qcManualStatus[deviceId];
    }
    return autoStatus;
}



// TEST SUCCESS
function evaluateTestSuccess(row) {
    let anyFail = false;
    dbCriteria.forEach(rule => {
        const rawObj = row.raw[rule.p];
        if (!rawObj) return;
        let val = parseFloat(calcMetric(row.raw, rule.p));
        const blank = blankData.find(b => b.p === rule.p)?.val || 0;
        const finalVal = val - blank;
        let fail = false;
        if (rule.rel === 'between') {
            if (finalVal >= rule.l && finalVal <= rule.u) fail = true;
        } else if (rule.rel === '<') {
            if (finalVal < rule.u) fail = true;
        } else if (rule.rel === '>') {
            if (finalVal > rule.l) fail = true;
        } else if (rule.rel === '=') {
            if (finalVal == rule.l) fail = true;
        }
        if (fail) anyFail = true;
    });
    return anyFail ? 'FAIL' : 'PASS';
}

// === Leaflet Map for Map View ===
var mapInstance = null;
var mapMarkersLayer = null;

// === Leaflet map for Device Installation locations ===
var installMap = null;
var installMarkersLayer = null;


function ensureLeafletMap() {
    const container = document.getElementById('map-container');
    if (!container) return;

    if (mapInstance) {
        // In case container size changed
        setTimeout(() => mapInstance.invalidateSize(), 50);
        return;
    }

    // Center roughly on India
    mapInstance = L.map('map-container').setView([22.5, 78.5], 5);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(mapInstance);

    mapMarkersLayer = L.layerGroup().addTo(mapInstance);
}


function ensureInstallMap() {
    const container = document.getElementById('map-container');
    if (!container) return;

    if (installMap) {
        // If map already exists, just fix size after layout changes
        setTimeout(() => installMap.invalidateSize(), 50);
        return;
    }

    // Center on India by default
    installMap = L.map('map-container').setView([22.5, 78.5], 5);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(installMap);

    installMarkersLayer = L.layerGroup().addTo(installMap);
}

// Parse "28.613900 N, 77.209000 E" → { lat: 28.6139, lng: 77.209 }
// Parse "28.6139, 77.2090" OR "28.6139 N, 77.2090 E"
// Parse "28.61, 77.20" OR "28.61 N, 77.20 E"
function parseLatLonString(latlonStr) {
    if (!latlonStr) return null;
    const cleaned = latlonStr.trim();

    // 1. Try "29.135292, 75.976476"
    if (/^-?\d+(\.\d+)?\s*,\s*-?\d+(\.\d+)?$/.test(cleaned)) {
        const parts = cleaned.split(',').map(s => parseFloat(s.trim()));
        if (!isNaN(parts[0]) && !isNaN(parts[1])) return { lat: parts[0], lng: parts[1] };
    }

    // 2. Try "29.13 N, 75.97 E"
    const m = cleaned.match(/^(-?\d+(?:\.\d+)?)[\s°]*([NnSs])\s*[;,]?\s*(-?\d+(?:\.\d+)?)[\s°]*([EeWw])$/);
    if (m) {
        let lat = parseFloat(m[1]), lng = parseFloat(m[3]);
        if (m[2].toUpperCase() === 'S') lat = -lat;
        if (m[4].toUpperCase() === 'W') lng = -lng;
        return { lat, lng };
    }
    return null;
}

// ===== Devices Dashboard (Results-only) =====
const REQUIRED_RGB_HEADERS = [
    'NH4N_S1_B_T','NH4N_S1_B_C','B_S1_B_T','B_S1_B_C','Cu_S2_R_T','Cu_S2_R_C',
    'EC_S0_R_T','EC_S0_R_C','Fe_S2_G_T','Fe_S2_G_C','Mn_S2_G_T','Mn_S2_G_C',
    'NO3N_S1_G_T','NO3N_S1_G_C','OC_S1_G_T','OC_S1_G_C','pH_S0_R_T','pH_S0_R_C',
    'P_S1_B_T','P_S1_B_C','K_S2_B_T','K_S2_B_C','S_S1_B_T','S_S1_B_C',
    'ZnCu_S2_R_T','ZnCu_S2_R_C'
];

function getRowTestDateObj(row) {
    const raw = row?.Test_date ?? row?.time ?? row?.Date ?? row?.datetime ?? row?.test_date ?? '';
    return parseDateObj(raw);
}

function isMissingRgbFields(row) {
    if (!row || !row.raw) return true;
    return REQUIRED_RGB_HEADERS.some(h => {
        const v = row.raw[h];
        return v === null || v === undefined || v === '';
    });
}

function buildDeviceDashboardStats(rows) {
    const byDevice = new Map();
    rows.forEach(row => {
        const did = String(row?.Device_ID ?? row?.did ?? row?.device_id ?? '').trim();
        if (!did) return;
        if (!byDevice.has(did)) byDevice.set(did, []);
        byDevice.get(did).push(row);
    });

    const stats = new Map();
    byDevice.forEach((deviceRows, did) => {
        const withDates = deviceRows
            .map(r => ({ row: r, d: getRowTestDateObj(r) }))
            .filter(x => x.d instanceof Date && !isNaN(x.d.getTime()))
            .sort((a, b) => a.d - b.d);

        if (withDates.length === 0) {
            stats.set(did, { status: 'NO DATA', missingRgb: true, avgGapDays: null });
            return;
        }

        const missingRgb = withDates.some(x => isMissingRgbFields(x.row));
        const dayMap = new Map();
        withDates.forEach(item => {
            const d = item.d;
            const key = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;
            if (!dayMap.has(key)) dayMap.set(key, []);
            dayMap.get(key).push(item);
        });

        const dayKeys = Array.from(dayMap.keys()).sort();
        const latestDayKey = dayKeys[dayKeys.length - 1];
        const latestDayRows = dayMap.get(latestDayKey)
            .sort((a, b) => a.d - b.d)
            .map(x => x.row);

        const dailyFails = latestDayRows.filter(r => evaluateTestSuccess(r) === 'FAIL').length;
        const thirdRow = latestDayRows[2];
        const thirdStatus = thirdRow ? evaluateTestSuccess(thirdRow) : null;

        let status = 'WARNING';
        if (missingRgb) {
            status = 'CRITICAL';
        } else if (dailyFails > 2) {
            status = 'ATTENTION';
        } else if (thirdStatus === 'FAIL') {
            status = 'ATTENTION';
        } else if (thirdStatus === 'PASS') {
            status = 'NORMAL';
        }

        const gaps = [];
        for (let i = 1; i < withDates.length; i++) {
            const diffMs = withDates[i].d - withDates[i - 1].d;
            const diffDays = diffMs / (1000 * 60 * 60 * 24);
            if (Number.isFinite(diffDays) && diffDays >= 0) gaps.push(diffDays);
        }
        const avgGapDays = gaps.length ? (gaps.reduce((a, b) => a + b, 0) / gaps.length) : null;

        stats.set(did, {
            status,
            missingRgb,
            avgGapDays,
            latestDayFails: dailyFails,
            latestDayThirdStatus: thirdStatus
        });
    });
    return stats;
}

function summarizeLocationStatus(entries) {
    const order = { CRITICAL: 3, ATTENTION: 2, WARNING: 1, NORMAL: 0, 'NO DATA': -1 };
    let best = 'NO DATA';
    entries.forEach(entry => {
        const status = entry.status || 'NO DATA';
        if ((order[status] ?? -1) > (order[best] ?? -1)) best = status;
    });
    return best;
}

function statusToColor(status) {
    switch (status) {
        case 'CRITICAL': return '#e11d48';
        case 'ATTENTION': return '#f97316';
        case 'NORMAL': return '#16a34a';
        case 'WARNING': return '#f59e0b';
        default: return '#6b7280';
    }
}


/**
 * Build the Map View table + markers from the Device Installation Registry.
 * Uses the lat/lng stored on the GPS input (.reg-gps) as data-lat / data-lng.
 */
function renderMapView() {
    // 1. Initialize Map (if needed)
    if (typeof L === 'undefined') return;
    
    var container = document.getElementById('map-container');
    if (!container) return;

    if (!mapInstance) {
        console.log("Creating Map Instance...");
        mapInstance = L.map('map-container').setView([22.5, 78.5], 5);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '© OpenStreetMap, © CARTO',
            maxZoom: 20
        }).addTo(mapInstance);
        mapMarkersLayer = L.layerGroup().addTo(mapInstance);
    } else {
        // Essential for split-panes: Force map to relearn its size
        mapInstance.invalidateSize(); 
    }

    // 2. Read Registry Rows & Plot Markers
    mapMarkersLayer.clearLayers();
    var markerPoints = [];
    var locationMap = new Map();
    const deviceStats = buildDeviceDashboardStats(rgbData || []);
    
    // We read directly from the inputs in the table you just built
    var rows = document.querySelectorAll('#body-device-registry tr');

    rows.forEach(function(row) {
        var clientInput = row.querySelector('.reg-client');
        var didInput    = row.querySelector('.reg-did');
        var gpsInput    = row.querySelector('.reg-gps');
        var mobileInput = row.querySelector('.reg-mobile');
        var moNameInput = row.querySelector('.reg-moName');
        var placeInput  = row.querySelector('.reg-place');

        if (!clientInput || !gpsInput) return;

        var client = clientInput.value || "Unknown";
        var did    = didInput ? didInput.value : "";
        var mobile = mobileInput ? mobileInput.value : "";
        var moName = moNameInput ? moNameInput.value : "";
        var place  = placeInput ? placeInput.value : "";

        if (registryMapSearchTerm && !matchesRegistrySearch({
            client,
            did,
            mobile,
            moName,
            place
        }, registryMapSearchTerm)) {
            return;
        }
        var gps    = gpsInput.value;
        
        var coords = parseLatLonString(gps);
        
        // Fallback to hidden dataset if text is empty (from autocomplete)
        if (!coords && gpsInput.dataset.lat) {
            coords = {
                lat: parseFloat(gpsInput.dataset.lat),
                lng: parseFloat(gpsInput.dataset.lng)
            };
        }

        if (coords && !isNaN(coords.lat)) {
            const key = `${coords.lat.toFixed(6)},${coords.lng.toFixed(6)}`;
            if (!locationMap.has(key)) {
                locationMap.set(key, { coords, entries: [] });
            }
            locationMap.get(key).entries.push({
                client,
                did,
                moName,
                mobile,
                address: row.querySelector('.reg-address')?.value || '',
                ...(deviceStats.get(did) || {})
            });
        }
    });

    locationMap.forEach(({ coords, entries }) => {
        const status = summarizeLocationStatus(entries);
        const markerColor = statusToColor(status);
        var m = L.circleMarker([coords.lat, coords.lng], {
            radius: 8,
            color: markerColor,
            fillColor: markerColor,
            fillOpacity: 0.85,
            weight: 2
        }).addTo(mapMarkersLayer);
        m.bindPopup(buildRegistryPopup(entries));
        markerPoints.push([coords.lat, coords.lng]);
    });

    // 3. Fit Bounds (only if markers exist)
    if (markerPoints.length > 0) {
        // Debounce fitting to avoid erratic jumping
        if (!window.mapFitTimeout) {
            window.mapFitTimeout = setTimeout(function() {
                mapInstance.fitBounds(markerPoints, { padding: [50, 50], maxZoom: 15 });
                window.mapFitTimeout = null;
            }, 500);
        }
    }
    
    // 4. Force Resize to prevent gray box
    setTimeout(function(){ mapInstance.invalidateSize(); }, 200);

    const mapSearchInput = document.getElementById('registry-search-map');
    if (mapSearchInput && mapSearchInput.value !== registryMapSearchTerm) {
        mapSearchInput.value = registryMapSearchTerm;
    }
}

function buildRegistryPopup(entries) {
    if (!entries || entries.length === 0) return '';
    let html = `<div style="font-weight:700; margin-bottom:6px;">Installation Registry</div>`;
    html += `<table class="map-popup-table"><thead><tr>
        <th>Client</th><th>MO Name</th><th>Mobile</th><th>Device ID</th><th>Address</th>
      </tr></thead><tbody>`;
    entries.forEach(entry => {
        html += `<tr>
          <td>${escapeHtml(entry.client || '')}</td>
          <td>${escapeHtml(entry.moName || '')}</td>
          <td>${escapeHtml(entry.mobile || '')}</td>
          <td>${escapeHtml(entry.did || '')}</td>
          <td>${escapeHtml(entry.address || '')}</td>
        </tr>`;
    });
    html += `</tbody></table>`;
    if (entries.some(entry => entry.status)) {
        html += `<div style="margin-top:8px; font-size:0.85rem;">`;
        entries.forEach(entry => {
            const status = entry.status || 'NO DATA';
            const gap = Number.isFinite(entry.avgGapDays) ? `${entry.avgGapDays.toFixed(1)} days` : 'n/a';
            const miss = entry.missingRgb ? 'Yes' : 'No';
            html += `<div style="margin-top:4px;">
              <strong>${escapeHtml(entry.did || 'Device')}</strong>: ${escapeHtml(status)}
              <span style="color:#6b7280;">(Missing RGB: ${miss} · Avg gap: ${gap})</span>
            </div>`;
        });
        html += `</div>`;
    }
    return html;
}

// Helper Function
function panMapTo(lat, lng, txt) {
    if(mapInstance) {
        mapInstance.setView([lat, lng], 15);
        L.popup().setLatLng([lat, lng]).setContent(txt).openOn(mapInstance);
    }
}


/* ================================
   INSTALLATION REGISTRY VALIDATION
   ================================ */

function validateRegistryField(input) {
    const field = input.dataset.field;
    let v = input.value;

    function autoCapitalizeFirst(s) {
        if (!s) return "";
        return s.charAt(0).toUpperCase() + s.slice(1);
    }

    switch (field) {

        /* Alphabetic + special; first letter capital */
        case "customer":
        case "state":
        case "district":
        case "block":
        case "mo":
        case "location":
            v = v.replace(/[^A-Za-z .,'-]/g, "");   // allow alphabet + special
            v = autoCapitalizeFirst(v);
            break;

        /* Address: alphanumeric + special, capital first letter */
        case "address":
            v = v.replace(/[^A-Za-z0-9 .,#'/-]/g, "");
            v = autoCapitalizeFirst(v);
            break;

        /* PAN: exactly 10 alphanumeric, upper case */
        case "pan":
            v = v.replace(/[^A-Za-z0-9]/g, "").toUpperCase();
            v = v.slice(0, 10); 
            break;

        /* GSTIN: exactly 15 characters, upper case */
        case "gstin":
            v = v.replace(/[^A-Za-z0-9]/g, "").toUpperCase();
            v = v.slice(0, 15);
            break;

        /* Company: alphanumeric + special, ALL CAPS */
        case "company":
            v = v.replace(/[^A-Za-z0-9 .,'/-]/g, "").toUpperCase();
            break;

        /* Aadhaar: numeric, exactly 12 digits */
        case "aadhaar":
            v = v.replace(/\D/g, "");
            v = v.slice(0, 12);
            break;

        /* Mobile: numeric, always +91 prefix, total 13 chars */
        case "mobile":
            v = v.replace(/\D/g, "");
            if (!v.startsWith("91")) v = "91" + v; // enforce prefix
            v = "+" + v;                           // convert to +91xxxxx
            v = v.slice(0, 13);
            break;

        /* Device ID: numeric, exactly 15 digits */
        case "did":
            v = v.replace(/\D/g, "");
            v = v.slice(0, 15);
            break;

        /* SIM: numeric (19–22 chars allowed) */
        case "sim":
            v = v.replace(/\D/g, "");
            v = v.slice(0, 22);
            break;

        /* Date: yyyy-mm-dd */
        case "date":
            v = v.replace(/[^\d-]/g, "");
            if (v.length === 4 || v.length === 7) v += "-";
            v = v.slice(0, 10);
            break;

        /* LatLon: numeric + decimal, up to 10 decimal places */
        case "latlon":
            v = v.replace(/[^0-9., -]/g, "");
            break;

        /* PIN: numeric, exactly 6 digits */
        case "pin":
            v = v.replace(/\D/g, "");
            v = v.slice(0, 6);
            break;
    }

    input.value = v;
}


function getDeviceInstallDate(deviceId) {
    const entry = deviceRegistry.find(d => d.did === deviceId);
    if (!entry || !entry.date) return null;
    try {
        return new Date(entry.date);
    } catch(e) {
        return null;
    }
}


// === AUTO-FETCH IMPLEMENTATION ===

// Helper to check if user is currently editing Admin/DB tabs
function isUserEditing() {
    const activeModule = document.querySelector('.module-view.active');
    // If user is in Database or Devices module, DO NOT refresh inputs to prevent overwriting
    if (activeModule && (activeModule.id === 'mod-db' || activeModule.id === 'mod-devices')) {
        return true;
    }
    return false;
}

// Refresh master lists at most once per 2 minutes (safe cadence)
setInterval(function () {
  // Only refresh masters if server exists
  const hasServer = (typeof google !== 'undefined' && google.script?.run);
  if (!hasServer) return;

  // If operational data call is already in flight, don't stack more calls
  if (window.__opDataInFlight) return;

  // This function already has its own single-flight promise guard (from earlier)
  loadMasterListsOnce(false);
}, 120000);



// TABLE RENDERERS
// Column model for Calculated Metrics table (flat data from sheet)
const METRIC_COLS_FLAT = [
  { k: "NH4N_Abs", label: "Ammonium-N" },
  { k: "P_Abs",    label: "Phosphorus" },
  { k: "S_Abs",    label: "Sulphur" },
  { k: "OC_Abs",   label: "Organic Carbon" },
  { k: "NO3N_Abs", label: "Nitrate-N" },
  { k: "B_Abs",    label: "Boron" },
  { k: "K_Abs",    label: "Potassium" },
  { k: "Cu_Abs",   label: "Copper" },
  { k: "ZnCu_Abs", label: "ZincCopper" },
  { k: "Fe_Abs",   label: "Iron" },
  { k: "Mn_Abs",   label: "Manganese" },
  { k: "EC_Val",   label: "EC" },
  { k: "pH_Val",   label: "pH" },
];

// Stable ID builder (works for flat rows OR legacy rows)
function makeRowKeyAny(row) {
  const did  = row.Device_ID ?? row.did ?? "";
  const tid  = row.Test_ID   ?? row.tid ?? "";
  const dt   = row.Test_date ?? row.time ?? "";
  return `${String(did).trim()}|${String(tid).trim()}|${String(dt).trim()}`;
}

function formatDateCell(dVal) {
  if (!dVal) return "";
  const dObj = new Date(dVal);
  if (!isNaN(dObj)) {
    // show date+time to preserve identity alignment with sheet format
    return dObj.toLocaleString("en-GB");
  }
  return String(dVal);
}

function renderTable(tab) {
  if (tab !== "rgb" && tab !== "qaqc") return;

  const isRGB = tab === "rgb";
  const tableId = isRGB ? "tbl-rgb-metrics" : "tbl-qaqc-metrics";
  const table = document.getElementById(tableId);
  if (!table) return;

  const thead = table.querySelector("thead");
  const tbody = table.querySelector("tbody");
  if (!thead || !tbody) return;

  // Ensure pageState exists
  window.pageState = window.pageState || {};
  if (!pageState[tab] || pageState[tab] < 1) pageState[tab] = 1;

  // -------------------------------
  // SAFE HELPERS (LOCAL)
  // -------------------------------
  const normStr = (v) => String(v ?? "").trim();
  const lower = (v) => normStr(v).toLowerCase();

  const parseRowDate = (x) => {
    if (!x) return null;
    if (x instanceof Date) return isNaN(x.getTime()) ? null : x;

    const s0 = normStr(x);
    if (!s0) return null;

    const s = s0.includes("|") ? s0.replace(/\s*\|\s*/g, " ") : s0;

    const d1 = new Date(s);
    if (!isNaN(d1.getTime())) return d1;

    const m = s0.match(/^(\d{4}-\d{2}-\d{2})/);
    if (m) {
      const d2 = new Date(m[1]);
      if (!isNaN(d2.getTime())) return d2;
    }
    return null;
  };

  const dateOnly = (d) => {
    const x = new Date(d);
    x.setHours(0, 0, 0, 0);
    return x;
  };

  const toNum = (v) => {
    const n = (typeof v === "number") ? v : Number(v);
    return Number.isFinite(n) ? n : null;
  };

  const fmt2 = (v) => {
    const n = toNum(v);
    return (n == null) ? "" : n.toFixed(2);
  };

  // Metric getter:
  const getMetricVal = (row, key) => {
    if (Object.prototype.hasOwnProperty.call(row, key) && row[key] !== "" && row[key] !== null && row[key] !== undefined) {
      return row[key];
    }

    const raw = row.raw || row.Raw || row.RAW || null;
    if (!raw) return "";

    const k = String(key || "").toLowerCase();
    try {
      if (k === "ph" || k === "ec") {
        if (typeof safeCalcMetric === "function") return safeCalcMetric(raw, k);
        if (typeof window?.calcMetric === "function") return window.calcMetric(raw, k);
        if (typeof calcMetric === "function") return calcMetric(raw, k);
        return "";
      }

      if (typeof getSTV === "function") {
        const v = getSTV(raw, k);
        return (v === null || v === undefined) ? "" : v;
      }

      if (typeof safeCalcMetric === "function") return safeCalcMetric(raw, k);
      if (typeof window?.calcMetric === "function") return window.calcMetric(raw, k);
      if (typeof calcMetric === "function") return calcMetric(raw, k);

      return "";
    } catch (e) {
      return "";
    }
  };

  // -------------------------------
  // FILTER INPUTS
  // -------------------------------
  const searchDev = lower(document.getElementById(isRGB ? "search-rgb-dev" : "search-qaqc-dev")?.value);
  const searchTest = lower(document.getElementById(isRGB ? "search-rgb-test" : "search-qaqc-test")?.value);

  const fromEl = document.getElementById(isRGB ? "date-rgb-from" : "date-qaqc-from");
  const toEl = document.getElementById(isRGB ? "date-rgb-to" : "date-qaqc-to");

  const dateFrom = fromEl?.valueAsDate || (fromEl?.value ? new Date(fromEl.value) : null);
  const dateTo = toEl?.valueAsDate || (toEl?.value ? new Date(toEl.value) : null);

  const src = isRGB ? (rgbData || []) : (qcData || []);
  const modKey = isRGB ? "rgb" : "qaqc";

  // Ensure every row has stable id (only if missing)
  for (let i = 0; i < src.length; i++) {
    const r = src[i];
    if (r && !r.id) {
      r.id = (typeof makeRowKeyAny === "function")
        ? makeRowKeyAny(r)
        : (normStr(r.Device_ID ?? r.did) + "__" + normStr(r.Test_ID ?? r.tid) + "__" + normStr(r.Test_date ?? r.time ?? ""));
    }
  }

  // -------------------------------
  // FILTER
  // -------------------------------
  let filtered = src.filter(row => {
    if (!row) return false;

    const devVal = lower(row.Device_ID ?? row.did);
    const testVal = lower(row.Test_ID ?? row.tid);

    if (searchDev && !devVal.includes(searchDev)) return false;
    if (searchTest && !testVal.includes(searchTest)) return false;

    if (dateFrom || dateTo) {
      const rowDateStr = row.Test_date ?? row.time ?? row.Date ?? row.datetime ?? "";
      const rowDate = parseRowDate(rowDateStr);
      if (!rowDate) return false;

      const cmp = dateOnly(rowDate);

      if (dateFrom) {
        const df = dateOnly(dateFrom);
        if (cmp < df) return false;
      }
      if (dateTo) {
        const dt = dateOnly(dateTo);
        if (cmp > dt) return false;
      }
    }
    return true;
  });

  // -------------------------------
  // PAGINATION
  // -------------------------------
  const perPage = (typeof ROWS_PER_PAGE === "number" && ROWS_PER_PAGE > 0) ? ROWS_PER_PAGE : 50;
  const totalRows = filtered.length;
  const maxPage = Math.ceil(totalRows / perPage) || 1;
  if (pageState[tab] > maxPage) pageState[tab] = maxPage;

  const startIdx = (pageState[tab] - 1) * perPage;
  const endIdx = Math.min(startIdx + perPage, totalRows);

  if (typeof setPaginationText === "function") {
    setPaginationText(tab, startIdx, endIdx, totalRows);
  }

  const pageData = filtered.slice(startIdx, endIdx);

  // -------------------------------
  // HEADER (MUST MATCH BODY COUNT)
  // -------------------------------
  const metricHeads = (Array.isArray(METRIC_COLS_FLAT) ? METRIC_COLS_FLAT : [])
    .map(c => `<th>${c.label}</th>`).join("");

  thead.innerHTML = `<tr>
    <th>QC</th>
    <th>Client_ID</th>
    <th>Farm_ID</th>
    <th>ProdBatch_ID</th>
    <th>QCBatch_ID</th>
    <th>Device_ID</th>
    <th>Test_ID</th>
    <th>Crop</th>
    <th>Test_date</th>
    ${metricHeads}
  </tr>`;

  // -------------------------------
  // BODY
  // -------------------------------
  tbody.innerHTML = "";

  const totalCols = 9 + ((METRIC_COLS_FLAT && METRIC_COLS_FLAT.length) ? METRIC_COLS_FLAT.length : 0);

  if (!pageData.length) {
    const tr = document.createElement("tr");
    const td = document.createElement("td");
    td.colSpan = totalCols;
    td.style.padding = "20px";
    td.style.color = "#777";
    td.style.textAlign = "center";
    td.textContent = "No matching records found";
    tr.appendChild(td);
    tbody.appendChild(tr);
    return;
  }

  // Ensure checkedRows exists
  window.checkedRows = window.checkedRows || { rgb: [], qaqc: [] };
  window.checkedRows.rgb = Array.isArray(window.checkedRows.rgb) ? window.checkedRows.rgb : [];
  window.checkedRows.qaqc = Array.isArray(window.checkedRows.qaqc) ? window.checkedRows.qaqc : [];

  // Use Set for fast membership tests
  const selectedSet = new Set((window.checkedRows[modKey] || []).map(v => String(v)));

  pageData.forEach(row => {
    const tr = document.createElement("tr");
    tr.dataset.id = String(row.id);

    if (typeof handleRowClick === "function") {
      tr.onclick = () => handleRowClick(modKey, row, tr);
    }

    const sId = String(row.id);
    const qcChecked = selectedSet.has(sId);

    // 1) QC tick (MUST be checkbox, never text)
    const tdQC = tr.insertCell();
    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.checked = qcChecked;

    // stop row click
    cb.addEventListener("click", function (e) {
      if (e && typeof e.stopPropagation === "function") e.stopPropagation();
    });

    // use change to update state
    cb.addEventListener("change", function (e) {
      if (e && typeof e.stopPropagation === "function") e.stopPropagation();
      if (typeof toggleSelection === "function") toggleSelection(modKey, sId, cb, e);
    });

    tdQC.appendChild(cb);

    // 2) Client/Farm
    tr.insertCell().innerText = normStr(row.Client_ID ?? row.client_id ?? row.clientId);
    tr.insertCell().innerText = normStr(row.Farm_ID ?? row.farm_id ?? row.farmId);

    // 3) ProdBatch_ID cell
    const tdProd = tr.insertCell();
    const curProdVal = normStr(row.ProdBatch_ID ?? row.prodbatch_id ?? row.prodBatchId) || "Default";

    if (isRGB) {
      const list = window.masterLists?.prodBatches;
      tdProd.innerHTML = `
        <select class="qc-batch-select-cell" data-id="${String(row.id).replace(/"/g, "&quot;")}">
          ${_buildOptionsHtml_(list, curProdVal)}
        </select>
      `;
      const sel = tdProd.querySelector("select");
      if (sel) {
        sel.value = curProdVal;
        sel.addEventListener("click", e => e?.stopPropagation && e.stopPropagation());
        sel.addEventListener("change", e => {
          e?.stopPropagation && e.stopPropagation();
          onRgbProdBatchChange(row, sel.value);
        });
      }

      // If list not loaded yet, trigger load once
      if (!Array.isArray(list)) {
        if (typeof loadMasterListsAndRerenderRGB === "function") loadMasterListsAndRerenderRGB();
      }
    } else {
      tdProd.innerText = curProdVal;
    }

    // 4) QCBatch_ID cell
    const tdQCBatch = tr.insertCell();
    const curBatchVal = normStr(row.QCBatch_ID ?? row.qcbatch_id ?? row.qcBatchId) || "Default";

    if (isRGB) {
      const list = window.masterLists?.qcBatches;
      tdQCBatch.innerHTML = `
        <select class="qc-batch-select-cell" data-id="${String(row.id).replace(/"/g, "&quot;")}">
          ${_buildOptionsHtml_(list, curBatchVal)}
        </select>
      `;
      const sel = tdQCBatch.querySelector("select");
      if (sel) {
        sel.value = curBatchVal;
        sel.addEventListener("click", e => e?.stopPropagation && e.stopPropagation());
        sel.addEventListener("change", e => {
          e?.stopPropagation && e.stopPropagation();
          onRgbQCBatchChange(row, sel.value);
        });
      }

      if (!Array.isArray(list)) {
        if (typeof loadMasterListsAndRerenderRGB === "function") loadMasterListsAndRerenderRGB();
      }
    } else {
      // QAQC behavior unchanged (dropdown per-row only in QAQC, and tied to QC checkbox enable/disable)
      if (typeof fillBatchSelectForRow === "function") {
        tdQCBatch.innerHTML = `
          <select class="qc-batch-select-cell" data-id="${String(row.id).replace(/"/g, "&quot;")}"
            ${cb.checked ? "" : "disabled"}>
          </select>
        `;
        fillBatchSelectForRow(row.id, curBatchVal);

        const sel = tdQCBatch.querySelector("select");
        if (sel) {
          sel.addEventListener("click", (e) => { if (e?.stopPropagation) e.stopPropagation(); });
          sel.addEventListener("change", (e) => {
            if (e?.stopPropagation) e.stopPropagation();
            if (typeof onQCBatchChange === "function") onQCBatchChange(String(row.id), sel.value);
          });
        }
      } else {
        tdQCBatch.innerText = curBatchVal;
      }
    }

    // 5) Device/Test/Date
    tr.insertCell().innerText = normStr(row.Device_ID ?? row.did);
    tr.insertCell().innerText = normStr(row.Test_ID ?? row.tid);
    tr.insertCell().innerText = normStr(row.crop ?? row.Crop ?? row.CropID);
    tr.insertCell().innerText = (typeof formatDateCell === "function")
      ? formatDateCell(row.Test_date ?? row.time ?? "")
      : normStr(row.Test_date ?? row.time ?? "");

    // 6) Metrics
    (METRIC_COLS_FLAT || []).forEach(c => {
      const td = tr.insertCell();
      const v = getMetricVal(row, c.k);
      const n = toNum(v);
      td.innerText = (n == null)
        ? (v === null || v === undefined ? "" : String(v))
        : fmt2(n);
    });

    tbody.appendChild(tr);
  });

  if (!isRGB && typeof updateQaqcActionButtons === "function") updateQaqcActionButtons();
  if (isRGB && typeof updateRgbActionButtons === "function") updateRgbActionButtons();
}







// Tick Only
// Tick Only (ROBUST)
function toggleSelection(mod, id, checkboxEl, ev) {
  // Stop row-click from firing
  if (ev && typeof ev.stopPropagation === "function") ev.stopPropagation();

  const modKey = (String(mod || "").toLowerCase() === "rgb") ? "rgb" : "qaqc";
  const normStr = (v) => String(v ?? "").trim();

  let sId = normStr(id);
  if (!sId) return;

  window.checkedRows = window.checkedRows || { rgb: [], qaqc: [] };
  window.checkedRows.rgb  = Array.isArray(window.checkedRows.rgb)  ? window.checkedRows.rgb  : [];
  window.checkedRows.qaqc = Array.isArray(window.checkedRows.qaqc) ? window.checkedRows.qaqc : [];

  const arr = window.checkedRows[modKey];
  const shouldBeChecked = !!checkboxEl?.checked;

  const idx = arr.indexOf(sId);
  if (shouldBeChecked) {
    if (idx === -1) arr.push(sId);
  } else {
    if (idx !== -1) arr.splice(idx, 1);
  }

  // Enable/disable batch dropdown in QA/QC rows (if present)
  if (modKey === "qaqc") {
    try {
      const sel = document.querySelector(`.qc-batch-select-cell[data-id="${CSS.escape(sId)}"]`);
      if (sel) sel.disabled = !shouldBeChecked;
    } catch (e) {}
  }

  // OPTIONAL BUT IMPORTANT: keep raw table in sync with QC-ticks too
  if (typeof renderRawSelection === "function") renderRawSelection(modKey);

  // Refresh buttons safely
  if (modKey === "rgb") {
    if (typeof safeUpdateRgbActionButtons === "function") safeUpdateRgbActionButtons();
    else if (typeof updateRgbActionButtons === "function") updateRgbActionButtons();
  } else {
    if (typeof safeUpdateQaqcActionButtons === "function") safeUpdateQaqcActionButtons();
    else if (typeof updateQaqcActionButtons === "function") updateQaqcActionButtons();
  }
}




// Highlight Only
function handleRowClick(mod, d, tr) {
  const modKey = (String(mod || '').toLowerCase() === 'rgb') ? 'rgb' : 'qaqc';

  // Ensure selection stores exist
  window.multiSelect = window.multiSelect || { rgb: [], qaqc: [], results: [] };
  window.multiSelect.rgb  = Array.isArray(window.multiSelect.rgb)  ? window.multiSelect.rgb  : [];
  window.multiSelect.qaqc = Array.isArray(window.multiSelect.qaqc) ? window.multiSelect.qaqc : [];

  // Ensure row has a stable id BEFORE selection
  const normStr = (v) => String(v ?? "").trim();
  if (d && !d.id) {
    d.id = (typeof makeRowKeyAny === "function")
      ? makeRowKeyAny(d)
      : (normStr(d.Device_ID ?? d.did) + "__" +
         normStr(d.Test_ID ?? d.tid) + "__" +
         normStr(d.Test_date ?? d.time ?? ""));
  }

  const sId = normStr(d?.id);
  if (!sId) return;

  const arr = window.multiSelect[modKey];
  const idx = arr.indexOf(sId);

  if (idx > -1) {
    arr.splice(idx, 1);
    if (tr) tr.classList.remove('selected');
  } else {
    if (arr.length >= 15) {
      const rem = arr.shift();
      try {
        const old = document.querySelector(`tr[data-id="${CSS.escape(rem)}"]`);
        if (old) old.classList.remove('selected');
      } catch (e) {}
    }
    arr.push(sId);
    if (tr) tr.classList.add('selected');
  }

  window.selectedRowId = sId;

  // Re-render raw compare table
  if (typeof renderRawSelection === 'function') renderRawSelection(mod);

  // Keep your existing behavior
  if (modKey === 'qaqc' && typeof renderQCStatus === 'function') renderQCStatus(d);
}



// ===============================
// RAW RGB TABLE: FIX (build row.raw from flat columns)
// ===============================

// Map your flat sheet columns -> the legacy row.raw shape used by the RAW table
const RAW_FLAT_MAP = {
  ammonium:   { t: 'NH4N_S1_B_T',  c: 'NH4N_S1_B_C' },
  phosphorus: { t: 'P_S1_B_T',     c: 'P_S1_B_C' },
  sulphur:    { t: 'S_S1_B_T',     c: 'S_S1_B_C' },
  oc:         { t: 'OC_S1_G_T',    c: 'OC_S1_G_C' },
  nitrate:    { t: 'NO3N_S1_G_T',  c: 'NO3N_S1_G_C' },
  boron:      { t: 'B_S1_B_T',     c: 'B_S1_B_C' },
  potassium:  { t: 'K_S2_B_T',     c: 'K_S2_B_C' },
  copper:     { t: 'Cu_S2_R_T',    c: 'Cu_S2_R_C' },
  zinccopper: { t: 'ZnCu_S2_R_T',  c: 'ZnCu_S2_R_C' },
  iron:       { t: 'Fe_S2_G_T',    c: 'Fe_S2_G_C' },
  manganese:  { t: 'Mn_S2_G_T',    c: 'Mn_S2_G_C' },
  ec:         { t: 'EC_S0_R_T',    c: 'EC_S0_R_C' },
  ph:         { t: 'pH_S0_R_T',    c: 'pH_S0_R_C' }
};

function _hasKey_(obj, key) {
  return obj && Object.prototype.hasOwnProperty.call(obj, key);
}

function _normKey_(key) {
  return String(key ?? '')
    .trim()
    .toLowerCase()
    .replace(/[\s_-]/g, '');
}

function _getRowValueByKeys_(row, keys) {
  if (!row || !keys) return undefined;
  const list = Array.isArray(keys) ? keys : [keys];
  for (const key of list) {
    if (!key) continue;
    if (_hasKey_(row, key)) return row[key];
  }

  const normMap = row.__normKeys || (() => {
    const map = {};
    Object.keys(row).forEach(k => {
      map[_normKey_(k)] = k;
    });
    row.__normKeys = map;
    return map;
  })();

  for (const key of list) {
    if (!key) continue;
    const norm = _normKey_(key);
    const realKey = normMap[norm];
    if (realKey && _hasKey_(row, realKey)) return row[realKey];
  }

  return undefined;
}

// Ensures row.raw[k] exists for every cols[k] using the flat fields you already store in rows
function ensureRowRaw(row) {
  if (!row || typeof row !== 'object') return row;

  if (!row.raw || typeof row.raw !== 'object') row.raw = {};

  const specs = Array.isArray(cols) ? cols : [];
  if (specs.length) {
    specs.forEach(spec => {
      const k = spec?.k;
      if (!k) return;
      if (!row.raw[k] || typeof row.raw[k] !== 'object') row.raw[k] = {};

      const fallback = RAW_FLAT_MAP[k] || {};
      const tKeys = [spec.csvT, fallback.t].filter(Boolean);
      const cKeys = [spec.csvC, fallback.c].filter(Boolean);

      if (row.raw[k].t === undefined || row.raw[k].t === null || row.raw[k].t === '') {
        const tVal = _getRowValueByKeys_(row, tKeys);
        if (tVal !== undefined) row.raw[k].t = tVal;
      }
      if (row.raw[k].c === undefined || row.raw[k].c === null || row.raw[k].c === '') {
        const cVal = _getRowValueByKeys_(row, cKeys);
        if (cVal !== undefined) row.raw[k].c = cVal;
      }
    });
  } else {
    for (const [k, m] of Object.entries(RAW_FLAT_MAP)) {
      if (!row.raw[k] || typeof row.raw[k] !== 'object') row.raw[k] = {};
      if (row.raw[k].t === undefined || row.raw[k].t === null || row.raw[k].t === '') {
        const tVal = _getRowValueByKeys_(row, m.t);
        if (tVal !== undefined) row.raw[k].t = tVal;
      }
      if (row.raw[k].c === undefined || row.raw[k].c === null || row.raw[k].c === '') {
        const cVal = _getRowValueByKeys_(row, m.c);
        if (cVal !== undefined) row.raw[k].c = cVal;
      }
    }
  }

  return row;
}

// RAW selection (FINAL)
// Shows meta columns + per-parameter T|C, aligned with header
function renderRawSelection(mod) {
  const tbody = document.getElementById(`body-${mod}-raw`);
  const thead = document.querySelector(`#tbl-${mod}-raw thead`);
  if (!tbody || !thead) return;

  const modKey = (String(mod || '').toLowerCase() === 'rgb') ? 'rgb' : 'qaqc';

  // Header must match row cell order
  const paramHeads = (Array.isArray(cols) ? cols : [])
    .map(c => `<th>${c.n}<br><small>T | C</small></th>`)
    .join("");

  thead.innerHTML = `<tr>
    <th>QC</th>
    <th>Client_ID</th>
    <th>Farm_ID</th>
    <th>ProdBatch_ID</th>
    <th>QCBatch_ID</th>
    <th>Device_ID</th>
    <th>Test_ID</th>
    <th>Test_date</th>
    ${paramHeads}
  </tr>`;

  const src = (modKey === 'rgb') ? (rgbData || []) : (qcData || []);

  // --- Ensure every row has a stable id (same logic as renderTable) ---
  const normStr = (v) => String(v ?? "").trim();
  src.forEach(r => {
    if (r && !r.id) {
      r.id = (typeof makeRowKeyAny === "function")
        ? makeRowKeyAny(r)
        : (normStr(r.Device_ID ?? r.did) + "__" +
           normStr(r.Test_ID ?? r.tid) + "__" +
           normStr(r.Test_date ?? r.time ?? ""));
    }
  });

  // --- Selection sources ---
  window.multiSelect = window.multiSelect || { rgb: [], qaqc: [], results: [] };
  window.checkedRows = window.checkedRows || { rgb: [], qaqc: [] };

  const ids = Array.from(new Set([
    ...(window.multiSelect?.[modKey] || []).map(String),
    ...(window.multiSelect?.results || []).map(String),
    ...(window.checkedRows?.[modKey] || []).map(String),
  ]));

  // Pick selected rows
  let rows = src.filter(r => ids.includes(String(r?.id)));

  tbody.innerHTML = "";

  // Fallback: last clicked row
  if (!rows.length && window.selectedRowId != null) {
    const focus = src.find(r => String(r?.id) === String(window.selectedRowId));
    if (focus) rows = [focus];
  }

  if (!rows.length) {
    const colSpan = 8 + (Array.isArray(cols) ? cols.length : 0);
    tbody.innerHTML = `<tr><td colspan="${colSpan}"
      style="padding:20px; color:#999; text-align:center;">
      Select rows (Yellow) or QC-tick rows to compare raw data
    </td></tr>`;
    return;
  }

  rows.forEach(r => renderSingleRow(r, tbody));
}



// Single RAW row renderer (FINAL)
// IMPORTANT: aligns with header above
function renderSingleRow(r, tbody) {
  if (!r || !tbody) return;

  const normStr = (v) => String(v ?? "").trim();
  const pick = (...vals) => {
    for (const v of vals) {
      const s = normStr(v);
      if (s) return s;
    }
    return "";
  };

  // Ensure legacy raw shape exists even if you store flat columns
  if (typeof ensureRowRaw === 'function') ensureRowRaw(r);

  // QC display
  const qcVal = (r.QC ?? r.qc ?? "");
  const qcDisp =
    (qcVal === true || String(qcVal).toUpperCase() === "TRUE") ? "TRUE" :
    (qcVal === false || String(qcVal).toUpperCase() === "FALSE") ? "FALSE" :
    normStr(qcVal);

  // Meta fields (show "-" if blank)
  const clientId   = pick(r.Client_ID, r.client_id, r.clientId) || "-";
  const farmId     = pick(r.Farm_ID, r.farm_id, r.farmId) || "-";
  const prodBatch  = pick(r.ProdBatch_ID, r.prodbatch_id, r.prodBatchId) || "-";
  const qcBatch    = pick(r.QCBatch_ID, r.qcbatch_id, r.qcBatchId, r.QC_Batch, r.qc_batch) || "-";

  const deviceId   = pick(r.Device_ID, r.did, r.device_id) || "";
  const testId     = pick(r.Test_ID, r.tid, r.test_id) || "";
  const testDate   = pick(r.Test_date, r.time, r.date, r.datetime) || "";

  // Build row HTML in EXACT same order as header
  let h = `<tr>
    <td>${qcDisp}</td>
    <td>${clientId}</td>
    <td>${farmId}</td>
    <td>${prodBatch}</td>
    <td>${qcBatch}</td>
    <td>${deviceId}</td>
    <td>${testId}</td>
    <td class="col-date">${testDate}</td>
  `;

  const rawMap = (r.raw && typeof r.raw === "object") ? r.raw : {};

  (Array.isArray(cols) ? cols : []).forEach(c => {
    const block = rawMap?.[c.k] || {};
    const tv = (block.t === 0 || block.t) ? String(block.t) : "-";
    const cv = (block.c === 0 || block.c) ? String(block.c) : "-";

    // Keep your original color scheme by band
    let colorVar = "#333";
    if (c.b === "R") colorVar = "var(--danger)";
    if (c.b === "G") colorVar = "var(--success)";
    if (c.b === "B") colorVar = "var(--accent)";

    h += `<td style="color:${colorVar};">${tv} | ${cv}</td>`;
  });

  h += `</tr>`;
  tbody.insertAdjacentHTML("beforeend", h);
}




function getTopCriticalStepsSummary(paramCode, maxItems = 3) {
  if (!window.recipeConfig) return '';
  const cfg = window.recipeConfig[paramCode];
  if (!cfg || !Array.isArray(cfg.steps) || !cfg.steps.length) return '';

  // Sort by normalizedWeight descending
  const steps = cfg.steps.slice().sort((a, b) => (b.normalizedWeight || 0) - (a.normalizedWeight || 0));
  const top = steps.slice(0, maxItems);

  const parts = top.map(st => {
    const label = st.description || st.stepId || st.hardwareId || 'Step';
    const w = (st.normalizedWeight * 100).toFixed(1);
    return `${label} (${w}%)`;
  });

  return parts.length ? `Most critical steps for ${cfg.paramName || paramCode}: ` + parts.join(', ') : '';
}



// Get diagnosis (reason + action) for a parameter, using QC_Recipes rules
function getQCDiagnosis(paramKey, observedAbs) {
  if (!window.recipeConfig || !paramKey || !Number.isFinite(observedAbs)) return null;

  const keyStr = String(paramKey).toLowerCase();
  let cfg = window.recipeConfig[paramKey];

  if (!cfg) {
    const all = Object.values(window.recipeConfig);
    cfg = all.find(c =>
      String(c.paramCode || '').toLowerCase() === keyStr ||
      String(c.paramName || '').toLowerCase() === keyStr
    );
  }
  if (!cfg || !Array.isArray(cfg.rules) || !cfg.rules.length) return null;

  const refMin = cfg.ref?.absRefMin;
  const refMax = cfg.ref?.absRefMax;

  for (const r of cfg.rules) {
    const type = String(r.bandType || '').toLowerCase();
    let ok = false;

    if (type === 'between') {
      const L = Number(r.bandMin);
      const U = Number(r.bandMax);
      if (Number.isFinite(L) && Number.isFinite(U)) {
        ok = (observedAbs >= L && observedAbs <= U);
      }
    } else if (type === '<') {
      if (typeof r.bandMax === 'string' && r.bandMax.indexOf('abs_ref_min') !== -1) {
        if (Number.isFinite(refMin)) ok = (observedAbs < refMin);
      } else {
        const L = Number(r.bandMin);
        if (Number.isFinite(L)) ok = (observedAbs < L);
      }
    } else if (type === '>') {
      if (typeof r.bandMax === 'string' && r.bandMax.indexOf('abs_ref_max') !== -1) {
        if (Number.isFinite(refMax)) ok = (observedAbs > refMax);
      } else {
        const U = Number(r.bandMax);
        if (Number.isFinite(U)) ok = (observedAbs > U);
      }
    }

    if (ok) {
      return {
        reason: r.reason || '',
        action: r.action || ''
      };
    }
  }

  return null;
}



// QC STATUS + HISTOGRAM
function getQCRowDeviceId(row) {
  return String(
    row?.Device_ID ?? row?.did ?? row?.device_id ?? row?.deviceId ?? ''
  ).trim();
}

function getQCRowTestId(row) {
  return String(
    row?.Test_ID ?? row?.tid ?? row?.test_id ?? row?.testId ?? ''
  ).trim();
}

function getQaqcStatusRowsByBatch() {
  return (Array.isArray(qcData) ? qcData : []);
}

function getQCObservedValue(row, paramKey) {
  if (!row || !paramKey) return NaN;
  const flatKeyMap = {
    ammonium: 'NH4N_Abs',
    phosphorus: 'P_Abs',
    sulphur: 'S_Abs',
    oc: 'OC_Abs',
    nitrate: 'NO3N_Abs',
    boron: 'B_Abs',
    potassium: 'K_Abs',
    copper: 'Cu_Abs',
    zinccopper: 'ZnCu_Abs',
    iron: 'Fe_Abs',
    manganese: 'Mn_Abs',
    ec: 'EC_Val',
    ph: 'pH_Val'
  };

  const flatKey = flatKeyMap[String(paramKey || '').toLowerCase()];
  if (flatKey && row[flatKey] !== undefined && row[flatKey] !== null && row[flatKey] !== '') {
    const n = Number(row[flatKey]);
    if (Number.isFinite(n)) return n;
  }
  const raw = row.raw && typeof row.raw === 'object' ? row.raw : null;
  if (raw) {
    const direct = safeCalcMetric(raw, paramKey);
    if (Number.isFinite(direct)) return direct;
    const obj = raw[paramKey];
    if (obj && typeof obj === 'object') {
      const v = Number(obj.v ?? obj.val ?? obj.abs ?? obj.metric);
      if (Number.isFinite(v)) return v;
    }
  }

  const top = row[paramKey];
  if (typeof top === 'number' && Number.isFinite(top)) return top;
  if (top && typeof top === 'object') {
    const v = Number(top.v ?? top.val ?? top.abs ?? top.metric);
    if (Number.isFinite(v)) return v;
  }

  return NaN;
}

function populateQaqcStatusFilters({ preserveSelection = true } = {}) {
  const deviceSel = document.getElementById('qaqc-status-device');
  const testSel = document.getElementById('qaqc-status-test');
  if (!deviceSel || !testSel) return;

      const rows = getQaqcStatusRowsByBatch();

  if (!rows.length) {
    deviceSel.innerHTML = '';
    testSel.innerHTML = '';
    return;
  }

  const prevDevice = preserveSelection ? deviceSel.value : '';
  const prevTest = preserveSelection ? testSel.value : '';

  const deviceIds = Array.from(
    new Set(rows.map(getQCRowDeviceId).filter(Boolean))
  ).sort();

  deviceSel.innerHTML = deviceIds
    .map(d => `<option value="${escapeHtml(d)}">${escapeHtml(d)}</option>`)
    .join('');

  const pickedDevice = deviceIds.includes(prevDevice) ? prevDevice : (deviceIds[0] || '');
  deviceSel.value = pickedDevice;

  const rowsForDevice = pickedDevice
    ? rows.filter(r => getQCRowDeviceId(r) === pickedDevice)
    : rows.slice();

  const testIds = Array.from(
    new Set(rowsForDevice.map(getQCRowTestId).filter(Boolean))
  ).sort();

  testSel.innerHTML = testIds
    .map(t => `<option value="${escapeHtml(t)}">${escapeHtml(t)}</option>`)
    .join('');

  const pickedTest = testIds.includes(prevTest) ? prevTest : (testIds[0] || '');
  testSel.value = pickedTest;

  applyQaqcStatusSelection();
}

function applyQaqcStatusSelection() {
  const deviceSel = document.getElementById('qaqc-status-device');
  const testSel = document.getElementById('qaqc-status-test');
  if (!deviceSel || !testSel) return;

  const deviceId = deviceSel.value;
  const testId = testSel.value;

  const rows = getQaqcStatusRowsByBatch();

  const row = rows.find(r =>
    getQCRowDeviceId(r) === deviceId && getQCRowTestId(r) === testId
  );

  if (row) {
    const batchId = getQCBatchIdFromRow(row);
    window.currentQCBatchId = batchId;
    currentQCBatchId = batchId;
    renderQCStatus(row);
  }
}

function onQaqcStatusDeviceChange() {
  populateQaqcStatusFilters({ preserveSelection: true });
}

function onQaqcStatusTestChange() {
  const deviceSel = document.getElementById('qaqc-status-device');
  const testSel = document.getElementById('qaqc-status-test');
  if (!deviceSel || !testSel) return;

  const testId = testSel.value;
  const rows = getQaqcStatusRowsByBatch();
  const match = rows.find(r => getQCRowTestId(r) === testId);
  if (match) {
    const deviceId = getQCRowDeviceId(match);
    deviceSel.value = deviceId;
  }
  applyQaqcStatusSelection();
}

function renderQCStatus(row) {
  if (!row) return;

  window.currentQCRowForCert = row; // used by PDF/CSV export

  const tbody = document.getElementById('body-qaqc-status');
  if (!tbody) return;
  tbody.innerHTML = '';

  // Reset AI diagnostics panel on row change (avoid stale text)
  try {
    const aiBox = document.getElementById('qaqc-ai-box');
    const aiContent = document.getElementById('qaqc-ai-content');
    if (aiBox && aiContent) {
      aiContent.textContent = 'Click "AI QC Diagnostics" to analyse this QC row.';
    }
  } catch (e) {
    console.warn('AI panel reset failed:', e);
  }

  // Summary counters
  let passCount = 0;
  let failCount = 0;
  let overallStatus = 'PASS';

  // batch used for criteria/histogram context
  const batchId = getQCBatchIdFromRow(row) || (window.currentQCBatchId || 'Default');

  // Ensure histogram param dropdown exists (safe if repeated)
  if (typeof populateQCHistParamDropdown === 'function') {
    populateQCHistParamDropdown();
  }

  // Helper: criteria (batch-aware if your function supports it)
  function getCriteria(paramKey) {
    try {
      return getQCCriteriaForParam(paramKey, batchId);
    } catch (e) {
      try {
        return getQCCriteriaForParam(paramKey);
      } catch (e2) {
        return null;
      }
    }
  }

  // Helper: title tooltips must NOT contain raw newlines in HTML attributes
  function toTitleAttr(s) {
    const esc = (typeof escapeHtml === 'function')
      ? escapeHtml
      : (x => String(x)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#39;'));
    return esc(String(s || '').replace(/\r?\n/g, ' | '));
  }

  // Helper: summarize top critical steps from recipeConfig (any parameter)
  function getTopCriticalStepsSummary(paramKeyOrName, maxItems = 3) {
    if (!window.recipeConfig || !paramKeyOrName) return '';

    const keyStr = String(paramKeyOrName || '').toLowerCase();

    // 1) Try direct key match (e.g. "S")
    let cfg = window.recipeConfig[paramKeyOrName];

    // 2) Fallback: search by paramCode or paramName, case-insensitive
    if (!cfg) {
      const all = Object.values(window.recipeConfig);
      cfg = all.find(c =>
        String(c.paramCode || '').toLowerCase() === keyStr ||
        String(c.paramName || '').toLowerCase() === keyStr
      );
    }

    if (!cfg || !Array.isArray(cfg.steps) || !cfg.steps.length) return '';

    const steps = cfg.steps.slice().sort(
      (a, b) => (b.normalizedWeight || 0) - (a.normalizedWeight || 0)
    );
    const top = steps.slice(0, maxItems);

    const parts = top.map(st => {
      const label = st.description || st.notes || st.stepId || st.hardwareId || 'Step';
      const w = (st.normalizedWeight * 100).toFixed(1);
      return `${label} (${w}%)`;
    });

    return parts.length
      ? `Most critical steps for ${cfg.paramName || cfg.paramCode}: ${parts.join(', ')}`
      : '';
  }

  // NEW helper: pick rule-based diagnosis from recipeConfig rules
  function getQCDiagnosis(paramKey, observedAbs) {
    if (!window.recipeConfig || !paramKey || !Number.isFinite(observedAbs)) return null;

    const keyStr = String(paramKey).toLowerCase();
    let cfg = window.recipeConfig[paramKey];

    if (!cfg) {
      const all = Object.values(window.recipeConfig);
      cfg = all.find(c =>
        String(c.paramCode || '').toLowerCase() === keyStr ||
        String(c.paramName || '').toLowerCase() === keyStr
      );
    }
    if (!cfg || !Array.isArray(cfg.rules) || !cfg.rules.length) return null;

    const refMin = cfg.ref && typeof cfg.ref.absRefMin === 'number' ? cfg.ref.absRefMin : null;
    const refMax = cfg.ref && typeof cfg.ref.absRefMax === 'number' ? cfg.ref.absRefMax : null;

    for (const r of cfg.rules) {
      const type = String(r.bandType || '').toLowerCase();
      let ok = false;

      if (type === 'between') {
        const L = Number(r.bandMin);
        const U = Number(r.bandMax);
        if (Number.isFinite(L) && Number.isFinite(U)) {
          ok = (observedAbs >= L && observedAbs <= U);
        }
      } else if (type === '<') {
        if (typeof r.bandMax === 'string' && r.bandMax.indexOf('abs_ref_min') !== -1) {
          if (Number.isFinite(refMin)) ok = (observedAbs < refMin);
        } else {
          const L = Number(r.bandMin);
          if (Number.isFinite(L)) ok = (observedAbs < L);
        }
      } else if (type === '>') {
        if (typeof r.bandMax === 'string' && r.bandMax.indexOf('abs_ref_max') !== -1) {
          if (Number.isFinite(refMax)) ok = (observedAbs > refMax);
        } else {
          const U = Number(r.bandMax);
          if (Number.isFinite(U)) ok = (observedAbs > U);
        }
      }

      if (ok) {
        return {
          reason: r.reason || '',
          action: r.action || ''
        };
      }
    }

    return null;
  }

  (Array.isArray(cols) ? cols : []).forEach(c => {
    if (!c || !c.k) return;

    const val = getQCObservedValue(row, c.k);
    const criteria = getCriteria(c.k);

    let status = 'PASS';
    let style  = 'status-pass';

    // Determine fail vs pass
    if (criteria && Number.isFinite(val)) {
      if (val < criteria.min || val > criteria.max) {
        status = 'FAIL';
        style = 'status-fail';
        overallStatus = 'FAIL';
        console.log('Detected FAIL for param key:', c.k);
      }
    }

    // Count pass/fail for summary
    if (status === 'PASS') passCount++;
    else failCount++;

    // Build fail tooltip (attribute-safe)
    let tip = '';
    if (criteria && Number.isFinite(val)) {
      if (status === 'FAIL') {
        const side  = (val < criteria.min) ? 'below MIN' : 'above MAX';
        const delta = (val < criteria.min) ? (criteria.min - val) : (val - criteria.max);
        tip =
          `FAIL: ${side}\n` +
          `Observed: ${val.toFixed(3)}\n` +
          `Allowed: ${criteria.min} – ${criteria.max}\n` +
          `Deviation: ${delta.toFixed(3)}`;
      } else {
        tip =
          `PASS\n` +
          `Observed: ${val.toFixed(3)}\n` +
          `Allowed: ${criteria.min} – ${criteria.max}`;
      }
    }

    const tr = document.createElement('tr');
    tr.dataset.paramKey = c.k;

    if (status === 'FAIL') tr.classList.add('is-fail');

    tr.onclick = function () {
      tbody.querySelectorAll('tr').forEach(r => r.classList.remove('row-active'));
      tr.classList.add('row-active');

      const selectedVal = getQCObservedValue(row, c.k);
      window.currentQCParamKey = c.k;

      const sel = document.getElementById('qaqc-hist-param');
      if (sel) sel.value = c.k;

      if (typeof updateQCHistogram === 'function') {
        updateQCHistogram(
          c.k,
          Number.isFinite(selectedVal) ? selectedVal : null,
          window.currentQCBatchId || batchId || 'Default'
        );
      }
    };

    const esc = (typeof escapeHtml === 'function')
      ? escapeHtml
      : (x => String(x)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#39;'));

    tr.innerHTML =
      `<td>${esc(c.n || c.k)}</td>` +
      `<td class="${style}" title="${toTitleAttr(tip)}">${esc(status)}</td>` +
      `<td>${Number.isFinite(val) ? val.toFixed(3) : 'NA'}</td>` +
      `<td>${criteria ? esc(criteria.min) : '0'}</td>` +
      `<td>${criteria ? esc(criteria.max) : '0'}</td>`;

    tbody.appendChild(tr);
  });

  // Render the summary strip
  const sumEl = document.getElementById('qaqc-status-summary');
  if (sumEl) {
    const esc = (typeof escapeHtml === 'function')
      ? escapeHtml
      : (x => String(x)
          .replace(/&/g, '&amp;')
          .replace(/</g, '&lt;')
          .replace(/>/g, '&gt;')
          .replace(/"/g, '&quot;')
          .replace(/'/g, '&#39;'));

    const overallCls = (overallStatus === 'PASS') ? 'pass' : 'fail';
    sumEl.innerHTML = `
      <div class="qaqc-summary-left">
        <div class="qaqc-summary-row pills-row">
          <span class="qaqc-summary-title">QC Summary</span>
          <span class="qaqc-pill ${overallCls}">Overall: ${esc(overallStatus)}</span>
          <span class="qaqc-pill pass">PASS: ${passCount}</span>
          <span class="qaqc-pill fail">FAIL: ${failCount}</span>
          <span class="qaqc-pill">TOTAL: ${passCount + failCount}</span>
        </div>
        <div class="qaqc-summary-row">
          <span>Batch: <b>${esc(batchId)}</b></span>
        </div>
        <div class="qaqc-summary-row">
          <span>Device: <b>${esc(row.did || '')}</b></span>
          <span style="margin-left:12px;">Test: <b>${esc(row.tid || '')}</b></span>
        </div>
      </div>
    `;

    // Auto‑add rule-based diagnosis line under summary if any FAIL
    if (failCount > 0 && window.recipeConfig) {
      const failedKeys = (Array.isArray(cols) ? cols : [])
        .filter(c => c && c.k)
        .map(c => c.k);

      let diagText = '';
      for (const k of failedKeys) {
        const v = parseFloat(calcMetric(row.raw, k));
        if (!Number.isFinite(v)) continue;
        const diag = getQCDiagnosis(k, v);
        if (diag && (diag.reason || diag.action)) {
          const name = (Array.isArray(cols)
            ? cols.find(c => c && c.k === k)?.n
            : null) || k;
          if (diag.reason && diag.action) {
            diagText = `${name} QC failed. ${diag.reason}. ${diag.action}.`;
          } else if (diag.reason) {
            diagText = `${name} QC failed. ${diag.reason}.`;
          } else if (diag.action) {
            diagText = `${name} QC failed. ${diag.action}.`;
          }
          break;
        }
      }

      if (diagText) {
        const extra = document.createElement('div');
        extra.className = 'qaqc-summary-row';
        extra.style.marginTop = '4px';
        extra.style.fontSize = '0.8rem';
        extra.style.color = '#555';
        extra.textContent = diagText;
        sumEl.appendChild(extra);
      }
    }

    // Keep old “critical steps” helper line if you still want it
    if (failCount > 0 && window.recipeConfig) {
      const failedWithRecipe = (Array.isArray(cols) ? cols : [])
        .filter(c => c && c.k)
        .map(c => c.k)
        .find(k => !!getTopCriticalStepsSummary(k));

      if (failedWithRecipe) {
        const critText = getTopCriticalStepsSummary(failedWithRecipe);
        if (critText) {
          const extra2 = document.createElement('div');
          extra2.className = 'qaqc-summary-row';
          extra2.style.marginTop = '4px';
          extra2.style.fontSize = '0.8rem';
          extra2.style.color = '#555';
          extra2.textContent = critText;
          sumEl.appendChild(extra2);
        }
      }
    }

    sumEl.hidden = false;
  }

  // Override section (unchanged)
  const input  = document.getElementById('qaqc-override-input');
  const toggle = document.getElementById('qaqc-override-toggle');
  const note   = document.getElementById('qaqc-override-note');
  if (!input || !toggle || !note) return;

  const deviceId = row.did;
  const enabled  = (window.qcManualOverrideEnabled &&
                    window.qcManualOverrideEnabled[deviceId] === true);
  const manualStatus = (window.qcManualStatus &&
                        window.qcManualStatus[deviceId]);

  input.dataset.deviceId       = deviceId || '';
  input.dataset.computedStatus = overallStatus;

  toggle.checked = !!enabled;

  if (enabled && manualStatus) {
    input.value    = String(manualStatus).toUpperCase();
    input.disabled = false;
    note.textContent = 'Mode: Manual override active';
    note.style.color = '#e67e22';
  } else {
    input.value    = overallStatus;
    input.disabled = true;
    note.textContent = 'Mode: Automatic (from parameter QC)';
    note.style.color = '#888';
  }

  // Default histogram: follow dropdown / remembered param
  const sel = document.getElementById('qaqc-hist-param');
  const defaultKey =
    (sel && sel.value) ||
    window.currentQCParamKey ||
    (Array.isArray(cols) && cols.length ? cols[0].k : null);

  if (defaultKey && typeof updateQCHistogram === 'function') {
    window.currentQCParamKey = defaultKey;
    const v = getQCObservedValue(row, defaultKey);
    updateQCHistogram(
      defaultKey,
      Number.isFinite(v) ? v : null,
      window.currentQCBatchId || batchId || 'Default'
    );
  }

  // Ensure export buttons are visible + enabled when a row is loaded
  const b1 = document.getElementById('btn-qc-export-pdf');
  const b2 = document.getElementById('btn-qc-export-csv');
  if (b1) b1.disabled = false;
  if (b2) b2.disabled = false;
}

function updateQCHistogram(paramKey, selectedVal, batchId) {
  const canvas  = document.getElementById('c-qc-hist');
  const titleEl = document.getElementById('qaqc-hist-title');
  const metaEl  = document.getElementById('qaqc-hist-meta');
  if (!canvas || !titleEl) return;

  const paramConf   = cols.find(c => c.k === paramKey);
  const label       = paramConf ? paramConf.n : paramKey;
  const targetBatch = batchId || currentQCBatchId || 'Default';
  const clamp = (val, min, max) => Math.min(max, Math.max(min, val));
  const quantile = (sorted, q) => {
    if (!sorted.length) return 0;
    const pos = (sorted.length - 1) * q;
    const base = Math.floor(pos);
    const rest = pos - base;
    const next = sorted[base + 1] !== undefined ? sorted[base + 1] : sorted[base];
    return sorted[base] + rest * (next - sorted[base]);
  };

  const values = qcData
    .filter(r => getQCBatchIdFromRow(r) === targetBatch)
    .map(r => getQCObservedValue(r, paramKey))
    .filter(v => Number.isFinite(v));

  let criteriaSd = '';
  try {
    const crit = getQCCriteriaForParam(paramKey, targetBatch);
    if (crit && crit.sd) criteriaSd = String(crit.sd).trim();
  } catch (e) {}

  titleEl.textContent = `QC Histogram – ${label}`;
  if (metaEl) {
    const sdTag = criteriaSd ? ` | Criteria: ±${criteriaSd}σ` : '';
    metaEl.textContent = `Batch: ${targetBatch} | n = ${values.length}${sdTag}`;
  }

  const ctx = canvas.getContext('2d');

  canvas.style.display = 'block';
  canvas.style.width = '100%';
  canvas.style.height = '100%';
  canvas.style.maxHeight = 'none';

  const wrap = canvas.closest('.qaqc-hist-plot') || canvas.parentElement;
  if (wrap) {
    wrap.style.height = '100%';
    wrap.style.maxHeight = 'none';
    wrap.style.minHeight = '0';
    wrap.style.overflow = 'hidden';
    wrap.style.position = 'relative';
  }

  if (chartObjs.qcHist) {
    chartObjs.qcHist.destroy();
    chartObjs.qcHist = null;
  }

  if (!values.length) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const lg = document.getElementById('qaqc-hist-legend');
    const ht = document.getElementById('qaqc-hist-hint');
    if (lg) lg.innerHTML = '';
    if (ht) {
      ht.textContent = 'No QC data for this batch/parameter.';
      ht.classList.remove('ok','bad');
    }
    return;
  }

  // =====================
  // Stats
  // =====================
  const sorted = values.slice().sort((a,b)=>a-b);
  const n      = sorted.length;
  const mean   = sorted.reduce((a,b)=>a+b,0)/n;
  const median = (n%2===1) ? sorted[(n-1)/2] : (sorted[n/2-1] + sorted[n/2])/2;
  const sd     = Math.sqrt(sorted.reduce((s,v)=>s+Math.pow(v-mean,2),0)/n);

  let min = sorted[0];
  let max = sorted[sorted.length-1];
  if (min === max) { min -= 0.001; max += 0.001; }

  // X-axis window: mean ± 2 SD with guards
  let xMin = min;
  let xMax = max;
  if (Number.isFinite(sd) && sd > 0) {
    const twoSdMin = mean - 2 * sd;
    const twoSdMax = mean + 2 * sd;
    xMin = Math.max(min, twoSdMin);
    xMax = Math.min(max, twoSdMax);
    if (xMax <= xMin) {
      xMin = mean - 2 * sd;
      xMax = mean + 2 * sd;
    }
  }
  if (!(xMax > xMin)) {
    xMin = min;
    xMax = max;
  }

  // =====================
  // Dynamic binning: Freedman–Diaconis with clamp
  // =====================
  const range = max - min;
  const q1 = quantile(sorted, 0.25);
  const q3 = quantile(sorted, 0.75);
  const iqr = q3 - q1;
  let binWidth = iqr > 0 ? (2 * iqr / Math.cbrt(n)) : 0;
  if (!Number.isFinite(binWidth) || binWidth <= 0) {
    const fallbackBins = clamp(Math.round(Math.sqrt(n)), 8, 30);
    binWidth = range / fallbackBins;
  }
  let binCount = Math.ceil(range / binWidth);
  binCount = clamp(binCount || 1, 8, 30);
  binWidth = range / binCount;

  const bins = [];
  for (let i=0; i<binCount; i++) {
    const bMin = min + i*binWidth;
    const bMax = bMin + binWidth;
    const mid  = (bMin + bMax) / 2;
    bins.push({min:bMin, max:bMax, mid, count:0});
  }

  sorted.forEach(v => {
    let idx = Math.floor((v - min) / binWidth);
    if (idx < 0) idx = 0;
    if (idx >= binCount) idx = binCount - 1;
    bins[idx].count++;
  });

  const histData = bins.map(b => ({ x: b.mid, y: b.count }));

  // =====================
  // KDE density curve
  // =====================
  function gaussian(u) {
    return Math.exp(-0.5 * u * u) / Math.sqrt(2 * Math.PI);
  }

  let h = 1.06 * sd * Math.pow(n, -0.2);
  if (!Number.isFinite(h) || h <= 0) h = binWidth || 1e-6;

  const gridN = 140;
  const step  = (max - min) / (gridN - 1);

  const kdeData = [];
  for (let i=0; i<gridN; i++) {
    const x = min + i * step;
    let sum = 0;
    for (let j=0; j<n; j++) {
      sum += gaussian((x - sorted[j]) / h);
    }
    const density = sum / (n * h);
    const scaledY = density * n * binWidth;
    kdeData.push({ x, y: scaledY });
  }

  // =====================
  // Vertical lines + legend/hint
  // =====================
  const vValues = [
    mean,
    median,
    mean - sd, mean + sd,
    mean - 2*sd, mean + 2*sd,
    mean - 3*sd, mean + 3*sd
  ];
  const vColors = [
    'rgba(46, 204, 113, 0.9)',
    'rgba(52, 152, 219, 0.9)',
    'rgba(241, 196, 15, 0.9)',
    'rgba(241, 196, 15, 0.9)',
    'rgba(230, 126, 34, 0.9)',
    'rgba(230, 126, 34, 0.9)',
    'rgba(231, 76, 60, 0.9)',
    'rgba(231, 76, 60, 0.9)'
  ];
  const vWidths = [1.5,1.5,1,1,1,1,1,1];
  const vDashes = new Array(vValues.length).fill([4,4]);

  if (typeof renderQCHistLegend === 'function') {
    renderQCHistLegend(Number.isFinite(selectedVal));
  }
  if (typeof renderQCHistHint === 'function') {
    renderQCHistHint(paramKey, selectedVal, mean, sd, targetBatch);
  }

  if (Number.isFinite(selectedVal)) {
    vValues.push(selectedVal);
    vColors.push('rgba(0,0,0,0.9)');
    vWidths.push(2);
    vDashes.push([]);
    if (metaEl) metaEl.textContent += ` | Selected: ${selectedVal.toFixed(3)}`;
    if (typeof renderQCHistHint === 'function') {
      renderQCHistHint(paramKey, selectedVal, mean, sd, targetBatch);
    }
  }

  // =====================
  // Chart.js render
  // =====================
  chartObjs.qcHist = new Chart(ctx, {
    data: {
      datasets: [
        {
          type: 'bar',
          label: 'Frequency',
          data: histData,
          parsing: false,
          borderWidth: 1,
          backgroundColor: getBandColor(paramKey, 0.4),
          borderColor: getBandColor(paramKey, 1),
          barThickness: 'flex',
          categoryPercentage: 1.0,
          barPercentage: 1.0
        },
        {
          type: 'line',
          label: 'Density',
          data: kdeData,
          parsing: false,
          pointRadius: 0,
          borderWidth: 2.5,
          tension: 0.25,
          borderColor: '#000',
          backgroundColor: 'transparent'
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      layout: {
        padding: { bottom: 18 }
      },
      scales: {
        x: {
          type: 'linear',
          title: { display: true, text: `QC metric (${label})` },
          min: xMin,
          max: xMax
        },
        y: {
          beginAtZero: true,
          title: { display: true, text: 'Count' }
        }
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: (c) => {
              if (c.dataset.type === 'line') {
                return `Density (scaled): ${c.parsed.y.toFixed(2)}`;
              }
              return `Count: ${c.parsed.y.toFixed(0)} (bin centre ${c.parsed.x.toFixed(3)})`;
            }
          }
        },
        verticalLinesPlugin: {
          values: vValues,
          colors: vColors,
          widths: vWidths,
          dashes: vDashes
        }
      }
    },
    plugins: [verticalLinesPlugin]
  });
}


function renderQCHistogramToCanvas(canvas, paramKey, selectedVal, batchId) {
  const targetBatch = batchId || currentQCBatchId || 'Default';
  const ctx = canvas.getContext('2d');
  const clamp = (val, min, max) => Math.min(max, Math.max(min, val));
  const quantile = (sorted, q) => {
    if (!sorted.length) return 0;
    const pos = (sorted.length - 1) * q;
    const base = Math.floor(pos);
    const rest = pos - base;
    const next = sorted[base + 1] !== undefined ? sorted[base + 1] : sorted[base];
    return sorted[base] + rest * (next - sorted[base]);
  };

  // 1) VALUES
  const values = qcData
    .filter(r => getQCBatchIdFromRow(r) === targetBatch)
    .map(r => getQCObservedValue(r, paramKey))
    .filter(v => Number.isFinite(v));

  if (!values.length) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    return null;
  }

  const sorted = values.slice().sort((a, b) => a - b);
  const n = sorted.length;
  const mean = sorted.reduce((a, b) => a + b, 0) / n;
  const median = (n % 2 === 1)
    ? sorted[(n - 1) / 2]
    : (sorted[n / 2 - 1] + sorted[n / 2]) / 2;

  const sd = Math.sqrt(
    sorted.reduce((s, v) => s + Math.pow(v - mean, 2), 0) / n
  );

  let min = sorted[0];
  let max = sorted[sorted.length - 1];
  if (min === max) {
    min -= 0.001;
    max += 0.001;
  }

 // X-axis window: mean ± 2SD, but never inverted and never fully collapsed
let xMin = min;
let xMax = max;

if (Number.isFinite(sd) && sd > 0) {
  const twoSdMin = mean - 2 * sd;
  const twoSdMax = mean + 2 * sd;
  xMin = Math.max(min, twoSdMin);
  xMax = Math.min(max, twoSdMax);

  // if clamped interval collapses, fall back to mean ± 2SD raw
  if (xMax <= xMin) {
    xMin = mean - 2 * sd;
    xMax = mean + 2 * sd;
  }
}

// final guard: ensure a small positive span
if (!(xMax > xMin)) {
  xMin = min;
  xMax = max;
}


  const range = max - min;
  const q1 = quantile(sorted, 0.25);
  const q3 = quantile(sorted, 0.75);
  const iqr = q3 - q1;
  let binWidth = iqr > 0 ? (2 * iqr / Math.cbrt(n)) : 0;
  if (!Number.isFinite(binWidth) || binWidth <= 0) {
    const fallbackBins = clamp(Math.round(Math.sqrt(n)), 8, 30);
    binWidth = range / fallbackBins;
  }
  let binCount = Math.ceil(range / binWidth);
  binCount = clamp(binCount || 1, 8, 30);
  binWidth = range / binCount;
  const bins = [];
  for (let i = 0; i < binCount; i++) {
    const bMin = min + i * binWidth;
    const bMax = bMin + binWidth;
    const mid = (bMin + bMax) / 2;
    bins.push({ min: bMin, max: bMax, mid, count: 0 });
  }

  sorted.forEach(v => {
    let idx = Math.floor((v - min) / binWidth);
    if (idx < 0) idx = 0;
    if (idx >= binCount) idx = binCount - 1;
    bins[idx].count++;
  });

  const histData = bins.map(b => ({ x: b.mid, y: b.count }));

  function gaussian(u) {
    return Math.exp(-0.5 * u * u) / Math.sqrt(2 * Math.PI);
  }

  let h = 1.06 * sd * Math.pow(n, -0.2);
  if (!Number.isFinite(h) || h <= 0) h = binWidth || 1e-6;

  const gridN = 140;
  const step = (max - min) / (gridN - 1);
  const kdeData = [];
  for (let i = 0; i < gridN; i++) {
    const x = min + i * step;
    let sum = 0;
    for (let j = 0; j < n; j++) sum += gaussian((x - sorted[j]) / h);
    const density = sum / (n * h);
    const scaledY = density * n * binWidth;
    kdeData.push({ x, y: scaledY });
  }

  const vValues = [
    mean,
    median,
    mean - sd, mean + sd,
    mean - 2 * sd, mean + 2 * sd,
    mean - 3 * sd, mean + 3 * sd
  ];
  const vColors = [
    'rgba(46, 204, 113, 0.9)',
    'rgba(52, 152, 219, 0.9)',
    'rgba(241, 196, 15, 0.9)',
    'rgba(241, 196, 15, 0.9)',
    'rgba(230, 126, 34, 0.9)',
    'rgba(230, 126, 34, 0.9)',
    'rgba(231, 76, 60, 0.9)',
    'rgba(231, 76, 60, 0.9)'
  ];
  const vWidths = [1.5, 1.5, 1, 1, 1, 1, 1, 1];
  const vDashes = new Array(vValues.length).fill([4, 4]);

  if (Number.isFinite(selectedVal)) {
    vValues.push(selectedVal);
    vColors.push('rgba(0, 0, 0, 0.9)');
    vWidths.push(2);
    vDashes.push([]);
  }

  const paramConf = Array.isArray(cols) ? cols.find(c => c.k === paramKey) : null;
  const axisLabel = paramConf ? (paramConf.n || paramConf.k) : paramKey;
  const insideTitle = `QC Histogram: ${axisLabel}`;

  const insideTitlePlugin = {
    id: 'insideTitlePlugin',
    afterDraw(chart) {
      const { ctx, chartArea } = chart;
      if (!chartArea) return;
      ctx.save();
      ctx.font = 'bold 20px Helvetica';
      ctx.fillStyle = '#111';
      ctx.textBaseline = 'top';
      ctx.fillText(insideTitle, chartArea.left + 4, chartArea.top + 2);
      ctx.restore();
    }
  };

  const maxCount = Math.max(...bins.map(b => b.count)) || 1;

  const chart = new Chart(ctx, {
    type: 'bar',
    data: {
      datasets: [
        {
          type: 'bar',
          label: 'Count',
          data: histData,
          backgroundColor: 'rgba(52, 152, 219, 0.45)',
          borderColor: 'rgba(52, 152, 219, 0.9)',
          borderWidth: 1,
          barPercentage: 1.0,
          categoryPercentage: 1.0
        },
        {
          type: 'line',
          label: 'KDE',
          data: kdeData,
          borderColor: 'rgba(231, 76, 60, 0.9)',
          borderWidth: 1.5,
          fill: false,
          pointRadius: 0,
          tension: 0.25,
          yAxisID: 'y'
        },
        ...vValues.map((vx, idx) => ({
          type: 'line',
          label: 'vline',
          data: [
            { x: vx, y: 0 },
            { x: vx, y: maxCount }
          ],
          borderColor: vColors[idx],
          borderWidth: vWidths[idx],
          borderDash: vDashes[idx],
          fill: false,
          pointRadius: 0,
          yAxisID: 'y'
        }))
      ]
    },
    options: {
      responsive: false,
      animation: false,
      maintainAspectRatio: false,
      layout: { padding: { left: 2, right: 2, top: 22, bottom: 2 } },
      scales: {
        x: {
          type: 'linear',
          min: xMin,
          max: xMax,
          title: {
            display: true,
            text: axisLabel,
            font: { size: 18 }
          },
          ticks: {
            maxTicksLimit: 6,
            font: { size: 14 }
          }
        },
        y: {
          beginAtZero: true,
          title: {
            display: true,
            text: 'Count',
            font: { size: 18 }
          },
          ticks: {
            font: { size: 14 }
          }
        }
      },
      plugins: {
        legend: {
          display: false,
          labels: { font: { size: 14 } }
        },
        tooltip: {
          enabled: true,
          titleFont: { size: 14 },
          bodyFont: { size: 14 }
        }
      }
    },
    plugins: [insideTitlePlugin, verticalLinesPlugin]
  });

  return chart;
}




function renderQCHistLegend(selectedValPresent) {
  const el = document.getElementById('qaqc-hist-legend');
  if (!el) return;

  // Matches your current color semantics in updateQCHistogram()
  const items = [
    { name: 'Mean',   color: 'rgba(46, 204, 113, 0.9)', dashed: false },
    { name: 'Median', color: 'rgba(52, 152, 219, 0.9)', dashed: false },
    { name: '±1σ',    color: 'rgba(241, 196, 15, 0.9)', dashed: true  },
    { name: '±2σ',    color: 'rgba(230, 126, 34, 0.9)', dashed: true  },
    { name: '±3σ',    color: 'rgba(231, 76, 60, 0.9)',  dashed: true  }
  ];

  if (selectedValPresent) {
    items.push({ name: 'Selected Test', color: 'rgba(0,0,0,0.9)', dashed: false });
  }

  el.innerHTML = items.map(it => {
    const cls = `lg-swatch ${it.dashed ? 'lg-dash' : ''}`;
    return `<span class="lg-item"><span class="${cls}" style="border-top-color:${it.color}"></span>${it.name}</span>`;
  }).join('');
}

function renderQCHistHint(paramKey, selectedVal, mean, sd, batchId) {
  const el = document.getElementById('qaqc-hist-hint');
  if (!el) return;

  // Default neutral
  el.classList.remove('ok', 'bad');

  // If no selected test value, show guidance only
  if (!Number.isFinite(selectedVal)) {
    el.textContent = 'Tip: select a Test ID (or click a QC Status row) to show the Selected marker and diagnostics.';
    return;
  }

  // Try to read criteria (batch-aware if your function supports it)
  let criteria = null;
  try { criteria = getQCCriteriaForParam(paramKey, batchId); }
  catch(e){ try { criteria = getQCCriteriaForParam(paramKey); } catch(_e){} }

  const sdLabel = criteria && criteria.sd ? ` | Criteria: ±${criteria.sd}σ` : '';

  // Decide “why” in a human-readable way
  const z = (Number.isFinite(sd) && sd > 0) ? ((selectedVal - mean) / sd) : null;
  const absZ = (z === null) ? null : Math.abs(z);

  // 1) Criteria failure is the most direct "why FAIL"
  if (criteria && Number.isFinite(criteria.min) && Number.isFinite(criteria.max)) {
    if (selectedVal < criteria.min || selectedVal > criteria.max) {
      el.classList.add('bad');
      const side = selectedVal < criteria.min ? 'below MIN' : 'above MAX';
      el.textContent =
        `Why FAIL: Selected value ${selectedVal.toFixed(3)} is ${side} limit ` +
        `(${criteria.min} – ${criteria.max}) for this QC batch${sdLabel}.`;
      return;
    }
  }

  // 2) If criteria didn’t fail, show sigma-based outlier logic
  if (absZ !== null) {
    if (absZ >= 3) {
      el.classList.add('bad');
      el.textContent = `Why FAIL: Selected value is outside ±3σ (z = ${z.toFixed(2)}).${sdLabel}`;
      return;
    }
    if (absZ >= 2) {
      el.classList.add('bad');
      el.textContent = `Why FAIL: Selected value is outside ±2σ (z = ${z.toFixed(2)}).${sdLabel}`;
      return;
    }
    if (absZ >= 1) {
      el.classList.add('ok');
      el.textContent = `Note: Selected value is outside ±1σ but within ±2σ (z = ${z.toFixed(2)}).${sdLabel}`;
      return;
    }
  }

  // 3) Otherwise, it’s within normal range
  el.classList.add('ok');
  el.textContent = `Looks OK: Selected value is within expected spread for this batch.${sdLabel}`;
}



function populateQCHistParamDropdown(force = false) {
  const sel = document.getElementById('qaqc-hist-param');
  if (!sel || !Array.isArray(cols) || !cols.length) return;

  // Safe fallback if escapeHtml isn't defined
  const esc = (typeof escapeHtml === 'function')
    ? escapeHtml
    : (s) => String(s ?? '').replace(/[&<>"']/g, m => (
        { '&':'&amp;', '<':'&lt;', '>':'&gt;', '"':'&quot;', "'":'&#39;' }[m]
      ));

  // If already populated and not forcing, do nothing
  if (!force && sel.dataset.ready === '1' && sel.options.length > 0) {
    // Ensure selection is still valid after any runtime changes to cols
    const key = window.currentQCParamKey || sel.value || cols[0].k;
    if ([...sel.options].some(o => o.value === key)) sel.value = key;
    return;
  }

  const previous = sel.value || window.currentQCParamKey || '';

  // Build options from your existing parameter config
  sel.innerHTML = cols
    .map(c => `<option value="${esc(c.k)}">${esc(c.n || c.k)}</option>`)
    .join('');

  // Pick default selection
  let key = previous && cols.some(c => c.k === previous)
    ? previous
    : (window.currentQCParamKey && cols.some(c => c.k === window.currentQCParamKey)
        ? window.currentQCParamKey
        : cols[0].k);

  sel.value = key;
  window.currentQCParamKey = key;
  sel.dataset.ready = '1';

  // Optional: immediately draw histogram for the default param
  // (only if histogram canvas exists)
  if (document.getElementById('c-qc-hist')) {
    onQCHistParamChange(); // will compute selectedVal if a row is selected
  }
}

function onQCHistParamChange() {
  const sel = document.getElementById('qaqc-hist-param');
  if (!sel) return;

  const key = sel.value || (cols && cols[0] ? cols[0].k : null);
  if (!key) return;

  window.currentQCParamKey = key;

  // If a QC row is selected, show its selected value line on the histogram
   let selectedVal = null;
  if (window.selectedRowId && Array.isArray(qcData) && qcData.length) {
    const row = qcData.find(r => r && r.id === selectedRowId);
    if (row && row.raw) {
      const val = parseFloat(window.calcMetric(row.raw, key));
      if (Number.isFinite(val)) selectedVal = val;
    }
  }
  updateQCHistogram(key, selectedVal, currentQCBatchId || 'Default');
}

  // Master lists (loaded from QC_Batch and Prod_Batch sheets)
  window.masterLists = window.masterLists || { qcBatches: null, prodBatches: null };
  window.__masterListsState = window.__masterListsState || {
    inFlight: false,
    lastLoadedAt: 0,
    minIntervalMs: 30000
  };

  function loadMasterListsAndRerenderRGB() {
  const hasServer = typeof google !== "undefined" && google.script?.run;
  if (!hasServer) {
    window.masterLists.qcBatches = ["Default"];
    window.masterLists.prodBatches = ["Default"];
    return;
  }

  const st = window.__masterListsState || (window.__masterListsState = {});
  const now = Date.now();
  if (st.inFlight) return;
  if (st.lastLoadedAt && (now - st.lastLoadedAt) < (st.minIntervalMs || 30000)) return;

  st.inFlight = true;
  let pending = 2;

  const done = () => {
    pending -= 1;
    if (pending > 0) return;
    st.inFlight = false;
    st.lastLoadedAt = Date.now();
  };

  // Load both lists in parallel
  google.script.run
    .withSuccessHandler(function (qcBatches) {
      window.masterLists.qcBatches = (Array.isArray(qcBatches) && qcBatches.length) ? qcBatches : ["Default"];
      // If RGB is on screen, rerender so dropdowns get options
      if (typeof renderTable === "function") renderTable("rgb");
      // Also refresh DB dropdown if present
      if (typeof refreshQCCriteriaBatchOptions === "function") refreshQCCriteriaBatchOptions();
      done();
    })
    .withFailureHandler(function (e) {
      console.error("getQCBatchOptions failed:", e);
      window.masterLists.qcBatches = ["Default"];
      done();
    })
    .getQCBatchOptions();

  google.script.run
    .withSuccessHandler(function (prodBatches) {
      window.masterLists.prodBatches = (Array.isArray(prodBatches) && prodBatches.length) ? prodBatches : ["Default"];
      if (typeof renderTable === "function") renderTable("rgb");
      done();
    })
    .withFailureHandler(function (e) {
      console.error("getProdBatchOptions failed:", e);
      window.masterLists.prodBatches = ["Default"];
      done();
    })
    .getProdBatchOptions();
}

function _buildOptionsHtml_(list, currentVal) {
  const cur = String(currentVal || "").trim() || "Default";
  const arr = Array.isArray(list) ? list.slice() : [];
  if (!arr.includes("Default")) arr.push("Default");
  if (cur && !arr.includes(cur)) arr.unshift(cur); // ensure current appears
  // de-dupe
  const seen = new Set();
  const final = arr.filter(x => {
    x = String(x || "").trim();
    if (!x) return false;
    if (seen.has(x)) return false;
    seen.add(x);
    return true;
  });

  return final
    .map(v => `<option value="${escapeHtml(v)}">${escapeHtml(v)}</option>`)
    .join("");
}

function onRgbProdBatchChange(row, newVal) {
  const deviceId = String(row.Device_ID ?? row.did ?? "").trim();
  const testId   = String(row.Test_ID ?? row.tid ?? "").trim();
  const testDate = row.Test_date ?? row.time ?? "";

  const prodBatchId = String(newVal || "Default").trim() || "Default";

  // Update local row object so UI stays consistent without reload
  row.ProdBatch_ID = prodBatchId;
  row.prodbatch_id = prodBatchId;
  row.prodBatchId  = prodBatchId;

  const hasServer = typeof google !== "undefined" && google.script?.run;
  if (!hasServer) return;

  google.script.run
    .withFailureHandler(err => console.error("srvrSetRgbBatchFields(prod) failed:", err))
    .srvrSetRgbBatchFields({ deviceId, testId, testDate, prodBatchId });
}

function onRgbQCBatchChange(row, newVal) {
  const deviceId = String(row.Device_ID ?? row.did ?? "").trim();
  const testId   = String(row.Test_ID ?? row.tid ?? "").trim();
  const testDate = row.Test_date ?? row.time ?? "";

  const qcBatchId = String(newVal || "Default").trim() || "Default";

  row.QCBatch_ID = qcBatchId;
  row.qcbatch_id = qcBatchId;
  row.qcBatchId  = qcBatchId;

  const hasServer = typeof google !== "undefined" && google.script?.run;
  if (!hasServer) return;

  google.script.run
    .withFailureHandler(err => console.error("srvrSetRgbBatchFields(qc) failed:", err))
    .srvrSetRgbBatchFields({ deviceId, testId, testDate, qcBatchId });
}



// RESULTS
function renderResults() {
  const mod = 'results';
  const tbody = document.getElementById('body-results');
  if (!tbody) return;
  tbody.innerHTML = '';

  // Ensure pageState exists
  window.pageState = window.pageState || {};
  if (!pageState[mod] || pageState[mod] < 1) pageState[mod] = 1;

  // -------------------------------
  // SAFE FORMAT HELPERS (local)
  // -------------------------------
  const toNum = (v) => {
    const n = (typeof v === 'number') ? v : Number(v);
    return Number.isFinite(n) ? n : null;
  };
  const fmt2 = (v) => {
    const n = toNum(v);
    return (n == null) ? '' : n.toFixed(2);
  };
  const addStrict = (a, b) => {
    const na = toNum(a), nb = toNum(b);
    if (na == null && nb == null) return null;
    return (na ?? 0) + (nb ?? 0);
  };
  const subStrict = (a, b) => {
    const na = toNum(a), nb = toNum(b);
    if (na == null || nb == null) return null;
    return na - nb;
  };

  // 1. Filter Data
  const devFilter = (document.getElementById(`search-results-dev`)?.value || '').toLowerCase();
  const testFilter = (document.getElementById(`search-results-test`)?.value || '').toLowerCase();
  const dFrom = document.getElementById(`date-results-from`)?.value;
  const dTo = document.getElementById(`date-results-to`)?.value;

  let filtered = (rgbData || []).filter(d =>
    String(d.did || '').toLowerCase().includes(devFilter) &&
    String(d.tid || '').toLowerCase().includes(testFilter)
  );

  if (dFrom || dTo) {
    const t1 = dFrom ? new Date(dFrom) : new Date('1900-01-01');
    const t2 = dTo ? new Date(dTo) : new Date('2100-01-01');
    t2.setHours(23, 59, 59);
    filtered = filtered.filter(d => {
      const date = parseDateObj(d.time);
      return date >= t1 && date <= t2;
    });
  }

  // 2. Pagination Logic
  const perPage = (typeof ROWS_PER_PAGE === 'number' && ROWS_PER_PAGE > 0) ? ROWS_PER_PAGE : 50;
  const totalRows = filtered.length;
  const maxPage = Math.ceil(totalRows / perPage) || 1;
  if (pageState[mod] > maxPage) pageState[mod] = maxPage;

  const startIdx = (pageState[mod] - 1) * perPage;
  const endIdx = Math.min(startIdx + perPage, totalRows);

  // UPDATE PAGINATION TEXT (fixed, consistent)
  setPaginationText('results', startIdx, endIdx, totalRows);

  // 3. Slice Data
  const pageData = filtered.slice(startIdx, endIdx);

  if (pageData.length === 0) {
    tbody.innerHTML = `<tr><td colspan="18" style="padding:20px; text-align:center; color:#666;">No results found</td></tr>`;
    return;
  }

  // 4. Render Rows
  pageData.forEach((d, idx) => {
    const tr = document.createElement('tr');
    tr.dataset.id = d.id;
    if ((multiSelect?.results || []).includes(d.id)) tr.classList.add('selected');

    tr.onclick = () => {
      const arr = multiSelect.results;
      const i = arr.indexOf(d.id);
      if (i > -1) { arr.splice(i, 1); tr.classList.remove('selected'); }
      else { arr.push(d.id); tr.classList.add('selected'); }

      selectedRowId = d.id;
      renderResultsDetails(d);

      const modeSel = document.getElementById('results-lower-mode');
      if (modeSel && modeSel.value === 'rgb') renderResultsRGB();
    };

    const globalIdx = startIdx + idx + 1;
    if (typeof ensureRowRaw === 'function') ensureRowRaw(d);
    const testStatus = evaluateTestSuccess(d);
    const tClass = testStatus === 'PASS' ? 'status-pass' : 'status-fail';

    const r = d.raw || {};

    const phN = toNum(calcMetric(r, 'ph'));
    const ecN = toNum(calcMetric(r, 'ec'));
    const ocN = toNum(getSTV(r, 'oc'));
    const nN  = toNum(addStrict(getSTV(r, 'ammonium'), getSTV(r, 'nitrate')));
    const pN  = toNum(getSTV(r, 'phosphorus'));
    const kN  = toNum(getSTV(r, 'potassium'));
    const sN  = toNum(getSTV(r, 'sulphur'));
    const znN = toNum(subStrict(getSTV(r, 'zinccopper'), getSTV(r, 'copper')));
    const cuN = toNum(getSTV(r, 'copper'));
    const feN = toNum(getSTV(r, 'iron'));
    const mnN = toNum(getSTV(r, 'manganese'));
    const bN  = toNum(getSTV(r, 'boron'));

    const ph = fmt2(phN);
    const ec = fmt2(ecN);
    const oc = fmt2(ocN);
    const n  = fmt2(nN);
    const p  = fmt2(pN);
    const k  = fmt2(kN);
    const s  = fmt2(sN);
    const zn = fmt2(znN);
    const cu = fmt2(cuN);
    const fe = fmt2(feN);
    const mn = fmt2(mnN);
    const b  = fmt2(bN);

    const st = (numVal) => {
      const n = toNum(numVal);
      return (n != null && n <= 0) ? 'val-red' : '';
    };

    tr.innerHTML = `<td>${globalIdx}</td><td class="${tClass}">${testStatus}</td>
      <td><button class="btn btn-sm btn-outline" onclick="downloadResultsReport(event, '${d.tid}', '${d.did}', '${d.crop ?? ''}', '${d.time ?? d.Test_date ?? ''}')">Download report</button></td>
      <td>${d.clientId || d.Client_ID || '-'}</td><td>${d.farmId || d.Farm_ID || '-'}</td><td>${d.crop || '-'}</td><td>${d.tid}</td><td>${d.did}</td><td class="col-date">${d.time}</td>
      <td class="${st(phN)}">${ph}</td><td class="${st(ecN)}">${ec}</td><td class="${st(ocN)}">${oc}</td><td class="${st(nN)}">${n}</td>
      <td class="${st(pN)}">${p}</td><td class="${st(kN)}">${k}</td><td class="${st(sN)}">${s}</td><td class="${st(znN)}">${zn}</td>
      <td class="${st(cuN)}">${cu}</td><td class="${st(feN)}">${fe}</td><td class="${st(mnN)}">${mn}</td><td class="${st(bN)}">${b}</td>`;

    tbody.appendChild(tr);
  });
}

function formatReportDate(testDate) {
  const parsed = parseDateObj(testDate);
  if (!parsed || Number.isNaN(parsed.getTime())) return '00000000';
  const dd = String(parsed.getDate()).padStart(2, '0');
  const mm = String(parsed.getMonth() + 1).padStart(2, '0');
  const yyyy = String(parsed.getFullYear());
  return `${dd}${mm}${yyyy}`;
}

function buildResultsReportId(testId, deviceId, testDate) {
  const testPart = String(testId || 'Test').replace(/[^a-z0-9]+/gi, '').trim() || 'Test';
  const did = String(deviceId || '').trim();
  const last5 = (did.length > 5 ? did.slice(-5) : did.padStart(5, '0')).replace(/[^a-z0-9]+/gi, '');
  const datePart = formatReportDate(testDate);
  return `RPT${last5}${testPart}${datePart}`;
}

function downloadResultsReport(evt, testId, deviceId, crop, testDate) {
  if (evt && typeof evt.stopPropagation === 'function') evt.stopPropagation();
  const button = evt && (evt.currentTarget || evt.target);
  const prevLabel = button ? button.textContent : '';
  const reportId = buildResultsReportId(testId, deviceId, testDate);
  if (button) {
    button.disabled = true;
    button.textContent = 'Preparing...';
  }
  const resetButton = () => {
    if (!button) return;
    button.disabled = false;
    button.textContent = prevLabel || 'Download report';
  };
  if (!testId) {
    alert('Missing Test ID for report export.');
    resetButton();
    return;
  }
  if (typeof google === 'undefined' || !google.script) {
    alert('Report export is only available in the Apps Script deployment.');
    resetButton();
    return;
  }

  google.script.run
    .withSuccessHandler(function (res) {
      resetButton();
      if (!res || !res.success) {
        alert(res && res.msg ? res.msg : 'Failed to generate report PDF.');
        return;
      }
      if (res.downloadUrl) {
        const link = document.createElement('a');
        link.href = res.downloadUrl;
        link.download = `${reportId}.pdf`;
        link.rel = 'noopener';
        link.target = '_blank';
        link.click();
        return;
      }
      if (res.pdfBase64) {
        downloadPDFFromBase64(res.pdfBase64, `${reportId}.pdf`);
      } else {
        alert('PDF generated but no data returned from server.');
      }
    })
    .withFailureHandler(function (err) {
      resetButton();
      alert('Error generating report: ' + (err && err.message ? err.message : err));
    })
    .generateNutrientPlanPDFForTest(testId, deviceId || '');
}



function renderResultsDetails(row) {
    const tbody = document.getElementById('body-results-details');
    tbody.innerHTML = '';

    if (typeof ensureRowRaw === 'function') ensureRowRaw(row);

    dbCriteria.forEach(rule => {
        const rawObj = row.raw[rule.p];
        let val = 0, blank = 0, finalVal = 0;

        if (rawObj) {
            val   = parseFloat(window.calcMetric(row.raw, rule.p));
            blank = blankData.find(b => b.p === rule.p)?.val || 0;
            finalVal = val - blank;
        }

        let fail = false;
        if(rawObj) {
            if (rule.rel === 'between') {
                if (finalVal >= rule.l && finalVal <= rule.u) fail = true;
            } else if (rule.rel === '<') {
                if (finalVal < rule.u) fail = true;
            } else if (rule.rel === '>') {
                if (finalVal > rule.l) fail = true;
            } else if (rule.rel === '=') {
                if (finalVal == rule.l) fail = true;
            }
        }

        let status      = fail ? "FAIL" : "PASS";
        let statusClass = fail ? "val-red" : "status-pass";

        tbody.innerHTML += `
            <tr>
                <td>${row.did}</td>
                <td><b>${cols.find(c => c.k === rule.p).n}</b></td>
                <td class="${fail ? 'val-red' : 'text-black'}">${val.toFixed(3)}</td>
                <td class="text-blue">${(finalVal+blank).toFixed(3)}</td>
                <td>${rawObj ? rawObj.c : '-'}</td>
                <td>${rawObj ? rawObj.t : '-'}</td>
                <td class="${statusClass}">${status}</td>
                <td>${fail ? rule.re : '-'}</td>
                <td>${fail ? rule.ac : '-'}</td>
            </tr>
        `;
    });
}


function pickFirst(obj, keys, fallback = '') {
  for (const k of keys) {
    const v = obj?.[k];
    if (v !== undefined && v !== null && String(v).trim() !== '') return v;
  }
  return fallback;
}

function getMetaCell(d, normKey) {
  // support multiple naming variants
  if (normKey === 'client_id')    return pickFirst(d, ['client_id','Client_ID','ClientId','clientId'], '');
  if (normKey === 'farm_id')      return pickFirst(d, ['farm_id','Farm_ID','FarmId','farmId'], '');
  if (normKey === 'prodbatch_id') return pickFirst(d, ['prodbatch_id','ProdBatch_ID','ProdBatchId','prodbatchId'], '');
  if (normKey === 'qcbatch_id')   return pickFirst(d, ['qcbatch_id','QCBatch_ID','qcBatchId','QC_Batch','qc_batch'], '');
  return '';
}

function getRgbParamDisplayName(label) {
  const map = {
    NH4N: 'Ammonium-N',
    NO3N: 'Nitrate-N',
    OC: 'Organic Carbon',
    P: 'Phosphorus',
    K: 'Potassium',
    S: 'Sulphur',
    ZnCu: 'ZincCopper',
    Cu: 'Copper',
    Fe: 'Iron',
    Mn: 'Manganese',
    B: 'Boron',
    pH: 'pH',
    EC: 'EC'
  };
  return map[label] || label;
}



function renderResultsRGB() {
  const tbody = document.getElementById('body-results-rgb');
  const thead = document.querySelector('#tbl-results-rgb thead');
  if (!tbody || !thead) return;

  const pickFirst = (obj, keys, fallback = '') => {
    for (const k of keys) {
      const v = obj?.[k];
      if (v !== undefined && v !== null && String(v).trim() !== '') return v;
    }
    return fallback;
  };

  const metaClient = (r) => pickFirst(r, ['Client_ID','client_id','clientId'], '');
  const metaFarm   = (r) => pickFirst(r, ['Farm_ID','farm_id','farmId'], '');
  const metaProd   = (r) => pickFirst(r, ['ProdBatch_ID','prodbatch_id','prodBatchId'], '');
  const metaBatch  = (r) => pickFirst(r, ['QCBatch_ID','qcbatch_id','qcBatchId','QC_Batch','qc_batch'], '');

  const ids = multiSelect.results || [];
  let rows = (rgbData || []).filter(r => ids.includes(r.id));

  if (!rows.length && selectedRowId != null) {
    const fallback = (rgbData || []).find(d => d.id === selectedRowId);
    if (fallback) rows = [fallback];
  }

  if (!rows.length) {
    thead.innerHTML = '';
    tbody.innerHTML = `<tr><td style="padding:15px;color:#777;">Select one or more rows in Calculated Metrics</td></tr>`;
    return;
  }

  // Detect flat T/C columns like "..._T" and "..._C"
  const sample = rows[0];
  const tKeys = Object.keys(sample).filter(k => /_T$/i.test(k));
  const pairs = tKeys
    .map(tk => {
      const ck = tk.replace(/_T$/i, '_C');
      if (!(ck in sample)) return null;
      const label = tk.split('_')[0];
      return { label, tKey: tk, cKey: ck };
    })
    .filter(Boolean)
    .sort((a, b) => a.label.localeCompare(b.label));

  const useFlat = pairs.length > 0;

  if (useFlat) {
    // IMPORTANT: header count must match body count
    thead.innerHTML =
      `<tr>
        <th>Client_ID</th>
        <th>Farm_ID</th>
        <th>ProdBatch_ID</th>
        <th>QCBatch_ID</th>
        <th>Test ID</th>
        <th>Device ID</th>
        <th>Test date</th>
        ${pairs.map(p => `<th>${getRgbParamDisplayName(p.label)}<br><small>T | C</small></th>`).join('')}
      </tr>`;

    tbody.innerHTML = '';
    rows.forEach(r => {
      const tr = document.createElement('tr');

      let html =
        `<td>${metaClient(r)}</td>` +
        `<td>${metaFarm(r)}</td>` +
        `<td>${metaProd(r)}</td>` +
        `<td>${metaBatch(r)}</td>` +
        `<td><b>${r.Test_ID ?? r.tid ?? ''}</b></td>` +
        `<td>${r.Device_ID ?? r.did ?? ''}</td>` +
        `<td class="col-date">${r.Test_date ?? r.time ?? ''}</td>`;

      pairs.forEach(p => {
        const tv = (r[p.tKey] ?? '').toString();
        const cv = (r[p.cKey] ?? '').toString();
        html += `<td>${tv} | ${cv}</td>`;
      });

      tr.innerHTML = html;
      tbody.appendChild(tr);
    });

    return;
  }

  // Legacy fallback (unchanged except meta columns in header/body)
  thead.innerHTML =
    `<tr>
      <th>Client</th><th>Farm</th><th>ProdBatch</th><th>QCBatch</th>
      <th>Test ID</th><th>Device ID</th><th>Time</th>
      ${cols.map(c => `<th>${c.n}<br><small>Test | Cal</small></th>`).join('')}
    </tr>`;

  tbody.innerHTML = '';
  rows.forEach(row => {
    const tr = document.createElement('tr');
    let html =
      `<td>${metaClient(row)}</td>` +
      `<td>${metaFarm(row)}</td>` +
      `<td>${metaProd(row)}</td>` +
      `<td>${metaBatch(row)}</td>` +
      `<td><b>${row.tid}</b></td><td>${row.did}</td><td class="col-date">${row.time}</td>`;

    cols.forEach(c => {
      const r = row.raw?.[c.k];
      html += r ? `<td class="${getBandClass(c.b)}">${r.t} | ${r.c}</td>` : `<td>-</td>`;
    });

    tr.innerHTML = html;
    tbody.appendChild(tr);
  });
}



function updateResultsLowerView() {
    const mode = document.getElementById('results-lower-mode').value;
    const dBox = document.getElementById('results-details-container');
    const rBox = document.getElementById('results-rgb-container');
    if (mode === 'details') {
        dBox.style.display = 'block';
        rBox.style.display = 'none';
    } else {
        dBox.style.display = 'none';
        rBox.style.display = 'block';
        renderResultsRGB();
    }
}

function ensureOperationalDataLoaded(options = {}) {
    const mode = options.mode || 'full';
    const force = !!options.force;

    if (window.isHeavyDataLoaded && !force) {
        if (mode === 'full') {
            if (typeof renderTable === 'function') renderTable('rgb');
            if (typeof setRgbFocus === 'function') setRgbFocus('metrics');
            if (typeof renderTable === 'function') renderTable('qaqc');
            if (typeof setQaqcFocus === 'function') setQaqcFocus('results');
            if (typeof renderResults === 'function') renderResults();
        } else if (mode === 'results') {
            if (typeof renderResults === 'function') renderResults();
        }
        return;
    }

    loadOperationalData({ mode, force });
}


// Module navigation (left sidebar)
function nav(id, e) {
    // 1. Reset all modules
    document.querySelectorAll('.module-view').forEach(elem => elem.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(elem => elem.classList.remove('active'));

    // 2. Activate target module
    const modEl = document.getElementById('mod-' + id);
    if (modEl) modEl.classList.add('active');

    // 3. Highlight Sidebar Item
    if (e && e.currentTarget) {
        e.currentTarget.classList.add('active');
    }

    // 4. Module-Specific Logic (Refreshes)
    const isUserNav = !!(e && e.currentTarget);
    if (isUserNav && id === 'rgb')      ensureOperationalDataLoaded({ mode: 'full', reason: 'nav-rgb' });
    if (isUserNav && id === 'qaqc')     ensureOperationalDataLoaded({ mode: 'full', reason: 'nav-qaqc' });
    if (isUserNav && id === 'results')  ensureOperationalDataLoaded({ mode: 'results', reason: 'nav-results' });
    if (id === 'devices') {
        // Default to registry when opening Devices module
        // We simulate a click on the 'install-reg' tab button if needed
        renderDeviceRegistry();
    }
    if (id === 'stv-direct') {
        refreshSTVDirect();
    }
    if (id === 'inventory') {
        initInventoryModule();
    }
    if (id === 'analytics') {
        if (isUserNav) ensureOperationalDataLoaded({ mode: 'full', reason: 'nav-analytics' });
        updateAnalyticsCharts();
    }
    if (id === "labval") {
  lvInitIfNeeded();
  if (isUserNav) ensureOperationalDataLoaded({ mode: 'full', reason: 'nav-labval' });

  // Auto-draw scatter charts when opening Lab Validation
  setTimeout(() => {
    lvAutoPickPairIfEmpty();   // optional, only if IDs are empty
    lvRenderCorrelations();    // this draws the scatter charts
  }, 0);
}


}


// ==========================================
// ADMIN LOGIC: PERMISSION MANAGEMENT
// ==========================================

const ACCESS_TREE = [
    { id: 'rgb', label: 'RGB / Abs', children: [
        { id: 'rgb.controls', label: 'Controls', children: [
            { id: 'rgb.controls.pagination', label: 'Pagination' },
            { id: 'rgb.controls.date', label: 'Date Range' },
            { id: 'rgb.controls.search', label: 'Device/Test Search' },
            { id: 'rgb.controls.import', label: 'Import CSV' },
            { id: 'rgb.controls.template', label: 'Download Template' },
            { id: 'rgb.controls.export', label: 'Export' },
            { id: 'rgb.controls.reset', label: 'Reset Data' },
            { id: 'rgb.controls.move-qc', label: 'Move to QC' }
        ]},
        { id: 'rgb.views', label: 'Views', children: [
            { id: 'rgb.metrics', label: 'Calculated Metrics' },
            { id: 'rgb.raw', label: 'Raw RGB Data' }
        ]}
    ]},
    { id: 'qaqc', label: 'Device QA/QC', children: [
        { id: 'qaqc.controls', label: 'Controls', children: [
            { id: 'qaqc.controls.tabs', label: 'Quarantine/Status Tabs' },
            { id: 'qaqc.controls.pagination', label: 'Pagination' },
            { id: 'qaqc.controls.date', label: 'Date Range' },
            { id: 'qaqc.controls.search', label: 'Device/Test Search' },
            { id: 'qaqc.controls.move-rgb', label: 'Move to RGB/Abs' },
            { id: 'qaqc.controls.raw-toggle', label: 'Raw RGB Toggle' }
        ]},
        { id: 'qaqc.results', label: 'Quarantine Data' },
        { id: 'qaqc.status', label: 'QC Status View' }
    ]},
    { id: 'results', label: 'Soil Results', children: [
        { id: 'results.controls', label: 'Controls', children: [
            { id: 'results.controls.pagination', label: 'Pagination' },
            { id: 'results.controls.date', label: 'Date Range' },
            { id: 'results.controls.search', label: 'Device/Test Search' },
            { id: 'results.controls.refresh', label: 'Refresh Results' },
            { id: 'results.controls.stv-tag', label: 'STV Version Tag' },
            { id: 'results.controls.download-report', label: 'Download Report' }
        ]},
        { id: 'results.table', label: 'Results Table' },
        { id: 'results.success', label: 'Success/Abs View' }
    ]},
    { id: 'stv-direct', label: 'STV Direct', children: [
        { id: 'stv-direct.controls', label: 'Controls', children: [
            { id: 'stv-direct.controls.import', label: 'Import CSV' },
            { id: 'stv-direct.controls.refresh', label: 'Refresh' },
            { id: 'stv-direct.controls.export-csv', label: 'Export CSV' },
            { id: 'stv-direct.controls.export-pdf', label: 'Export PDF' }
        ]},
        { id: 'stv-direct.table', label: 'STV Direct Table' }
    ]},
    { id: 'inventory', label: 'Inventory Manager', children: [
        { id: 'inventory.stock', label: 'Stock', children: [
            { id: 'inventory.stock.parts', label: 'Parts', children: [
                { id: 'inventory.stock.parts.edit', label: 'Edit Toggle' },
                { id: 'inventory.stock.parts.add', label: 'Add Row' },
                { id: 'inventory.stock.parts.delete', label: 'Delete Selected' },
                { id: 'inventory.stock.parts.save', label: 'Save' }
            ]},
            { id: 'inventory.stock.built', label: 'Built Units', children: [
                { id: 'inventory.stock.built.edit', label: 'Edit Toggle' },
                { id: 'inventory.stock.built.add', label: 'Add Row' },
                { id: 'inventory.stock.built.delete', label: 'Delete Selected' },
                { id: 'inventory.stock.built.save', label: 'Save' }
            ]}
        ]},
        { id: 'inventory.constitution', label: 'Device Constitution', children: [
            { id: 'inventory.constitution.edit', label: 'Edit Toggle' },
            { id: 'inventory.constitution.add', label: 'Add Row' },
            { id: 'inventory.constitution.import', label: 'Import CSV' },
            { id: 'inventory.constitution.delete', label: 'Delete Selected' },
            { id: 'inventory.constitution.save', label: 'Save' }
        ]},
        { id: 'inventory.liquidation', label: 'Liquidation', children: [
            { id: 'inventory.liquidation.edit', label: 'Edit Toggle' },
            { id: 'inventory.liquidation.add', label: 'Add Row' },
            { id: 'inventory.liquidation.delete', label: 'Delete Selected' },
            { id: 'inventory.liquidation.save', label: 'Save' }
        ]},
        { id: 'inventory.approvals', label: 'Approvals', children: [
            { id: 'inventory.approvals.edit', label: 'Edit Toggle' },
            { id: 'inventory.approvals.add', label: 'Add Row' },
            { id: 'inventory.approvals.delete', label: 'Delete Selected' },
            { id: 'inventory.approvals.save', label: 'Save' }
        ]},
        { id: 'inventory.clients', label: 'Clients', children: [
            { id: 'inventory.clients.edit', label: 'Edit Toggle' },
            { id: 'inventory.clients.add', label: 'Add Row' },
            { id: 'inventory.clients.delete', label: 'Delete Selected' },
            { id: 'inventory.clients.save', label: 'Save' }
        ]},
        { id: 'inventory.prod-batch', label: 'Prod Batch', children: [
            { id: 'inventory.prod-batch.edit', label: 'Edit Toggle' },
            { id: 'inventory.prod-batch.add', label: 'Add Row' },
            { id: 'inventory.prod-batch.delete', label: 'Delete Selected' },
            { id: 'inventory.prod-batch.save', label: 'Save' }
        ]},
        { id: 'inventory.refill', label: 'Refill Batch', children: [
            { id: 'inventory.refill.edit', label: 'Edit Toggle' },
            { id: 'inventory.refill.add', label: 'Add Row' },
            { id: 'inventory.refill.delete', label: 'Delete Selected' },
            { id: 'inventory.refill.save', label: 'Save' }
        ]}
    ]},
    { id: 'db', label: 'Database', children: [
        { id: 'db.criteria', label: 'Success Criteria' },
        { id: 'db.stv', label: 'STV Logic' },
        { id: 'db.qc-criteria', label: 'QA/QC Criteria' },
        { id: 'db.blanks', label: 'Blank Values' },
        { id: 'db.qc-batch', label: 'QC Batch' }
    ]},
    { id: 'devices', label: 'Devices', children: [
        { id: 'devices.install-reg', label: 'Installation Registry', children: [
            { id: 'devices.install-reg.installed', label: 'Installed Devices', children: [
                { id: 'devices.install-reg.controls.search', label: 'Search' },
                { id: 'devices.install-reg.controls.add', label: 'Add Row' },
                { id: 'devices.install-reg.controls.delete', label: 'Delete Rows' },
                { id: 'devices.install-reg.controls.save', label: 'Save' },
                { id: 'devices.install-reg.controls.edit', label: 'Edit Toggle' },
                { id: 'devices.install-reg.controls.view', label: 'View Panel' },
                { id: 'devices.install-reg.controls.download-report', label: 'Download Report' },
                { id: 'devices.install-reg.controls.results-toggle', label: 'Results/Quarantine Toggle' }
            ]},
            { id: 'devices.install-reg.map', label: 'Map View', children: [
                { id: 'devices.install-reg.map.search', label: 'Map Search' },
                { id: 'devices.install-reg.map.refresh', label: 'Refresh Map' }
            ]}
        ]},
        { id: 'devices.service-reg', label: 'Service Registry', children: [
            { id: 'devices.service-reg.search', label: 'Search' },
            { id: 'devices.service-reg.clear', label: 'Clear Search' },
            { id: 'devices.service-reg.new-ticket', label: 'New Ticket' },
            { id: 'devices.service-reg.history', label: 'Fetch Service History' },
            { id: 'devices.service-reg.export', label: 'Export Form' },
            { id: 'devices.service-reg.submit', label: 'Submit Form' }
        ]}
    ]},
    { id: 'analytics', label: 'Analytics' },
    { id: 'fertilizer', label: 'Nutrient Manager', children: [
        { id: 'fertilizer.controls', label: 'Controls', children: [
            { id: 'fertilizer.controls.schedule-toggle', label: 'Schedule Toggle' },
            { id: 'fertilizer.controls.export', label: 'Export Report' }
        ]}
    ]},
    { id: 'impact', label: 'Impact Assess.' },
    { id: 'feedback', label: 'User Feedback' },
    { id: 'admin', label: 'Admin', children: [
        { id: 'admin.create', label: 'Create User' },
        { id: 'admin.manage', label: 'Manage Permissions' },
        { id: 'admin.reset', label: 'Reset Password' }
    ]}
];

// Initialize the "Create User" access tree on load
document.addEventListener('DOMContentLoaded', () => {
    renderAccessTree('adm-new-access-tree', []);
});

function renderAccessTree(containerId, selectedIds = []) {
    const container = document.getElementById(containerId);
    if (!container) return;
    const selected = new Set(selectedIds || []);

    const renderNode = (node) => {
        const hasChildren = Array.isArray(node.children) && node.children.length > 0;
        const checked = selected.has(node.id) ? 'checked' : '';
        const childrenHtml = hasChildren
            ? `<div class="access-tree-children">
                ${node.children.map(renderNode).join('')}
              </div>`
            : '';
        return `
          <div>
            <label class="access-tree-item">
              <input type="checkbox" data-access-id="${node.id}" ${checked}>
              <span>${node.label}</span>
            </label>
            ${childrenHtml}
          </div>
        `;
    };

    container.innerHTML = ACCESS_TREE.map(renderNode).join('');
    wireAccessTree(container);
    syncAccessTree(container);
}

function wireAccessTree(container) {
    const checkboxes = Array.from(container.querySelectorAll('input[type="checkbox"][data-access-id]'));
    checkboxes.forEach(cb => {
        cb.addEventListener('change', () => {
            const id = cb.dataset.accessId;
            const descendants = checkboxes.filter(c => c.dataset.accessId.startsWith(id + '.'));
            descendants.forEach(d => { d.checked = cb.checked; d.indeterminate = false; });
            syncAccessTree(container);
        });
    });
}

function syncAccessTree(container) {
    const checkboxes = Array.from(container.querySelectorAll('input[type="checkbox"][data-access-id]'));
    const byId = new Map(checkboxes.map(cb => [cb.dataset.accessId, cb]));

    const ids = Array.from(byId.keys()).sort((a, b) => b.split('.').length - a.split('.').length);
    ids.forEach(id => {
        const parts = id.split('.');
        if (parts.length <= 1) return;
        parts.pop();
        const parentId = parts.join('.');
        const parent = byId.get(parentId);
        if (!parent) return;
        const children = checkboxes.filter(cb => cb.dataset.accessId.startsWith(parentId + '.') && cb.dataset.accessId.split('.').length === parentId.split('.').length + 1);
        const allChecked = children.length && children.every(c => c.checked);
        const someChecked = children.some(c => c.checked || c.indeterminate);
        parent.checked = allChecked;
        parent.indeterminate = !allChecked && someChecked;
    });
}

function collectAccessSelections(containerId) {
    const container = document.getElementById(containerId);
    if (!container) return [];
    const checks = container.querySelectorAll('input[type="checkbox"][data-access-id]:checked');
    return Array.from(checks).map(c => c.dataset.accessId);
}

function normalizeAccessList(entries) {
    const list = Array.isArray(entries) ? entries : [];
    const out = new Set(list);
    list.forEach(id => {
        const root = id.split('.')[0];
        if (root) out.add(root);
    });
    return Array.from(out);
}

// 1. CREATE USER
function createUser() {
    const type = document.getElementById('adm-type').value;
    const user = document.getElementById('adm-user').value.trim();
    const pass = document.getElementById('adm-pass').value.trim();
    
    const treeSelections = collectAccessSelections('adm-new-access-tree');
    const mergedSelections = normalizeAccessList(treeSelections);

    let email = prompt("Please enter the user's @absolute.ag email:");
    if(!email) return;
    
    if (!email.endsWith('@absolute.ag')) {
        alert("Error: Email must end with @absolute.ag");
        return;
    }

    if (!user || !pass) {
        alert("Please enter Employee ID and Password.");
        return;
    }

    const data = {
        empId: user,
        email: email,
        password: pass,
        role: type,
        modules: mergedSelections // Send array of modules
    };

    google.script.run.withSuccessHandler(msg => {
        alert(msg);
        // Clear fields
        document.getElementById('adm-user').value = '';
        document.getElementById('adm-pass').value = '';
        renderAccessTree('adm-new-access-tree', []);
        // Refresh list
        refreshUserList();
    }).withFailureHandler(err => {
        alert("Error: " + err.message);
    }).adminCreateUser(data);
}

// 2. MANAGE EXISTING USERS
let cachedUsers = [];

function refreshUserList() {
    const sel = document.getElementById('adm-existing-list');
    sel.innerHTML = '<option>Loading...</option>';
    
    google.script.run.withSuccessHandler(users => {
        cachedUsers = users;
        sel.innerHTML = '<option value="">Select a User...</option>';
        users.forEach(u => {
            const opt = document.createElement('option');
            opt.value = u.empId;
            opt.text = `${u.empId} (${u.role})`;
            sel.appendChild(opt);
        });
        document.getElementById('adm-edit-container').style.display = 'none';
    }).getAllUsers();
}

function loadUserPermissions() {
    const empId = document.getElementById('adm-existing-list').value;
    const container = document.getElementById('adm-edit-container');
    const roleSpan = document.getElementById('adm-edit-role');
    const accessTreeContainer = document.getElementById('adm-edit-access-tree');

    if (!empId) {
        container.style.display = 'none';
        return;
    }

    const user = cachedUsers.find(u => u.empId === empId);
    if (!user) return;

    container.style.display = 'block';
    roleSpan.innerText = user.role;

    // Render checkboxes with user's current permissions ticked
    // If user has NO custom permissions (empty array), fallback to Role defaults logic if you want, 
    // but here we show what is explicitly saved.
    
    const userModules = user.modules || [];
    renderAccessTree('adm-edit-access-tree', userModules);
    if (accessTreeContainer) syncAccessTree(accessTreeContainer);
}

function saveUserPermissions() {
    const empId = document.getElementById('adm-existing-list').value;
    if(!empId) return;

    const treeSelections = collectAccessSelections('adm-edit-access-tree');
    const mergedSelections = normalizeAccessList(treeSelections);

    google.script.run.withSuccessHandler(msg => {
        alert(msg);
        refreshUserList(); // Reload to update cache
    }).withFailureHandler(err => {
        alert("Error: " + err.message);
    }).adminUpdateUserPermissions(empId, mergedSelections);
}

function adminResetPassword() {
    const empId = document.getElementById('adm-existing-list').value;
    const newPass = document.getElementById('adm-reset-pass').value.trim();
    if (!empId) return alert('Select a user first.');
    if (!newPass) return alert('Enter a new password.');

    if (!confirm(`Reset password for ${empId}?`)) return;

    google.script.run.withSuccessHandler(msg => {
        alert(msg);
        document.getElementById('adm-reset-pass').value = '';
    }).withFailureHandler(err => {
        alert("Error: " + err.message);
    }).adminResetUserPassword(empId, newPass);
}




// DB RENDERERS
function renderCriteria() {
    const tbody = document.getElementById('body-criteria');
    tbody.innerHTML = '';
    const spectros  = ['S1','S2','S0'];
    const metrics   = ['Abs','Val'];
    const relations = ['between','<','>','='];

    dbCriteria.forEach(r => {
        const tr = document.createElement('tr');
        const createSelect = (opts, v) => {
            let s = `<select class="db-input">`;
            opts.forEach(o => {
                if (typeof o === 'string')
                    s += `<option value="${o}" ${o===v?'selected':''}>${o}</option>`;
                else
                    s += `<option value="${o.k}" ${o.k===v?'selected':''}>${o.n}</option>`;
            });
            s += `</select>`;
            return s;
        };
        tr.innerHTML = `
            <td>${createSelect(spectros, r.s)}</td>
            <td>${createSelect(cols.map(c=>({k:c.k,n:c.n})), r.p)}</td>
            <td>${createSelect(metrics, r.m)}</td>
            <td><input type="text" class="db-input" value="${r.l ?? ''}"></td>
            <td>${createSelect(relations, r.rel)}</td>
            <td><input type="text" class="db-input" value="${r.u ?? ''}"></td>
            <td><input type="text" class="db-input" value="${r.re ?? ''}"></td>
            <td><input type="text" class="db-input" value="${r.ac ?? ''}"></td>
        `;
        tbody.appendChild(tr);
    });
}
function renderSTV() {
    const tbody = document.getElementById('body-stv');
    tbody.innerHTML = '';
    stvData.forEach(r => {
        const tr = document.createElement('tr');
        let pSel = `<select class="db-input">` +
            cols.map(c => `<option value="${c.k}" ${c.k===r.p?'selected':''}>${c.n}</option>`).join('') +
            `</select>`;
        tr.innerHTML = `
            <td>${pSel}</td>
            <td><input type="text" class="db-input" value="${r.a ?? ''}"></td>
            <td><input type="text" class="db-input" value="${r.b ?? ''}"></td>
            <td><input type="text" class="db-input" value="${r.df1 ?? ''}"></td>
            <td><input type="text" class="db-input" value="${r.df2 ?? ''}"></td>
            <td><input type="text" class="db-input" value="${r.df3 ?? ''}"></td>
            <td><input type="text" class="db-input" value="${r.df4 ?? ''}"></td>
        `;
        tbody.appendChild(tr);
    });
}

function renderQCCriteria() {
  const tbody = document.getElementById("body-qc-criteria");
  if (!tbody) return;

  const activeBatch = String(window.currentQCCriteriaBatchId || "Default").trim() || "Default";

  // Ensure array exists
  if (!Array.isArray(qcCriteriaData)) qcCriteriaData = [];

  // Filter rows for this batch (supports older field names too)
  let rowsForBatch = qcCriteriaData.filter(r =>
    String(r?.batch || r?.qcBatchId || "Default").trim() === activeBatch
  );

  // If none exist for this batch, auto-create 13 rows (one per param)
  if (!rowsForBatch.length) {
    rowsForBatch = cols.map(c => ({
      batch: activeBatch,
      p: c.k,
      min: "",
      max: "",
      mean: ""
    }));

    // Replace any old rows for this batch completely
    const kept = qcCriteriaData.filter(r =>
      String(r?.batch || r?.qcBatchId || "Default").trim() !== activeBatch
    );
    qcCriteriaData = [...kept, ...rowsForBatch];
  }

  tbody.innerHTML = "";

    rowsForBatch.forEach((r, idx) => {
    const tr = document.createElement("tr");
    tr.dataset.idx = String(idx);

    const batchCellHtml = `
      <div style="display:flex; align-items:center; gap:8px;">
        <span class="qc-batch-label">${escapeHtml(activeBatch)}</span>
        <input type="hidden" class="qc-batch-cell" value="${escapeHtml(activeBatch)}">
      </div>
    `;

    const pSel = `
      <select class="db-input qc-param-select">
        ${cols.map(c =>
          `<option value="${escapeHtml(c.k)}" ${c.k === r.p ? "selected" : ""}>${escapeHtml(c.n)}</option>`
        ).join("")}
      </select>
    `;

    // Coerce numeric fields to string so escapeHtml works safely
    const vMin  = r.min  == null ? "" : String(r.min);
    const vMax  = r.max  == null ? "" : String(r.max);
    const vMean = r.mean == null ? "" : String(r.mean);
    const vSd   = r.sd   == null ? "" : String(r.sd);

    tr.innerHTML = `
      <td>${batchCellHtml}</td>
      <td>${pSel}</td>
      <td><input type="text" class="db-input qc-abs-min"  value="${escapeHtml(vMin)}"></td>
      <td><input type="text" class="db-input qc-abs-max"  value="${escapeHtml(vMax)}"></td>
      <td><input type="text" class="db-input qc-abs-mean" value="${escapeHtml(vMean)}"></td>
      <td><input type="text" class="db-input qc-abs-sd" value="${escapeHtml(vSd)}" readonly></td>
    `;
    tbody.appendChild(tr);
  });
}



function renderBlanks() {
    const tbody = document.getElementById('body-blanks');
    tbody.innerHTML = '';
    
    blankData.forEach((r, index) => {
        const tr = document.createElement('tr');
        
        // Create parameter dropdown
        let pSel = `<select class="db-input" onchange="updateBlankParam(${index}, this.value)">`;
        cols.forEach(c => {
            pSel += `<option value="${c.k}" ${c.k === r.p ? 'selected' : ''}>${c.n}</option>`;
        });
        pSel += `</select>`;

        tr.innerHTML = `
            <td>${pSel}</td>
            <td><input type="text" class="db-input" value="${r.val ?? ''}" onchange="updateBlankVal(${index}, this.value)"></td>
        `;
        tbody.appendChild(tr);
    });
}

// Helpers to update data model immediately when inputs change
function updateBlankParam(index, newVal) {
    if (blankData[index]) blankData[index].p = newVal;
}
function updateBlankVal(index, newVal) {
    if (blankData[index]) blankData[index].val = parseFloat(newVal) || 0;
}


let registryEditMode = false;
let registryDetailMode = 'results';
let registryDetailDeviceId = '';
let registryDetailSelectedIds = [];
let registryDetailSelectedRow = null;

function toggleRegistryEditMode(toggle) {
  registryEditMode = !!(toggle && toggle.checked);
  applyRegistryEditMode();
}

function applyRegistryEditMode() {
  const panel = document.getElementById('install-upper');
  const toggle = document.getElementById('registry-edit-toggle');
  if (panel) {
    panel.classList.toggle('registry-editing', registryEditMode);
    panel.classList.toggle('registry-readonly', !registryEditMode);
  }
  if (toggle) toggle.checked = registryEditMode;
  setRegistryReadOnly(!registryEditMode);
}

function setRegistryReadOnly(readonly) {
  const inputs = document.querySelectorAll('#body-device-registry .db-input');
  inputs.forEach(input => {
    if (input.type === 'checkbox') return;
    if (input.dataset.locked === 'true') {
      input.readOnly = true;
      input.disabled = true;
      input.tabIndex = -1;
      return;
    }
    input.readOnly = readonly;
    input.disabled = readonly;
    input.tabIndex = readonly ? -1 : 0;
  });

  const placeInputs = document.querySelectorAll('#body-device-registry input.reg-place-proxy');
  placeInputs.forEach(input => {
    input.readOnly = readonly;
    input.disabled = readonly;
    input.tabIndex = readonly ? -1 : 0;
  });

  refreshRegistryTextareaHeights();
}

let registrySearchTerm = '';
let registryMapSearchTerm = '';

function filterRegistryTable(value) {
  registrySearchTerm = String(value || '').trim().toLowerCase();
  renderDeviceRegistry();
}

function filterRegistryMap(value) {
  registryMapSearchTerm = String(value || '').trim().toLowerCase();
  renderMapView();
}

function matchesRegistrySearch(row, term) {
  if (!term) return true;
  const haystack = [
    row.client,
    row.did,
    row.mobile,
    row.moName,
    row.place
  ]
    .map(v => String(v ?? '').toLowerCase())
    .join(' ');
  return haystack.includes(term);
}

function enforceRegistryTextLimit(value, maxChars = 50) {
  const text = String(value || '');
  if (!text) return '';
  return text.slice(0, maxChars);
}

function getProdBatchIdsFromMaster_() {
  try {
    const dbRows = window.dbMasters?.prod?.rows;
    if (Array.isArray(dbRows)) {
      const ids = dbRows
        .map(row => String(row?.ProdBatch_ID ?? '').trim())
        .filter(Boolean);
      if (ids.length) return Array.from(new Set(ids));
    }
  } catch (e) {}
  const fallback = window.masterLists?.prodBatchIds;
  if (Array.isArray(fallback) && fallback.length) {
    return fallback.map(x => String(x || '').trim()).filter(Boolean);
  }
  return ['Default'];
}

function buildProdBatchOptions_(currentValue) {
  const ids = getProdBatchIdsFromMaster_();
  const selectedValue = String(currentValue || '').trim() || 'Default';
  if (!ids.includes('Default')) ids.unshift('Default');
  const unique = Array.from(new Set(ids));
  return unique.map(id => {
    const val = String(id || '').trim();
    const selected = val === selectedValue ? 'selected' : '';
    return `<option value="${escapeHtml(val)}" ${selected}>${escapeHtml(val)}</option>`;
  }).join('');
}

function updateRegistryProdBatch(selectEl, did) {
  const value = String(selectEl?.value || '').trim();
  const row = deviceRegistry.find(r => String(r.did || '') === String(did || ''));
  if (row) row.prodBatchId = value;
}

function autoResizeRegistryTextarea(el) {
  if (!el) return;
  el.style.height = 'auto';
  el.style.height = `${el.scrollHeight}px`;
}

function wireRegistryTextLimits(tr) {
  if (!tr) return;
  const fields = tr.querySelectorAll('.reg-limited');
  fields.forEach(field => {
    const handler = () => {
      const limited = enforceRegistryTextLimit(field.value);
      if (field.value !== limited) field.value = limited;
      autoResizeRegistryTextarea(field);
    };
    field.addEventListener('input', handler);
    handler();
  });
}

function refreshRegistryTextareaHeights() {
  const fields = document.querySelectorAll('#body-device-registry .reg-limited');
  fields.forEach(field => {
    autoResizeRegistryTextarea(field);
  });
}

function toggleRegistrySelectAll(source) {
  const checks = document.querySelectorAll('#body-device-registry .reg-select');
  checks.forEach(cb => { cb.checked = source.checked; });
}

function removeRegistryRows() {
  if (!registryEditMode) return;
  const tbody = document.getElementById('body-device-registry');
  if (!tbody) return;
  const rows = Array.from(tbody.querySelectorAll('tr'));
  let removed = 0;
  rows.forEach(row => {
    const cb = row.querySelector('.reg-select');
    if (cb && cb.checked) {
      row.remove();
      removed += 1;
    }
  });
  if (removed === 0) showToast('Select at least one row to remove.', 'warning');
}

function renderDeviceRegistry() {
  const tbody = document.getElementById('body-device-registry');
  if (!tbody) return;

  // NEW: ensure headers are always present (every re-render)
  const thead = document.querySelector('#tbl-device-registry thead');
  if (thead) {
    thead.innerHTML = `
      <tr>
        <th class="registry-edit-only" data-col="select"><input type="checkbox" aria-label="Select all" onclick="toggleRegistrySelectAll(this)"></th>
        <th data-col="client">Client</th>
        <th data-col="company">Company</th>
        <th data-col="pan">PAN</th>
        <th data-col="gstin">GSTIN</th>
        <th data-col="address">Address</th>
        <th data-col="did">Device ID</th>
        <th data-col="sim">SIM</th>
        <th data-col="aadhaar">Aadhaar</th>
        <th data-col="mobile">Mobile</th>
        <th data-col="moName">MO Name</th>
        <th data-col="date">Date</th>
        <th data-col="place">Place</th>
        <th data-col="gps">GPS</th>
        <th data-col="pin">PIN</th>
        <th data-col="block">Block</th>
        <th data-col="district">District</th>
        <th data-col="state">State</th>
        <th data-col="prodBatchId">Prod Batch</th>
        <th data-col="action">Action</th>
      </tr>
    `;
  }

  tbody.innerHTML = '';

  if (!Array.isArray(deviceRegistry) || deviceRegistry.length === 0) {
    addRegistryRow(true);
    applyRegistryEditMode();
    return;
  }

  const filteredRegistry = deviceRegistry.filter(r => matchesRegistrySearch(r, registrySearchTerm));

  filteredRegistry.forEach(function (r) {
    const tr = document.createElement('tr');
    tr.style.cursor = 'pointer'; // Show hand cursor to indicate clickability

    const safeDid = escapeHtml(String(r.did ?? ''));
    const prodBatchOptions = buildProdBatchOptions_(r.prodBatchId);
    const gstinLocked = String(r.gstin ?? '').trim() !== '';
    const gstinAttrs = gstinLocked ? 'data-locked="true" readonly disabled' : '';
    tr.innerHTML = `
      <td class="registry-edit-only"><input type="checkbox" class="reg-select" aria-label="Select row"></td>
      <td><textarea class="db-input db-textarea reg-client reg-limited" data-col="client" placeholder="Client" rows="1" maxlength="50">${r.client ?? ''}</textarea></td>
      <td><textarea class="db-input db-textarea reg-company reg-limited" data-col="company" rows="1" maxlength="50">${r.company ?? ''}</textarea></td>
      <td><input type="text" class="db-input reg-pan" data-col="pan" value="${r.pan ?? ''}"></td>
      <td><input type="text" class="db-input reg-gstin" data-col="gstin" value="${r.gstin ?? ''}" ${gstinAttrs}></td>
      <td><textarea class="db-input db-textarea reg-address reg-limited" data-col="address" rows="1" maxlength="50">${r.address ?? ''}</textarea></td>
      <td><input type="text" class="db-input reg-did" data-col="did" value="${r.did ?? ''}"></td>
      <td><input type="text" class="db-input reg-sim" data-col="sim" value="${r.sim ?? ''}"></td>
      <td><input type="text" class="db-input reg-aadhaar" data-col="aadhaar" value="${r.aadhaar ?? ''}"></td>
      <td><input type="text" class="db-input reg-mobile" data-col="mobile" value="${r.mobile ?? ''}" oninput="limitPhoneInput(this)"></td>
      <td><textarea class="db-input db-textarea reg-moName reg-limited" data-col="moName" rows="1" maxlength="50">${r.moName ?? ''}</textarea></td>
      <td><input type="date" class="db-input reg-date" data-col="date" value="${r.date ?? ''}"></td>
      <td><textarea class="db-input db-textarea reg-place reg-limited" data-col="place" rows="1" maxlength="50">${r.place ?? ''}</textarea></td>
      <td><input type="text" class="db-input reg-gps" data-col="gps" value="${r.gps ?? ''}" placeholder="Lat, Lon"></td>
      <td><input type="text" class="db-input reg-pin" data-col="pin" value="${r.pin ?? ''}"></td>
      <td><textarea class="db-input db-textarea reg-block reg-limited" data-col="block" rows="1" maxlength="50">${r.block ?? ''}</textarea></td>
      <td><textarea class="db-input db-textarea reg-district reg-limited" data-col="district" rows="1" maxlength="50">${r.district ?? ''}</textarea></td>
      <td><textarea class="db-input db-textarea reg-state reg-limited" data-col="state" rows="1" maxlength="50">${r.state ?? ''}</textarea></td>
      <td>
        <select class="db-input reg-prod-batch" data-col="prodBatchId" onchange="updateRegistryProdBatch(this, '${safeDid}')">
          ${prodBatchOptions}
        </select>
      </td>
      <td><button class="btn btn-outline btn-sm" onclick="openRegistryDetailPanel('${safeDid}')">View</button></td>
    `;

    // --- NEW: Row Click Logic ---
    tr.addEventListener('click', function(e) {
      if (['INPUT', 'TEXTAREA'].includes(e.target.tagName)) return;

      const gpsInput = tr.querySelector('.reg-gps');
      const val = gpsInput.value;
      let coords = parseLatLonString(val);

      if (!coords && gpsInput.dataset.lat) {
        coords = { lat: parseFloat(gpsInput.dataset.lat), lng: parseFloat(gpsInput.dataset.lng) };
      }

      if (coords && mapInstance) {
        mapInstance.setView([coords.lat, coords.lng], 16);
        L.popup()
          .setLatLng(coords)
          .setContent("<b>" + (r.client ?? 'Client') + "</b><br>" + (r.did ?? ''))
          .openOn(mapInstance);
      }
    });

    const gpsIn = tr.querySelector('.reg-gps');
    if (gpsIn) gpsIn.addEventListener('blur', function() { renderMapView(); });

    tbody.appendChild(tr);

    if (typeof wireRegistryRowValidation === 'function') wireRegistryRowValidation(tr);
    wireRegistryTextLimits(tr);
    const placeInput = tr.querySelector('.reg-place');
    if (placeInput && typeof initRegistryLocationAutocomplete === 'function') initRegistryLocationAutocomplete(placeInput);
  });

  applyRegistryEditMode();
  const searchInput = document.getElementById('registry-search-installed');
  if (searchInput && searchInput.value !== registrySearchTerm) {
    searchInput.value = registrySearchTerm;
  }
  initRegistryColumnSizing();
  refreshRegistryTextareaHeights();
  setTimeout(renderMapView, 500);
}

function openRegistryDetailPanel(deviceId) {
  const panel = document.getElementById('registry-detail-panel');
  const split = panel?.closest('.registry-split');
  const subtitle = document.getElementById('registry-detail-subtitle');
  const stats = document.getElementById('registry-detail-stats');
  const toggle = document.getElementById('registry-detail-toggle');
  const filterFrom = document.getElementById('registry-results-date-from');
  const filterTo = document.getElementById('registry-results-date-to');
  const filterTest = document.getElementById('registry-results-test-search');
  if (!panel || !split) return;
  panel.classList.add('active');
  split.classList.add('has-detail');
  registryDetailDeviceId = deviceId || '';
  registryDetailMode = 'results';
  registryDetailSelectedIds = [];
  registryDetailSelectedRow = null;
  if (toggle) toggle.checked = false;
  if (filterFrom) filterFrom.value = '';
  if (filterTo) filterTo.value = '';
  if (filterTest) filterTest.value = '';
  if (subtitle) subtitle.textContent = deviceId ? `Device ID: ${deviceId}` : 'Device results';
  if (stats) stats.textContent = '';
  updateRegistryDetailView();
}

function closeRegistryDetailPanel() {
  const panel = document.getElementById('registry-detail-panel');
  const split = panel?.closest('.registry-split');
  const stats = document.getElementById('registry-detail-stats');
  const toggle = document.getElementById('registry-detail-toggle');
  if (panel) panel.classList.remove('active');
  if (split) split.classList.remove('has-detail');
  const tbody = document.getElementById('body-device-results');
  if (tbody) tbody.innerHTML = '';
  const detailBody = document.getElementById('body-device-results-details');
  if (detailBody) detailBody.innerHTML = '';
  const rgbBody = document.getElementById('body-device-results-rgb');
  if (rgbBody) rgbBody.innerHTML = '';
  const rgbHead = document.querySelector('#tbl-device-results-rgb thead');
  if (rgbHead) rgbHead.innerHTML = '';
  if (stats) stats.textContent = '';
  if (toggle) toggle.checked = false;
  registryDetailSelectedIds = [];
  registryDetailSelectedRow = null;
}

function toggleRegistryDetailView(toggle) {
  registryDetailMode = toggle?.checked ? 'qaqc' : 'results';
  updateRegistryDetailView();
}

function updateRegistryDetailView() {
  const resultsTable = document.getElementById('tbl-device-results');
  const successPanel = document.getElementById('device-results-success-panel');
  const stats = document.getElementById('registry-detail-stats');
  const filters = document.querySelector('.registry-detail-filters');
  if (resultsTable) resultsTable.style.display = registryDetailMode === 'results' ? 'table' : 'none';
  if (successPanel) successPanel.hidden = registryDetailMode !== 'qaqc';
  if (stats) stats.style.display = registryDetailMode === 'results' ? 'flex' : 'none';
  if (filters) filters.style.display = registryDetailMode === 'results' ? 'flex' : 'none';

  if (registryDetailMode === 'qaqc') {
    renderDeviceResultsSuccessPanel(registryDetailDeviceId);
  } else {
    renderDeviceResultsTable(registryDetailDeviceId);
  }
}

function applyRegistryDetailFilters() {
  if (registryDetailMode !== 'results') return;
  renderDeviceResultsTable(registryDetailDeviceId);
}

function renderDeviceResultsTable(deviceId) {
  const table = document.getElementById('tbl-device-results');
  const thead = table?.querySelector('thead');
  const tbody = document.getElementById('body-device-results');
  const stats = document.getElementById('registry-detail-stats');
  if (!table || !thead || !tbody) return;

  thead.innerHTML = `
    <tr>
      <th>#</th>
      <th>Status</th>
      <th>Report</th>
      <th>Client ID</th>
      <th>Farm ID</th>
      <th>Crop</th>
      <th>Test ID</th>
      <th>Device ID</th>
      <th>Test Date-Time</th>
      <th>pH</th>
      <th>EC</th>
      <th>OC</th>
      <th>N</th>
      <th>P</th>
      <th>K</th>
      <th>S</th>
      <th>Zn</th>
      <th>Cu</th>
      <th>Fe</th>
      <th>Mn</th>
      <th>B</th>
    </tr>
  `;

  const toNum = (v) => {
    const n = (typeof v === 'number') ? v : Number(v);
    return Number.isFinite(n) ? n : null;
  };
  const fmt2 = (v) => {
    const n = toNum(v);
    return (n == null) ? '' : n.toFixed(2);
  };
  const addStrict = (a, b) => {
    const na = toNum(a), nb = toNum(b);
    if (na == null && nb == null) return null;
    return (na ?? 0) + (nb ?? 0);
  };
  const subStrict = (a, b) => {
    const na = toNum(a), nb = toNum(b);
    if (na == null || nb == null) return null;
    return na - nb;
  };

  const didFilter = String(deviceId || '').trim().toLowerCase();
  const testFilter = String(document.getElementById('registry-results-test-search')?.value || '').toLowerCase();
  const dFrom = document.getElementById('registry-results-date-from')?.value;
  const dTo = document.getElementById('registry-results-date-to')?.value;

  let rows = (rgbData || []).filter(d => String(d.did || '').toLowerCase() === didFilter);
  if (testFilter) {
    rows = rows.filter(d => String(d.tid || d.Test_ID || '').toLowerCase().includes(testFilter));
  }
  if (dFrom || dTo) {
    const t1 = dFrom ? new Date(dFrom) : new Date('1900-01-01');
    const t2 = dTo ? new Date(dTo) : new Date('2100-01-01');
    t2.setHours(23, 59, 59);
    rows = rows.filter(d => {
      const date = parseDateObj(d.time || d.Test_date || d.testDate);
      return date >= t1 && date <= t2;
    });
  }

  if (!rows.length) {
    tbody.innerHTML = `<tr><td colspan="21" style="padding:16px; text-align:center; color:#666;">No results found for this device.</td></tr>`;
    if (stats) {
      stats.innerHTML = `<span class="stat-pass">PASS: 0</span><span class="stat-fail">FAIL: 0</span>`;
    }
    registryDetailSelectedIds = [];
    registryDetailSelectedRow = null;
    return;
  }

  tbody.innerHTML = '';
  let passCount = 0;
  let failCount = 0;
  rows.forEach((d, idx) => {
    if (typeof ensureRowRaw === 'function') ensureRowRaw(d);
    const testStatus = evaluateTestSuccess(d);
    const tClass = testStatus === 'PASS' ? 'status-pass' : 'status-fail';
    if (testStatus === 'PASS') passCount += 1;
    if (testStatus === 'FAIL') failCount += 1;

    const r = d.raw || {};
    const phN = toNum(calcMetric(r, 'ph'));
    const ecN = toNum(calcMetric(r, 'ec'));
    const ocN = toNum(getSTV(r, 'oc'));
    const nN  = toNum(addStrict(getSTV(r, 'ammonium'), getSTV(r, 'nitrate')));
    const pN  = toNum(getSTV(r, 'phosphorus'));
    const kN  = toNum(getSTV(r, 'potassium'));
    const sN  = toNum(getSTV(r, 'sulphur'));
    const znN = toNum(subStrict(getSTV(r, 'zinccopper'), getSTV(r, 'copper')));
    const cuN = toNum(getSTV(r, 'copper'));
    const feN = toNum(getSTV(r, 'iron'));
    const mnN = toNum(getSTV(r, 'manganese'));
    const bN  = toNum(getSTV(r, 'boron'));

    const st = (numVal) => {
      const n = toNum(numVal);
      return (n != null && n <= 0) ? 'val-red' : '';
    };

    const tr = document.createElement('tr');
    tr.classList.add('selectable-row');
    const rowId = d.id ?? d.tid ?? '';
    if (rowId && registryDetailSelectedIds.includes(rowId)) {
      tr.classList.add('selected');
    }
    tr.addEventListener('click', () => {
      const rowId = d.id ?? d.tid ?? '';
      if (rowId) {
        const idx = registryDetailSelectedIds.indexOf(rowId);
        if (idx > -1) {
          registryDetailSelectedIds.splice(idx, 1);
          tr.classList.remove('selected');
        } else {
          registryDetailSelectedIds.push(rowId);
          tr.classList.add('selected');
        }
      }
      registryDetailSelectedRow = d;
      renderDeviceResultsDetails(d);
      const modeSel = document.getElementById('device-results-lower-mode');
      if (modeSel && modeSel.value === 'rgb') renderDeviceResultsRGB();
    });
    tr.innerHTML = `
      <td>${idx + 1}</td>
      <td class="${tClass}">${testStatus}</td>
      <td><button class="btn btn-sm btn-outline" onclick="downloadResultsReport(event, '${d.tid}', '${d.did}', '${d.crop ?? ''}', '${d.time ?? d.Test_date ?? ''}')">Download report</button></td>
      <td>${escapeHtml(d.clientId ?? d.Client_ID ?? '')}</td>
      <td>${escapeHtml(d.farmId ?? d.Farm_ID ?? '')}</td>
      <td>${escapeHtml(d.crop ?? '')}</td>
      <td>${escapeHtml(d.tid ?? '')}</td>
      <td>${escapeHtml(d.did ?? '')}</td>
      <td class="col-date">${escapeHtml(d.time ?? '')}</td>
      <td class="${st(phN)}">${fmt2(phN)}</td>
      <td class="${st(ecN)}">${fmt2(ecN)}</td>
      <td class="${st(ocN)}">${fmt2(ocN)}</td>
      <td class="${st(nN)}">${fmt2(nN)}</td>
      <td class="${st(pN)}">${fmt2(pN)}</td>
      <td class="${st(kN)}">${fmt2(kN)}</td>
      <td class="${st(sN)}">${fmt2(sN)}</td>
      <td class="${st(znN)}">${fmt2(znN)}</td>
      <td class="${st(cuN)}">${fmt2(cuN)}</td>
      <td class="${st(feN)}">${fmt2(feN)}</td>
      <td class="${st(mnN)}">${fmt2(mnN)}</td>
      <td class="${st(bN)}">${fmt2(bN)}</td>
    `;
    tbody.appendChild(tr);
  });

  if (stats) {
    stats.innerHTML = `<span class="stat-pass">PASS: ${passCount}</span><span class="stat-fail">FAIL: ${failCount}</span>`;
  }
}

function renderDeviceResultsSuccessPanel(deviceId) {
  const detailBody = document.getElementById('body-device-results-details');
  const modeSel = document.getElementById('device-results-lower-mode');
  if (!detailBody || !modeSel) return;

  const didFilter = String(deviceId || '').trim().toLowerCase();
  const rows = (rgbData || []).filter(d => String(d.did || '').toLowerCase() === didFilter);

  if (!rows.length) {
    detailBody.innerHTML = `<tr><td colspan="9" style="padding:16px; text-align:center; color:#666;">No results found for this device.</td></tr>`;
    const rgbBody = document.getElementById('body-device-results-rgb');
    const rgbHead = document.querySelector('#tbl-device-results-rgb thead');
    if (rgbBody) rgbBody.innerHTML = '';
    if (rgbHead) rgbHead.innerHTML = '';
    registryDetailSelectedIds = [];
    registryDetailSelectedRow = null;
    return;
  }

  if (!registryDetailSelectedRow || String(registryDetailSelectedRow.did || '').toLowerCase() !== didFilter) {
    registryDetailSelectedRow = rows[0];
    registryDetailSelectedIds = [registryDetailSelectedRow.id ?? registryDetailSelectedRow.tid ?? ''].filter(Boolean);
  }

  renderDeviceResultsDetails(registryDetailSelectedRow);
  if (modeSel.value === 'rgb') {
    renderDeviceResultsRGB();
  }
}

function renderDeviceResultsDetails(row) {
  const tbody = document.getElementById('body-device-results-details');
  if (!tbody || !row) return;
  tbody.innerHTML = '';

  if (typeof ensureRowRaw === 'function') ensureRowRaw(row);

  dbCriteria.forEach(rule => {
    const rawObj = row.raw?.[rule.p];
    let val = 0, blank = 0, finalVal = 0;

    if (rawObj) {
      val = parseFloat(window.calcMetric(row.raw, rule.p));
      blank = blankData.find(b => b.p === rule.p)?.val || 0;
      finalVal = val - blank;
    }

    let fail = false;
    if (rawObj) {
      if (rule.rel === 'between') {
        if (finalVal >= rule.l && finalVal <= rule.u) fail = true;
      } else if (rule.rel === '<') {
        if (finalVal < rule.u) fail = true;
      } else if (rule.rel === '>') {
        if (finalVal > rule.l) fail = true;
      } else if (rule.rel === '=') {
        if (finalVal == rule.l) fail = true;
      }
    }

    const status = fail ? "FAIL" : "PASS";
    const statusClass = fail ? "val-red" : "status-pass";

    tbody.innerHTML += `
      <tr>
        <td>${row.did}</td>
        <td><b>${cols.find(c => c.k === rule.p).n}</b></td>
        <td class="${fail ? 'val-red' : 'text-black'}">${val.toFixed(3)}</td>
        <td class="text-blue">${(finalVal + blank).toFixed(3)}</td>
        <td>${rawObj ? rawObj.c : '-'}</td>
        <td>${rawObj ? rawObj.t : '-'}</td>
        <td class="${statusClass}">${status}</td>
        <td>${fail ? rule.re : '-'}</td>
        <td>${fail ? rule.ac : '-'}</td>
      </tr>
    `;
  });
}

function renderDeviceResultsRGB() {
  const tbody = document.getElementById('body-device-results-rgb');
  const thead = document.querySelector('#tbl-device-results-rgb thead');
  if (!tbody || !thead) return;

  const pickFirst = (obj, keys, fallback = '') => {
    for (const k of keys) {
      const v = obj?.[k];
      if (v !== undefined && v !== null && String(v).trim() !== '') return v;
    }
    return fallback;
  };

  const metaClient = (r) => pickFirst(r, ['Client_ID','client_id','clientId'], '');
  const metaFarm   = (r) => pickFirst(r, ['Farm_ID','farm_id','farmId'], '');
  const metaProd   = (r) => pickFirst(r, ['ProdBatch_ID','prodbatch_id','prodBatchId'], '');
  const metaBatch  = (r) => pickFirst(r, ['QCBatch_ID','qcbatch_id','qcBatchId','QC_Batch','qc_batch'], '');

  const ids = registryDetailSelectedIds || [];
  let rows = (rgbData || []).filter(r => ids.includes(r.id ?? r.tid ?? ''));

  if (!rows.length && registryDetailSelectedRow) {
    rows = [registryDetailSelectedRow];
  }

  if (!rows.length) {
    thead.innerHTML = '';
    tbody.innerHTML = `<tr><td style="padding:15px;color:#777;">Select one or more rows in Results</td></tr>`;
    return;
  }

  const sample = rows[0];
  const tKeys = Object.keys(sample).filter(k => /_T$/i.test(k));
  const pairs = tKeys
    .map(tk => {
      const ck = tk.replace(/_T$/i, '_C');
      if (!(ck in sample)) return null;
      const label = tk.split('_')[0];
      return { label, tKey: tk, cKey: ck };
    })
    .filter(Boolean)
    .sort((a, b) => a.label.localeCompare(b.label));

  const useFlat = pairs.length > 0;

  if (useFlat) {
    thead.innerHTML =
      `<tr>
        <th>Client_ID</th>
        <th>Farm_ID</th>
        <th>ProdBatch_ID</th>
        <th>QCBatch_ID</th>
        <th>Test ID</th>
        <th>Device ID</th>
        <th>Test date</th>
        ${pairs.map(p => `<th>${p.label}<br><small>T | C</small></th>`).join('')}
      </tr>`;

    tbody.innerHTML = '';
    rows.forEach(r => {
      const tr = document.createElement('tr');

      let html =
        `<td>${metaClient(r)}</td>` +
        `<td>${metaFarm(r)}</td>` +
        `<td>${metaProd(r)}</td>` +
        `<td>${metaBatch(r)}</td>` +
        `<td><b>${r.Test_ID ?? r.tid ?? ''}</b></td>` +
        `<td>${r.Device_ID ?? r.did ?? ''}</td>` +
        `<td class="col-date">${r.Test_date ?? r.time ?? ''}</td>`;

      pairs.forEach(p => {
        const tv = (r[p.tKey] ?? '').toString();
        const cv = (r[p.cKey] ?? '').toString();
        html += `<td>${tv} | ${cv}</td>`;
      });

      tr.innerHTML = html;
      tbody.appendChild(tr);
    });

    return;
  }

  const raw = rows[0].raw || {};
  const keys = Object.keys(raw);
  if (!keys.length) {
    thead.innerHTML = '';
    tbody.innerHTML = `<tr><td style="padding:15px;color:#777;">No raw RGB values available.</td></tr>`;
    return;
  }

  thead.innerHTML = `<tr><th>Parameter</th><th>Abs</th><th>Val</th></tr>`;
  tbody.innerHTML = '';
  keys.forEach(k => {
    const r = raw[k] || {};
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${k}</td><td>${r.c ?? ''}</td><td>${r.t ?? ''}</td>`;
    tbody.appendChild(tr);
  });
}

function updateDeviceResultsLowerView() {
  const modeSel = document.getElementById('device-results-lower-mode');
  const dBox = document.getElementById('device-results-details-container');
  const rBox = document.getElementById('device-results-rgb-container');
  if (!modeSel || !dBox || !rBox) return;

  if (modeSel.value === 'rgb') {
    dBox.style.display = 'none';
    rBox.style.display = 'block';
    renderDeviceResultsRGB();
  } else {
    dBox.style.display = 'block';
    rBox.style.display = 'none';
    if (registryDetailSelectedRow) renderDeviceResultsDetails(registryDetailSelectedRow);
  }
}



function addRegistryRow(force = false) {
    if (!registryEditMode && !force) return;
    const tbody = document.getElementById('body-device-registry');
    if (!tbody) return;

    const tr = document.createElement('tr');
    const prodBatchOptions = buildProdBatchOptions_('Default');

    tr.innerHTML = `
    <td class="registry-edit-only"><input type="checkbox" class="reg-select" aria-label="Select row"></td>
    <td><textarea class="db-input db-textarea reg-client reg-limited" data-col="client" placeholder="Client" rows="1" maxlength="50"></textarea></td>
    <td><textarea class="db-input db-textarea reg-company reg-limited" data-col="company" placeholder="Company" rows="1" maxlength="50"></textarea></td>
    <td><input type="text"  class="db-input reg-pan" data-col="pan" placeholder="PAN" maxlength="10"></td>
    <td><input type="text"  class="db-input reg-gstin" data-col="gstin" placeholder="GSTIN" maxlength="15"></td>
    <td><textarea class="db-input db-textarea reg-address reg-limited" data-col="address" placeholder="Address" rows="1" maxlength="50"></textarea></td>
    <td><input type="text"  class="db-input reg-did" data-col="did" placeholder="Device ID" maxlength="15"></td>
    <td><input type="text"  class="db-input reg-sim" data-col="sim" placeholder="SIM#" maxlength="22"></td>
    <td><input type="text"  class="db-input reg-aadhaar" data-col="aadhaar" placeholder="Aadhaar#" maxlength="12"></td>
    <td><input type="text"  class="db-input reg-mobile" data-col="mobile" placeholder="Mobile#" maxlength="11" oninput="limitPhoneInput(this)"></td>
    <td><textarea class="db-input db-textarea reg-moName reg-limited" data-col="moName" placeholder="MO Name" rows="1" maxlength="50"></textarea></td>
    <td><input type="date"  class="db-input reg-date" data-col="date"></td>
    <td><textarea class="db-input db-textarea reg-place reg-limited" data-col="place" placeholder="Place" rows="1" maxlength="50"></textarea></td>
    <td><input type="text"  class="db-input reg-gps" data-col="gps" placeholder="28.000000, 74.000000"></td>
    <td><input type="text"  class="db-input reg-pin" data-col="pin" placeholder="PIN code" maxlength="6"></td>
    <td><textarea class="db-input db-textarea reg-block reg-limited" data-col="block" placeholder="Block" rows="1" maxlength="50"></textarea></td>
    <td><textarea class="db-input db-textarea reg-district reg-limited" data-col="district" placeholder="District" rows="1" maxlength="50"></textarea></td>
    <td><textarea class="db-input db-textarea reg-state reg-limited" data-col="state" placeholder="State" rows="1" maxlength="50"></textarea></td>
    <td>
      <select class="db-input reg-prod-batch" data-col="prodBatchId">
        ${prodBatchOptions}
      </select>
    </td>
    <td><button class="btn btn-outline btn-sm" onclick="openRegistryDetailPanel('')">View</button></td>
`;


    tbody.appendChild(tr);

    // Your existing validation / formatting hooks
    if (typeof wireRegistryRowValidation === 'function') {
        wireRegistryRowValidation(tr);
    }
    if (typeof wireRegistryRowFormatting === 'function') {
        wireRegistryRowFormatting(tr);
    }

    wireRegistryTextLimits(tr);

    // Geoapify autocomplete on Place
    const placeInput = tr.querySelector('.reg-place');
    if (placeInput && typeof initRegistryLocationAutocomplete === 'function') {
        initRegistryLocationAutocomplete(placeInput);
    }

    applyRegistryEditMode();
    initRegistryColumnSizing();
    refreshRegistryTextareaHeights();
}

function initRegistryColumnSizing() {
  const table = document.getElementById('tbl-device-registry');
  if (!table) return;

  const measureCanvas = initRegistryColumnSizing._canvas || (initRegistryColumnSizing._canvas = document.createElement('canvas'));
  const ctx = measureCanvas.getContext('2d');
  const inputs = Array.from(table.querySelectorAll('tbody .db-input'));
  const headers = Array.from(table.querySelectorAll('thead th'));

  const widths = {};
  headers.forEach(th => {
    const col = th.dataset.col;
    if (!col) return;
    const thStyle = getComputedStyle(th);
    ctx.font = `${thStyle.fontWeight} ${thStyle.fontSize} ${thStyle.fontFamily}`;
    const width = ctx.measureText(th.textContent.trim()).width + 24;
    widths[col] = Math.max(widths[col] || 0, width);
  });

  inputs.forEach(input => {
    const col = input.dataset.col;
    if (!col) return;
    const style = getComputedStyle(input);
    ctx.font = `${style.fontWeight} ${style.fontSize} ${style.fontFamily}`;
    const text = input.value || input.placeholder || '';
    const width = ctx.measureText(text).width + 32;
    widths[col] = Math.max(widths[col] || 0, width);
  });

  headers.forEach(th => {
    const col = th.dataset.col;
    if (!col || !widths[col]) return;
    th.style.minWidth = `${Math.ceil(widths[col])}px`;
  });

  inputs.forEach(input => {
    const col = input.dataset.col;
    if (!col || !widths[col]) return;
    input.style.minWidth = `${Math.ceil(widths[col])}px`;
  });

  const onInput = initRegistryColumnSizing._handler || (initRegistryColumnSizing._handler = () => {
    cancelAnimationFrame(initRegistryColumnSizing._raf || 0);
    initRegistryColumnSizing._raf = requestAnimationFrame(initRegistryColumnSizing);
  });

  inputs.forEach(input => {
    input.removeEventListener('input', onInput);
    input.addEventListener('input', onInput);
  });
}


function addCriteriaRow() {
  dbCriteria.push({ s:'', p:'', m:'', l:'', rel:'between', u:'', re:'', ac:'' });
  renderCriteria();
}

function deleteCriteriaRow() {
  if (dbCriteria.length > 0) {
    dbCriteria.pop();
    renderCriteria();
  }
}

function addSTVRow() {
  stvData.push({ p:'', a:1, b:0, df1:1, df2:1, df3:1, df4:1 });
  renderSTV();
}

function deleteSTVRow() {
  if (stvData.length > 0) {
    stvData.pop();
    renderSTV();
  }
}

function addQCCriteriaRow() {
  const batchId = String(window.currentQCCriteriaBatchId || "Default").trim() || "Default";
  qcCriteriaData.push({ batch: batchId, p: cols[0].k, min: "", max: "", mean: "" });
  renderQCCriteria();
}


function deleteQCCriteriaRow() {
  if (qcCriteriaData.length > 0) {
    qcCriteriaData.pop();
    renderQCCriteria();
  }
}

function addBlankRow() {
    // Default to the first available parameter to avoid render errors
    const defaultParam = cols.length > 0 ? cols[0].k : '';
    blankData.push({ p: defaultParam, val: 0 });
    renderBlanks();
}

function deleteBlankRow() {
    if (blankData.length > 0) {
        blankData.pop();
        renderBlanks();
    }
}



function saveQCCriteria() {
  const tbody = document.getElementById("body-qc-criteria");
  if (!tbody) return;

  const batchId = String(window.currentQCCriteriaBatchId || "Default").trim() || "Default";

  if (!Array.isArray(qcCriteriaData)) qcCriteriaData = [];

  const trs = Array.from(tbody.querySelectorAll("tr"));

  const toNum = (el) => {
    const s = String(el?.value ?? "").trim();
    if (!s) return NaN;
    const n = Number(s);
    return Number.isFinite(n) ? n : NaN;
  };

  // Build ONLY complete numeric rows for this batch (Option-A strict)
  const newRows = trs.map(tr => {
    const pEl = tr.querySelector("select.qc-param-select");
    const minEl = tr.querySelector("input.qc-abs-min");
    const maxEl = tr.querySelector("input.qc-abs-max");
    const meanEl = tr.querySelector("input.qc-abs-mean");
    const sdEl = tr.querySelector("input.qc-abs-sd");

    const p = String(pEl?.value || "").trim();
    if (!p) return null;

    const min = toNum(minEl);
    const max = toNum(maxEl);
    const mean = toNum(meanEl);
    const sd = String(sdEl?.value || "").trim();

    // Strict: require all 3
    if (!Number.isFinite(min) || !Number.isFinite(max) || !Number.isFinite(mean)) return null;

    return { batch: batchId, p, min, max, mean, sd };
  }).filter(Boolean);

  // Replace only this batch, keep other batches
  const keptOtherBatches = qcCriteriaData.filter(r =>
    String(r?.batch || r?.qcBatchId || "Default").trim() !== batchId
  );

  qcCriteriaData = [...keptOtherBatches, ...newRows];

  // Global cleanup: remove any leftover "blank" rows from ANY batch (incl. Default)
  qcCriteriaData = qcCriteriaData.filter(r => {
    const p = String(r?.p || "").trim();
    if (!p) return false;
    const nums = [r?.min, r?.max, r?.mean].map(Number);
    return nums.some(Number.isFinite);
  });

  console.log("Saving QC Criteria:", {
    batchId,
    rowsForThisBatch: newRows.length,
    totalRowsAllBatches: qcCriteriaData.length
  });

  if (typeof google !== "undefined" && google.script?.run) {
    google.script.run
      .withSuccessHandler((msg) => {
        alert(msg || `QC Criteria saved for batch ${batchId}.`);
      })
      .withFailureHandler((err) => {
        console.error(err);
        alert("Error while saving QC Criteria: " + (err?.message || err));
      })
      .saveQCCriteria(qcCriteriaData);
  } else {
    alert("QC Criteria updated in memory (no Apps Script context).");
  }
}


// SAVE DB (wired to Apps Script)
function saveCriteria() {
    const rows = document.querySelectorAll('#body-criteria tr');
    const spectros  = ['S1', 'S2', 'S0'];   // for reference only
    const relations = ['between', '<', '>', '='];

    const newCriteria = [];

    rows.forEach(row => {
        const selects = row.querySelectorAll('select.db-input');
        const inputs  = row.querySelectorAll('input.db-input');

        if (selects.length < 3 || inputs.length < 3) return;

        const s   = selects[0].value;                          // spectro
        const p   = selects[1].value;                          // parameter key
        const m   = selects[2].value;                          // metric (Abs/Val)
        const l   = inputs[0].value.trim();
        const rel = selects[3].value;                          // relation
        const u   = inputs[1].value.trim();
        const re  = inputs[2].value.trim();                    // reason
        const ac  = inputs[3].value.trim();                    // action

        newCriteria.push({
            s,
            p,
            m,
            l: l === '' ? '' : parseFloat(l),
            rel,
            u: u === '' ? '' : parseFloat(u),
            re,
            ac
        });
    });

    dbCriteria = newCriteria;

    if (typeof google !== 'undefined' && google.script && google.script.run) {
        google.script.run
            .withSuccessHandler(function () {
                alert('Test Success Criteria saved to Sheet.');
            })
            .withFailureHandler(function (err) {
                console.error(err);
                alert('Error while saving Test Success Criteria: ' + err.message);
            })
            .saveTestSuccessCriteria(dbCriteria);   // <-- Code.gs function
    } else {
        alert('Test Success Criteria updated in memory (no Apps Script context).');
    }
}






function saveSTV() {
    const rows = document.querySelectorAll('#body-stv tr');
    const newStv = [];

    rows.forEach(row => {
        const select = row.querySelector('select.db-input');
        const inputs = row.querySelectorAll('input.db-input');
        if (!select || inputs.length < 6) return;

        newStv.push({
            p:   select.value,
            a:   parseFloat(inputs[0].value) || 0,
            b:   parseFloat(inputs[1].value) || 0,
            df1: parseFloat(inputs[2].value) || 1,
            df2: parseFloat(inputs[3].value) || 1,
            df3: parseFloat(inputs[4].value) || 1,
            df4: parseFloat(inputs[5].value) || 1
        });
    });

    stvData = newStv;

    if (typeof google !== 'undefined' && google.script && google.script.run) {
        google.script.run
            .withSuccessHandler(function () {
                alert('STV Equations saved to Sheet.');
            })
            .withFailureHandler(function (err) {
                console.error(err);
                alert('Error while saving STV Equations: ' + err.message);
            })
            .saveSTVEquations(stvData);      // <-- Code.gs function
    } else {
        alert('STV Equations updated in memory (no Apps Script context).');
    }
}


function dbOverrideSTV() {
  if (typeof google === 'undefined' || !google.script) return;
  if (!confirm('Recalculate soil test values for ALL Test IDs using current STV logic?')) return;

  google.script.run
    .withSuccessHandler(function(msg) {
      console.log(msg || 'Override STV finished');
      alert('SoilTest_Results updated with current STV logic.');
    })
    .withFailureHandler(function(err) {
      console.error('overrideSTVForAllTests failed:', err);
      alert('Override STV failed: ' + err.message);
    })
    .overrideSTVForAllTests();
}




function saveBlanks() {
    // We do NOT need to scrape the HTML table anymore because
    // updateBlankParam() and updateBlankVal() keep 'blankData' updated in real-time.
    
    if (typeof google !== 'undefined' && google.script && google.script.run) {
        google.script.run
            .withSuccessHandler(function () {
                alert('Blanks saved to Sheet.');
            })
            .withFailureHandler(function (err) {
                console.error(err);
                alert('Error while saving Blanks: ' + err.message);
            })
            .saveBlanks(blankData); // <-- Send the global variable directly
    } else {
        console.log("Local save: ", blankData);
        alert('Blanks updated in memory (no Apps Script context).');
    }
}


function saveDeviceRegistry() {
    const tbody = document.getElementById('body-device-registry');
    if (!tbody) return;

    const rows = Array.from(tbody.querySelectorAll('tr'));
    const newRegObjects = [];
    let hadErrors = false;
    const allErrorMessages = [];
    let anyData = false;

    rows.forEach(function (row, rowIndex) {
        // Grab inputs by class (ignores Geoapify's extra visible input)
        const clientInput    = row.querySelector('.reg-client');
        const companyInput   = row.querySelector('.reg-company');
        const panInput       = row.querySelector('.reg-pan');
        const gstinInput     = row.querySelector('.reg-gstin');
        const addressInput   = row.querySelector('.reg-address');
        const didInput       = row.querySelector('.reg-did');
        const simInput       = row.querySelector('.reg-sim');
        const aadhaarInput   = row.querySelector('.reg-aadhaar');
        const mobileInput    = row.querySelector('.reg-mobile');
        const moNameInput    = row.querySelector('.reg-moName');
        const dateInput      = row.querySelector('.reg-date');
        const placeInput     = row.querySelector('.reg-place');   // hidden original
        const gpsInput       = row.querySelector('.reg-gps');
        const pinInput       = row.querySelector('.reg-pin');
        const blockInput     = row.querySelector('.reg-block');
        const districtInput  = row.querySelector('.reg-district');
        const stateInput     = row.querySelector('.reg-state');
        const prodBatchInput = row.querySelector('.reg-prod-batch');

        const allInputs = [
            clientInput, companyInput, panInput, gstinInput, addressInput,
            didInput, simInput, aadhaarInput, mobileInput, moNameInput,
            dateInput, placeInput, gpsInput, pinInput,
            blockInput, districtInput, stateInput, prodBatchInput
        ].filter(Boolean);

        if (allInputs.length === 0) return;

        // Clear old highlights
        allInputs.forEach(inp => { inp.style.backgroundColor = ''; });

        // Read + normalise values
        const client    = clientInput    ? autoCapitalizeWords(clientInput.value.trim())      : '';
        const company   = companyInput   ? companyInput.value.toUpperCase().trim()            : '';
        const pan       = panInput       ? toUpperAlnum(panInput.value.trim())                : '';
        const gstin     = gstinInput     ? toUpperAlnum(gstinInput.value.trim())              : '';
        const address   = addressInput   ? autoCapitalizeWords(addressInput.value.trim())     : '';
        const did       = didInput       ? toDigits(didInput.value.trim())                    : '';
        const simRaw    = simInput       ? toDigits(simInput.value.trim())                    : '';
        const aadhaar   = aadhaarInput   ? toDigits(aadhaarInput.value.trim())                : '';
        let   mobile    = mobileInput    ? mobileInput.value.trim()                           : '';
        const moName    = moNameInput    ? autoCapitalizeWords(moNameInput.value.trim())      : '';
        const dateRaw   = dateInput      ? dateInput.value                                    : '';
        const place     = placeInput     ? autoCapitalizeWords(placeInput.value.trim())       : '';
        const gpsRaw    = gpsInput       ? normalizeGps(gpsInput.value.trim())                : '';
        const pin       = pinInput       ? toDigits(pinInput.value.trim())                    : '';
        const block     = blockInput     ? autoCapitalizeWords(blockInput.value.trim())       : '';
        const district  = districtInput  ? autoCapitalizeWords(districtInput.value.trim())    : '';
        const state     = stateInput     ? autoCapitalizeWords(stateInput.value.trim())       : '';
        const prodBatchId = prodBatchInput ? String(prodBatchInput.value || '').trim()        : '';

        // Track if this row has *any* data at all
        if (client || company || pan || gstin || address || did || simRaw ||
            aadhaar || mobile || moName || dateRaw || place || gpsRaw || pin ||
            block || district || state || prodBatchId) {
            anyData = true;
        }

        const rowErrors = [];

        function markError(el, message) {
            hadErrors = true;
            if (el) el.style.backgroundColor = '#fff59d'; // soft yellow
            rowErrors.push(message);
        }

        // === Validations ===
        const panPattern = /^[A-Z]{5}[0-9]{4}[A-Z]$/;
        const gstinPattern = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z][0-9][A-Z][0-9]$/;
        const didPattern = /^[0-9]{15}$/;
        const pinPattern = /^[0-9]{6}$/;

        if (!pan || !panPattern.test(pan)) {
            markError(panInput, 'PAN must be in the format AAAAA0000A');
        }
        if (!gstin || !gstinPattern.test(gstin)) {
            markError(gstinInput, 'GSTIN must be in the format 00AAAAA0000A0A0');
        }
        if (!aadhaar || aadhaar.length !== 12) {
            markError(aadhaarInput, 'Aadhaar must be exactly 12 digits');
        }
        if (mobile) {
            const mobileCore = mobile.replace(/^\+/, '');
            if (mobileCore.length > 10) {
                markError(mobileInput, 'Mobile cannot exceed 10 characters (excluding +).');
            }
        }
        if (!did || !didPattern.test(did)) {
            markError(didInput, 'Device ID must be exactly 15 digits');
        }
        if (!simRaw || simRaw.length < 19 || simRaw.length > 22) {
            markError(simInput, 'SIM# must be 19–22 digits');
        }
        if (!pin || !pinPattern.test(pin)) {
            markError(pinInput, 'PIN must be 6 digits');
        }
        // Block, GPS, District, State can be empty → no checks

        if (rowErrors.length > 0) {
            allErrorMessages.push(
                'Row ' + (rowIndex + 1) + ': ' + rowErrors.join('; ')
            );
            // DO NOT remove or clear this row – just leave it highlighted
            return;
        }

        // All validations for this row passed → include in save batch
        const date = dateRaw || ''; // keep yyyy-mm-dd for <input type="date">

        if (client || company || pan || gstin || address || did || simRaw ||
            aadhaar || mobile || moName || date || place || gpsRaw || pin ||
            block || district || state || prodBatchId) {

            newRegObjects.push({
                client,
                company,
                pan,
                gstin,
                address,
                did,
                sim: simRaw,
                aadhaar,
                mobile,
                moName,
                date,
                place,
                gps: gpsRaw,
                pin,
                block,
                district,
                state,
                prodBatchId
            });
        }
    });

    // If *any* validation failed, DO NOT save or re-render
    if (hadErrors) {
        const msg = allErrorMessages.length
            ? 'Some fields have validation errors:\n\n' + allErrorMessages.join('\n')
            : 'No rows were saved due to validation errors. Please fix highlighted fields and try again.';
        alert(msg);
        return; // leave table exactly as-is for user to fix
    }

    // If there is literally nothing filled anywhere
    if (!anyData) {
        alert('Nothing to save in Device Registry.');
        return;
    }

    // All good → update in-memory registry & sheet
    deviceRegistry = newRegObjects;

    const sheetRows = newRegObjects.map(function (r) {
        return [
            r.client   || '',
            r.company  || '',
            r.pan      || '',
            r.gstin    || '',
            r.address  || '',
            r.did      || '',
            r.sim      || '',
            r.aadhaar  || '',
            r.mobile   || '',
            r.moName   || '',
            r.date     || '',  // yyyy-mm-dd
            r.place    || '',
            r.gps      || '',
            r.pin      || '',
            r.block    || '',
            r.district || '',
            r.state    || '',
            r.prodBatchId || ''
        ];
    });

    if (typeof google !== 'undefined' && google.script && google.script.run) {
        google.script.run
            .withSuccessHandler(function (result) {
                console.log('Device_Registry saved:', result);
                alert('Registry saved successfully: ' + sheetRows.length + ' rows');
                registryEditMode = false;
                applyRegistryEditMode();
                // Now safe to re-render from clean data
                renderDeviceRegistry();
            })
            .withFailureHandler(function (err) {
                console.error('Sheet save failed:', err);
                alert('Error saving Device Registry: ' + err.message);
            })
            .saveDeviceRegistry(sheetRows);
    } else {
        console.warn('google.script.run not available; registry not saved to sheet.');
        registryEditMode = false;
        applyRegistryEditMode();
    }
}



// EXPORT & DATA RESET
function exportExcel(mod) {
  const dataToExport = (mod === 'rgb' && window.currentFilteredRGB)
    ? window.currentFilteredRGB
    : rgbData;

  // ---------- Helpers ----------
  const toNum = (v) => {
    const n = (typeof v === 'number') ? v : Number(v);
    return Number.isFinite(n) ? n : null;
  };

  const round3 = (v) => {
    const n = toNum(v);
    return (n == null) ? null : Number(n.toFixed(3));
  };

  // Base fields (support both {tid,did,time} and {Test_ID,Device_ID,Test_date})
  function getBaseField(d, which) {
    if (!d) return "";
    if (which === 'tid') return (d.tid ?? d.Test_ID ?? d["Test ID"] ?? "");
    if (which === 'did') return (d.did ?? d.Device_ID ?? d["Device ID"] ?? "");
    if (which === 'time') return (d.time ?? d.Test_date ?? d["Date"] ?? "");
    return "";
  }

  // Metric getter: prefer flat precomputed field, else compute from raw
  function getMetricForExport(d, key) {
    if (!d || !key) return "";

    // 1) Prefer precomputed flat value if present
    if (Object.prototype.hasOwnProperty.call(d, key)) {
      const v = d[key];
      if (v !== "" && v !== null && v !== undefined) return v;
    }

    // 2) Compute from raw
    if (d.raw) {
      // Prefer safeCalcMetric if you have it
      if (typeof window.safeCalcMetric === 'function') return window.safeCalcMetric(d.raw, key);

      // You said you have window.calcMetric (not calcMetric)
      if (typeof window.calcMetric === 'function') return window.calcMetric(d.raw, key);
    }

    return "";
  }

  // ---------- XLSX Export ----------
  if (typeof XLSX !== 'undefined') {
    const exportData = (dataToExport || []).map(d => {
      const row = {
        "Test ID": getBaseField(d, 'tid'),
        "Device ID": getBaseField(d, 'did'),
        "Date": getBaseField(d, 'time')
      };

      (cols || []).forEach(c => {
        const v = getMetricForExport(d, c.k);

        // Keep numbers as numbers for Excel; round to 3 decimals
        // If null/invalid -> blank cell
        const n = toNum(v);
        row[c.n] = (n == null) ? "" : Number(n.toFixed(3));
      });

      return row;
    });

    const ws = XLSX.utils.json_to_sheet(exportData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Data");
    XLSX.writeFile(wb, "Insoil_Data.xlsx");
    return;
  }

  // ---------- CSV fallback ----------
  let csv = "TestID,DeviceID,Date," + (cols || []).map(c => c.n).join(',') + "\n";

  (dataToExport || []).forEach(d => {
    const tid = getBaseField(d, 'tid');
    const did = getBaseField(d, 'did');
    const time = getBaseField(d, 'time');

    const metricVals = (cols || []).map(c => {
      const v = getMetricForExport(d, c.k);
      const n = toNum(v);
      if (n != null) return n.toFixed(3);

      // Non-numeric: keep as text, but make CSV safe:
      // - replace commas to avoid column shifts
      // - wrap in quotes if it contains quotes/newlines
      let s = (v === null || v === undefined) ? "" : String(v);
      s = s.replace(/,/g, ' ');
      if (/[\"\n\r]/.test(s)) s = '"' + s.replace(/"/g, '""') + '"';
      return s;
    }).join(',');

    csv += `${tid},${did},${time},${metricVals}\n`;
  });

  const blob = new Blob([csv], { type: 'text/csv' });
  const a = document.createElement('a');
  a.href = window.URL.createObjectURL(blob);
  a.download = 'insoil_data.csv';
  a.click();
}



function resetData() {
    if(!confirm("Remove all data?")) return;
    globalData=[]; rgbData=[]; qcData=[];
    multiSelect = { rgb:[], qaqc:[], results:[] };
    selectedRowId = null;
    renderTable('rgb');
    renderTable('qaqc');
    renderResults();
    document.getElementById('body-rgb-raw').innerHTML   = '';
    document.getElementById('body-qaqc-raw').innerHTML  = '';
    document.getElementById('body-results-rgb').innerHTML = '';
    updateAnalyticsCharts();
}


function moveDataToQC() {
  // ALWAYS use window.checkedRows (do not use bare checkedRows)
  window.checkedRows = window.checkedRows || { rgb: [], qaqc: [] };
  window.checkedRows.rgb = Array.isArray(window.checkedRows.rgb) ? window.checkedRows.rgb : [];

  const selected = window.checkedRows.rgb.slice();
  const n = selected.length;

  if (!n) {
    alert("No rows selected. Please QC-toggle at least one row in RGB/Abs, then click Move to QC.");
    return;
  }

  const globalBatchInput = (document.getElementById('qcBatchInput')?.value || '').trim();

  const req = selected.map(id => {
    const row = (window.rgbData || rgbData || []).find(r => String(r.id) === String(id));
    if (!row) return null;

    const rowBatch =
      (row.QCBatch_ID ?? row.qcBatchId ?? row.QC_Batch ?? row.qcbatch_id ?? '').toString().trim();

    const batchToUse = (rowBatch || globalBatchInput || 'Default').trim() || 'Default';

    return {
      Device_ID:  row.Device_ID ?? row.did ?? row.device_id ?? "",
      Test_ID:    row.Test_ID   ?? row.tid ?? row.test_id ?? "",
      // date optional; keep for compatibility
      Test_date:  row.Test_date ?? row.time ?? row.date ?? "",
      QCBatch_ID: batchToUse
    };
  }).filter(Boolean);

  if (!req.length) {
    alert("Selected IDs were not found in current RGB data. Refresh and try again.");
    return;
  }

  const uniqueBatches = [...new Set(req.map(r => (r.QCBatch_ID || 'Default').trim()).filter(Boolean))];
  const batchMsg = (uniqueBatches.length === 1)
    ? `QC Batch: ${uniqueBatches[0]}`
    : `QC Batches: ${uniqueBatches.length} (mixed)`;

  const ok = confirm(`Want to move ${req.length} RGB/Abs row(s) to Device QA/QC?\n${batchMsg}`);
  if (!ok) return;

  google.script.run
    .withSuccessHandler(function(res) {
      if (!res || res.ok !== true) {
        alert("Move failed: " + (res?.message || "Unknown error"));
        return;
      }

      google.script.run.withSuccessHandler(function(data) {
        if (data?.rgbData) window.rgbData = rgbData = data.rgbData;
        if (data?.qcData)  window.qcData  = qcData  = data.qcData;

        renderTable('rgb');
        renderTable('qaqc');

        // Clear selection using window.checkedRows
        window.checkedRows.rgb = [];

        if (typeof safeUpdateRgbActionButtons === "function") safeUpdateRgbActionButtons();
        else if (typeof updateRgbActionButtons === "function") updateRgbActionButtons();

        if (typeof safeUpdateQaqcActionButtons === "function") safeUpdateQaqcActionButtons();
        else if (typeof updateQaqcActionButtons === "function") updateQaqcActionButtons();

        const moved   = Number(res.moved   ?? req.length);
        const removed = Number(res.removed ?? moved);
        const skipped = Number(res.skipped ?? 0);

        let msg = `${moved} RGB/Abs row(s) were moved to QA/QC successfully.\nRemoved from RGB/Abs: ${removed}`;
        if (skipped) msg += `\nSkipped (not found / duplicate): ${skipped}`;
        alert(msg);

      }).getOperationalData();
    })
    .withFailureHandler(function(err) {
      alert("Move failed: " + (err?.message || err));
    })
    .syncMoveDataToQC(req);
}



function moveDataToRGB() {
  // ALWAYS use window.checkedRows (do not use bare checkedRows)
  window.checkedRows = window.checkedRows || { rgb: [], qaqc: [] };
  window.checkedRows.qaqc = Array.isArray(window.checkedRows.qaqc) ? window.checkedRows.qaqc : [];

  const selected = window.checkedRows.qaqc.slice();
  const n = selected.length;

  if (!n) {
    alert("No rows selected. Please QC-toggle at least one row in QA/QC, then click Move to RGB/Abs.");
    return;
  }

  const ok = confirm(`Want to move ${n} QA/QC row(s) to RGB/Abs?`);
  if (!ok) return;

  const req = selected.map(id => {
    const row = (window.qcData || qcData || []).find(r => String(r.id) === String(id));
    if (!row) return null;

    const batch = (row.QCBatch_ID ?? row.qcBatchId ?? row.QC_Batch ?? row.qcBatch ?? 'Default');

    return {
      Device_ID:  row.Device_ID ?? row.did ?? row.device_id ?? "",
      Test_ID:    row.Test_ID   ?? row.tid ?? row.test_id ?? "",
      // date optional; backend should NOT rely on this for matching
      Test_date:  row.Test_date ?? row.time ?? row.date ?? row.test_date ?? "",
      QCBatch_ID: (String(batch || '').trim() || 'Default')
    };
  }).filter(Boolean);

  if (!req.length) {
    alert("Selected IDs were not found in current QA/QC data. Refresh and try again.");
    return;
  }

  window.__moveBusy = true;

  google.script.run
    .withSuccessHandler(function(res) {
      window.__moveBusy = false;

      if (!res || res.ok !== true) {
        alert("Move failed: " + (res?.message || "Unknown error"));
        return;
      }

      google.script.run.withSuccessHandler(function(data) {
        if (data?.rgbData) window.rgbData = rgbData = data.rgbData;
        if (data?.qcData)  window.qcData  = qcData  = data.qcData;

        renderTable('rgb');
        renderTable('qaqc');

        // Clear selection using window.checkedRows
        window.checkedRows.qaqc = [];

        if (typeof safeUpdateRgbActionButtons === 'function') safeUpdateRgbActionButtons();
        else if (typeof updateRgbActionButtons === 'function') updateRgbActionButtons();

        if (typeof safeUpdateQaqcActionButtons === 'function') safeUpdateQaqcActionButtons();
        else if (typeof updateQaqcActionButtons === 'function') updateQaqcActionButtons();

        const moved   = Number(res.moved   ?? 0);
        const removed = Number(res.removed ?? moved);
        const skipped = Number(res.skipped ?? 0);

        let msg = `${moved} QA/QC row(s) were moved to RGB/Abs successfully.\nRemoved from QA/QC: ${removed}`;
        if (skipped) msg += `\nSkipped (not found / duplicate): ${skipped}`;
        alert(msg);

      }).getOperationalData();
    })
    .withFailureHandler(function(err) {
      window.__moveBusy = false;
      alert("Move failed: " + (err?.message || err));
    })
    .syncMoveDataToRGB(req);
}


function makeRowKey(r) {
  // Stable identity for matching across sheets
  return `${String(r.did||'')}|${String(r.tid||'')}|${String(r.time||'')}`;
}

function cloneToQCRowFromRGB(r, batchId) {
  return {
    id: null, // UI-only; sheet id may not exist yet
    did: String(r.did || ''),
    tid: String(r.tid || ''),
    time: String(r.time || ''),
    qcBatchId: String(batchId || 'Default'),
    raw: r.raw
  };
}

function cloneToRGBRowFromQC(r) {
  return {
    id: null,
    did: String(r.did || ''),
    tid: String(r.tid || ''),
    time: String(r.time || ''),
    raw: r.raw
  };
}

function setMoveButtonState(btn, busy, textBusy, textNormal) {
  if (!btn) return;
  btn.disabled = !!busy;
  btn.textContent = busy ? textBusy : textNormal;
}



// --- TAB NAVIGATION LOGIC ---
function tab(id, e) {
    // 1. Force Hide ALL Tab Contents
    document.querySelectorAll('.tab-content').forEach(el => {
        el.classList.remove('active');
        // IMPORTANT: Reset cssText to ensure no residual flex/block styles persist
        el.style.cssText = 'display: none !important'; 
    });

    // 2. Deactivate all buttons
    document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

    // 3. Show selected tab
    const el = document.getElementById('tab-' + id);
    if(el) {
        el.classList.add('active');
        // Force the display style directly
        if(id === 'install-reg') {
            el.style.cssText = 'display: flex !important; flex-direction: column; height: 100%;';
            renderDeviceRegistry();
            if (typeof setInstallSubtab === 'function') setInstallSubtab('installed');
        } else if(id === 'service-reg') {
            el.style.cssText = 'display: flex !important; flex-direction: column; height: 100%; padding: 20px; overflow-y: auto;';
        } else {
            el.style.cssText = 'display: block !important';
        }
        if (id === "qc-criteria") {
          setTimeout(populateQCCriteriaBatchDropdown, 0);
        }
        if (id === "qc-batch") {
          dbShowMasterTab('qc');
        }
    }

    // 4. Highlight Button
    if(e && e.currentTarget) e.currentTarget.classList.add('active');
}

function adminTab(id, e) {
  const root = document.getElementById('mod-admin');
  if (!root) return;
  root.querySelectorAll('.tab-content').forEach(el => {
    if (!el.id.startsWith('tab-admin-')) return;
    el.classList.remove('active');
    el.style.display = 'none';
  });
  root.querySelectorAll('.tab-btn').forEach(el => {
    el.classList.remove('active');
  });
  const target = document.getElementById(`tab-admin-${id}`);
  if (target) {
    target.classList.add('active');
    target.style.display = 'block';
  }
  if (e && e.currentTarget) e.currentTarget.classList.add('active');
}

function installSubtab(kind, event) {
    const container = document.getElementById('tab-install-reg');
    if (!container) return;
    container.querySelectorAll('.device-subtab-content').forEach(el => {
        el.classList.remove('active');
    });
    const target = document.getElementById(`install-subtab-${kind}`);
    if (target) target.classList.add('active');

    if (kind === 'map') {
        setTimeout(() => {
            renderMapView();
            if (mapInstance) mapInstance.invalidateSize();
        }, 50);
    }
}

function setInstallSubtab(kind) {
    installSubtab(kind);
    const toggle = document.getElementById('install-view-toggle');
    const title = document.getElementById('install-subtab-title');
    const isMap = kind === 'map';
    if (toggle && toggle.checked !== isMap) toggle.checked = isMap;
    if (title) title.textContent = isMap ? 'MAP VIEW' : 'INSTALLED DEVICES';
}

// Function to handle sub-tabs within the Fertilizer module
function subTab(tabId, event) {
    // 1. Hide all fertilizer sub-tab contents
    document.querySelectorAll('#mod-fertilizer .sub-tab-content').forEach(el => {
        el.style.display = 'none';
    });

    // 2. Deactivate buttons in this specific container
    const container = event.target.closest('.tab-nav');
    if (container) {
        container.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    }

    // 3. Show clicked content
    const content = document.getElementById('tab-' + tabId);
    if (content) {
        content.style.display = 'block';
    }

    // 4. Activate clicked button
    event.target.classList.add('active');
}


// === Geoapify autocomplete for Device Registry "Place" field ===
const GEOAPIFYAPIKEY = '4be88a7b307e422a8ebd9f7f9461fc96'; // your key


function initRegistryLocationAutocomplete(placeInput) {
    if (!GEOAPIFYAPIKEY || !placeInput) return;

    // avoid double-binding
    if (placeInput.dataset.geoapifyBound === 'true') return;
    placeInput.dataset.geoapifyBound = 'true';

    // find row + companion fields
    const tr            = placeInput.closest('tr');
    if (!tr) return;
    const gpsInput      = tr.querySelector('.reg-gps');
    const pinInput      = tr.querySelector('.reg-pin');
    const blockInput    = tr.querySelector('.reg-block');
    const districtInput = tr.querySelector('.reg-district');
    const stateInput    = tr.querySelector('.reg-state');

    // wrapper so Geoapify can create its own input
    const wrapper = document.createElement('div');
    wrapper.style.position = 'relative';
    wrapper.style.width = '100%';

    const parent = placeInput.parentNode;
    parent.insertBefore(wrapper, placeInput);
    wrapper.appendChild(placeInput);

    // hide original; we still use its value when saving
    placeInput.style.display = 'none';

    const geoContainer = document.createElement('div');
    wrapper.appendChild(geoContainer);

    // library global: either GeocoderAutocomplete or autocomplete.GeocoderAutocomplete
    const GeoapifyCtor =
        window.GeocoderAutocomplete ||
        (window.autocomplete && window.autocomplete.GeocoderAutocomplete);

    if (!GeoapifyCtor) {
        console.warn('[Geoapify] library not found. Try `typeof autocomplete` in console – it should be "object".');
        return;
    }

    const geoAutocomplete = new GeoapifyCtor(geoContainer, GEOAPIFYAPIKEY, {
        placeholder: placeInput.placeholder || 'Place',
        language: 'en',
        skipIcons: true,
        // filter: { countrycode: ['in'] } // optional: restrict to India
    });

    // style created input and keep it synced with hidden reg-place
    const geoInput = geoContainer.querySelector('input');
    if (geoInput) {
        geoInput.value = placeInput.value || '';
        geoInput.classList.add('db-input', 'reg-place-proxy');
        geoInput.addEventListener('input', () => {
            placeInput.value = geoInput.value;
        });
    }

    geoAutocomplete.on('select', (location) => {
        if (!location || !location.properties) return;
        const props = location.properties;

        // ---- derive address fields ----
        const blockVal =
            props.suburb ||
            props.neighbourhood ||
            props.village ||
            props.hamlet ||
            '';

        const districtVal =
            props.city_district ||
            props.state_district ||
            props.county ||
            props.city ||
            '';

        const stateVal = props.state || '';

        const pinRaw =
            props.postcode ||
            props.postal_code ||
            '';

        let lat = props.lat;
        let lon = props.lon;
        if ((lat == null || lon == null) &&
            location.geometry &&
            Array.isArray(location.geometry.coordinates)) {
            lon = location.geometry.coordinates[0];
            lat = location.geometry.coordinates[1];
        }

        const cap = (v) => {
            if (!v) return '';
            return (typeof autoCapitalizeWords === 'function')
                ? autoCapitalizeWords(v.trim())
                : v.trim();
        };

        // Block / District / State
        if (blockInput && blockVal)    blockInput.value    = cap(blockVal);
        if (districtInput && districtVal) districtInput.value = cap(districtVal);
        if (stateInput && stateVal)    stateInput.value    = cap(stateVal);

        // PIN
        if (pinInput && pinRaw) {
            const pinDigits = pinRaw.toString().replace(/\D/g, '').slice(0, 6);
            pinInput.value = pinDigits;
        }

        // GPS "lat, lon"
        if (gpsInput && lat != null && lon != null) {
            const latNum = Number(lat);
            const lonNum = Number(lon);
            if (!Number.isNaN(latNum) && !Number.isNaN(lonNum)) {
                const latStr = latNum.toFixed(6);
                const lonStr = lonNum.toFixed(6);
                gpsInput.value = `${latStr}, ${lonStr}`;
                gpsInput.dataset.lat = latStr;
                gpsInput.dataset.lng = lonStr;
            }
        }

        // Place text itself
        let placeText =
            props.formatted ||
            props.city ||
            props.town ||
            props.village ||
            props.name ||
            (geoInput ? geoInput.value : placeInput.value);

        placeText = cap(placeText);

        if (geoInput) geoInput.value = placeText;
        placeInput.value = placeText;

        if (typeof autoSizeInput === 'function') {
            if (geoInput)      autoSizeInput(geoInput);
            if (blockInput)    autoSizeInput(blockInput);
            if (districtInput) autoSizeInput(districtInput);
            if (stateInput)    autoSizeInput(stateInput);
            if (pinInput)      autoSizeInput(pinInput);
            if (gpsInput)      autoSizeInput(gpsInput);
        }
    });
}







function wireRegistryRowValidation(tr) {
    if (!tr) return;

    const client   = tr.querySelector('.reg-client');
    const company  = tr.querySelector('.reg-company');
    const pan      = tr.querySelector('.reg-pan');
    const gstin    = tr.querySelector('.reg-gstin');
    const address  = tr.querySelector('.reg-address');
    const did      = tr.querySelector('.reg-did');
    const sim      = tr.querySelector('.reg-sim');
    const aadhaar  = tr.querySelector('.reg-aadhaar');
    const mobile   = tr.querySelector('.reg-mobile');
    const moName   = tr.querySelector('.reg-moName');
    const date     = tr.querySelector('.reg-date');
    const place    = tr.querySelector('.reg-place');
    const gps      = tr.querySelector('.reg-gps');
    const pin      = tr.querySelector('.reg-pin');
    const block    = tr.querySelector('.reg-block');
    const district = tr.querySelector('.reg-district');
    const state    = tr.querySelector('.reg-state');

    if (client) client.addEventListener('blur', () => {
        client.value = autoCapitalizeWords(client.value.trim());
    });

    const setValidationHighlight = (el, isValid) => {
        if (!el) return;
        el.style.backgroundColor = (!el.value || isValid) ? '' : '#fff59d';
    };

    if (company) company.addEventListener('input', () => {
        company.value = company.value.toUpperCase().slice(0, 50);
        autoResizeRegistryTextarea(company);
    });

    if (pan) pan.addEventListener('input', () => {
        pan.value = toUpperAlnum(pan.value).slice(0, 10);
        setValidationHighlight(pan, /^[A-Z]{5}[0-9]{4}[A-Z]$/.test(pan.value));
        autoSizeInput(pan);
    });

    if (gstin) gstin.addEventListener('input', () => {
        gstin.value = toUpperAlnum(gstin.value).slice(0, 15);
        setValidationHighlight(gstin, /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z][0-9][A-Z][0-9]$/.test(gstin.value));
        autoSizeInput(gstin);
    });

    if (address) address.addEventListener('blur', () => {
        address.value = autoCapitalizeWords(address.value.trim());
    });

    if (did) did.addEventListener('input', () => {
        did.value = toDigits(did.value).slice(0, 15);
        setValidationHighlight(did, /^[0-9]{15}$/.test(did.value));
        autoSizeInput(did);
    });

    if (sim) sim.addEventListener('input', () => {
        sim.value = toDigits(sim.value).slice(0, 22);
        autoSizeInput(sim);
    });

    if (aadhaar) aadhaar.addEventListener('input', () => {
        aadhaar.value = toDigits(aadhaar.value).slice(0, 12);
        autoSizeInput(aadhaar);
    });

    if (mobile) {
        mobile.addEventListener('input', () => {
            mobile.value = limitPhoneInput(mobile);
            autoSizeInput(mobile);
        });
    }

    if (moName) moName.addEventListener('blur', () => {
        moName.value = autoCapitalizeWords(moName.value.trim());
    });

    if (pin) pin.addEventListener('input', () => {
        pin.value = toDigits(pin.value).slice(0, 6);
        setValidationHighlight(pin, /^[0-9]{6}$/.test(pin.value));
        autoSizeInput(pin);
    });

    if (gps) gps.addEventListener('blur', () => {
        gps.value = normalizeGps(gps.value.trim());
        autoSizeInput(gps);
    });

    if (block)    block.readOnly    = false;
    if (district) district.readOnly = false;
    if (state)    state.readOnly    = true;

    [
        client, company, pan, gstin, address, did, sim,
        aadhaar, mobile, moName, date, place, gps, pin,
        block, district, state
    ].forEach(inp => {
        if (inp) {
            inp.addEventListener('input', () => autoSizeInput(inp));
            inp.addEventListener('blur', () => autoSizeInput(inp));
            autoSizeInput(inp);
        }
    });

    setValidationHighlight(pan, /^[A-Z]{5}[0-9]{4}[A-Z]$/.test(pan?.value || ''));
    setValidationHighlight(gstin, /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z][0-9][A-Z][0-9]$/.test(gstin?.value || ''));
    setValidationHighlight(did, /^[0-9]{15}$/.test(did?.value || ''));
    setValidationHighlight(pin, /^[0-9]{6}$/.test(pin?.value || ''));
}





function autoSizeInput(inputEl) {
    if (!inputEl) return;
    // Create a temporary span to measure text width
    const span = document.createElement('span');
    span.style.position = 'absolute';
    span.style.visibility = 'hidden';
    span.style.whiteSpace = 'nowrap';
    span.style.font = window.getComputedStyle(inputEl).font;
    span.textContent = inputEl.value || inputEl.placeholder;
    
    document.body.appendChild(span);
    const width = span.offsetWidth + 16; // +16 for padding
    document.body.removeChild(span);
    
    inputEl.style.width = Math.min(width, 350) + 'px';
}

// Wire auto-size to ALL db-input fields
document.addEventListener('input', function(e) {
    if (e.target.classList.contains('db-input')) {
        autoSizeInput(e.target);
    }
});

// Also trigger on initial load for existing values
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.db-input').forEach(inp => {
        if (inp.value) autoSizeInput(inp);
    });
});

// --- NEW ANALYTICS LOGIC ---
let scatterCharts = []; // Track mini charts
let modalChart = null;  // Track modal chart
let trendChart = null;
let qcVsTestChart = null;
let s1ChartInstance = null;

// Initialize Dropdowns
function initAnalyticsUI() {
    const xSel = document.getElementById('scatter-x');
    if (xSel) {
        xSel.innerHTML = cols.map(c => `<option value="${c.k}">${c.n}</option>`).join('');
        xSel.value = 'ammonium'; 
    }
    const strip = document.getElementById('an-param-strip');
    if (strip) {
        strip.innerHTML = cols.map(c => {
            const isChecked = ['ammonium','phosphorus','oc'].includes(c.k) ? 'checked' : '';
            const activeClass = isChecked ? 'active' : '';
            return `<label class="param-pill ${activeClass}">
                        <input type="checkbox" value="${c.k}" ${isChecked} onchange="this.parentElement.classList.toggle('active',this.checked); scheduleAnalyticsUpdate()"> 
                        ${c.n}
                    </label>`;
        }).join('');
    }
}

let analyticsUpdateTimer;

function scheduleAnalyticsUpdate() {
    if (analyticsUpdateTimer) clearTimeout(analyticsUpdateTimer);
    analyticsUpdateTimer = setTimeout(() => {
        updateAnalyticsCharts();
    }, 150);
}

// Master Update Function
function updateAnalyticsCharts() {
    const mod = document.getElementById('mod-analytics');
    if (!mod || !mod.classList.contains('active')) return;
    if (typeof rgbData === 'undefined' || rgbData.length === 0) return;

    renderTrendChart();
    renderS1Chart();     
    renderFacetCharts(); // NEW: Facet Logic
    renderQCComparisonChart();
}

function syncAnalyticsDateRange() {
    const fromInput = document.getElementById('an-date-from');
    const toInput = document.getElementById('an-date-to');
    const rgbFrom = document.getElementById('date-rgb-from');
    const rgbTo = document.getElementById('date-rgb-to');
    if (fromInput && rgbFrom) rgbFrom.value = fromInput.value;
    if (toInput && rgbTo) rgbTo.value = toInput.value;
    updateAnalyticsCharts();
}

function normalizeAnalyticsRows(rows) {
    const list = Array.isArray(rows) ? rows : [];
    if (typeof ensureRowRaw === 'function') {
        list.forEach(r => ensureRowRaw(r));
    }
    return list;
}

// 1. New: Updated renderTrendChart to integrate the Chart.js Zoom Plugin
function renderTrendChart() {
    const ctx = document.getElementById('c-trend');
    if(!ctx) return;
    const chk = document.querySelectorAll('#an-param-strip input:checked');
    const keys = Array.from(chk).map(cb=>cb.value);
    
    if(keys.length===0){ if(chartObjs.trend) chartObjs.trend.clear(); return; }
    
    const did = document.getElementById('an-device').value;
    const f = new Date(document.getElementById('date-rgb-from').value||'1900-01-01');
    const t = new Date(document.getElementById('date-rgb-to').value||'2100-01-01'); t.setHours(23,59,59);
    
    const rows = normalizeAnalyticsRows(rgbData.filter(r=>{
        const d=parseDateObj(r.time); 
        return (!did || r.did===did) && d>=f && d<=t; 
    }).sort((a,b)=>parseDateObj(a.time)-parseDateObj(b.time)));

    const labels = rows.map(r=>r.time);
    const datasets = keys.map(k=>({
        label: cols.find(c=>c.k===k)?.n||k,
        data: rows.map(r=>calcMetric(r.raw,k)),
        borderColor: getBandColor(k,1),
        backgroundColor: getBandColor(k,0.1),
        borderWidth:1, tension:0.3, pointRadius:1
    }));

    if(chartObjs.trend) chartObjs.trend.destroy();
    chartObjs.trend = new Chart(ctx, { // Storing the chart instance in chartObjs.trend
        type:'line', data:{labels,datasets},
        options:{
            responsive:true, maintainAspectRatio:false,
            scales:{ x:{ticks:{maxTicksLimit:10}} },
            plugins: {
                legend: { display: true },
                redZonePlugin: true, // Keep your custom plugin
                // 2. NEW: Zoom Plugin Configuration
                zoom: { 
                    pan: {
                        enabled: true,
                        mode: 'xy', // Allows panning in both directions
                        modifierKey: 'ctrl', // Hold Ctrl/Cmd to pan
                    },
                    zoom: {
                        wheel: {
                            enabled: true, // Enable mouse wheel zoom
                        },
                        pinch: {
                            enabled: true // Enable pinch zoom on touch devices
                        },
                        drag: {
                            enabled: true, // Enable drag-to-zoom (rubber band zoom)
                            borderColor: 'rgba(52, 152, 219, 0.5)',
                            borderWidth: 1,
                            backgroundColor: 'rgba(52, 152, 219, 0.2)',
                            // Use Shift key to trigger drag-to-zoom
                            modifierKey: 'shift', 
                        },
                        mode: 'xy', // Allows zooming in both X and Y directions
                    }
                }
            }
        },
        plugins: [redZonePlugin] // Re-apply custom plugin
    });
}

// 2. Facet Charts (Multi-Y against One-X)
function renderFacetCharts() {
    const grid = document.getElementById('scatter-grid');
    if (!grid) return;
    
    // Cleanup old charts
    grid.innerHTML = '';
    scatterCharts.forEach(c => c.destroy());
    scatterCharts = [];

    const xKey = document.getElementById('scatter-x').value || 'ammonium';
    const exclude = document.getElementById('scatter-exclude-outliers').checked;
    
    // Filter Data
    const deviceId = document.getElementById('an-device').value;
    const from = new Date(document.getElementById('date-rgb-from').value || '1900-01-01');
    const to = new Date(document.getElementById('date-rgb-to').value || '2100-01-01'); to.setHours(23,59,59);

    const rows = normalizeAnalyticsRows(rgbData.filter(r => {
        const d = parseDateObj(r.time);
        return (!deviceId || r.did === deviceId) && d >= from && d <= to;
    }));

    if (rows.length < 2) {
        grid.innerHTML = '<div style="padding:20px; color:#666;">Not enough data points.</div>';
        return;
    }

    // Generate a chart for every parameter (except X)
    cols.forEach(yCol => {
        if (yCol.k === xKey) return; 

        const stats = calculateRegression(rows, xKey, yCol.k, exclude);
        if(!stats.valid) return;

        // Card HTML
        const card = document.createElement('div');
        card.className = 'mini-chart-card';
        card.innerHTML = `
            <div class="mini-chart-header">
                <span>${yCol.n} vs ${cols.find(c=>c.k===xKey).n}</span>
                <span class="magnify-btn" title="Full View" onclick="expandChart('${xKey}', '${yCol.k}')">🔍</span>
            </div>
            <div style="height:200px; width:100%;"><canvas></canvas></div>
            <div class="mini-chart-stats">R²=${stats.r2} | y=${stats.slope}x ${stats.intercept >= 0 ? '+' : ''}${stats.intercept}</div>
        `;
        grid.appendChild(card);
        
        // Render Chart
        const chart = new Chart(card.querySelector('canvas').getContext('2d'), {
            type: 'scatter',
            data: {
                datasets: [
                    { label:'Data', data:stats.points, backgroundColor: getBandColor(yCol.k,0.6), pointRadius:1 },
                    { type:'line', label:'Fit', data:stats.line, borderColor:'#333', borderWidth:1, pointRadius:0, animation: false }
                ]
            },
            options: { 
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { x: {title:{display:true, text:cols.find(c=>c.k===xKey).n}, ticks:{maxTicksLimit:5}}, y:{ticks:{maxTicksLimit:5}} }
            }
        });
        scatterCharts.push(chart);
    });
}

// 3. Regression Math
function calculateRegression(rows, xKey, yKey, exclude) {
    let points = rows.map(r => ({ x: calcMetric(r.raw, xKey), y: calcMetric(r.raw, yKey) }))
                     .filter(p => Number.isFinite(p.x) && Number.isFinite(p.y));

    if (exclude) {
        const ys = points.map(p => p.y).sort((a,b)=>a-b);
        const q1 = ys[Math.floor(ys.length*0.25)];
        const q3 = ys[Math.floor(ys.length*0.75)];
        const min = q1 - 1.5*(q3 - q1);
        const max = q3 + 1.5*(q3 - q1);
        points = points.filter(p => p.y >= min && p.y <= max);
    }

    if (points.length < 2) return { valid: false };

    const n = points.length;
    let sumX=0, sumY=0, sumXY=0, sumXX=0;
    points.forEach(p => { sumX+=p.x; sumY+=p.y; sumXY+=p.x*p.y; sumXX+=p.x*p.x; });
    
    const slope = (n*sumXY - sumX*sumY) / (n*sumXX - sumX*sumX);
    const intercept = (sumY - slope*sumX) / n;
    
    const meanY = sumY/n;
    const ssTot = points.reduce((a,b) => a + Math.pow(b.y - meanY, 2), 0);
    const ssRes = points.reduce((a,b) => a + Math.pow(b.y - (slope*b.x + intercept), 2), 0);
    const r2 = ssTot !== 0 ? (1 - (ssRes/ssTot)) : 0; 

    const xs = points.map(p => p.x);
    const line = [ 
        {x: Math.min(...xs), y: slope*Math.min(...xs)+intercept}, 
        {x: Math.max(...xs), y: slope*Math.max(...xs)+intercept} 
    ];

    return { valid: true, points, line, r2: r2.toFixed(3), slope: slope.toFixed(3), intercept: intercept.toFixed(3) };
}

// 4. Modal Logic
function expandChart(xKey, yKey) {
    const modal = document.getElementById('chart-modal');
    modal.classList.add('active');
    document.getElementById('modal-chart-title').textContent = `${cols.find(c=>c.k===yKey).n} vs ${cols.find(c=>c.k===xKey).n}`;

    if (modalChart) modalChart.destroy();
    
    const exclude = document.getElementById('scatter-exclude-outliers').checked;
    const deviceId = document.getElementById('an-device').value;
    const from = new Date(document.getElementById('date-rgb-from').value || '1900-01-01');
    const to = new Date(document.getElementById('date-rgb-to').value || '2100-01-01'); to.setHours(23,59,59);

    const rows = rgbData.filter(r => {
        const d = parseDateObj(r.time);
        return (!deviceId || r.did === deviceId) && d >= from && d <= to;
    });

    const stats = calculateRegression(rows, xKey, yKey, exclude); 
    
    const ctx = document.getElementById('c-modal').getContext('2d');
    modalChart = new Chart(ctx, {
        type: 'scatter',
        data: {
            datasets: [{
                label: 'Data', data: stats.points, backgroundColor: getBandColor(yKey, 0.6), pointRadius: 2
            }, {
                type: 'line', label: `Fit: y=${stats.slope}x ${stats.intercept >=0?'+':''}${stats.intercept}, R²=${stats.r2}`,
                data: stats.line, borderColor: '#333', borderWidth: 1
            }]
        },
        options: {
            responsive: true, maintainAspectRatio: false,
            scales: {
                x: { title: {display:true, text:cols.find(c=>c.k===xKey).n, font:{size:14}} },
                y: { title: {display:true, text:cols.find(c=>c.k===yKey).n, font:{size:14}} }
            }
        }
    });
}
function closeChartModal() { document.getElementById('chart-modal').classList.remove('active'); }

// 5. Restored S1 Chart
function renderS1Chart() {
    const ctx = document.getElementById('c-s1');
    if(!ctx) return;
    
    const deviceId = document.getElementById('an-device').value;
    const from = new Date(document.getElementById('date-rgb-from').value || '1900-01-01');
    const to = new Date(document.getElementById('date-rgb-to').value || '2100-01-01'); to.setHours(23,59,59);
    
    const rows = normalizeAnalyticsRows(rgbData.filter(r => {
        const d = parseDateObj(r.time);
        return (!deviceId || r.did === deviceId) && d >= from && d <= to;
    }).sort((a,b) => parseDateObj(a.time) - parseDateObj(b.time)));

    const getData = (key) => rows.map(r => r.raw[key]?.c || null);
    const labels = rows.map(r => r.time);

    if(s1ChartInstance) s1ChartInstance.destroy();
    s1ChartInstance = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                { label:'P (Cal)', data:getData('phosphorus'), borderColor: getBandColor('phosphorus',1), borderDash:[5,5], borderWidth:1.5, pointRadius:1 },
                { label:'OC (Cal)', data:getData('oc'), borderColor: getBandColor('oc',1), borderDash:[5,5], borderWidth:1.5, pointRadius:1 },
                { label:'K (Cal)', data:getData('potassium'), borderColor: getBandColor('potassium',1), borderWidth:1.5, pointRadius:1 },
                { label:'Fe (Cal)', data:getData('iron'), borderColor: getBandColor('iron',1), borderWidth:1.5, pointRadius:1 },
                { label:'Cu (Cal)', data:getData('copper'), borderColor: getBandColor('copper',1), borderWidth:1.5, pointRadius:1 }
            ]
        },
        options: { 
            responsive:true, maintainAspectRatio:false, 
            scales:{
                x:{ticks:{maxTicksLimit:10}},
                // Retain the fix preventing downward stretch
                y: { suggestedMin: 10000 } 
            },
            plugins: {
                // Legend is standard for line charts
                legend: { display: true },
                // NEW: Zoom Plugin Configuration
                zoom: { 
                    pan: { enabled: true, mode: 'xy', modifierKey: 'ctrl' },
                    zoom: { 
                        wheel: { enabled: true }, 
                        pinch: { enabled: true }, 
                        drag: { enabled: true, modifierKey: 'shift' }, 
                        mode: 'xy' 
                    }
                }
            }
        }
    });
}

// 6. Restored QC Chart
function renderQCComparisonChart() {
    const ctx = document.getElementById('c-qc-vs-test');
    if(!ctx || !rgbData.length) return;
    
    const totalF = rgbData.length;
    let passF = 0; try { passF = rgbData.filter(r => evaluateTestSuccess(r) === 'PASS').length; } catch(e){}
    const pctF = totalF ? (passF/totalF*100) : 0;
    
    const totalQ = qcData.length;
    let passQ = 0; try { passQ = qcData.filter(r => getEffectiveQCStatusForDevice(r.did, computeAutoQCStatus(r)) === 'PASS').length; } catch(e){}
    const pctQ = totalQ ? (passQ/totalQ*100) : 0;

    if(qcVsTestChart) qcVsTestChart.destroy();
    qcVsTestChart = new Chart(ctx, {
        type:'bar',
        data:{
            labels:['Field Success %', 'QC Pass %'],
            datasets:[{label:'%', data:[pctF, pctQ], backgroundColor:['#27ae60','#2980b9']}]
        },
        options:{responsive:true,maintainAspectRatio:false,scales:{y:{beginAtZero:true,max:100}}, plugins: {legend: {display:false}}}
    });
}

// Modal Logic
function expandChart(xKey, yKey) {
    const modal = document.getElementById('chart-modal');
    modal.classList.add('active');
    document.getElementById('modal-chart-title').textContent = `${cols.find(c=>c.k===yKey).n} vs ${cols.find(c=>c.k===xKey).n}`;

    if (modalChart) modalChart.destroy();
    
    const exclude = document.getElementById('scatter-exclude-outliers').checked;
    const deviceId = document.getElementById('an-device').value;
    const from = new Date(document.getElementById('date-rgb-from').value || '1900-01-01');
    const to = new Date(document.getElementById('date-rgb-to').value || '2100-01-01'); to.setHours(23,59,59);

    const rows = rgbData.filter(r => {
        const d = parseDateObj(r.time);
        return (!deviceId || r.did === deviceId) && d >= from && d <= to;
    });

    const stats = calculateRegression(rows, xKey, yKey, exclude); 
    
    const ctx = document.getElementById('c-modal').getContext('2d');
    modalChart = new Chart(ctx, {
        type: 'scatter',
        data: {
            datasets: [{
                label: 'Data', data: stats.points, backgroundColor: getBandColor(yKey, 0.6), pointRadius: 2
            }, {
                type: 'line', label: `Fit: y=${stats.slope}x ${stats.intercept >=0?'+':''}${stats.intercept}, R²=${stats.r2}`,
                data: stats.line, borderColor: '#333', borderWidth: 1
            }]
        },
        options: {
            responsive: true, maintainAspectRatio: false,
            scales: {
                x: { title: {display:true, text:cols.find(c=>c.k===xKey).n, font:{size:14}} },
                y: { title: {display:true, text:cols.find(c=>c.k===yKey).n, font:{size:14}} }
            }
        }
    });
}


function createUser() {
    const type = document.getElementById('adm-type').value;
    const user = document.getElementById('adm-user').value.trim(); // Emp ID
    const pass = document.getElementById('adm-pass').value.trim();
    
    // Simple Email check logic (assuming EmpID + domain for simplicity, or user types full email)
    // Constraint: User must type either an EmpID or a full email. 
    // We will assume the input 'adm-user' is the Employee ID, and we ask for Email separately?
    // OR we follow your prompt: "emails and employee IDs as usernames".
    
    // Let's prompt for Email since your prompt implies strict domain checking
    let email = prompt("Please enter the user's @absolute.ag email:");
    if(!email) return;
    
    if (!email.endsWith('@absolute.ag')) {
        alert("Error: Email must end with @absolute.ag");
        return;
    }

    if (!user || !pass) {
        alert("Please enter Employee ID and Password.");
        return;
    }

    const data = {
        empId: user,
        email: email,
        password: pass,
        role: type
    };

    google.script.run.withSuccessHandler(msg => {
        alert(msg);
        // Clear fields
        document.getElementById('adm-user').value = '';
        document.getElementById('adm-pass').value = '';
    }).withFailureHandler(err => {
        alert("Error: " + err.message);
    }).adminCreateUser(data);
}
 

function saveQCBatchAssignments() {
    const selects = document.querySelectorAll('#tbl-qaqc-metrics .qc-batch-select-cell');
    if (!selects.length) {
        alert('No QC rows to save.');
        return;
    }
    selects.forEach(sel => {
        const id    = parseInt(sel.dataset.id, 10);
        const batch = sel.value && sel.value.trim() ? sel.value.trim() : 'Default';
        const row   = qcData.find(r => r.id === id);
        if (row) {
            row.qcBatchId = batch;
        }
    });
    refreshQCBatchOptions();
    renderTable('qaqc');
    alert('QC Batch assignments saved.');
}

// QC override
function toggleQCOverrideMode() {
    const toggle = document.getElementById('qaqc-override-toggle');
    const input  = document.getElementById('qaqc-override-input');
    const note   = document.getElementById('qaqc-override-note');
    const saveBtn = document.getElementById('qaqc-override-save');
    if (!toggle || !input || !note) return;

    const deviceId       = input.dataset.deviceId;
    const computedStatus = input.dataset.computedStatus || 'PASS';

    if (!deviceId) {
        toggle.checked = false;
        if (saveBtn) saveBtn.disabled = true;
        alert('Select a QC row first to choose a device.');
        return;
    }

    if (toggle.checked) {
        qcManualOverrideEnabled[deviceId] = true;
        if (!qcManualStatus[deviceId]) {
            qcManualStatus[deviceId] = computedStatus;
        }

        input.value   = qcManualStatus[deviceId];
        input.disabled = false;
        if (saveBtn) saveBtn.disabled = false;
        note.textContent = 'Mode: Manual override active';
        note.style.color = '#e67e22';
    } else {
        qcManualOverrideEnabled[deviceId] = false;
        input.value   = computedStatus;
        input.disabled = true;
        if (saveBtn) saveBtn.disabled = true;
        note.textContent = 'Mode: Automatic (from parameter QC)';
        note.style.color = '#888';
    }
}
function applyQCOverride() {
    const input  = document.getElementById('qaqc-override-input');
    const toggle = document.getElementById('qaqc-override-toggle');
    const saveBtn = document.getElementById('qaqc-override-save');
    if (!input || !toggle) return;

    const deviceId       = input.dataset.deviceId;
    const computedStatus = input.dataset.computedStatus || 'PASS';

    if (!deviceId) return;

    if (!toggle.checked) {
        input.value = computedStatus;
        if (saveBtn) saveBtn.disabled = true;
        return;
    }

    let value = input.value.trim().toUpperCase();
    if (value !== 'PASS' && value !== 'FAIL') {
        alert('Please type PASS or FAIL (or disable manual override to use automatic QC status).');
        const last = qcManualStatus[deviceId] || computedStatus;
        input.value = last;
        return;
    }
    qcManualStatus[deviceId] = value;
    renderTable('qaqc');
}

// ===============================
// MEMORY-FIRST QC BATCH DROPDOWNS
// ===============================

function refreshQCBatchOptions() {
  // Deprecated: QC Status no longer uses a batch dropdown.
}


/**
 * Database QC Criteria dropdown.
 * UPDATED: Memory-first from window.dbMasters.qc.rows (QCBatch_ID).
 * No loadMasterListsOnce() call (prevents concurrency errors).
 */
function refreshQCCriteriaBatchOptions() {
  const sel = document.getElementById("qc-criteria-batch");
  if (!sel) return;

  // 1) Prefer DB masters in memory (NO SERVER CALLS)
  let batches = [];
  try {
    const rows = window.dbMasters?.qc?.rows;
    if (Array.isArray(rows) && rows.length) {
      batches = rows
        .map(r => String(r?.QCBatch_ID ?? '').trim())
        .filter(Boolean);
    }
  } catch (e) {}

  // 2) Fallback: if you have masterLists already loaded in memory, use it (still no server call)
  if (!batches.length) {
    const ml = window.masterLists;
    if (ml && Array.isArray(ml.qcBatchIds) && ml.qcBatchIds.length) {
      batches = ml.qcBatchIds.map(x => String(x).trim()).filter(Boolean);
    }
  }

  // 3) Last fallback
  if (!batches.length) batches = ["Default"];

  // Ensure Default exists + de-dup + sort Default first
  if (!batches.includes("Default")) batches.unshift("Default");
  batches = Array.from(new Set(batches.map(b => String(b).trim()).filter(Boolean)));
  batches.sort((a, b) => (a === "Default" ? -1 : b === "Default" ? 1 : a.localeCompare(b)));

  const prev = String(sel.value || window.currentQCCriteriaBatchId || "Default").trim();

  sel.innerHTML = batches.map(b => {
    const v = String(b).trim();
    return `<option value="${escapeHtml(v)}">${escapeHtml(v)}</option>`;
  }).join("");

  const pick = batches.includes(prev) ? prev : (batches.includes("Default") ? "Default" : (batches[0] || "Default"));
  sel.value = pick;
  window.currentQCCriteriaBatchId = pick;

  if (typeof renderQCCriteria === "function") renderQCCriteria();
}






function setQCCriteriaBatchFromUI() {
  const sel = document.getElementById('qc-criteria-batch-select');
  if (!sel) return;
  window.currentQCCriteriaBatchId = sel.value || 'Default';
  renderQCCriteria();
}


function setQCBatchFromUI() {
  // Deprecated: QC Status no longer uses a batch dropdown.
}





// Analytics helpers
function setDateRange(range) {
    const now = new Date();
    let from = new Date();

    if (range === 7) {
        from.setDate(now.getDate() - 7);
    } else if (range === 30) {
        from.setDate(now.getDate() - 30);
    } else if (range === 'month') {
        from = new Date(now.getFullYear(), now.getMonth(), 1);
    }

    const f = d => d.toISOString().split('T')[0];

    document.getElementById('date-rgb-from').value = f(from);
    document.getElementById('date-rgb-to').value   = f(now);
    const anFrom = document.getElementById('an-date-from');
    const anTo = document.getElementById('an-date-to');
    if (anFrom) anFrom.value = f(from);
    if (anTo) anTo.value = f(now);

    renderTable('rgb');
    updateAnalyticsCharts();
}


function setDateRangeFromData(rows, days) {
  try {
    const normStr = (v) => String(v ?? "").trim();

    const parseRowDate = (x) => {
      if (!x) return null;
      if (x instanceof Date) return isNaN(x.getTime()) ? null : x;

      const s0 = normStr(x);
      if (!s0) return null;

      // Support "yyyy-mm-dd | hh:mm"
      const s = s0.includes("|") ? s0.replace(/\s*\|\s*/g, " ") : s0;

      const d1 = new Date(s);
      if (!isNaN(d1.getTime())) return d1;

      // Fallback: yyyy-mm-dd prefix
      const m = s0.match(/^(\d{4}-\d{2}-\d{2})/);
      if (m) {
        const d2 = new Date(m[1]);
        if (!isNaN(d2.getTime())) return d2;
      }
      return null;
    };

    const toISODate = (d) => d.toISOString().split("T")[0];

    if (!Array.isArray(rows) || rows.length === 0) return false;

    // Find max date in backend data
    let maxD = null;
    rows.forEach(r => {
      const ds = r?.Test_date ?? r?.time ?? r?.Date ?? r?.datetime ?? "";
      const d = parseRowDate(ds);
      if (!d) return;
      if (!maxD || d > maxD) maxD = d;
    });

    if (!maxD) return false;

    const to = new Date(maxD);
    const from = new Date(maxD);
    from.setDate(from.getDate() - (Number(days) || 30));

    const fromEl = document.getElementById("date-rgb-from");
    const toEl   = document.getElementById("date-rgb-to");
    if (!fromEl || !toEl) return false;

    fromEl.value = toISODate(from);
    toEl.value   = toISODate(to);

    return true;
  } catch (e) {
    return false;
  }
}


function downloadChart(id) {
    const canvas = document.getElementById(id);
    if(!canvas) return;
    downloadCanvasWithWhiteBackground(canvas, `${id}.png`);
}

function downloadCanvasWithWhiteBackground(canvas, filename) {
    const out = document.createElement('canvas');
    out.width = canvas.width;
    out.height = canvas.height;
    const ctx = out.getContext('2d');
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, out.width, out.height);
    ctx.drawImage(canvas, 0, 0);
    const link = document.createElement('a');
    link.download = filename || 'chart.png';
    link.href = out.toDataURL('image/png');
    link.click();
}


function getSelectedAnalyticsParams() {
    const strip = document.getElementById('an-param-strip');
    if (!strip) return ['ammonium'];
    const cbs = strip.querySelectorAll('input[type="checkbox"]');
    const selected = Array.from(cbs)
        .filter(cb => cb.checked)
        .map(cb => cb.value);
    return selected.length ? selected : ['ammonium'];
}



//---------------- Database module end -------------------

//---------------- Device module starts -------------------

// Capitalize first letter of each word, keep rest as-typed
function autoCapitalizeWords(str) {
    str = str.trimStart();
    return str.replace(/\b(\p{L})(\p{L}*)/gu, (m, first, rest) =>
        first.toUpperCase() + rest
    );
}

// Uppercase and strip non-alphanumerics
function toUpperAlnum(str) {
    return str.toUpperCase().replace(/[^A-Z0-9]/g, '');
}

// Numeric only
function toDigits(str) {
    return str.replace(/\D/g, '');
}

// GPS: allow digits, sign, dot, comma, space; clamp decimals
function normalizeGps(str) {
    // keep only valid chars
    let s = str.replace(/[^0-9+\-.,\s]/g, '');
    // limit each numeric token to 10 decimals
    return s.replace(/(\d+\.\d{0,10})\d*/g, '$1');
}

// Simple dd-mm-yyyy normalization from input[type=date] value (yyyy-mm-dd)
function toDDMMYYYY(dateStr) {
    if (!dateStr) return '';
    const parts = dateStr.split('-'); // yyyy-mm-dd
    if (parts.length !== 3) return dateStr;
    return parts[2] + '-' + parts[1] + '-' + parts[0];
}

function toggleSidebar() {
    const sidebar = document.querySelector('.sidebar');
    if (!sidebar) return;
    sidebar.classList.toggle('collapsed');
}




// Resizers
{
    const resizerQC  = document.getElementById('drag-qaqc');
    const upperQC    = document.getElementById('qaqc-upper');
    let yQC=0, hQC=0;
    if(resizerQC) resizerQC.addEventListener('mousedown', function(e) {
        yQC=e.clientY; hQC=parseInt(window.getComputedStyle(upperQC).height);
        document.addEventListener('mousemove', mmQC);
        document.addEventListener('mouseup', muQC);
    });
    function mmQC(e) { upperQC.style.height = (hQC + e.clientY - yQC) + 'px'; }
    function muQC() {
        document.removeEventListener('mousemove', mmQC);
        document.removeEventListener('mouseup', muQC);
    }

    const resizerMap = document.getElementById('drag-map');
    const upperMap   = document.getElementById('map-upper');
    let yMap = 0, hMap = 0;
    if (resizerMap && upperMap) {
        resizerMap.addEventListener('mousedown', function(e) {
            yMap = e.clientY;
            hMap = parseInt(window.getComputedStyle(upperMap).height);
            document.addEventListener('mousemove', mmMap);
            document.addEventListener('mouseup', muMap);
        });
    }
    function mmMap(e) {
        upperMap.style.height = (hMap + e.clientY - yMap) + 'px';
    }
    function muMap() {
        document.removeEventListener('mousemove', mmMap);
        document.removeEventListener('mouseup', muMap);
    }

    const resizerQC2 = document.getElementById('drag-qaqc2');
    const statusQC   = document.getElementById('qaqc-status');
    let yQC2=0, hQC2=0;
    if(resizerQC2) resizerQC2.addEventListener('mousedown', function(e) {
        yQC2 = e.clientY; hQC2 = parseInt(window.getComputedStyle(statusQC).height);
        document.addEventListener('mousemove', mmQC2);
        document.addEventListener('mouseup', muQC2);
    });
    function mmQC2(e) {
        const delta = yQC2 - e.clientY;
        statusQC.style.height = (hQC2 + delta) + 'px';
    }
    function muQC2() {
        document.removeEventListener('mousemove', mmQC2);
        document.removeEventListener('mouseup', muQC2);
    }

    
}
/* ========================================
   PANEL TOGGLE FUNCTIONS - SIMPLE & RELIABLE
   ======================================== */

// Generic panel toggle (keeps your 3‑state logic)
// INSTALLATION REGISTRY: button shows Minimize (orange) vs Maximize (green)
function togglePanel(panelId, button) {
  console.log('togglePanel called:', panelId);

  const panel = document.getElementById(panelId);
  if (!panel) {
    console.error('Panel not found:', panelId);
    return;
  }

  // ========= INSTALLATION REGISTRY: STRICT 2-STATE =========
  if (panelId === 'install-upper') {
    const isMax = panel.classList.contains('maximized');

    if (isMax) {
      // State A (MAX) → State B (MIN)
      panel.classList.remove('maximized');
      panel.classList.add('minimized');

      // Next action is Maximize → green
      button.textContent = 'Switch to Registry Table';
      button.classList.remove('minimize');
      button.classList.add('maximize');

      console.log('install-upper minimized');
    } else {
      // State B (MIN or normal) → State A (MAX)
      panel.classList.remove('minimized');
      panel.classList.add('maximized');

      // Next action is Minimize → orange
      button.textContent = 'Switch to Map View';
      button.classList.remove('maximize');
      button.classList.add('minimize');

      console.log('install-upper maximized');
    }
    return;  // IMPORTANT: do not fall through to default logic
  }

  // ========= DEFAULT LOGIC FOR OTHER PANELS (unchanged) =========
  const isMinimized = panel.classList.contains('minimized');
  const isMaximized = panel.classList.contains('maximized');

  panel.classList.remove('minimized', 'maximized');

  if (isMinimized) {
    button.textContent = 'Minimize';
    button.classList.remove('maximize');
    button.classList.add('minimize');
    console.log('Restored from minimized');
  } else if (isMaximized) {
    button.textContent = 'Minimize';
    button.classList.remove('maximize');
    button.classList.add('minimize');
    console.log('Restored from maximized');
  } else if (button.classList.contains('minimize')) {
    panel.classList.add('minimized');
    button.textContent = 'Maximize';
    button.classList.remove('minimize');
    button.classList.add('maximize');
    console.log('Panel minimized');
  } else {
    panel.classList.add('maximized');
    button.textContent = 'Minimize';
    button.classList.remove('maximize');
    button.classList.add('minimize');
    console.log('Panel maximized');
  }

  if (panelId === 'install-lower' && typeof installMap !== 'undefined' && installMap) {
    setTimeout(function () {
      installMap.invalidateSize();
      console.log('Map resized');
    }, 100);
  }
}



function setResultsFocus(view) {
  const resultsPanel = document.getElementById('results-table-panel');
  const successPanel = document.getElementById('results-success-panel');
  const toggle = document.getElementById('results-view-toggle');
  const title = document.getElementById('results-panel-title');
  if (!resultsPanel || !successPanel) return;

  const isSuccess = view === 'success';

  resultsPanel.classList.toggle('active', !isSuccess);
  successPanel.classList.toggle('active', isSuccess);

  if (isSuccess) {
    resultsPanel.setAttribute('hidden', 'true');
    successPanel.removeAttribute('hidden');
    if (title) title.textContent = 'SUCCESS/ABS VIEW';
    if (typeof updateResultsLowerView === 'function') updateResultsLowerView();
  } else {
    successPanel.setAttribute('hidden', 'true');
    resultsPanel.removeAttribute('hidden');
    if (title) title.textContent = 'RESULTS TABLE';
    if (typeof renderResults === 'function') renderResults();
  }

  if (toggle && toggle.checked !== isSuccess) {
    toggle.checked = isSuccess;
  }
}

let qaqcRawMode = false;

function setQaqcFocus(mode) {

  const mod = document.getElementById('mod-qaqc');
  if (mod) {
    mod.classList.remove('qaqc-view-results','qaqc-view-status');
    if (mode === 'results') mod.classList.add('qaqc-view-results');
    else if (mode === 'status') mod.classList.add('qaqc-view-status');
  }

  const resultsTab = document.getElementById('tab-qaqc-results');
  const statusTab = document.getElementById('tab-qaqc-status');
  const results = document.getElementById('qaqc-results-panel');
  const raw     = document.getElementById('qaqc-raw-panel');
  const status  = document.getElementById('qaqc-status-panel');
  const resizerMain = document.getElementById('drag-qaqc');
  const resizerStatus = document.getElementById('drag-qaqc2');

  if (mode === 'status') {
    if (resultsTab) {
      resultsTab.classList.remove('active');
      resultsTab.style.display = 'none';
    }
    if (statusTab) {
      statusTab.classList.add('active');
      statusTab.style.display = 'flex';
    }
    if (results) { results.style.display = 'none'; results.setAttribute('hidden', 'true'); }
    if (raw) { raw.style.display = 'none'; raw.setAttribute('hidden', 'true'); }
    if (status) { status.style.display = 'block'; status.removeAttribute('hidden'); }
    if (resizerMain) resizerMain.style.display = 'none';
    if (resizerStatus) resizerStatus.style.display = 'none';
  } else {
    if (statusTab) {
      statusTab.classList.remove('active');
      statusTab.style.display = 'none';
    }
    if (resultsTab) {
      resultsTab.classList.add('active');
      resultsTab.style.display = 'flex';
    }
    if (status) { status.style.display = 'none'; status.setAttribute('hidden', 'true'); }
    if (resizerStatus) resizerStatus.style.display = 'none';
    setQaqcRawView(qaqcRawMode);
  }

  updateQaqcSwitchButtons(mode);

  /* =========================================================
     ✅ NEW: QC Status view hook (parameter dropdown + histogram)
     ========================================================= */
  if (mode === 'status') {

    if (typeof populateQaqcStatusFilters === 'function') populateQaqcStatusFilters({ preserveSelection: false });


    // Populate parameter dropdown once (safe if called repeatedly)
    populateQCHistParamDropdown();

    // Ensure histogram is drawn even if no row is clicked
    const key =
      window.currentQCParamKey ||
      (window.cols && window.cols.length ? window.cols[0].k : null);

    if (key) {
      updateQCHistogram(
        key,
        null,                               // selectedVal handled internally if row selected
        currentQCBatchId || 'Default'
      );
    }
  }
}

function setQaqcRawView(isRaw) {
  qaqcRawMode = !!isRaw;
  const toggles = [
    document.getElementById('qaqc-raw-toggle'),
    document.getElementById('qaqc-raw-toggle-raw')
  ];
  toggles.forEach(toggle => {
    if (toggle && toggle.checked !== qaqcRawMode) {
      toggle.checked = qaqcRawMode;
    }
  });
  const results = document.getElementById('qaqc-results-panel');
  const raw = document.getElementById('qaqc-raw-panel');
  const resizerMain = document.getElementById('drag-qaqc');

  if (qaqcRawMode) {
    if (results) { results.style.display = 'none'; results.setAttribute('hidden', 'true'); }
    if (raw) { raw.style.display = 'block'; raw.removeAttribute('hidden'); }
    if (resizerMain) resizerMain.style.display = 'none';
    if (typeof renderRawSelection === 'function') renderRawSelection('qaqc');
  } else {
    if (results) { results.style.display = 'block'; results.removeAttribute('hidden'); }
    if (raw) { raw.style.display = 'none'; raw.setAttribute('hidden', 'true'); }
    if (resizerMain) resizerMain.style.display = 'none';
  }
}


// ===== RGB / Abs view switch =====
function setRgbFocus(view) {
  const metricsPanel = document.getElementById('rgb-metrics-panel');
  const rawPanel = document.getElementById('rgb-raw-panel');
  const toggle = document.getElementById('rgb-view-toggle');
  const title = document.getElementById('rgb-panel-title');
  if (!metricsPanel || !rawPanel) return;

  const isRaw = view === 'raw';

  metricsPanel.classList.toggle('active', !isRaw);
  rawPanel.classList.toggle('active', isRaw);

  if (isRaw) {
    metricsPanel.setAttribute('hidden', 'true');
    rawPanel.removeAttribute('hidden');
    if (title) title.textContent = 'RAW RGB DATA';
    if (typeof renderRawSelection === 'function') renderRawSelection('rgb');
  } else {
    rawPanel.setAttribute('hidden', 'true');
    metricsPanel.removeAttribute('hidden');
    if (title) title.textContent = 'CALCULATED METRICS';
    if (typeof renderTable === 'function') renderTable('rgb');
  }

  if (toggle && toggle.checked !== isRaw) {
    toggle.checked = isRaw;
  }
}





function updateQaqcSwitchButtons(mode) {
  const buttons = document.querySelectorAll('#mod-qaqc .tab-nav .tab-btn[data-qaqc-mode]');
  buttons.forEach(btn => {
    const target = btn.dataset.qaqcMode;
    btn.classList.toggle('active', target === mode);
  });
}



document.addEventListener('DOMContentLoaded', function () {
  setQaqcFocus('results'); // Quarantine data as default view
});

document.addEventListener('DOMContentLoaded', function () {
  setResultsFocus('table');
});


// === AUTO-SAVE IMPLEMENTATION ===
document.addEventListener('DOMContentLoaded', function() {

    // 1. Auto-save Success Criteria (dbCriteria)
    const criteriaTable = document.getElementById('tbl-criteria-editable');
    if (criteriaTable) {
        criteriaTable.addEventListener('change', function(e) {
            if (e.target.matches('input, select')) {
                // Visual feedback
                console.log('Criteria changed. Auto-saving dbCriteria...');
                saveCriteria(); // Calls your existing function linked to google.script.run
            }
        });
    }

    // 2. Auto-save STV Logic (stvData)
    const stvTable = document.getElementById('tbl-stv-editable');
    if (stvTable) {
        stvTable.addEventListener('change', function(e) {
            if (e.target.matches('input, select')) {
                console.log('STV Logic changed. Auto-saving stvData...');
                saveSTV(); // Calls your existing function
            }
        });
    }

    // 3. Auto-save Device Registry (deviceRegistry)
    // We use a "Debounce" timer here because the Registry has many text fields.
    // We don't want to save on every single keystroke, but 1 second after you stop typing.
    const regTable = document.getElementById('body-device-registry');
    let regSaveTimer;
    
    if (regTable) {
        regTable.addEventListener('input', function(e) { // 'input' fires on keystrokes
            if (e.target.matches('input, select')) {
                clearTimeout(regSaveTimer);
                regSaveTimer = setTimeout(() => {
                    console.log('Registry input detected. Auto-saving deviceRegistry...');
                    saveDeviceRegistry(); // Calls your existing function
                }, 30000); // Wait 1.5 seconds after typing stops
            }
        });
    }
});





function deleteRegistryRow() {
    const tbody = document.getElementById('body-device-registry');
    if (tbody && tbody.rows.length > 0) {
        // Remove the last row from the DOM
        tbody.deleteRow(-1);
        
        // Also remove from the internal data array if it exists
        if (deviceRegistry.length > 0) {
            deviceRegistry.pop();
        }
    }
}


// --- ZOOM LOGIC ---
function zoomChart(chartName, axis, factor) {
    // Identify which chart to zoom
    let chart;
    if (chartName === 'trend') chart = chartObjs.trend; // Uses your global chartObjs object
    
    if (!chart) return;

    const scales = [];
    if (axis.includes('x')) scales.push(chart.scales.x);
    if (axis.includes('y')) scales.push(chart.scales.y);

    scales.forEach(scale => {
        // If scale is auto (no min/max), set them current values to lock them
        if (scale.min === undefined) scale.options.min = scale.min;
        if (scale.max === undefined) scale.options.max = scale.max;

        const range = scale.options.max - scale.options.min;
        const newRange = range / factor;
        const center = scale.options.min + (range / 2);

        scale.options.min = center - (newRange / 2);
        scale.options.max = center + (newRange / 2);
    });

    chart.update('none'); // Update without animation for speed
}

function resetZoom(chartName) {
    let chart;
    if (chartName === 'trend') chart = chartObjs.trend;
    
    if (!chart) return;

    // Setting to null resets to auto-scaling
    if (chart.options.scales.x) { chart.options.scales.x.min = null; chart.options.scales.x.max = null; }
    if (chart.options.scales.y) { chart.options.scales.y.min = null; chart.options.scales.y.max = null; }
    
    chart.update();
}

//---------------- Device module start -------------------

// ============================================
// SERVICE REGISTRY LOGIC (Complete & Consolidated)
// ============================================

let activeHwButton = null;
let serviceConfigTree = {}; 
let serviceActionMeta = new Map();
let serviceActionsLog = []; 
let currentDeviceMeta = {}; 
let serviceCostAccepted = false;

// 1. Initialize Search
document.addEventListener('DOMContentLoaded', () => {
    const svcInput = document.getElementById('svc-device-search');
    if (svcInput) {
        svcInput.addEventListener('input', (e) => {
            const val = e.target.value.toLowerCase();
            const list = document.getElementById('svc-device-list');
            list.innerHTML = '';
            
            toggleNewTicketBtn(false);

            if (!val) { list.style.display='none'; return; }
            
            const matches = deviceRegistry.filter(d => {
                const didStr = String(d.did || '').toLowerCase();
                const clientStr = String(d.client || '').toLowerCase();
                const mobileStr = String(d.mobile || '').toLowerCase();
                const moNameStr = String(d.moName || '').toLowerCase();
                return didStr.includes(val) || clientStr.includes(val) || mobileStr.includes(val) || moNameStr.includes(val);
            }).slice(0, 8);

            if (matches.length > 0) {
                list.style.display='block';
                matches.forEach(d => {
                    const i = document.createElement('div');
                    i.className = 'autocomplete-item';
                    i.innerHTML = `<strong>${d.did}</strong> <span style='font-size:0.8em;color:#666'>(${d.client||''})</span>`;
                    i.onclick = () => selectDevice(d);
                    list.appendChild(i);
                });
            } else { list.style.display='none'; }
        });
    }
});

document.addEventListener('click', (e) => {
    if(!e.target.closest('.autocomplete-container')) { document.getElementById('svc-device-list').style.display='none'; }
    if (!e.target.closest('#hw-callout') && !e.target.closest('.hw-btn')) closeCallout();
});

// 2. Device Selection
function selectDevice(d) {
    document.getElementById('svc-device-list').style.display = 'none';
    document.getElementById('svc-device-search').value = d.did;
    currentDeviceMeta = d; 
    
    toggleNewTicketBtn(true);
    document.getElementById('service-form-container').style.display = 'flex';
    updateServiceSummary(d, null);
    clearServiceForm();
    checkDeviceStatus(d.did);
}

function checkDeviceStatus(did) {
    lockServiceForm(true); 
    google.script.run.withSuccessHandler(history => {
        const hSelect = document.getElementById('svc-history-list');
        hSelect.innerHTML = '';
        let lastTicket = null;

        if (!history || history.length === 0) {
            hSelect.innerHTML = '<option value="">No history found</option>';
        } else {
            history.forEach((h, index) => {
                const opt = document.createElement('option');
                opt.value = h.ticket;
                opt.text = `${h.date} - ${h.ticket} [${h.status}]`;
                hSelect.appendChild(opt);
                if (index === 0) lastTicket = h;
            });
        }

        renderServiceHistoryTable(history || []);
        updateServiceSummary(currentDeviceMeta, lastTicket);

        if (lastTicket && lastTicket.status === 'OPEN') {
            alert(`Found OPEN Ticket: ${lastTicket.ticket}. Loading...`);
            loadExistingTicket(lastTicket);
        } else {
            fillMetaFields(currentDeviceMeta);
            document.getElementById('svc-ticket-id').value = "";
            lockServiceForm(true); 
        }
    }).getServiceHistoryList(did);
    
    if(typeof renderServiceSoilHistory === 'function') renderServiceSoilHistory(did);
}

// 3. New Ticket Workflow
function createNewTicket() {
    if (!currentDeviceMeta.did) {
        const inputVal = document.getElementById('svc-device-search')?.value || '';
        const match = deviceRegistry.find(d => String(d.did || '').trim() === String(inputVal).trim());
        if (match) {
            currentDeviceMeta = match;
        }
    }
    if (!currentDeviceMeta.did) return alert("Please search for a device first.");
    
    lockServiceForm(false);
    fillMetaFields(currentDeviceMeta);
    
    const stateMap = { "Andhra Pradesh":"AP", "Arunachal Pradesh":"AR", "Assam":"AS", "Bihar":"BR", "Chhattisgarh":"CG", "Goa":"GA", "Gujarat":"GJ", "Haryana":"HR", "Himachal Pradesh":"HP", "Jammu and Kashmir":"JK", "Jharkhand":"JH", "Karnataka":"KA", "Kerala":"KL", "Madhya Pradesh":"MP", "Maharashtra":"MH", "Manipur":"MN", "Meghalaya":"ML", "Mizoram":"MZ", "Nagaland":"NL", "Orissa":"OR", "Punjab":"PB", "Rajasthan":"RJ", "Sikkim":"SK", "Tamil Nadu":"TN", "Tripura":"TR", "Uttarakhand":"UK", "Uttar Pradesh":"UP", "West Bengal":"WB", "Andaman and Nicobar Islands":"AN", "Chandigarh":"CH", "Dadra and Nagar Haveli":"DH", "Daman and Diu":"DD", "Delhi":"DL", "Lakshadweep":"LD", "Pondicherry":"PY" };
    let st = String(currentDeviceMeta.state || "XX").trim();
    let code = stateMap[st] || "XX";
    if(code === "XX" && st.length>=2) code = st.substring(0,2).toUpperCase();
    const didStr = String(currentDeviceMeta.did || "00000");
    const last5 = didStr.length > 5 ? didStr.slice(-5) : didStr.padStart(5, '0');
    const rand = Math.floor(1000 + Math.random() * 9000);
    
    document.getElementById('svc-ticket-id').value = `ST-${code}-${last5}-${rand}`;
    
    // Status Logic
    document.getElementById('svc-status').value = 'OPEN';
    renderStatusDisplay('OPEN');
    
    // Inputs
    document.getElementById('svc-emp-id').value = '';
    document.getElementById('svc-declaration').checked = false;
    document.getElementById('svc-feedback-file').value = '';
    
    serviceActionsLog = [];
    serviceCostAccepted = false;
    updateServiceBasket();
    
    updateMainActionButton(); 
    toggleExportButton(false);
}

// 4. Critical UI Update Logic
function updateMainActionButton() {
    // GUARD: If ticket is closed, DO NOT unfreeze
    const currentStatus = document.getElementById('svc-status').value;
    if (currentStatus === 'RESOLVED') return;

    const closeToggle = document.getElementById('svc-close-toggle');
    const wantsClose = closeToggle ? closeToggle.checked : false;
    const isChecked = document.getElementById('svc-declaration').checked;
    const empId = document.getElementById('svc-emp-id').value.trim();
    const fileInput = document.getElementById('svc-feedback-file');
    const hasFile = fileInput.files.length > 0;
    
    const btn = document.getElementById('svc-main-btn');
    if (!btn) return;
    
    // Ensure button is enabled for editing draft
    btn.disabled = false;
    btn.style.pointerEvents = 'auto';

    if (wantsClose && isChecked && empId && hasFile && serviceCostAccepted) {
        btn.innerText = "Close Ticket";
        btn.className = "btn btn-red"; 
    } else {
        btn.innerText = "Draft";
        btn.className = "btn btn-green"; 
    }
}

function toggleExportButton(enable) {
    const btn = document.getElementById('svc-btn-export');
    if (!btn) return;
    
    if (enable) {
        btn.disabled = false;
        btn.style.opacity = '1';
        btn.style.pointerEvents = 'auto';
        btn.style.borderColor = 'var(--accent)';
        btn.style.color = 'var(--accent)';
        btn.style.cursor = 'pointer';
    } else {
        btn.disabled = true;
        btn.style.opacity = '0.5';
        btn.style.pointerEvents = 'none';
        btn.style.borderColor = '#ccc';
        btn.style.color = '#999';
        btn.style.cursor = 'not-allowed';
    }
}

function submitServiceForm() {
    const btn = document.getElementById('svc-main-btn');
    const btnText = btn.innerText;
    const ticketId = document.getElementById('svc-ticket-id').value.trim();
    
    if (!ticketId) return alert("No active ticket.");

    if (btnText === "Draft") {
        // Drafts don't require file validation
        saveToBackend('OPEN', null);
    } else {
        if (!serviceCostAccepted) {
            alert("Please accept the service basket before closing the ticket.");
            return;
        }
        // --- CLOSURE VALIDATION ---
        
        // 1. Confirm Action
        if(!confirm("You are about to CLOSE this ticket. Ensure the file is correct. Continue?")) return;
        
        const fileInput = document.getElementById('svc-feedback-file');
        
        // 2. Check if file exists
        if (fileInput.files.length === 0) {
            return alert("Please upload the Customer Feedback Form.");
        }
        
        const file = fileInput.files[0];
        
        // 3. VALIDATE FILENAME MATCHES TICKET ID
        // Removes extension (e.g., ".pdf") to check just the name
        const fileNameNoExt = file.name.substring(0, file.name.lastIndexOf('.')) || file.name;
        
        if (fileNameNoExt !== ticketId) {
            alert(`Form filename must match Ticket ID.\n\nTicket ID: ${ticketId}\nFilename: ${fileNameNoExt}`);
            return; // Stop processing
        }
        
        // 4. Proceed if Valid
        const reader = new FileReader();
        
        // Disable button while processing
        btn.disabled = true;
        btn.innerText = "Processing...";
        
        reader.onload = function(e) {
            const base64 = e.target.result; 
            const filePayload = {
                data: base64,
                // Save exactly as uploaded since we verified it matches
                name: file.name 
            };
            saveToBackend('RESOLVED', filePayload);
        };
        
        reader.readAsDataURL(file);
    }
}

function saveToBackend(statusToSave, fileObj) {
    const empId = document.getElementById('svc-emp-id').value.trim();
    const costSummary = buildServiceCostSummary();
    const cutometerStatement = document.getElementById('svc-cutometer-note')?.value || '';
    
    const readableLog = serviceActionsLog.map(a => {
        const deepAction = a.subAct ? `${a.act} [${a.subAct}]` : a.act;
        return `[${a.section}] ${a.btn} > ${a.sub}: ${deepAction}`;
    }).join('; ');

    const data = {
        ticketId: document.getElementById('svc-ticket-id').value,
        deviceId: document.getElementById('svc-meta-did').value,
        owner: document.getElementById('svc-meta-owner').value,
        status: statusToSave,
        empId: empId,
        actions: serviceActionsLog,
        actionLogReadable: readableLog,
        costSummary,
        cutometerStatement
    };

    if (fileObj) {
        data.fileData = fileObj.data;
        data.fileName = fileObj.name;
    }

    const runner = google.script.run.withSuccessHandler(res => {
        // Handle Backend Errors
        if(res && res.startsWith("Error:")) {
            alert(res);
            // If server says "already CLOSED", freeze UI locally to match server state
            if(res.includes("already CLOSED")) {
                document.getElementById('svc-status').value = 'RESOLVED';
                renderStatusDisplay('RESOLVED');
                lockServiceForm(true);
                const mainBtn = document.getElementById('svc-main-btn');
                if(mainBtn) {
                    mainBtn.innerText = "Ticket Closed";
                    mainBtn.className = "btn btn-slate";
                    mainBtn.disabled = true;
                    mainBtn.style.pointerEvents = 'none';
                }
                toggleExportButton(true);
            } else {
                // Reset button from "Processing..." to previous state on other errors
                updateMainActionButton();
            }
            return;
        }

        // Success Alert
        alert(res); 
        
        // Refresh History Dropdown
        refreshServiceHistory(data.deviceId);
        
        if (statusToSave === 'RESOLVED') {
            // --- INLINE FREEZE LOGIC (Guaranteed Execution) ---
            document.getElementById('svc-status').value = 'RESOLVED';
            renderStatusDisplay('RESOLVED');
            lockServiceForm(true);
            
            const mainBtn = document.getElementById('svc-main-btn');
            if(mainBtn) {
                mainBtn.innerText = "Ticket Closed";
                mainBtn.className = "btn btn-slate";
                mainBtn.disabled = true; 
                mainBtn.style.pointerEvents = 'none';
            }
            
            toggleExportButton(true);
        } else {
            // Draft Saved: Ensure button is active again
            updateMainActionButton();
            toggleExportButton(false);
        }
    }).withFailureHandler(err => {
        alert("Error saving: " + err.message);
        // Reset button on failure
        updateMainActionButton();
    });

    if (fileObj) runner.saveServiceTicketWithFile(data);
    else runner.saveServiceHistory(data);
}

function loadExistingTicket(historyItem) {
    let data = {};
    try { data = JSON.parse(historyItem.fullData); } catch(e){ console.error(e); }
    
    fillMetaFields(currentDeviceMeta);
    document.getElementById('svc-ticket-id').value = historyItem.ticket;
    
    // Sync Hidden Input
    const status = historyItem.status || 'OPEN';
    document.getElementById('svc-status').value = status;
    renderStatusDisplay(status);
    
    serviceActionsLog = data.actions || [];
    serviceCostAccepted = !!data?.costSummary?.accepted;
    updateServiceBasket();
    const note = document.getElementById('svc-cutometer-note');
    if (note) {
        note.value = data.cutometerStatement || '';
        autoResizeSvcNote(note);
    }
    if(data.empId) document.getElementById('svc-emp-id').value = data.empId;
    
    document.getElementById('svc-declaration').checked = false;
    document.getElementById('svc-feedback-file').value = '';
    
    const isClosed = (status === 'RESOLVED');
    
    if (isClosed) {
        // Freeze
        lockServiceForm(true);
        const mainBtn = document.getElementById('svc-main-btn');
        if(mainBtn) {
            mainBtn.innerText = "Ticket Closed";
            mainBtn.className = "btn btn-slate";
            mainBtn.disabled = true;
            mainBtn.style.pointerEvents = 'none';
        }
        toggleExportButton(true);
    } else {
        // Unlock
        lockServiceForm(false);
        updateMainActionButton(); 
        toggleExportButton(false);
    }
}

// 5. Helpers
function fillMetaFields(d) {
    document.getElementById('svc-meta-did').value = d.did || '';
    document.getElementById('svc-meta-owner').value = d.client || '';
    document.getElementById('svc-meta-addr').value = d.address || '';
    document.getElementById('svc-meta-mobile').value = d.mobile || '';
    updateServiceSummary(d, null);
}

function clearServiceForm() {
    document.getElementById('svc-ticket-id').value = '';
    document.getElementById('svc-status').value = 'OPEN';
    document.getElementById('svc-meta-did').value = '';
    document.getElementById('svc-meta-owner').value = '';
    document.getElementById('svc-meta-addr').value = '';
    document.getElementById('svc-meta-mobile').value = '';
    const closeToggle = document.getElementById('svc-close-toggle');
    if (closeToggle) closeToggle.checked = false;
    toggleSvcClosureSection(closeToggle);
    const note = document.getElementById('svc-cutometer-note');
    if (note) {
        note.value = '';
        autoResizeSvcNote(note);
    }
    serviceActionsLog = [];
    serviceCostAccepted = false;
    updateServiceBasket();
}

function lockServiceForm(isLocked) {
    const container = document.getElementById('service-form-container');
    const status = document.getElementById('svc-status')?.value;
    if (status === 'RESOLVED') {
        isLocked = true;
    }
    const elements = container.querySelectorAll('input, select, textarea, .hw-btn, .btn-teal, .btn-green, .btn-red');
    
    elements.forEach(el => {
        if (el.id === 'svc-history-list' || el.innerText === 'Fetch') return;
        if (isLocked) {
            el.setAttribute('disabled', 'true');
            el.style.pointerEvents = 'none';
            el.style.opacity = '0.5';
        } else {
            el.removeAttribute('disabled');
            el.style.pointerEvents = 'auto';
            el.style.opacity = '1';
        }
    });
}

function toggleNewTicketBtn(isActive) {
    const btn = document.getElementById('btn-new-ticket');
    if (!btn) return;
    btn.style.opacity = isActive ? '1' : '0.5';
    btn.style.pointerEvents = isActive ? 'auto' : 'none';
    btn.disabled = !isActive;
    btn.setAttribute('aria-disabled', isActive ? 'false' : 'true');
}

function renderStatusDisplay(status) {
    const el = document.getElementById('svc-status-display');
    if(el) {
        el.innerText = status;
        if(status === 'OPEN') {
            el.style.color = 'var(--success)';
            el.style.borderColor = 'var(--success)';
            el.style.background = '#e8f5e9';
        } else {
            el.style.color = 'var(--danger)';
            el.style.borderColor = 'var(--danger)';
            el.style.background = '#fce4ec';
        }
    }
}

function clearServiceSearch() {
    const list = document.getElementById('svc-device-list');
    const input = document.getElementById('svc-device-search');
    if (input) input.value = '';
    if (list) list.style.display = 'none';
    toggleNewTicketBtn(false);
}

function updateServiceSummary(device, lastTicket) {
    const summary = document.getElementById('svc-summary');
    if (!summary) return;
    const didEl = document.getElementById('svc-summary-did');
    const ownerEl = document.getElementById('svc-summary-owner');
    const statusEl = document.getElementById('svc-summary-status');
    const ticketEl = document.getElementById('svc-summary-ticket');

    didEl.textContent = device?.did || '-';
    ownerEl.textContent = device?.client || '-';
    statusEl.textContent = lastTicket?.status || 'OPEN';
    ticketEl.textContent = lastTicket?.ticket || '-';
}

function autoResizeSvcNote(el) {
    if (!el) return;
    el.style.height = 'auto';
    el.style.height = `${el.scrollHeight}px`;
}

function buildServiceCostSummary() {
    const items = serviceActionsLog.map(a => ({
        section: a.section,
        btn: a.btn,
        sub: a.sub,
        act: a.act,
        subAct: a.subAct,
        unit: a.unit || '',
        cost: typeof a.cost === 'number' ? a.cost : Number(a.cost || 0)
    }));
    const total = items.reduce((sum, item) => sum + (Number(item.cost) || 0), 0);
    return { items, total, accepted: serviceCostAccepted };
}

function updateServiceBasket() {
    const tbody = document.getElementById('svc-basket-body');
    const totalEl = document.getElementById('svc-basket-total');
    const acceptBtn = document.getElementById('svc-basket-accept');
    if (!tbody || !totalEl || !acceptBtn) return;

    tbody.innerHTML = '';
    let total = 0;

    if (!serviceActionsLog.length) {
        tbody.innerHTML = '<tr><td colspan="3" style="color:#777; padding:8px;">No items selected</td></tr>';
    } else {
        serviceActionsLog.forEach(item => {
            const unit = item.unit || '-';
            const cost = Number(item.cost || 0);
            total += cost;
            const label = `${item.btn} / ${item.sub} / ${item.subAct || item.act}`;
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${label}</td><td>${unit}</td><td>₹${cost.toFixed(2)}</td>`;
            tbody.appendChild(tr);
        });
    }

    totalEl.textContent = total.toFixed(2);
    acceptBtn.disabled = !serviceActionsLog.length;
    acceptBtn.style.opacity = serviceActionsLog.length ? '1' : '0.5';
    acceptBtn.textContent = serviceCostAccepted ? 'Accepted' : 'I understand and accept';
    acceptBtn.className = serviceCostAccepted ? 'btn btn-slate' : 'btn btn-green';
}

function acceptServiceBasket() {
    if (!serviceActionsLog.length) return;
    serviceCostAccepted = true;
    updateServiceBasket();
    updateMainActionButton();
}

function renderServiceHistoryTable(history) {
    const tbody = document.getElementById('svc-history-table');
    if (!tbody) return;
    tbody.innerHTML = '';
    if (!history || history.length === 0) {
        tbody.innerHTML = '<tr><td colspan="3" style="color:#777; padding:8px;">No history found</td></tr>';
        return;
    }
    history.forEach(item => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${item.date || '-'}</td><td>${item.ticket || '-'}</td><td>${item.status || '-'}</td>`;
        tr.addEventListener('click', () => loadExistingTicket(item));
        tbody.appendChild(tr);
    });
}

function toggleSvcClosureSection(toggle) {
    const body = document.getElementById('svc-closure-body');
    if (!body) return;
    const isOn = !!toggle?.checked;
    body.classList.toggle('active', isOn);
    updateMainActionButton();
}

function refreshServiceHistory(did) {
    google.script.run.withSuccessHandler(history => {
        const hSelect = document.getElementById('svc-history-list');
        hSelect.innerHTML = '';
        if(!history || history.length === 0) hSelect.innerHTML = '<option value="">No history found</option>';
        else history.forEach(h => {
             const opt = document.createElement('option');
             opt.value = h.ticket;
             opt.text = `${h.date} - ${h.ticket} [${h.status}]`;
             hSelect.appendChild(opt);
        });
        renderServiceHistoryTable(history || []);
    }).getServiceHistoryList(did);
}

// ============================================
// 4-LEVEL MENU LOGIC (Fixed & Robust)
// ============================================

// 1. Process Config into Tree (Splits BOTH Actions and Sub-Actions)
function processServiceConfig(flatList) {
    serviceConfigTree = {};
    serviceActionMeta = new Map();
    
    flatList.forEach(row => {
        const btnName = row.btn || row.name || row.Button_Name;
        const subName = row.sub || row.Sub_Component || 'General';
        const unitVal = row.unit || row.Unit || row.units || row.Units || '';
        const costVal = row.cost || row.Cost || row['Cost (INR/unit)'] || row['Cost_INR'] || '';
        const sectionRaw = row.section || row.Section || row.SECTION || row['Section'] || row['SECTION'] || '';
        const sectionName = String(sectionRaw || '').trim() || 'Hardware';
        
        // FIX: Split Actions by comma (handles "Clean, Replace" in one cell)
        const actStr = row.act || row.Actions || "General";
        const actionList = actStr.split(',').map(s => s.trim()).filter(s => s);

        // Split Sub-Actions by comma
        const subActStr = row.subActions || row.Sub_Actions || "";
        const subActList = subActStr.split(',').map(s => s.trim()).filter(s => s);

        if (!btnName) return;

        // Initialize Tree Levels
        if (!serviceConfigTree[btnName]) {
            serviceConfigTree[btnName] = { 
                section: sectionName, 
                subs: {} 
            };
        } else if (sectionName !== 'Hardware' && serviceConfigTree[btnName].section === 'Hardware') {
            serviceConfigTree[btnName].section = sectionName;
        } else if (sectionName !== serviceConfigTree[btnName].section) {
            console.warn('Service config section mismatch for button', { btnName, existing: serviceConfigTree[btnName].section, incoming: sectionName });
        }
        
        if (!serviceConfigTree[btnName].subs[subName]) {
            serviceConfigTree[btnName].subs[subName] = {}; 
        }

        // Assign Sub-Actions to EACH Action in the list
        actionList.forEach(actName => {
            const metaKey = `${btnName}|||${subName}|||${actName}|||`;
            serviceActionMeta.set(metaKey, { unit: unitVal, cost: costVal });
            // Initialize array for this specific action if missing
            if (!serviceConfigTree[btnName].subs[subName][actName]) {
                 serviceConfigTree[btnName].subs[subName][actName] = [];
            }
            
            // If this row has sub-actions, add them to this action's list
            if (subActList.length > 0) {
                subActList.forEach(subActName => {
                    const subKey = `${btnName}|||${subName}|||${actName}|||${subActName}`;
                    serviceActionMeta.set(subKey, { unit: unitVal, cost: costVal });
                });
                serviceConfigTree[btnName].subs[subName][actName].push(...subActList);
            }
        });
    });
    
    renderServiceButtons();
}

function renderServiceButtons() {
    document.querySelectorAll('.hw-grid').forEach(el => el.innerHTML = '');
    updateServiceBasket();
    Object.keys(serviceConfigTree).forEach(btnName => {
        const btnData = serviceConfigTree[btnName];
        // Create grid ID from section name (e.g. "Hardware" -> "svc-grid-Hardware")
        const secId = 'svc-grid-' + (btnData.section || 'Hardware').replace(/\s+/g, '_');
        const grid = document.getElementById(secId);
        
        if (grid) {
            const btn = document.createElement('button');
            btn.className = 'hw-btn';
            btn.textContent = btnName;
            btn.onclick = (e) => toggleHwBtn(e, btn, btnName);
            grid.appendChild(btn);
        }
    });
}

function toggleHwBtn(e, btn, btnName) {
    e.stopPropagation();
    
    // Close if clicking the same active button
    if (activeHwButton === btn) { 
        closeCallout(); 
        return; 
    }
    
    // Switch active state
    if (activeHwButton) activeHwButton.classList.remove('active');
    btn.classList.add('active');
    activeHwButton = btn;
    
    // Render and Position Menu
    renderMenuRoot(btnName);
    const menu = document.getElementById('hw-callout');
    
    // Position Logic (prevent overflow)
    const rect = btn.getBoundingClientRect();
    let top = rect.top; 
    let left = rect.right + 5;
    
    if (left + 200 > window.innerWidth) left = rect.left - 205; 
    if (top + 200 > window.innerHeight) top = window.innerHeight - 200;
    
    menu.style.top = top + 'px'; 
    menu.style.left = left + 'px';
    menu.style.display = 'flex'; // Changed to flex for the column layout
}

// LEVEL 1: Sub-Components
function renderMenuRoot(btnName) {
    const menu = document.getElementById('hw-callout');
    const head = menu.querySelector('.callout-header');
    const body = menu.querySelector('.callout-body');
    
    // Hide Header at root level
    head.style.display = 'none';
    body.innerHTML = '';
    
    const subs = serviceConfigTree[btnName].subs;
    
    Object.keys(subs).forEach(subName => {
        const r = document.createElement('div');
        r.className = 'callout-sub-item'; // CSS should add arrow >
        r.innerText = subName;
        r.onclick = (e) => { 
            e.stopPropagation(); 
            renderMenuActions(btnName, subName); 
        };
        body.appendChild(r);
    });
}

// LEVEL 2: Actions
function renderMenuActions(btnName, subName) {
    const menu = document.getElementById('hw-callout');
    const head = menu.querySelector('.callout-header');
    const body = menu.querySelector('.callout-body');
    
    // Show Header with Back button
    head.style.display = 'flex';
    head.innerHTML = `
        <div class="ctx-back-header" onclick="renderMenuRoot('${btnName}')" style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <span>‹</span> <span>${subName}</span>
        </div>
        <span style="cursor:pointer;" onclick="closeCallout()">×</span>
    `;
    
    body.innerHTML = '';
    const actionsObj = serviceConfigTree[btnName].subs[subName];
    const actionKeys = Object.keys(actionsObj);

    if (actionKeys.length === 0) {
        body.innerHTML = '<div style="padding:8px; color:#999;">No actions</div>';
        return;
    }

    actionKeys.forEach(actName => {
        const subActions = actionsObj[actName];
        
        // LOGIC: If sub-actions exist, render as Branch (Arrow). If not, render as Leaf (Selectable).
        if (subActions && subActions.length > 0) {
            const div = document.createElement('div');
            div.className = 'callout-sub-item'; 
            div.innerText = actName;
            div.onclick = (e) => {
                e.stopPropagation();
                renderMenuSubActions(btnName, subName, actName);
            };
            body.appendChild(div);
        } else {
            // Leaf node at Level 2
            const btn = createLeafButton(btnName, subName, actName, null);
            body.appendChild(btn);
        }
    });
}

// LEVEL 3: Sub-Actions
function renderMenuSubActions(btnName, subName, actName) {
    const menu = document.getElementById('hw-callout');
    const head = menu.querySelector('.callout-header');
    const body = menu.querySelector('.callout-body');
    
    // Header backs up to Actions
    head.innerHTML = `
        <div class="ctx-back-header" onclick="renderMenuActions('${btnName}', '${subName}')" style="cursor:pointer; display:flex; align-items:center; gap:5px;">
            <span>‹</span> <span>${actName}</span>
        </div>
        <span style="cursor:pointer;" onclick="closeCallout()">×</span>
    `;
    
    body.innerHTML = '';
    const subActionList = serviceConfigTree[btnName].subs[subName][actName];

    subActionList.forEach(subActName => {
        const btn = createLeafButton(btnName, subName, actName, subActName);
        body.appendChild(btn);
    });
}

// Helper: Creates the final selectable button (Leaf)
function createLeafButton(btnName, subName, actName, subActName) {
    const btn = document.createElement('button');
    btn.className = 'callout-action';
    
    const displayLabel = subActName || actName;
    
    // Check selection state
    const isSelected = serviceActionsLog.some(a => 
        a.btn === btnName && 
        a.sub === subName && 
        a.act === actName && 
        a.subAct === (subActName || null)
    );
    
    btn.innerHTML = isSelected ? `✓ ${displayLabel}` : displayLabel;
    
    if(isSelected) {
        btn.style.background = '#e3f2fd';
        btn.style.color = 'var(--accent)';
    }

    btn.onclick = (e) => {
        e.stopPropagation();
        selectHwAction(btnName, subName, actName, subActName, btn);
    };
    
    return btn;
}

// Logic: Toggle Selection
function selectHwAction(btn, sub, act, subAct, element) {
    const displayLabel = subAct || act;
    const metaKey = `${btn}|||${sub}|||${act}|||${subAct || ''}`;
    const meta = serviceActionMeta.get(metaKey) || { unit: '', cost: 0 };
    
    const idx = serviceActionsLog.findIndex(a => 
        a.btn === btn && 
        a.sub === sub && 
        a.act === act && 
        a.subAct === (subAct || null)
    );

    if (idx > -1) {
        // Unselect
        serviceActionsLog.splice(idx, 1);
        element.style.background = 'none';
        element.style.color = 'black';
        element.innerHTML = displayLabel; 
    } else {
        // Select
        serviceActionsLog.push({ 
            section: serviceConfigTree[btn].section, 
            btn: btn, 
            sub: sub, 
            act: act,
            subAct: subAct || null,
            unit: meta.unit || '',
            cost: Number(meta.cost || 0)
        });
        element.style.background = '#e3f2fd';
        element.style.color = 'var(--accent)';
        element.innerHTML = `✓ ${displayLabel}`;
    }

    serviceCostAccepted = false;
    updateServiceBasket();
    
    // Light up the main hardware button to show activity
    if(activeHwButton) {
        activeHwButton.style.borderColor = 'var(--success)';
    }
    
    // Note: We do NOT close the callout here, allowing multi-select. 
    // User closes by clicking X or outside.
}

function closeCallout() {
    document.getElementById('hw-callout').style.display='none';
    if(activeHwButton) activeHwButton.classList.remove('active');
    activeHwButton = null;
}
// 8. PDF Functions
function exportServiceFormPDF() {
    const cutometerStatement = document.getElementById('svc-cutometer-note')?.value || '';
    const data = {
        ticketId: document.getElementById('svc-ticket-id').value + " (DRAFT)",
        deviceId: document.getElementById('svc-meta-did').value,
        owner: document.getElementById('svc-meta-owner').value,
        status: "DRAFT EXPORT",
        date: new Date().toDateString(),
        actions: serviceActionsLog,
        costSummary: buildServiceCostSummary(),
        cutometerStatement
    };
    google.script.run.withSuccessHandler(downloadPDF).generateServicePdf(data);
}

function fetchServiceHistoryPDF() {
    const tid = document.getElementById('svc-history-list').value;
    if(!tid) return alert("Select a ticket first.");
    google.script.run.withSuccessHandler(downloadPDF).generateServicePdf(tid);
}

function downloadPDF(res) {
    const str = atob(res.base64);
    const bytes = new Uint8Array(str.length);
    for(let i=0; i<str.length; i++) bytes[i] = str.charCodeAt(i);
    const blob = new Blob([bytes], {type: 'application/pdf'});
    const link = document.createElement('a');
    link.href = window.URL.createObjectURL(blob);
    link.download = res.filename;
    link.click();
}


function toggleExportButton(enable) {
    const btn = document.getElementById('svc-btn-export');
    if (!btn) return;
    
    if (enable) {
        btn.disabled = false;
        btn.style.opacity = '1';
        btn.style.pointerEvents = 'auto';
        btn.style.borderColor = 'var(--accent)';
        btn.style.color = 'var(--accent)';
        btn.style.cursor = 'pointer';
    } else {
        btn.disabled = true;
        btn.style.opacity = '0.5';
        btn.style.pointerEvents = 'none';
        btn.style.borderColor = '#ccc';
        btn.style.color = '#999';
        btn.style.cursor = 'not-allowed';
    }
}
//---------------- Device module end -------------------

//---------------- Nutrient Management module start -------------------

// --- Nutrient Manager state (minimal stubs + indices) ---
let nmCurrentClientId = 'Default';
let nmDeviceIndex = []; // {did, tests: [tid1, tid2,...]}
let nmTestIndex = [];   // {tid, deviceIds: [did1,did2,...]}

function buildNutrientManagerIndices() {
  const devMap = new Map();
  const testMap = new Map();

  if (!Array.isArray(rgbData)) return;

  rgbData.forEach(function (row) {
    const did = row && row.did ? String(row.did).trim() : '';
    const tid = row && row.tid ? String(row.tid).trim() : '';
    if (!did || !tid) return;

    if (!devMap.has(did)) devMap.set(did, new Set());
    devMap.get(did).add(tid);

    if (!testMap.has(tid)) testMap.set(tid, new Set());
    testMap.get(tid).add(did);
  });

  nmDeviceIndex = Array.from(devMap.entries()).map(function (e) {
    return { did: e[0], tests: Array.from(e[1]).sort() };
  }).sort(function (a, b) {
    return a.did.localeCompare(b.did);
  });

  nmTestIndex = Array.from(testMap.entries()).map(function (e) {
    return { tid: e[0], deviceIds: Array.from(e[1]).sort() };
  }).sort(function (a, b) {
    return a.tid.localeCompare(b.tid);
  });
}

function nmFilterAndRenderDeviceList(filter, allowedDevices) {
  const listEl = document.getElementById('nm-device-list');
  if (!listEl) return;

  listEl.innerHTML = '';
  if (!nmDeviceIndex || nmDeviceIndex.length === 0) {
    listEl.style.display = 'none';
    return;
  }

  const f = (filter || '').toLowerCase();

  nmDeviceIndex.forEach(function (item) {
    // item.did is the Device ID
    if (allowedDevices && !allowedDevices.has(item.did)) return;
    if (f && !item.did.toLowerCase().includes(f)) return;

    const div = document.createElement('div');
    div.className = 'autocomplete-item';
    div.textContent = item.did;

    div.onclick = function () {
      const devInput = document.getElementById('nm-device-id');
      if (devInput) devInput.value = item.did;
      listEl.style.display = 'none';
      // no hint/style logic here to avoid null.style errors
    };

    listEl.appendChild(div);
  });

  listEl.style.display = listEl.children.length ? 'block' : 'none';
}


function nmFilterAndRenderTestList(filter, allowedTests) {
  const listEl = document.getElementById('nm-test-list');
  if (!listEl) return;

  listEl.innerHTML = '';
  if (!nmTestIndex || nmTestIndex.length === 0) {
    listEl.style.display = 'none';
    return;
  }

  const f = (filter || '').toLowerCase();

  nmTestIndex.forEach(function (item) {
    // item.tid is the Test ID
    if (allowedTests && !allowedTests.has(item.tid)) return;
    if (f && !item.tid.toLowerCase().includes(f)) return;

    const div = document.createElement('div');
    div.className = 'autocomplete-item';
    div.textContent = item.tid;

    div.onclick = function () {
  const testInput = document.getElementById('nm-test-id');
  if (testInput) testInput.value = item.tid;
  listEl.style.display = 'none';
  nmLoadPlanForCurrentSelection();
};

    listEl.appendChild(div);
  });

  listEl.style.display = listEl.children.length ? 'block' : 'none';
}





function nmOnTestChosen(testId) {
  var input = document.getElementById('nm-test-id');
  if (input) input.value = testId;
  var list = document.getElementById('nm-test-list');
  if (list) list.style.display = 'none';

  nmLoadPlanForCurrentSelection();
}


function nmShowDeviceList() {
  const devInput = document.getElementById('nm-device-id');
  nmFilterAndRenderDeviceList(devInput.value, null);
}

function nmShowTestList() {
  const testInput = document.getElementById('nm-test-id');
  const devVal = document.getElementById('nm-device-id').value.trim();

  let allowedTests = null;
  if (devVal) {
    const devItem = nmDeviceIndex.find(function (d) { return d.did === devVal; });
    if (devItem) {
      allowedTests = new Set(devItem.tests);
    }
  }
  nmFilterAndRenderTestList(testInput.value, allowedTests);
}

function nmOnDeviceInput() {
  const devInput = document.getElementById('nm-device-id');
  const listEl = document.getElementById('nm-device-list');
  if (!devInput || !listEl) return;   // guard against null

  const filter = devInput.value || '';
  let allowedDevices = null;

  // If a Test is already selected, optionally restrict devices to that Test
  const testInput = document.getElementById('nm-test-id');
  const testVal = testInput ? testInput.value.trim() : '';
  if (testVal && nmTestIndex && nmTestIndex.length) {
    const testItem = nmTestIndex.find(function (t) { return t.tid === testVal; });
    if (testItem && testItem.deviceIds) {
      allowedDevices = new Set(testItem.deviceIds);
    }
  }

  nmFilterAndRenderDeviceList(filter, allowedDevices);
}


function nmOnTestInput() {
  const testInput = document.getElementById('nm-test-id');
  const listEl = document.getElementById('nm-test-list');
  if (!testInput || !listEl) return;

  const devInput = document.getElementById('nm-device-id');
  const devVal = devInput ? devInput.value.trim() : '';

  let allowedTests = null;
  if (devVal) {
    const devItem = nmDeviceIndex
      ? nmDeviceIndex.find(function (d) { return d.did === devVal; })
      : null;
    if (devItem) {
      allowedTests = new Set(devItem.tests);
    }
  }

  nmFilterAndRenderTestList(testInput.value, allowedTests);
}



function nmRecalculate() {
  const y = parseFloat(document.getElementById('nm-target-yield').value);
  const modeEl = document.getElementById('nm-mode-label');
  if (y && !isNaN(y) && y > 0) {
    modeEl.textContent = 'Yield-based recommendation';
  } else {
    modeEl.textContent = 'Standard (no yield)';
  }
}


function fmtSoilVal(v, nutrient) {
  if (v === null || v === '' || v === undefined) return '';
  var num = Number(v);
  if (isNaN(num)) return v; // keep non-numeric as-is

  // Optional: per-parameter precision
  // if (nutrient === 'pH') return num.toFixed(1);

  return num.toFixed(2); // default: 2 decimal places
}

function recalculateNutrientPlan() {
  const clientSel = document.getElementById('nm-client');
  const schemeSel = document.getElementById('nm-rating-scheme');
  const testSel   = document.getElementById('nm-test-id');
  const deviceInp = document.getElementById('nm-device-id');
  const methodSel = document.getElementById('nm-method');
  const cropSel   = document.getElementById('nm-crop');
  const yieldInp  = document.getElementById('nm-target-yield');

  const clientId       = clientSel ? clientSel.value : 'Default';
  const ratingSchemeId = schemeSel ? schemeSel.value : '';
  const testId         = testSel ? testSel.value : '';
  const deviceId       = deviceInp ? deviceInp.value.trim() : '';
  const methodId       = methodSel ? methodSel.value : 'GEN';
  const cropId         = cropSel ? cropSel.value : '';
  const targetYield    = yieldInp ? (parseFloat(yieldInp.value) || 0) : 0;

  if (!deviceId || !testId || !ratingSchemeId) {
    alert('Please select Device, Soil Test ID and Rating Scheme.');
    return;
  }

  const sumBody = document.getElementById('nm-fertility-body');
  const nutrientBody = document.getElementById('body-nm-nutrient-schedule');
  const fertilizerBody = document.getElementById('body-nm-fertilizer-schedule');

  if (sumBody) {
    sumBody.innerHTML =
      '<tr><td colspan="5" style="text-align:center;">Loading nutrient summary...</td></tr>';
  }
  if (nutrientBody) {
    nutrientBody.innerHTML =
      '<tr><td colspan="3" style="text-align:center;">Loading nutrient schedule...</td></tr>';
  }
  if (fertilizerBody) {
    fertilizerBody.innerHTML =
      '<tr><td colspan="9" style="text-align:center;">Loading fertilizer schedule...</td></tr>';
  }
  const totalCostEl = document.getElementById('nm-total-cost');
  if (totalCostEl) totalCostEl.textContent = '…';

  google.script.run
    .withSuccessHandler(function (res) {

      // --- Nutrient summary table ---
      if (sumBody) {
        sumBody.innerHTML = '';
        (res.summary || []).forEach(function (s) {
          const tr = document.createElement('tr');

          const tdNutrient = document.createElement('td');
          tdNutrient.textContent = s.nutrient || '';
          tr.appendChild(tdNutrient);

          const tdSoil = document.createElement('td');
          tdSoil.textContent = fmtSoilVal(s.soilValue, s.nutrient);
          tr.appendChild(tdSoil);

          const tdUnit = document.createElement('td');
          tdUnit.textContent = s.unit || '-';
          tr.appendChild(tdUnit);

          const tdClass = document.createElement('td');
          tdClass.textContent = s.className || '-';
          tr.appendChild(tdClass);

          const tdRequirement = document.createElement('td');
          tdRequirement.textContent = s.requirementKgHa || s.requirement || s.recommendedKgHa || s.notes || '';
          tr.appendChild(tdRequirement);

          sumBody.appendChild(tr);
        });

        if (!res.summary || res.summary.length === 0) {
          sumBody.innerHTML =
            '<tr><td colspan="5" style="text-align:center;">No nutrient data found for this Test ID.</td></tr>';
        }
      }

      // --- Cache totals + stages for PDF export (from res.stages.dose) ---
      var stagesRaw = res.stages || [];

      // Keep a raw copy so fertilizer builder can access productQty, costPerHa, details
      window.nmCurrentStagesRaw = stagesRaw;

      // Compute total N, P, K from stagesRaw.dose by nutrient
      var totalN = 0, totalP = 0, totalK = 0;
      stagesRaw.forEach(function (s) {
        var nut = (s.nutrient || '').toUpperCase();
        var d   = Number(s.dose || 0);
        if (nut === 'N') totalN += d;
        if (nut === 'P₂O₅' || nut === 'P2O5' || nut === 'P') totalP += d;
        if (nut === 'K₂O' || nut === 'K2O' || nut === 'K') totalK += d;
      });

      window.nmCurrentNRate = totalN;
      window.nmCurrentPRate = totalP;
      window.nmCurrentKRate = totalK;

      // Remap stages into rows the PDF expects (per-stage N/P/K etc.)
      window.nmCurrentStages = stagesRaw.map(function (s) {
        var nut = s.nutrient || '';
        var d   = Number(s.dose || 0);
        return {
          stage: s.stage || '-',
          growthPeriod: s.growthPeriod || s.stageLabel || '',
          nRate: (nut === 'N') ? d : 0,
          pRate: (nut === 'P₂O₅' || nut === 'P2O5' || nut === 'P') ? d : 0,
          kRate: (nut === 'K₂O' || nut === 'K2O' || nut === 'K') ? d : 0,
          window: s.window || s.timing || '',
          product: s.product || s.source || '',
          remarks: s.remarks || s.notes || ''
        };
      });

      console.log(
        'NM cache for PDF',
        window.nmCurrentNRate,
        window.nmCurrentPRate,
        window.nmCurrentKRate,
        window.nmCurrentStages
      );

      // --- Stage-wise nutrient plan UI (still uses original stages) ---
      renderFertStages(res.stages || []);
      nmUpdateSoilReportPreview(res.summary || []);
    })
    .withFailureHandler(function (err) {
      if (sumBody) {
        sumBody.innerHTML =
          '<tr><td colspan="5" style="text-align:center;">Error loading nutrient summary.</td></tr>';
      }
      if (nutrientBody) {
        nutrientBody.innerHTML =
          '<tr><td colspan="3" style="text-align:center;">Error loading nutrient schedule.</td></tr>';
      }
      if (fertilizerBody) {
        fertilizerBody.innerHTML =
          '<tr><td colspan="9" style="text-align:center;">Error loading fertilizer schedule.</td></tr>';
      }
      alert('Failed to calculate nutrient plan: ' + err.message);
    })
    .getNutrientPlanForTest(testId, deviceId, clientId, ratingSchemeId, methodId, cropId, targetYield);
}





function exportNutrientPDF() {
  const cropSel = document.getElementById('nm-crop');
  const methodSel = document.getElementById('nm-method');
  const tyInp = document.getElementById('nm-target-yield');

  if (!cropSel.value || !methodSel.value) {
    alert('Select crop and method first.');
    return;
  }

  const cropId = cropSel.value;
  const method = methodSel.value;
  const targetYield = tyInp.value || null;

  // Gather your calculated N, P, K rates
  const nRate = document.getElementById('nm-n-rate') ? document.getElementById('nm-n-rate').value : null;
  const pRate = document.getElementById('nm-p-rate') ? document.getElementById('nm-p-rate').value : null;
  const kRate = document.getElementById('nm-k-rate') ? document.getElementById('nm-k-rate').value : null;

  google.script.run
    .withSuccessHandler(res => {
      if (res.success) {
        alert('PDF generated: ' + res.pdfName);
        // Optionally open the PDF
        // window.open(res.downloadUrl);
      } else {
        alert(res.msg);
      }
    })
    .withFailureHandler(err => alert('Error: ' + err.message))
    .generateNutrientPlanPDF('Default', cropId, method, targetYield, nRate, pRate, kRate, {
      pH: 6.8,
      EC: 0.45,
      OM: 2.1,
      N: 180,
      P: 25,
      K: 180
    });
}


function nmViewConfig() {
  alert('Config summary view will be implemented later.');
}

function nmExportPlan() {
  // Make sure a plan exists
  if (!window.nmCurrentStages || !Array.isArray(window.nmCurrentStages) || window.nmCurrentStages.length === 0) {
    alert('Please calculate a nutrient plan before exporting.');
    return;
  }

  // Basic inputs from UI
  var deviceId = document.getElementById('nm-device-id').value.trim();
  var testId   = document.getElementById('nm-test-id').value.trim();
  var cropSel  = document.getElementById('nm-crop');
  var cropId   = cropSel.value;
  var cropName = cropSel.options[cropSel.selectedIndex]
    ? cropSel.options[cropSel.selectedIndex].text
    : '';

  if (!deviceId || !testId) {
    alert('Please enter both Device ID and Test ID before exporting the plan.');
    return;
  }
  if (!cropId || cropId === 'Select crop...') {
    alert('Please select a crop before exporting the plan.');
    return;
  }

  // These should be set when you recalculate the plan
  var clientId    = window.nmCurrentClientId         || 'Default';
  var clientName  = window.nmCurrentClientName       || '';
  var schemeId    = window.nmCurrentRatingSchemeId   || '';
  var schemeName  = window.nmCurrentRatingSchemeName || '';
  var methodId    = window.nmCurrentMethodId         || '';
  var methodName  = window.nmCurrentMethodName       || '';
  var targetYield = window.nmCurrentTargetYield      || 0;

  // Stage-wise nutrient plan from UI cache
  var stagesRaw = window.nmCurrentStages || []; // [{stage, nRate, pRate, kRate, ...}]

  // --- Recompute N, P, K totals from stagesRaw for Page 1 ---
  var totalN = 0, totalP = 0, totalK = 0;
  stagesRaw.forEach(function (row) {
    totalN += Number(row.nRate || 0);
    totalP += Number(row.pRate || 0);
    totalK += Number(row.kRate || 0);
  });

  var nRate = totalN;
  var pRate = totalP;
  var kRate = totalK;

  // --- Map UI stages to PDF-ready stages (nutrient rows) ---
  var pdfStages = [];

  stagesRaw.forEach(function (row) {
    if (!row || !row.stage) return;

    if (row.nRate && Number(row.nRate) > 0) {
      pdfStages.push({
        stage: row.stage,
        nutrient: 'N',
        dose: Number(row.nRate),
        details: ''
      });
    }
    if (row.pRate && Number(row.pRate) > 0) {
      pdfStages.push({
        stage: row.stage,
        nutrient: 'P₂O₅',
        dose: Number(row.pRate),
        details: ''
      });
    }
    if (row.kRate && Number(row.kRate) > 0) {
      pdfStages.push({
        stage: row.stage,
        nutrient: 'K₂O',
        dose: Number(row.kRate),
        details: ''
      });
    }
  });

  // --- Build fertilizer materials & costs from raw stages ---
  nmBuildFertRowsForPdf();

  // Expected shapes after builder:
  // nmCurrentFertMaterials: [{stage, materialName, qtyPerHa, nutrientContent}, ...]
  // nmCurrentFertCosts    : [{materialName, qtyPerHa, unitPrice, totalCost}, ...]
  var fertilizerMaterials = Array.isArray(window.nmCurrentFertMaterials)
    ? window.nmCurrentFertMaterials
    : [];

  var fertilizerCosts = Array.isArray(window.nmCurrentFertCosts)
    ? window.nmCurrentFertCosts
    : [];

  var cfg = {
    clientId:           clientId,
    clientName:         clientName,
    ratingSchemeId:     schemeId,
    ratingSchemeName:   schemeName,
    testId:             testId,
    deviceId:           deviceId,
    cropId:             cropId,
    cropName:           cropName,
    methodId:           methodId,
    methodName:         methodName,
    targetYield:        targetYield,
    nRate:              nRate,
    pRate:              pRate,
    kRate:              kRate,
    stages:             pdfStages,
    fertilizerMaterials: fertilizerMaterials,
    fertilizerCosts:     fertilizerCosts
  };

  console.log('nmExportPlan cfg about to send:', cfg);

  var btn = document.querySelector('#mod-fertilizer .btn.btn-slate[onclick="nmExportPlan()"]');
  if (btn) {
    btn.disabled = true;
    btn.innerText = 'Exporting...';
  }

  google.script.run
    .withSuccessHandler(function (res) {
      if (btn) {
        btn.disabled = false;
        btn.innerText = 'Export Plan PDF';
      }

      if (!res || !res.success) {
        alert(res && res.msg ? res.msg : 'Failed to generate PDF.');
        return;
      }

      if (res.pdfBase64) {
        downloadPDFFromBase64(res.pdfBase64, res.fileName);
      } else {
        alert('PDF created but no data returned from server.');
      }
    })
    .withFailureHandler(function (err) {
      if (btn) {
        btn.disabled = false;
        btn.innerText = 'Export Plan PDF';
      }
      alert('Error generating PDF: ' + (err && err.message ? err.message : err));
    })
    .generateNutrientPlanPDFForUI(cfg);
}




function initNutrientManagerConfig(clientId) {
  if (typeof google === 'undefined' || !google.script) {
    console.warn('Nutrient Manager: google.script not available (local mode).');
    return;
  }

  google.script.run
    .withSuccessHandler(function (res) {
      try {
        if (!res) return;

        nmCurrentClientId = res.clientId || clientId || 'Default';

        // Client dropdown
        var clientSel = document.getElementById('nm-client');
        if (clientSel) {
          clientSel.innerHTML = '';
          var opt = document.createElement('option');
          opt.value = nmCurrentClientId;
          opt.textContent = nmCurrentClientId;
          clientSel.appendChild(opt);
          clientSel.value = nmCurrentClientId;
        }

        // Rating schemes
        var rsSel = document.getElementById('nm-rating-scheme');
        if (rsSel) {
          rsSel.innerHTML = '';
          var placeholder = document.createElement('option');
          placeholder.value = '';
          placeholder.textContent = 'Rating scheme...';
          rsSel.appendChild(placeholder);

          (res.ratingSchemes || []).forEach(function (rs) {
            var o = document.createElement('option');
            o.value = rs.id;
            o.textContent = rs.label;
            rsSel.appendChild(o);
          });

          if ((res.ratingSchemes || []).length === 1) {
            rsSel.value = res.ratingSchemes[0].id;
            var schemeLabel = document.getElementById('nm-scheme-label');
            if (schemeLabel) schemeLabel.textContent = res.ratingSchemes[0].id;
          }
        }

        // Crops
        var cropSel = document.getElementById('nm-crop');
        if (cropSel) {
          cropSel.innerHTML = '';
          var cPlaceholder = document.createElement('option');
          cPlaceholder.value = '';
          cPlaceholder.textContent = 'Select crop...';
          cropSel.appendChild(cPlaceholder);

          (res.crops || []).forEach(function (c) {
            var o = document.createElement('option');
            o.value = c.cropId;
            o.textContent = c.name || c.cropId;
            o.setAttribute('data-yield-unit', c.yieldUnit || 't/ha');
            cropSel.appendChild(o);
          });

          cropSel.onchange = function () {
            var sel = cropSel.options[cropSel.selectedIndex];
            if (!sel) return;
            var yu = sel.getAttribute('data-yield-unit') || 't/ha';
            var yuEl = document.getElementById('nm-yield-unit');
            if (yuEl) yuEl.textContent = yu;
            // Target yield now controlled by method (RDF / STCR), not crop
            nmRecalculate();
          };
        }
      } catch (e) {
        console.error('initNutrientManagerConfig error:', e);
      }
    })
    .withFailureHandler(function (err) {
      console.error('Failed to load Nutrient Manager config:', err);
    })
    .getNutrientManagerConfig(clientId);
}

function nmBindMethodBehaviour() {
  var methodSel = document.getElementById('nm-method');
  var tyField   = document.getElementById('nm-target-yield');

  if (!methodSel || !tyField) return;

  function updateTYState() {
    var m = methodSel.value;
    if (m === 'RDF') {
      // RDF: fixed by recommendation → user should NOT edit
      tyField.value = '';
      tyField.disabled = true;
      tyField.placeholder = 'Not used for RDF';
    } else if (m === 'STCR') {
      // STCR: requires target yield
      tyField.disabled = false;
      tyField.placeholder = 'Enter target yield';
    } else {
      // Default / other methods
      tyField.disabled = false;
      tyField.placeholder = '';
    }
  }

  methodSel.onchange = updateTYState;
  updateTYState(); // run once on load
}

function nmToggleScheduleView(showFertilizer) {
  const nutrientPanel = document.getElementById('nm-schedule-nutrient');
  const fertilizerPanel = document.getElementById('nm-schedule-fertilizer');
  if (!nutrientPanel || !fertilizerPanel) return;
  if (showFertilizer) {
    nutrientPanel.style.display = 'none';
    fertilizerPanel.style.display = 'block';
  } else {
    nutrientPanel.style.display = 'block';
    fertilizerPanel.style.display = 'none';
  }
}

function nmUpdateSoilReportPreview(summaryRows) {
  const reportIdEl = document.getElementById('metaReportId');
  const reportDtEl = document.getElementById('metaReportDt');
  const reportNameEl = document.getElementById('metaName');
  const testId = document.getElementById('nm-test-id')?.value || '—';
  const deviceId = document.getElementById('nm-device-id')?.value || '';
  const clientName = document.getElementById('nm-client')?.value || '—';

  if (reportIdEl) reportIdEl.textContent = testId || '—';
  if (reportDtEl) reportDtEl.textContent = new Date().toLocaleString();
  if (reportNameEl) reportNameEl.textContent = deviceId || clientName || '—';

  const normalized = new Map();
  (summaryRows || []).forEach((row) => {
    const key = String(row.nutrient || '').toUpperCase().replace(/\s+/g, '');
    normalized.set(key, row);
  });

  const mapKey = (key) => normalized.get(key);

  const row = {
    reportId: testId,
    reportDt: new Date().toLocaleString(),
    farmerName: deviceId || clientName || '—',
    pH: mapKey('PH')?.soilValue,
    pH_Rating: mapKey('PH')?.className,
    EC: mapKey('EC')?.soilValue,
    EC_Rating: mapKey('EC')?.className,
    OC: mapKey('OC')?.soilValue || mapKey('ORGANICCARBON')?.soilValue,
    OC_Rating: mapKey('OC')?.className || mapKey('ORGANICCARBON')?.className,
    N: mapKey('N')?.soilValue,
    N_Rating: mapKey('N')?.className,
    P: mapKey('P')?.soilValue,
    P_Rating: mapKey('P')?.className,
    K: mapKey('K')?.soilValue,
    K_Rating: mapKey('K')?.className,
    S: mapKey('S')?.soilValue,
    S_Rating: mapKey('S')?.className,
    Cu: mapKey('CU')?.soilValue,
    Cu_Rating: mapKey('CU')?.className,
    Fe: mapKey('FE')?.soilValue,
    Fe_Rating: mapKey('FE')?.className,
    Zn: mapKey('ZN')?.soilValue,
    Zn_Rating: mapKey('ZN')?.className,
    Mn: mapKey('MN')?.soilValue,
    Mn_Rating: mapKey('MN')?.className,
    B: mapKey('B')?.soilValue,
    B_Rating: mapKey('B')?.className
  };

  applySoilRow(row);
}

function applySoilRow(row) {
  const safeRow = row || {};
  if (safeRow.reportId != null) document.getElementById('metaReportId').textContent = safeRow.reportId;
  if (safeRow.reportDt != null) document.getElementById('metaReportDt').textContent = safeRow.reportDt;
  if (safeRow.farmerName != null) document.getElementById('metaName').textContent = safeRow.farmerName;

  const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
  const fmt = (v, dp) => {
    const n = Number(v);
    if (!Number.isFinite(n)) return '—';
    return n.toFixed(dp);
  };

  const parseBands = (attr) => {
    if (!attr) return null;
    const parts = String(attr).split(',').map((s) => Number(s.trim()));
    if (parts.length < 2 || parts.some((x) => !Number.isFinite(x))) return null;
    return parts;
  };

  const markerPct = (min, max, v) => {
    const vv = Number(v);
    if (!Number.isFinite(vv)) return '50%';
    const x = clamp(vv, min, max);
    const pct = ((x - min) / ((max - min) || 1)) * 100;
    return clamp(pct, 0, 100).toFixed(2) + '%';
  };

  document.querySelectorAll('#mod-fertilizer .soil-report .param-card').forEach((card) => {
    const key = card.getAttribute('data-key');
    const type = card.getAttribute('data-type');
    const dp = Number(card.getAttribute('data-dp') || '2');

    const value = safeRow[key];
    const rating = safeRow[`${key}_Rating`] ?? safeRow[`${key}_Class`] ?? safeRow[`${key}_Fertility`];

    const valueEl = card.querySelector('[data-role="value"]');
    const ratingEl = card.querySelector('[data-role="rating"]');
    const markerEl = card.querySelector('[data-role="marker"]');

    if (valueEl) valueEl.textContent = (value === undefined || value === null) ? '—' : fmt(value, dp);
    if (ratingEl) ratingEl.textContent = rating !== undefined && rating !== null && String(rating).trim() !== '' ? String(rating) : '—';

    if (markerEl) {
      if (type === 'cuts') {
        const min = Number(card.getAttribute('data-min') || 0);
        const max = Number(card.getAttribute('data-max') || 1);
        markerEl.style.left = markerPct(min, max, value);
      } else if (type === 'bands') {
        const bands = parseBands(card.getAttribute('data-bands'));
        if (bands) {
          markerEl.style.left = markerPct(bands[0], bands[bands.length - 1], value);
        }
      }
    }
  });
}


function renderFertStages(stages) {
  const nutrientBody = document.getElementById('body-nm-nutrient-schedule');
  const fertilizerBody = document.getElementById('body-nm-fertilizer-schedule');
  const totalCostEl = document.getElementById('nm-total-cost');
  if (!nutrientBody || !fertilizerBody) return;

  nutrientBody.innerHTML = '';
  fertilizerBody.innerHTML = '';

  const valueOrDash = (value) => (String(value || '').trim() !== '' ? value : '-');
  const parseCost = (value) => {
    if (value === null || value === undefined) return NaN;
    const match = String(value).replace(/,/g, '').match(/-?\d+(\.\d+)?/);
    return match ? Number(match[0]) : NaN;
  };
  let totalCost = 0;

    // ✅ Option C: compute nutrient load + cost from FERT rows (no UI changes)
  // Ensure NutrientSources is already loaded in window.nmNutrientSources (or change this variable name)
  try {
    const impact = nmComputeImpactFromStages_FERT_ONLY(stages, window.nmNutrientSources || []);
    window.nmImpactTotals = impact.totals;
    window.nmImpactRows = impact.rows;

    console.log('NM Impact Totals (per ha):', window.nmImpactTotals);

    if (window.nmImpactTotals.missingSources?.length) {
      console.warn('NM Impact: missing NutrientSources match for:', window.nmImpactTotals.missingSources);
    }
  } catch (e) {
    console.error('NM Impact calc failed:', e);
  }


  if (!stages || stages.length === 0) {
    nutrientBody.innerHTML = '<tr><td colspan="3" style="text-align:center; padding:10px;">No nutrient schedule generated.</td></tr>';
    fertilizerBody.innerHTML = '<tr><td colspan="9" style="text-align:center; padding:10px;">No fertilizer schedule generated.</td></tr>';
    if (totalCostEl) totalCostEl.textContent = '—';
    return;
  }

  stages.forEach(function (s) {
    const isFertRow = s.details && String(s.details).indexOf('FERT:') === 0;

    if (isFertRow) {
      const tr = document.createElement('tr');

      const tdStage = document.createElement('td');
      tdStage.textContent = valueOrDash(s.stage);
      tr.appendChild(tdStage);

      const tdNut = document.createElement('td');
      tdNut.textContent = valueOrDash(s.nutrient);
      tr.appendChild(tdNut);

      const tdDose = document.createElement('td');
      tdDose.textContent = valueOrDash(s.dose);
      tr.appendChild(tdDose);

      const tdMethod = document.createElement('td');
      tdMethod.textContent = valueOrDash(s.method);
      tr.appendChild(tdMethod);

      const tdMix = document.createElement('td');
      tdMix.textContent = valueOrDash(s.sourceMix);
      tr.appendChild(tdMix);

      const tdQty = document.createElement('td');
      tdQty.textContent = valueOrDash(s.productQty);
      tr.appendChild(tdQty);

      const tdCost = document.createElement('td');
      tdCost.textContent = valueOrDash(s.costPerHa);
      tr.appendChild(tdCost);

      const costValue = parseCost(s.costPerHa);
      if (Number.isFinite(costValue)) {
        totalCost += costValue;
      }

      const tdDetails = document.createElement('td');
      tdDetails.textContent = valueOrDash(s.details);
      tr.appendChild(tdDetails);

      const tdFlags = document.createElement('td');
      tdFlags.textContent = valueOrDash(s.flags);
      tr.appendChild(tdFlags);

      fertilizerBody.appendChild(tr);
      return;
    }

    const tr = document.createElement('tr');

    const tdStage = document.createElement('td');
    tdStage.textContent = valueOrDash(s.stage);
    tr.appendChild(tdStage);

    const tdNut = document.createElement('td');
    tdNut.textContent = valueOrDash(s.nutrient);
    tr.appendChild(tdNut);

    const tdDose = document.createElement('td');
    tdDose.textContent = valueOrDash(s.dose);
    tr.appendChild(tdDose);

    nutrientBody.appendChild(tr);
  });

  if (!nutrientBody.children.length) {
    nutrientBody.innerHTML = '<tr><td colspan="3" style="text-align:center; padding:10px;">No nutrient schedule generated.</td></tr>';
  }

  if (!fertilizerBody.children.length) {
    fertilizerBody.innerHTML = '<tr><td colspan="9" style="text-align:center; padding:10px;">No fertilizer schedule generated.</td></tr>';
  }

  if (totalCostEl) {
    totalCostEl.textContent = totalCost > 0 ? totalCost.toFixed(2) : '—';
  }
}

// Build fertilizer material and cost arrays for PDF export from raw stage rows
// Build fertilizer material and cost arrays for PDF export from raw stage rows
function nmBuildFertRowsForPdf() {
  // Prefer raw stages (with productQty, costPerHa, details)
  const stages = Array.isArray(window.nmCurrentStagesRaw)
    ? window.nmCurrentStagesRaw
    : Array.isArray(window.nmCurrentStages)
    ? window.nmCurrentStages
    : [];

  const fertMaterials = [];
  const fertCosts = [];

  const toNum = (v) => {
    if (v === null || v === undefined) return NaN;
    // If it's already a number
    if (typeof v === 'number') return v;
    // Extract first numeric token from strings like "2 bags", "50 kg", "1.5", etc.
    const s = String(v).trim();
    const m = s.match(/-?\d+(\.\d+)?/);
    return m ? parseFloat(m[0]) : NaN;
  };

  stages.forEach(function (s) {
    const details = s.details || s.remarks || '';
    const isFertRow = details && String(details).indexOf('FERT:') === 0;

    const name = s.product || s.productName || s.source || s.sourceMix || '';

    const qtyNum = toNum(s.productQty);
    const costNum = toNum(s.costPerHa);

    // Reject bad / non-numeric quantities explicitly
    if (!isFertRow || !name) return;
    if (!Number.isFinite(qtyNum) || qtyNum <= 0) return;

    // If cost is missing or non-numeric, keep it as 0 (but do not break qty)
    const safeCost = Number.isFinite(costNum) ? costNum : 0;

    fertMaterials.push({
      stage: s.stage || '',
      materialName: name,
      qtyPerHa: qtyNum,
      nutrientContent: details
    });

    fertCosts.push({
      materialName: name,
      qtyPerHa: qtyNum,
      unitPrice: qtyNum ? safeCost / qtyNum : 0,
      totalCost: safeCost
    });
  });

  window.nmCurrentFertMaterials = fertMaterials;
  window.nmCurrentFertCosts = fertCosts;

  console.log('NM fert materials for PDF:', fertMaterials);
  console.log('NM fert costs for PDF:', fertCosts);
}


function nmParseNumber(v){
  if (v === null || v === undefined) return 0;
  if (typeof v === 'number' && Number.isFinite(v)) return v;

  const s = String(v).trim();
  if (!s) return 0;

  const m = s.match(/-?\d+(\.\d+)?/);
  return m ? (Number(m[0]) || 0) : 0;
}



function nmLoadPlanForCurrentSelection() {
  if (typeof google === 'undefined' || !google.script) return;

  var testIdInput = document.getElementById('nm-test-id');
  var testId = testIdInput ? testIdInput.value.trim() : '';
  if (!testId) return;

  var clientId = nmCurrentClientId || 'Default';
  var rsSel = document.getElementById('nm-rating-scheme');
  var ratingSchemeId = rsSel ? rsSel.value : '';
  var methodId = ''; // to wire later

  if (!ratingSchemeId) {
    console.warn('Select rating scheme first.');
    return;
  }

  google.script.run
    .withSuccessHandler(function(res) {
      nmRenderSummaryTable((res && res.summary) || []);
      nmRenderStagePlanTable((res && res.stages) || []);
    })
    .withFailureHandler(function(err) {
      console.error('getNutrientPlanForTest failed:', err);
    })
    .getNutrientPlanForTest(testId, clientId, ratingSchemeId, methodId);
}





function nmRenderSummaryTable(summary) {
  var tbody = document.getElementById('nm-fertility-body');
  if (!tbody) return;
  tbody.innerHTML = '';
  summary.forEach(function(row) {
    var tr = document.createElement('tr');
    tr.innerHTML =
      '<td>' + row.nutrient   + '</td>' +
      '<td>' + row.soilValue  + '</td>' +
      '<td>' + (row.unit || '') + '</td>' +
      '<td>' + (row.className || '') + '</td>';
    tbody.appendChild(tr);
  });
}


function nmRenderStagePlanTable(stages) {
  var tbody = document.getElementById('nm-stage-body');
  if (!tbody) return;
  tbody.innerHTML = '';
  stages.forEach(function(row) {
    var tr = document.createElement('tr');
    tr.innerHTML =
      '<td>' + row.stage       + '</td>' +
      '<td>' + (row.days || '') + '</td>' +
      '<td>' + (row.method || '') + '</td>' +
      '<td>' + (row.N || '') + '</td>' +
      '<td>' + (row.P2O5 || '') + '</td>' +
      '<td>' + (row.K2O || '') + '</td>' +
      '<td>' + (row.sourceMix || '') + '</td>' +
      '<td>' + (row.productQty || '') + '</td>' +
      '<td>' + (row.cost || '') + '</td>' +
      '<td>' + (row.delivery || '') + '</td>' +
      '<td>' + (row.flags || '') + '</td>';
    tbody.appendChild(tr);
  });
}

function nmOnTestIdChange() {
  var testSel = document.getElementById('nm-test-id');
  if (!testSel) return;
  var testId = testSel.value || '';
  if (!testId) return;

  var clientId = nmCurrentClientId || 'Default';
  var rsSel = document.getElementById('nm-rating-scheme');
  var ratingSchemeId = rsSel ? rsSel.value : '';
  var mSel = document.getElementById('nm-method');
  var methodId = mSel ? mSel.value : '';

  if (!ratingSchemeId || !methodId) {
    console.warn('Select rating scheme and method first.');
    return;
  }

  if (typeof google === 'undefined' || !google.script) return;

  google.script.run
    .withSuccessHandler(function(res) {
      try {
        nmRenderSummaryTable((res && res.summary) || []);
        nmRenderStagePlanTable((res && res.stages) || []);
      } catch (e) {
        console.error('nmOnTestIdChange handler error:', e);
      }
    })
    .withFailureHandler(function(err) {
      console.error('getNutrientPlanForTest failed:', err);
    })
    .getNutrientPlanForTest(testId, clientId, ratingSchemeId, methodId);
}


function onMethodChange() {
  var methodSel = document.getElementById('nm-method');
  var tyRow = document.getElementById('nm-target-yield-row');
  var tyInp = document.getElementById('nm-target-yield');

  var m = methodSel ? methodSel.value : '';

  if (tyRow) {
    tyRow.style.display = (m === 'RDF') ? 'none' : '';
  }

  if (tyInp) {
    tyInp.disabled = (m === 'RDF');
  }
}

// Download a PDF from base64 returned by Apps Script
function downloadPDFFromBase64(pdfBase64, fileName) {
  try {
    var binaryString = atob(pdfBase64);
    var len = binaryString.length;
    var bytes = new Uint8Array(len);
    for (var i = 0; i < len; i++) {
      bytes[i] = binaryString.charCodeAt(i);
    }
    var blob = new Blob([bytes], { type: 'application/pdf' });
    var url = URL.createObjectURL(blob);

    var link = document.createElement('a');
    link.href = url;
    link.download = fileName || 'Insoil_Plan.pdf';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
  } catch (e) {
    alert('Error downloading PDF: ' + e.message);
  }
}



// Main function: call server and download PDF
function generateAndDownloadNutrientPlan(cfg) {
  google.script.run
    .withSuccessHandler(function(res) {
      if (!res || !res.success) {
        alert(res && res.msg ? res.msg : 'PDF generation failed');
        return;
      }
      // res.pdfBase64 and res.fileName are from Apps Script
      downloadPDFFromBase64(res.pdfBase64, res.fileName);
    })
    .withFailureHandler(function(err) {
      alert('Server error: ' + (err && err.message ? err.message : err));
    })
    .generateNutrientPlanPDFForUI(cfg);
}

// Example: hook to a button click
// <button id="btnDownloadPlan">Download Nutrient Plan (PDF)</button>
document.addEventListener('DOMContentLoaded', function() {
  var btn = document.getElementById('btnDownloadPlan');
  if (!btn) return;

  btn.addEventListener('click', function() {
    // Build cfg from your current UI state
    var cfg = {
      testId: currentTestId,          // replace with your variables
      deviceId: currentDeviceId,
      clientId: currentClientId,
      cropId: selectedCropId,
      cropName: selectedCropName,
      methodId: selectedMethodId,
      methodName: selectedMethodName,
      ratingSchemeId: selectedRatingId,
      ratingSchemeName: selectedRatingName,
      targetYield: selectedTargetYield,
      // optional: stages, planTotals, nRate, pRate, kRate...
    };

    generateAndDownloadNutrientPlan(cfg);
  });
});


/* =========================================================
   Option C: compute nutrient load + cost from stages
   Only rows with details starting "FERT:" are counted
   ========================================================= */

function nmBuildNutrientSourcesMap(rows){
  const map = { byId:{}, byName:{} };
  const num = v => (Number.isFinite(Number(v)) ? Number(v) : 0);

  (rows || []).forEach(r => {
    const id = String(r.SourceID || '').trim();
    const nameKey = String(r.SourceName || '').trim().toLowerCase();
    const obj = {
      SourceID: id,
      SourceName: r.SourceName || id,
      GradeN: num(r.GradeN),
      GradeP2O5: num(r.GradeP2O5),
      GradeK2O: num(r.GradeK2O),
      GradeS: num(r.GradeS),
      GradeZn: num(r.GradeZn),
      GradeB: num(r.GradeB),
      UnitBasis: String(r.UnitBasis || '').toLowerCase(),
      UnitSize: num(r.UnitSize) || 1,
      PricePerUnit: num(r.PricePerUnit)
    };
    if (id) map.byId[id] = obj;
    if (nameKey) map.byName[nameKey] = obj;
  });

  return map;
}

function nmParseNumber(v){
  if (v === null || v === undefined) return 0;
  if (typeof v === 'number' && Number.isFinite(v)) return v;

  const s = String(v).trim();
  if (!s) return 0;

  const m = s.match(/-?\d+(\.\d+)?/);
  return m ? (Number(m[0]) || 0) : 0;
}


function nmComputeImpactFromStages_FERT_ONLY(stages, nutrientSourcesRows){
  const srcMap = nmBuildNutrientSourcesMap(nutrientSourcesRows);

  const totals = { productKgHa:0, costHa:0, N:0, P2O5:0, K2O:0, S:0, Zn:0, B:0, missing:[] };
  const rowsOut = [];

  (stages || []).forEach(s => {
    const details = String(s.details || '');
    const isFertRow = details.indexOf('FERT:') === 0;
    if (!isFertRow) return;

    const nameRaw = String(s.product || s.productName || s.source || s.sourceMix || '').trim();
    const nameKey = nameRaw.toLowerCase();

    const qtyKgHa = nmParseNumber(s.productQty);
    const costHa  = nmParseNumber(s.costPerHa);

    // match by SourceID first (e.g., "DAP"), else by SourceName
    const idKey = nameRaw.toUpperCase();
    const src = srcMap.byId[nameRaw] || srcMap.byId[idKey] || srcMap.byName[nameKey] || null;


    const N    = src ? qtyKgHa * (src.GradeN    / 100) : 0;
    const P2O5 = src ? qtyKgHa * (src.GradeP2O5 / 100) : 0;
    const K2O  = src ? qtyKgHa * (src.GradeK2O  / 100) : 0;
    const S    = src ? qtyKgHa * (src.GradeS    / 100) : 0;
    const Zn   = src ? qtyKgHa * (src.GradeZn   / 100) : 0;
    const B    = src ? qtyKgHa * (src.GradeB    / 100) : 0;

    totals.productKgHa += qtyKgHa;
    totals.costHa += costHa;
    totals.N += N; totals.P2O5 += P2O5; totals.K2O += K2O; totals.S += S; totals.Zn += Zn; totals.B += B;

    if (!src && nameRaw) totals.missing.push(nameRaw);

    rowsOut.push({
      stage: s.stage || '',
      materialName: nameRaw,
      qtyKgHa,
      costHa,
      nutrientsKgHa: { N, P2O5, K2O, S, Zn, B },
      matchedSourceID: src ? src.SourceID : null
    });
  });

  const r2 = x => Math.round((Number(x) || 0) * 100) / 100;

  return {
    rows: rowsOut,
    totals: {
      productKgHa: r2(totals.productKgHa),
      costHa: r2(totals.costHa),
      N: r2(totals.N),
      P2O5: r2(totals.P2O5),
      K2O: r2(totals.K2O),
      S: r2(totals.S),
      Zn: r2(totals.Zn),
      B: r2(totals.B),
      missingSources: totals.missing
    }
  };
}


//---------------- Nutrient Management module end -------------------

// ---------------- Nutrient Manager-2 Module (Placeholders) -------------------

// Placeholder autocomplete functions (wire to nmDeviceIndex / nmTestIndex later)
function nm2OnDeviceInput() {
  console.log('nm2OnDeviceInput - placeholder');
}
function nm2ShowDeviceList() {
  console.log('nm2ShowDeviceList - placeholder');
}
function nm2OnTestInput() {
  console.log('nm2OnTestInput - placeholder');
}
function nm2ShowTestList() {
  console.log('nm2ShowTestList - placeholder');
}

// Method change: show/hide target yield field
function nm2MethodChange() {
  const methodSel = document.getElementById('nm2-method');
  const tyField = document.getElementById('nm2-target-yield');
  if (!methodSel || !tyField) return;
  
  const m = methodSel.value;
  if (m === 'RDF') {
    tyField.disabled = true;
    tyField.placeholder = 'Not used for RDF';
  } else {
    tyField.disabled = false;
    tyField.placeholder = 'Enter target yield';
  }
}

// Recalculate plan (same logic as NM-1, but reads nm2- IDs)
function nm2RecalculatePlan() {
  alert('nm2RecalculatePlan - placeholder.\n\nWill call getNutrientPlanForTest() and render stages.');
}

// Export single PDF
function nm2ExportPlan() {
  alert('nm2ExportPlan - placeholder.\n\nWill assemble cfg and call generateNutrientPlanPDFForUI(cfg).');
}

// Toggle advanced override panel
function nm2ToggleAdvanced() {
  const panel = document.getElementById('nm2-advanced-panel');
  if (!panel) return;
  panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
}

// Apply P-source override
function nm2ApplyOverride() {
  const status = document.getElementById('nm2-override-status');
  if (status) status.textContent = 'Override applied (placeholder)';
  alert('nm2ApplyOverride - placeholder.\n\nWill force selected P-source into plan recalculation.');
}

// Bulk Export: Preview count
function nm2BulkPreview() {
  const from = document.getElementById('nm2-bulk-from').value;
  const to = document.getElementById('nm2-bulk-to').value;
  const limit = parseInt(document.getElementById('nm2-bulk-limit').value) || 50;
  const successOnly = document.getElementById('nm2-bulk-success-only').checked;
  
  const status = document.getElementById('nm2-bulk-status');
  status.textContent = 'Counting...';
  
  // TODO: wire to backend
  // google.script.run
  //   .withSuccessHandler(res => {
  //     status.textContent = `Found ${res.count} tests`;
  //   })
  //   .withFailureHandler(err => {
  //     status.textContent = 'Error';
  //     alert(err.message);
  //   })
  //   .nmBulkExportPreview({ from, to, limit, successOnly });
  
  // Placeholder response
  setTimeout(() => {
    status.textContent = `Found 23 tests (placeholder)`;
  }, 500);
}

// Bulk Export: Run export
function nm2BulkExport() {
  const from = document.getElementById('nm2-bulk-from').value;
  const to = document.getElementById('nm2-bulk-to').value;
  const limit = parseInt(document.getElementById('nm2-bulk-limit').value) || 50;
  const successOnly = document.getElementById('nm2-bulk-success-only').checked;
  
  if (!from || !to) {
    alert('Please select From and To dates for bulk export.');
    return;
  }
  
  const status = document.getElementById('nm2-bulk-status');
  status.textContent = 'Exporting...';
  
  // TODO: wire to backend
  // google.script.run
  //   .withSuccessHandler(res => {
  //     status.textContent = `✓ ${res.exported} PDFs`;
  //     alert(`Bulk export complete!\n\nFolder: ${res.folderUrl}\nExported: ${res.exported}\nFailed: ${res.failed}`);
  //   })
  //   .withFailureHandler(err => {
  //     status.textContent = 'Failed';
  //     alert('Bulk export error: ' + err.message);
  //   })
  //   .nmBulkExportRun({ from, to, limit, successOnly });
  
  // Placeholder response
  setTimeout(() => {
    status.textContent = `✓ 23 PDFs (placeholder)`;
    alert('Bulk export placeholder:\n\nFolder: [Drive folder link]\nExported: 23\nFailed: 0');
  }, 2000);
}

// ---------------- Nutrient Manager-2 end -------------------







//---------------- Lab validation module start -------------------


/* =========================================================
   LAB VALIDATION MODULE - Frontend JS
   ========================================================= */

let lvIndex = { ok:false, tests:[], devices:[], pairs:[], counts:{tests:0, devices:0, rows:0}, msg:'' };
let lvMapDeviceToTests = {};
let lvMapTestToDevices = {};
let lvSelected = { deviceId:'', testId:'' };

let lvTableRows = [];         // rows in the Enter Lab Data table
let lvCorrelationPoints = {}; // per-parameter points {paramKey:[{x,y}]}
let lvCharts = [];            // Chart.js instances for correlation grid
let lvModalChart = null;

const LV_PARAMS = [
  { key:'pH',      name:'pH',              unit:'-'      , insoilCol:'pH' },
  { key:'EC',      name:'Electrical Conductivity', unit:'dS/m'  , insoilCol:'EC' },
  { key:'OC',      name:'Organic Carbon',  unit:'%'      , insoilCol:'OC' },
  { key:'N',       name:'Available Nitrogen', unit:'kg/ha', insoilCol:'Avail_N' },
  { key:'P',       name:'Available Phosphorus', unit:'kg/ha', insoilCol:'Avail_P' },
  { key:'K',       name:'Available Potassium', unit:'kg/ha', insoilCol:'Avail_K' },
  { key:'S',       name:'Available Sulphur', unit:'mg/kg', insoilCol:'Avail_S' },
  { key:'Zn',      name:'Zinc',            unit:'mg/kg'  , insoilCol:'Zn' },
  { key:'Fe',      name:'Iron',            unit:'mg/kg'  , insoilCol:'Fe' },
  { key:'Mn',      name:'Manganese',       unit:'mg/kg'  , insoilCol:'Mn' },
  { key:'Cu',      name:'Copper',          unit:'mg/kg'  , insoilCol:'Cu' },
  { key:'B',       name:'Boron',           unit:'mg/kg'  , insoilCol:'B' }
];

function lvTogglePanel(panelId, btnEl){
  const el = document.getElementById(panelId);
  if (!el) return;

  const collapsedNow = el.classList.toggle('lv-collapsed');

  // If button element not passed, try to find one inside the panel header
  if (!btnEl) {
    btnEl = el.querySelector('.lv-head button');
  }
  if (!btnEl) return;

  if (collapsedNow) {
    btnEl.textContent = 'Maximize';
    btnEl.classList.remove('btn-orange');
    btnEl.classList.add('btn-green');
  } else {
    btnEl.textContent = 'Minimize';
    btnEl.classList.remove('btn-green');
    btnEl.classList.add('btn-orange');
  }
}


function lvSetStatus(ok, msg){
  const dot = document.getElementById('lv-dot');
  const st = document.getElementById('lv-status');
  if (dot) dot.className = ok ? 'dot ok' : 'dot';
  if (st) st.value = msg || (ok ? 'OK' : 'Error');
}

function lvInitIfNeeded(){
  // Only init once
  if (lvIndex && lvIndex.ok) return;

  lvSetStatus(false, 'Loading SoilTest index...');

  google.script.run
    .withSuccessHandler(res => {
      lvIndex = res || lvIndex;
      if (!lvIndex.ok){
        lvSetStatus(false, lvIndex.msg || 'Failed to load SoilTest index');
        return;
      }
      lvSetStatus(true, lvIndex.msg || 'Loaded');
      const c = lvIndex.counts || {tests:0, devices:0};
      document.getElementById('lv-counts').textContent = `Tests = ${c.tests}, Devices = ${c.devices}`;

      // Build maps for bi-directional filtering
      lvMapDeviceToTests = {};
      lvMapTestToDevices = {};
      (lvIndex.pairs || []).forEach(p => {
        if (!lvMapDeviceToTests[p.deviceId]) lvMapDeviceToTests[p.deviceId] = {};
        lvMapDeviceToTests[p.deviceId][p.testId] = true;

        if (!lvMapTestToDevices[p.testId]) lvMapTestToDevices[p.testId] = {};
        lvMapTestToDevices[p.testId][p.deviceId] = true;
      });

      // Build default table
      lvBuildDefaultTable();

      // Init Geoapify UI
      lvInitGeoapify();

    })
    .withFailureHandler(err => {
      lvSetStatus(false, (err && err.message) ? err.message : 'Load failed');
    })
    .getSoilTestIndexForLabValidation();
}

function lvAutoPickPairIfEmpty() {
  const devEl  = document.getElementById("lv-device-id");
  const testEl = document.getElementById("lv-test-id");
  if (!devEl || !testEl) return;

  const d = String(devEl.value || "").trim();
  const t = String(testEl.value || "").trim();
  if (d && t) return; // already chosen by user

  // pick first available pair from index
  if (!lvIndex || !lvIndex.ok || !Array.isArray(lvIndex.pairs) || !lvIndex.pairs.length) return;

  devEl.value = lvIndex.pairs[0].deviceId || "";
  testEl.value = lvIndex.pairs[0].testId || "";

  // keep internal selection in sync (your code uses lvSelected)
  lvSelected.deviceId = String(devEl.value).trim();
  lvSelected.testId = String(testEl.value).trim();
}


function lvBuildDefaultTable(){
  lvTableRows = LV_PARAMS.map(p => ({
    Parameter: p.name,
    Unit: p.unit,
    Lab_Value: '',
    Insoil_Value: '',
    Notes: '',
    _insoilCol: p.insoilCol
  }));
  lvRenderTable();
}

function lvRenderTable(){
  const tb = document.getElementById('lv-tbody');
  if (!tb) return;

  const editOn = document.getElementById('lv-edit-toggle')?.checked;

  // 2 significant digits formatter (display only)
  const fmtSig2 = (v) => {
    if (v === '' || v === null || v === undefined) return '-';
    const num = Number(v);
    if (!Number.isFinite(num)) return String(v);

    // 2 significant digits; convert back to normal number string (avoids 1.2e-4 style in many cases)
    // If you WANT scientific notation when needed, use: return num.toPrecision(2);
    return String(Number(num.toPrecision(2)));
  };

  tb.innerHTML = '';
  lvTableRows.forEach((r, idx) => {
    const tr = document.createElement('tr');

    const tdP = document.createElement('td');
    if (editOn){
      tdP.innerHTML = `<input data-k="Parameter" data-i="${idx}" type="text" value="${escapeHtml(r.Parameter)}" style="width:180px;">`;
    } else {
      tdP.textContent = r.Parameter;
    }

    const tdU = document.createElement('td');
    if (editOn){
      tdU.innerHTML = `<input data-k="Unit" data-i="${idx}" type="text" value="${escapeHtml(r.Unit)}" style="width:90px;">`;
    } else {
      tdU.textContent = r.Unit;
    }

    const tdL = document.createElement('td');
    tdL.innerHTML = `<input data-k="Lab_Value" data-i="${idx}" type="number" min="0" step="any" value="${r.Lab_Value ?? ''}" style="width:110px;">`;

    const tdI = document.createElement('td');
    tdI.textContent = fmtSig2(r.Insoil_Value);   // <-- only change

    const tdN = document.createElement('td');
    tdN.innerHTML = `<input data-k="Notes" data-i="${idx}" type="text" value="${escapeHtml(r.Notes || '')}" style="width:240px;">`;

    tr.appendChild(tdP);
    tr.appendChild(tdU);
    tr.appendChild(tdL);
    tr.appendChild(tdI);
    tr.appendChild(tdN);

    tb.appendChild(tr);
  });

  // Bind change events once per render
  tb.querySelectorAll('input').forEach(inp => {
    inp.addEventListener('input', e => {
      const k = e.target.getAttribute('data-k');
      const i = Number(e.target.getAttribute('data-i'));
      if (Number.isNaN(i) || !lvTableRows[i]) return;

      // Lab_Value must be +ve float only
      if (k === 'Lab_Value'){
        const v = e.target.value;
        if (v === '') { lvTableRows[i][k] = ''; return; }
        const num = Number(v);
        if (Number.isFinite(num) && num >= 0) lvTableRows[i][k] = num;
        else {
          // reject invalid
          e.target.value = lvTableRows[i][k] ?? '';
        }
        lvRefreshCorrelationData();
        return;
      }

      lvTableRows[i][k] = e.target.value;
      if (k === 'Notes') lvRefreshCorrelationData();
    });
  });

  lvRefreshCorrelationData();
}


function lvToggleEditTable(){
  const on = document.getElementById('lv-edit-toggle')?.checked;
  const head = document.getElementById('lv-panel-entry');
  const actions = document.getElementById('lv-edit-actions');
  if (head) head.classList.toggle('lv-edit-on', !!on);
  if (actions) actions.style.display = on ? 'flex' : 'none';
  lvRenderTable();
}

function lvAddRow(){
  lvTableRows.push({ Parameter:'', Unit:'', Lab_Value:'', Insoil_Value:'', Notes:'', _insoilCol:'' });
  lvRenderTable();
}

function lvRemoveRow(){
  if (!lvTableRows.length) return;
  lvTableRows.pop();
  lvRenderTable();
}

/* ---------- Autocomplete (Device/Test) ---------- */

function lvFilteredDevices(){
  const t = String(document.getElementById('lv-test-id').value || '').trim();
  if (!t) return lvIndex.devices || [];
  const set = lvMapTestToDevices[t] || {};
  return Object.keys(set).sort();
}

function lvFilteredTests(){
  const d = String(document.getElementById('lv-device-id').value || '').trim();
  if (!d) return lvIndex.tests || [];
  const set = lvMapDeviceToTests[d] || {};
  return Object.keys(set).sort();
}

function lvShowDeviceList(){
  lvShowList('lv-device-id','lv-device-list', lvFilteredDevices());
}
function lvShowTestList(){
  lvShowList('lv-test-id','lv-test-list', lvFilteredTests());
}

function lvOnDeviceInput(){
  const q = String(document.getElementById('lv-device-id').value || '').trim().toLowerCase();
  const items = lvFilteredDevices().filter(x => x.toLowerCase().includes(q)).slice(0, 50);
  lvShowList('lv-device-id','lv-device-list', items);
}
function lvOnTestInput(){
  const q = String(document.getElementById('lv-test-id').value || '').trim().toLowerCase();
  const items = lvFilteredTests().filter(x => x.toLowerCase().includes(q)).slice(0, 50);
  lvShowList('lv-test-id','lv-test-list', items);
}

function lvShowList(inputId, listId, items){
  const list = document.getElementById(listId);
  const input = document.getElementById(inputId);
  if (!list || !input) return;

  list.innerHTML = '';
  if (!items.length){
    list.style.display = 'none';
    return;
  }

  items.forEach(v => {
    const div = document.createElement('div');
    div.className = 'autocomplete-item';
    div.textContent = v;
    div.onclick = () => {
      input.value = v;
      list.style.display = 'none';
      lvHandleSelection();
    };
    list.appendChild(div);
  });
  list.style.display = 'block';
}

// When either field is selected, enforce bi-direction subset by auto-filling the other if invalid
function lvHandleSelection() {
  const deviceEl = document.getElementById('lv-device-id');
  const testEl   = document.getElementById('lv-test-id');

  const d = String(deviceEl?.value || '').trim();
  const t = String(testEl?.value   || '').trim();

  // ✅ Detect selection change BEFORE we mutate values (so we can clear Lab inputs)
  const prevDevice = String(lvSelected?.deviceId || '').trim();
  const prevTest   = String(lvSelected?.testId   || '').trim();
  const selectionChanged = (d !== prevDevice) || (t !== prevTest);

  // ✅ If user changed Device/Test, empty only the Lab value column
  // (do NOT clear Parameter/Unit/Notes; keep user's structure)
  if (selectionChanged) {
    lvTableRows = lvTableRows.map(r => ({ ...r, Lab_Value: '' }));
  }

  // If both filled but not a valid pair, clear Test and let user re-pick
  if (d && t) {
    const ok = lvMapDeviceToTests[d] && lvMapDeviceToTests[d][t];
    if (!ok) {
      if (testEl) testEl.value = '';
    }
  }

  // ✅ Re-read after potential clearing of Test
  lvSelected.deviceId = String(deviceEl?.value || '').trim();
  lvSelected.testId   = String(testEl?.value   || '').trim();

  if (lvSelected.testId) {
    google.script.run
      .withSuccessHandler(row => {
        if (!row) {
          lvSetStatus(false, 'No matching SoilTest row found');
          // Keep Insoil empty if no row found
          lvTableRows = lvTableRows.map(r => ({ ...r, Insoil_Value: '' }));
          lvRenderTable();
          lvRenderCorrelations();
          return;
        }

        lvSetStatus(true, 'SoilTest row loaded');

        // Fill Insoil_Value (auto) based on row values
        lvTableRows = lvTableRows.map(r => {
          if (!r._insoilCol) return r;
          const v = row[r._insoilCol];
          return { ...r, Insoil_Value: (v === null || v === undefined) ? '' : v };
        });

        lvRenderTable();
        lvRenderCorrelations();
      })
      .withFailureHandler(err => {
        lvSetStatus(false, err?.message || 'Fetch failed');
      })
      .getSoilTestRowForLabValidation(lvSelected.testId, lvSelected.deviceId);

  } else {
    // No test selected -> clear auto values, and re-render (Lab values already cleared if selection changed)
    lvTableRows = lvTableRows.map(r => ({ ...r, Insoil_Value: '' }));
    lvRenderTable();
    lvRenderCorrelations();
  }
}


/* ---------- Geoapify autocomplete ---------- */


// ---- Geoapify API-based autocomplete (NO external library needed) ----
let lvGeoTimer = null;

function lvInitGeoapify(){
  // Nothing to load now; keep function so your init flow does not change
  const inp = document.getElementById('lv-location-input');
  if (inp) inp.value = '';
  const list = document.getElementById('lv-location-list');
  if (list) list.style.display = 'none';
}

function lvGeoSearch(force){
  const inp = document.getElementById('lv-location-input');
  const list = document.getElementById('lv-location-list');
  if (!inp || !list) return;

  const q = String(inp.value || '').trim();

// Never call API with empty query
if (q.length === 0) {
  list.style.display = 'none';
  list.innerHTML = '';
  return;
}

// If not forced, require >= 3 chars to reduce API calls
if (!force && q.length < 3) {
  list.style.display = 'none';
  list.innerHTML = '';
  return;
}


  if (lvGeoTimer) clearTimeout(lvGeoTimer);
  lvGeoTimer = setTimeout(async () => {
    try {
      const apiKey = '4be88a7b307e422a8ebd9f7f9461fc96';
      const url =
        'https://api.geoapify.com/v1/geocode/autocomplete' +
        '?text=' + encodeURIComponent(q) +
        '&type=city' +
        '&limit=8' +
        '&format=geojson' +
        '&apiKey=' + encodeURIComponent(apiKey);

      const resp = await fetch(url);
      if (!resp.ok) throw new Error('Geoapify API error: ' + resp.status);

      const data = await resp.json();
      const features = (data && data.features) ? data.features : [];

      list.innerHTML = '';
      if (!features.length){
        list.style.display = 'none';
        return;
      }

      features.forEach(f => {
        const p = f.properties || {};
        const label = p.formatted || p.address_line1 || p.city || '';
        const lat = p.lat;
        const lon = p.lon;

        const div = document.createElement('div');
        div.className = 'autocomplete-item';
        div.textContent = label;

        div.onclick = () => {
          inp.value = label;
          document.getElementById('lv-lab-location').value = label || '';
          document.getElementById('lv-lab-gps').value = (lat && lon) ? (lat + ',' + lon) : '';
          list.style.display = 'none';
        };

        list.appendChild(div);
      });

      list.style.display = 'block';
    } catch (e){
      // Fail silently in UI, but keep debug in console
      console.error(e);
      list.style.display = 'none';
    }
  }, 250);
}




/* ---------- CSV import ---------- */

function lvHandleCsv(input){
  const file = input.files && input.files[0];
  if (!file) return;

  document.getElementById('lv-filepath').value = file.name;

  const reader = new FileReader();
  reader.onload = (e) => {
    const text = String(e.target.result || '');
    const rows = lvParseCsv(text);
    if (!rows.length){
      lvSetStatus(false, 'CSV empty or not readable');
      return;
    }

    // Expect headers like: Parameter, Unit, Lab_Value, Notes (flexible)
    const h = rows[0].map(x => String(x).trim());
    const idxP = h.findIndex(x => /parameter/i.test(x));
    const idxU = h.findIndex(x => /unit/i.test(x));
    const idxV = h.findIndex(x => /(lab[_\s]*value|value)/i.test(x));
    const idxN = h.findIndex(x => /notes?/i.test(x));

    const out = [];
    for (let i=1; i<rows.length; i++){
      const r = rows[i];
      const P = idxP>=0 ? (r[idxP] ?? '') : '';
      const U = idxU>=0 ? (r[idxU] ?? '') : '';
      const V = idxV>=0 ? (r[idxV] ?? '') : '';
      const N = idxN>=0 ? (r[idxN] ?? '') : '';
      if (!P) continue;

      const num = (V === '' || V === null || V === undefined) ? '' : Number(V);
      out.push({
        Parameter: String(P),
        Unit: String(U || ''),
        Lab_Value: (Number.isFinite(num) && num >= 0) ? num : '',
        Insoil_Value: '',
        Notes: String(N || ''),
        _insoilCol: '' // CSV may not map; manual still valid
      });
    }

    if (!out.length){
      lvSetStatus(false, 'CSV had no usable rows');
      return;
    }

    // Replace table rows with CSV rows (user can edit)
    lvTableRows = out.map(r => ({...r}));
    lvRenderTable();
    lvRenderCorrelations();
    lvSetStatus(true, `CSV loaded: ${out.length} rows`);
  };
  reader.readAsText(file);
}

// =========================
// STV DIRECT
// =========================
const STV_DIRECT_TABLE_HEADERS = [
  'Report',
  'Client ID',
  'Farm ID',
  'Crop',
  'Test ID',
  'Device ID',
  'Test Date-Time',
  'pH (-)',
  'EC (dS/m)',
  'Org Carbon (%)',
  'Nitrogen (kg/ha)',
  'Phosphorus (kg/ha)',
  'Potassium (kg/ha)',
  'Sulphur (mg/kg)',
  'Zinc (mg/kg)',
  'Copper (mg/kg)',
  'Iron (mg/kg)',
  'Manganese (mg/kg)',
  'Boron (mg/kg)'
];

let stvDirectRows = [];
let stvDirectSelected = new Set();

function client_ImportCSV_STVDirect(input) {
  if (!input || !input.files || !input.files.length) return;
  const statusEl = document.getElementById('stv-direct-status');
  const file = input.files[0];
  const reader = new FileReader();
  reader.onload = (e) => {
    const csvText = e.target.result || '';
    if (!csvText.trim()) {
      alert('CSV file is empty.');
      return;
    }
    if (statusEl) statusEl.textContent = 'Importing STV Direct CSV...';
    google.script.run
      .withSuccessHandler((res) => {
        const addedCount = res && typeof res.addedCount === 'number' ? res.addedCount : 0;
        const errorCount = res && typeof res.errorCount === 'number' ? res.errorCount : 0;
        if (errorCount) {
          const details = Array.isArray(res.errors) && res.errors.length
            ? `\n${res.errors.join('\n')}`
            : '';
          alert(`Imported ${addedCount} row(s) with ${errorCount} error(s).${details}`);
        }
        refreshSTVDirect();
      })
      .withFailureHandler((err) => {
        console.error('STV Direct import failed:', err);
        alert('STV Direct import failed: ' + (err && err.message ? err.message : err));
      })
      .srvr_ImportSTVDirectCSV({ csvText });
  };
  reader.onerror = () => {
    alert('Failed to read CSV file.');
  };
  reader.readAsText(file);
  input.value = '';
}

function refreshSTVDirect() {
  const statusEl = document.getElementById('stv-direct-status');
  if (statusEl) statusEl.textContent = 'Loading STV Direct...';

  google.script.run
    .withSuccessHandler((res) => {
      if (!res || res.status !== 'OK') {
        const msg = res && res.error ? res.error : 'Unknown error';
        if (statusEl) statusEl.textContent = `Load failed: ${msg}`;
        return;
      }
      stvDirectRows = Array.isArray(res.rows) ? res.rows : [];
      stvDirectSelected = new Set();
      renderSTVDirectTable(stvDirectRows);
      updateSTVDirectSelectionState();
      if (statusEl) statusEl.textContent = `Loaded ${stvDirectRows.length} rows.`;
    })
    .withFailureHandler((err) => {
      console.error('STV Direct load failed:', err);
      if (statusEl) statusEl.textContent = 'Load failed.';
    })
    .getSTVDirectData();
}

function renderSTVDirectTable(rows) {
  const tbody = document.getElementById('body-stv-direct');
  if (!tbody) return;

  if (!rows || !rows.length) {
    tbody.innerHTML = '<tr><td colspan="20" style="padding:20px;text-align:center;">No STV Direct records found.</td></tr>';
    return;
  }

  tbody.innerHTML = '';
  rows.forEach((row, idx) => {
    const checked = stvDirectSelected.has(idx) ? 'checked' : '';
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>
        <input type="checkbox" class="stv-direct-row-check" data-index="${idx}" onclick="toggleSTVDirectRowSelection(${idx}, this)" ${checked}>
      </td>
      <td>
        <button class="btn btn-outline" onclick="exportSTVDirectRowReport(${idx})">CSV</button>
        <button class="btn btn-outline" onclick="exportSTVDirectPdfReport(${idx})">PDF</button>
      </td>
      <td>${escapeHtml(row.ClientID)}</td>
      <td>${escapeHtml(row.Farm_ID)}</td>
      <td>${escapeHtml(row.Crop)}</td>
      <td>${escapeHtml(row.Test_ID)}</td>
      <td>${escapeHtml(row.Device_ID)}</td>
      <td class="col-date">${escapeHtml(row.Date)}</td>
      <td>${escapeHtml(row.pH)}</td>
      <td>${escapeHtml(row.EC)}</td>
      <td>${escapeHtml(row.OC)}</td>
      <td>${escapeHtml(row.Avail_N)}</td>
      <td>${escapeHtml(row.Avail_P)}</td>
      <td>${escapeHtml(row.Avail_K)}</td>
      <td>${escapeHtml(row.Avail_S)}</td>
      <td>${escapeHtml(row.Zn)}</td>
      <td>${escapeHtml(row.Cu)}</td>
      <td>${escapeHtml(row.Fe)}</td>
      <td>${escapeHtml(row.Mn)}</td>
      <td>${escapeHtml(row.B)}</td>
    `;
    tbody.appendChild(tr);
  });
  updateSTVDirectSelectionState();
}

function toggleSTVDirectRowSelection(index, checkbox) {
  if (!checkbox) return;
  if (checkbox.checked) {
    stvDirectSelected.add(index);
  } else {
    stvDirectSelected.delete(index);
  }
  updateSTVDirectSelectionState();
}

function toggleSTVDirectSelectAll(checkbox) {
  if (!checkbox) return;
  stvDirectSelected = new Set();
  if (checkbox.checked) {
    stvDirectRows.forEach((_, idx) => stvDirectSelected.add(idx));
  }
  document.querySelectorAll('.stv-direct-row-check').forEach(input => {
    input.checked = checkbox.checked;
  });
  updateSTVDirectSelectionState();
}

function updateSTVDirectSelectionState() {
  const selectAll = document.getElementById('stv-direct-select-all');
  const total = stvDirectRows.length;
  const selectedCount = stvDirectSelected.size;
  if (selectAll) {
    selectAll.checked = total > 0 && selectedCount === total;
    selectAll.indeterminate = selectedCount > 0 && selectedCount < total;
  }
  const bulkBtn = document.querySelector('[onclick="exportSTVDirectBulkPdf()"]');
  if (bulkBtn) bulkBtn.disabled = selectedCount === 0;
}

function getSelectedSTVDirectRows() {
  return Array.from(stvDirectSelected)
    .filter(idx => stvDirectRows[idx])
    .map(idx => ({ row: stvDirectRows[idx], index: idx }));
}

function exportSTVDirectReport() {
  if (!stvDirectRows.length) {
    alert('No STV Direct rows to export.');
    return;
  }
  const rows = stvDirectRows.map(row => formatSTVDirectRowForExport(row));
  const csv = buildCsv(STV_DIRECT_TABLE_HEADERS, rows);
  const filename = `STV_Direct_Report_${new Date().toISOString().split('T')[0]}.csv`;
  downloadTextFile(filename, csv, 'text/csv');
}

function exportSTVDirectRowReport(index) {
  const row = stvDirectRows[index];
  if (!row) {
    alert('Report row not found.');
    return;
  }
  const csv = buildCsv(STV_DIRECT_TABLE_HEADERS, [formatSTVDirectRowForExport(row)]);
  const tid = row.Test_ID ? String(row.Test_ID).replace(/\s+/g, '_') : 'STV_Direct';
  const filename = `${tid}_STV_Direct_Report.csv`;
  downloadTextFile(filename, csv, 'text/csv');
}

async function exportSTVDirectPdfReport(index) {
  if (!ensureSTVDirectExportLibs()) return;
  const row = stvDirectRows[index];
  if (!row) {
    alert('Report row not found.');
    return;
  }
  const statusEl = document.getElementById('stv-direct-status');
  if (statusEl) statusEl.textContent = 'Generating PDF report...';
  try {
    const reportData = mapSTVDirectReportRow(row);
    const blob = await generateStvDirectPdfBlob(reportData);
    const tid = row.Test_ID ? String(row.Test_ID).replace(/\s+/g, '_') : 'STV_Direct';
    downloadBlobFile(`${tid}_STV_Direct_Report.pdf`, blob);
    if (statusEl) statusEl.textContent = 'PDF report ready.';
  } catch (err) {
    console.error('STV Direct PDF export failed:', err);
    alert('Failed to generate PDF report.');
    if (statusEl) statusEl.textContent = 'PDF export failed.';
  }
}

function formatSTVDirectRowForExport(row) {
  return [
    'Download',
    row.ClientID,
    row.Farm_ID,
    row.Crop,
    row.Test_ID,
    row.Device_ID,
    row.Date,
    row.pH,
    row.EC,
    row.OC,
    row.Avail_N,
    row.Avail_P,
    row.Avail_K,
    row.Avail_S,
    row.Zn,
    row.Cu,
    row.Fe,
    row.Mn,
    row.B
  ];
}

async function exportSTVDirectBulkPdf() {
  if (!ensureSTVDirectExportLibs()) return;
  const selected = getSelectedSTVDirectRows();
  if (!selected.length) {
    alert('Select at least one STV Direct row to export.');
    return;
  }
  const statusEl = document.getElementById('stv-direct-status');
  if (statusEl) statusEl.textContent = `Generating ${selected.length} PDF report(s)...`;

  try {
    const zip = new JSZip();
    for (let i = 0; i < selected.length; i++) {
      const { row } = selected[i];
      const reportData = mapSTVDirectReportRow(row);
      const blob = await generateStvDirectPdfBlob(reportData);
      const tid = row.Test_ID ? String(row.Test_ID).replace(/\s+/g, '_') : `STV_Direct_${i + 1}`;
      zip.file(`${tid}_STV_Direct_Report.pdf`, blob);
      if (statusEl) statusEl.textContent = `Generated ${i + 1}/${selected.length} PDFs...`;
    }
    const zipBlob = await zip.generateAsync({ type: 'blob' });
    const zipName = `STV_Direct_Reports_${new Date().toISOString().split('T')[0]}.zip`;
    downloadBlobFile(zipName, zipBlob);
    if (statusEl) statusEl.textContent = 'Bulk export ready.';
  } catch (err) {
    console.error('STV Direct bulk export failed:', err);
    alert('Failed to generate bulk PDF export.');
    if (statusEl) statusEl.textContent = 'Bulk export failed.';
  }
}

function exportSTVDirectSvgPrint() {
  const selected = getSelectedSTVDirectRows();
  if (!selected.length) {
    alert('Select one STV Direct row to export.');
    return;
  }
  if (selected.length > 1) {
    alert('Select a single STV Direct row for SVG export.');
    return;
  }
  const { row } = selected[0];
  const reportData = mapSTVDirectReportRow(row);
  const statusEl = document.getElementById('stv-direct-status');
  if (statusEl) statusEl.textContent = 'Generating SVG report...';

  const { svgMarkup, svgContent, pageWidth, pageHeight } = buildStvDirectSvgReport(reportData);
  const tid = row.Test_ID ? String(row.Test_ID).replace(/\s+/g, '_') : 'STV_Direct';
  downloadTextFile(`${tid}_STV_Direct_Report.svg`, svgMarkup, 'image/svg+xml');

  const printWindow = window.open('', '_blank');
  if (!printWindow) {
    alert('Unable to open print preview. Please allow pop-ups.');
    if (statusEl) statusEl.textContent = 'SVG export ready.';
    return;
  }
  printWindow.document.write(buildStvDirectSvgPrintHtml(svgContent, pageWidth, pageHeight));
  printWindow.document.close();
  printWindow.focus();
  if (statusEl) statusEl.textContent = 'SVG export ready.';
}

function buildStvDirectSvgReport(reportData) {
  const pageWidth = 794;
  const pageHeight = 1123;
  const totalHeight = pageHeight * 4;
  const svgContent = buildStvDirectSvgContent(reportData, pageWidth, totalHeight, pageHeight);
  const svgMarkup = `
<svg xmlns="http://www.w3.org/2000/svg" width="${pageWidth}" height="${totalHeight}" viewBox="0 0 ${pageWidth} ${totalHeight}">
${svgContent}
</svg>`.trim();
  return { svgMarkup, svgContent, pageWidth, pageHeight, totalHeight };
}

function buildStvDirectSvgContent(reportData, pageWidth, totalHeight, pageHeight) {
  const text = [];
  const headerHeight = 170;
  const margin = 40;
  const columnGap = 20;
  const columnWidth = (pageWidth - margin * 2 - columnGap) / 2;
  const cardHeight = 90;
  const tableRowHeight = 38;
  const fontFamily = 'Poppins, Arial, sans-serif';

  const paramConfig = [
    { key: 'pH', label: 'pH', unit: '-' },
    { key: 'EC', label: 'Electrical Conductivity', unit: 'dS/m' },
    { key: 'OC', label: 'Organic Carbon', unit: '%' },
    { key: 'N', label: 'Nitrogen', unit: 'kg/ha' },
    { key: 'P', label: 'Phosphorus', unit: 'kg/ha' },
    { key: 'K', label: 'Potassium', unit: 'kg/ha' },
    { key: 'S', label: 'Sulphur', unit: 'mg/kg' },
    { key: 'Zn', label: 'Zinc', unit: 'mg/kg' },
    { key: 'Fe', label: 'Iron', unit: 'mg/kg' },
    { key: 'Mn', label: 'Manganese', unit: 'mg/kg' },
    { key: 'Cu', label: 'Copper', unit: 'mg/kg' },
    { key: 'B', label: 'Boron', unit: 'mg/kg' }
  ];

  const safe = (value) => String(value ?? '');
  const formatNumber = (value) => {
    const num = Number(value);
    if (!Number.isFinite(num)) return 'NA';
    return num.toFixed(2).replace(/\.?0+$/, '');
  };

  text.push(`<rect width="${pageWidth}" height="${totalHeight}" fill="#ffffff"/>`);
  text.push(`<rect x="0" y="0" width="${pageWidth}" height="${headerHeight}" fill="#1f2937"/>`);
  text.push(svgText(40, 62, 'Insoil STV Direct Report', {
    size: 28,
    weight: 700,
    fill: '#ffffff',
    family: fontFamily
  }));
  text.push(svgText(40, 104, `Report ID: ${safe(reportData.reportId)}`, {
    size: 14,
    fill: '#d1d5db',
    family: fontFamily
  }));
  text.push(svgText(40, 132, `Generated: ${safe(reportData.generatedAt || '—')}`, {
    size: 13,
    fill: '#d1d5db',
    family: fontFamily
  }));
  text.push(svgText(pageWidth - 40, 62, safe(reportData.farmerName || 'Client'), {
    size: 18,
    weight: 600,
    fill: '#ffffff',
    family: fontFamily,
    anchor: 'end'
  }));

  const summaryY = headerHeight + 30;
  const summaryTitles = ['Report', 'Client', 'Sampling'];
  const summaryValues = [
    reportData.reportId || 'STV-Direct',
    reportData.farmerName || '—',
    reportData.generatedAt || '—'
  ];
  summaryTitles.forEach((title, idx) => {
    const x = margin + idx * (columnWidth + columnGap);
    text.push(`<rect x="${x}" y="${summaryY}" width="${columnWidth}" height="${cardHeight}" rx="12" fill="#f8fafc" stroke="#e5e7eb"/>`);
    text.push(svgText(x + 18, summaryY + 30, title, {
      size: 12,
      fill: '#6b7280',
      family: fontFamily
    }));
    text.push(svgText(x + 18, summaryY + 60, safe(summaryValues[idx]), {
      size: 16,
      weight: 600,
      fill: '#111827',
      family: fontFamily
    }));
  });

  const gridStartY = summaryY + cardHeight + 36;
  text.push(svgText(margin, gridStartY - 14, 'Parameter Overview', {
    size: 16,
    weight: 700,
    fill: '#111827',
    family: fontFamily
  }));

  paramConfig.forEach((param, idx) => {
    const row = Math.floor(idx / 2);
    const col = idx % 2;
    const x = margin + col * (columnWidth + columnGap);
    const y = gridStartY + row * (cardHeight + 16);
    const value = formatNumber(reportData[param.key]);
    text.push(`<rect x="${x}" y="${y}" width="${columnWidth}" height="${cardHeight}" rx="14" fill="#f1f5f9" stroke="#e2e8f0"/>`);
    text.push(svgText(x + 18, y + 32, param.label, {
      size: 13,
      fill: '#334155',
      family: fontFamily
    }));
    text.push(svgText(x + 18, y + 62, `${value} ${param.unit}`, {
      size: 20,
      weight: 700,
      fill: '#0f172a',
      family: fontFamily
    }));
  });

  const tableStartY = pageHeight + 40;
  text.push(svgText(margin, tableStartY, 'Nutrient Details', {
    size: 18,
    weight: 700,
    fill: '#111827',
    family: fontFamily
  }));

  const tableY = tableStartY + 24;
  const tableWidth = pageWidth - margin * 2;
  const colWidths = [tableWidth * 0.4, tableWidth * 0.2, tableWidth * 0.2, tableWidth * 0.2];
  text.push(`<rect x="${margin}" y="${tableY}" width="${tableWidth}" height="${tableRowHeight}" fill="#1f2937"/>`);
  const tableHeaders = ['Parameter', 'Value', 'Unit', 'Notes'];
  let xCursor = margin;
  tableHeaders.forEach((header, idx) => {
    text.push(svgText(xCursor + 12, tableY + 24, header, {
      size: 12,
      weight: 600,
      fill: '#ffffff',
      family: fontFamily
    }));
    xCursor += colWidths[idx];
  });

  paramConfig.forEach((param, idx) => {
    const y = tableY + tableRowHeight + idx * tableRowHeight;
    const fill = idx % 2 === 0 ? '#f8fafc' : '#ffffff';
    text.push(`<rect x="${margin}" y="${y}" width="${tableWidth}" height="${tableRowHeight}" fill="${fill}" stroke="#e5e7eb"/>`);
    let colX = margin;
    text.push(svgText(colX + 12, y + 24, param.label, { size: 12, fill: '#0f172a', family: fontFamily }));
    colX += colWidths[0];
    text.push(svgText(colX + 12, y + 24, formatNumber(reportData[param.key]), { size: 12, fill: '#0f172a', family: fontFamily }));
    colX += colWidths[1];
    text.push(svgText(colX + 12, y + 24, param.unit, { size: 12, fill: '#475569', family: fontFamily }));
    colX += colWidths[2];
    text.push(svgText(colX + 12, y + 24, 'Measured', { size: 12, fill: '#475569', family: fontFamily }));
  });

  const recStartY = pageHeight * 2 + 40;
  text.push(svgText(margin, recStartY, 'Recommendations', {
    size: 18,
    weight: 700,
    fill: '#111827',
    family: fontFamily
  }));
  const recLines = [
    'Review nutrient balance and align fertiliser inputs with crop targets.',
    'Monitor salinity (EC) and organic carbon to maintain soil structure.',
    'Re-sample after major amendments to track changes in fertility.'
  ];
  recLines.forEach((line, idx) => {
    text.push(svgText(margin + 10, recStartY + 32 + idx * 24, `• ${line}`, {
      size: 12.5,
      fill: '#334155',
      family: fontFamily
    }));
  });

  const observationY = recStartY + 120;
  text.push(svgText(margin, observationY, 'Key Observations', {
    size: 16,
    weight: 600,
    fill: '#111827',
    family: fontFamily
  }));
  const observationLines = [
    `pH: ${formatNumber(reportData.pH)} | EC: ${formatNumber(reportData.EC)} dS/m`,
    `Organic Carbon: ${formatNumber(reportData.OC)} %`,
    `Macro nutrients - N: ${formatNumber(reportData.N)}, P: ${formatNumber(reportData.P)}, K: ${formatNumber(reportData.K)} (kg/ha)`
  ];
  observationLines.forEach((line, idx) => {
    text.push(svgText(margin, observationY + 26 + idx * 22, line, {
      size: 12.5,
      fill: '#475569',
      family: fontFamily
    }));
  });

  const notesStartY = pageHeight * 3 + 40;
  text.push(svgText(margin, notesStartY, 'Method Notes & Glossary', {
    size: 18,
    weight: 700,
    fill: '#111827',
    family: fontFamily
  }));
  const notesText = [
    'Results are reported as received from the STV Direct sensor suite.',
    'Values are indicative and should be interpreted alongside local agronomy guidance.',
    'Units: dS/m (electrical conductivity), kg/ha (nutrient load), mg/kg (trace elements).'
  ];
  notesText.forEach((line, idx) => {
    text.push(svgText(margin, notesStartY + 30 + idx * 22, line, {
      size: 12.5,
      fill: '#475569',
      family: fontFamily
    }));
  });

  text.push(svgText(margin, totalHeight - 40, `Generated ${safe(new Date().toLocaleString())}`, {
    size: 11,
    fill: '#94a3b8',
    family: fontFamily
  }));
  text.push(svgText(pageWidth - margin, totalHeight - 40, 'Insoil • STV Direct', {
    size: 11,
    fill: '#94a3b8',
    family: fontFamily,
    anchor: 'end'
  }));

  return text.join('\n');
}

function buildStvDirectSvgPrintHtml(svgContent, pageWidth, pageHeight) {
  const pages = Array.from({ length: 4 }, (_, idx) => {
    const viewBoxY = idx * pageHeight;
    return `
      <div class="page">
        <svg xmlns="http://www.w3.org/2000/svg" width="${pageWidth}" height="${pageHeight}" viewBox="0 ${viewBoxY} ${pageWidth} ${pageHeight}">
          <g>${svgContent}</g>
        </svg>
      </div>`;
  }).join('');

  return `
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>STV Direct SVG Print</title>
    <style>
      @page { size: A4; margin: 0; }
      body { margin: 0; background: #cbd5f5; }
      .page {
        width: ${pageWidth}px;
        height: ${pageHeight}px;
        margin: 16px auto;
        background: #ffffff;
        box-shadow: 0 10px 25px rgba(15,23,42,0.15);
        display: flex;
        align-items: center;
        justify-content: center;
        page-break-after: always;
      }
      .page:last-child { page-break-after: auto; }
      svg { display: block; }
      @media print {
        body { background: #ffffff; }
        .page { margin: 0; box-shadow: none; }
      }
    </style>
  </head>
  <body>${pages}</body>
</html>`.trim();
}

function svgText(x, y, content, options = {}) {
  const fill = options.fill || '#111827';
  const size = options.size || 12;
  const weight = options.weight || 400;
  const family = options.family || 'Arial, sans-serif';
  const anchor = options.anchor || 'start';
  return `<text x="${x}" y="${y}" fill="${fill}" font-size="${size}" font-weight="${weight}" font-family="${family}" text-anchor="${anchor}">${stvDirectEscapeSvg(content)}</text>`;
}

function stvDirectEscapeSvg(value) {
  return String(value)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

function ensureSTVDirectExportLibs() {
  if (!window.JSZip) {
    alert('Bulk export requires JSZip to be loaded.');
    return false;
  }
  if (!window.html2canvas) {
    alert('PDF export requires html2canvas to be loaded.');
    return false;
  }
  if (!(window.jspdf && window.jspdf.jsPDF) && !window.jsPDF) {
    alert('PDF export requires jsPDF to be loaded.');
    return false;
  }
  return true;
}

function downloadBlobFile(filename, blob) {
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  setTimeout(() => {
    URL.revokeObjectURL(url);
    a.remove();
  }, 0);
}

function mapSTVDirectReportRow(row) {
  const toNumber = (value) => {
    const num = Number(String(value ?? '').trim());
    return Number.isFinite(num) ? num : null;
  };
  return {
    reportId: row.Test_ID || row.Device_ID || 'STV-Direct',
    generatedAt: row.Date || '',
    farmerName: row.ClientID || '',
    pH: toNumber(row.pH),
    EC: toNumber(row.EC),
    OC: toNumber(row.OC),
    N: toNumber(row.Avail_N),
    P: toNumber(row.Avail_P),
    K: toNumber(row.Avail_K),
    S: toNumber(row.Avail_S),
    Zn: toNumber(row.Zn),
    Fe: toNumber(row.Fe),
    Mn: toNumber(row.Mn),
    Cu: toNumber(row.Cu),
    B: toNumber(row.B)
  };
}

function getStvDirectReportTemplate() {
  return `
  <div class="stv-direct-report">
    <style>
      :root{
        --bg: #f6f7fb;
        --card: #ffffff;
        --ink: #111827;
        --muted: #6b7280;
        --line: #e5e7eb;
        --brand: #2f6b3a;
        --cream: #f3f4ee;
        --shadow: 0 10px 25px rgba(17,24,39,.08);
        --seg1: #ff6b6b;
        --seg2: #ffa26b;
        --seg3: #ffd36b;
        --seg4: #cfe97b;
        --seg5: #8ed16f;
        --seg6: #6fa35c;
      }
      .stv-direct-report {
        background: var(--bg);
        color: var(--ink);
        font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        width: 980px;
      }
      .stv-direct-report *{ box-sizing:border-box; }
      .stv-direct-report .sheet{
        background: #fff;
        border-radius: 18px;
        box-shadow: var(--shadow);
        overflow: hidden;
        margin-bottom: 18px;
        border: 1px solid rgba(229,231,235,.6);
      }
      .stv-direct-report .hero{
        position: relative;
        height: 170px;
        background: #2b2b2b;
        color:#fff;
        overflow:hidden;
      }
      .stv-direct-report .hero::before{
        content:"";
        position:absolute; inset:0;
        background-image: var(--hero-bg);
        background-size: cover;
        background-position: center;
        filter: saturate(1.05) contrast(1.05);
        transform: scale(1.02);
      }
      .stv-direct-report .hero::after{
        content:"";
        position:absolute; inset:0;
        background: linear-gradient(90deg, rgba(0,0,0,.55), rgba(0,0,0,.20) 55%, rgba(0,0,0,.25));
      }
      .stv-direct-report .hero-inner{
        position: relative;
        padding: 18px 22px;
        display:flex;
        align-items:flex-start;
        justify-content: space-between;
        gap: 16px;
      }
      .stv-direct-report .brand-lockup{ display:flex; flex-direction:column; gap: 6px; margin-top: 6px; }
      .stv-direct-report .logo-row{ display:flex; align-items:flex-end; gap:10px; }
      .stv-direct-report .logo{ height: 34px; width: auto; display:block; filter: drop-shadow(0 8px 12px rgba(0,0,0,.25)); }
      .stv-direct-report .powered{ font-size: 12px; opacity: .9; margin-left: 2px; line-height: 1.1; }
      .stv-direct-report .hero-title{ font-weight: 600; font-size: 16px; margin-top: 12px; opacity: .95; display:flex; align-items:center; gap:10px; }
      .stv-direct-report .sprout{ width: 28px; height: 28px; border-radius: 50%; background: rgba(255,255,255,.12); display:grid; place-items:center; border: 1px solid rgba(255,255,255,.18); }
      .stv-direct-report .top-strip{
        position: relative;
        margin: -22px 18px 10px;
        background: rgba(255,255,255,.95);
        border: 1px solid rgba(229,231,235,.9);
        border-radius: 12px;
        padding: 12px 14px;
        display:grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 12px;
        box-shadow: 0 10px 18px rgba(0,0,0,.10);
      }
      .stv-direct-report .kv{ display:flex; flex-direction:column; gap: 3px; }
      .stv-direct-report .k{ font-size: 11px; color: var(--muted); letter-spacing: .2px; }
      .stv-direct-report .v{ font-size: 14px; font-weight: 600; color: var(--ink); }
      .stv-direct-report .section{ padding: 8px 18px 14px; }
      .stv-direct-report .section-head{
        display:grid;
        grid-template-columns: 240px 1fr 290px;
        align-items:end;
        gap: 12px;
        margin-top: 8px;
        margin-bottom: 6px;
      }
      .stv-direct-report .h-left{ font-weight: 700; color: #1f2937; font-size: 14px; line-height: 1.1; }
      .stv-direct-report .h-mid, .stv-direct-report .h-right{
        font-size: 11px; color: var(--muted);
        display:flex; align-items:center; gap:6px;
      }
      .stv-direct-report .legend-ideal{ width: 24px; height: 4px; border-radius: 4px; background: var(--seg3); display:inline-block; }
      .stv-direct-report .param-row{
        display:grid;
        grid-template-columns: 240px 1fr 290px;
        gap: 12px;
        align-items: stretch;
        margin: 10px 0;
      }
      .stv-direct-report .tile{
        background: var(--cream);
        border: 1px solid rgba(229,231,235,.85);
        border-radius: 12px;
        padding: 12px 12px;
        display:flex;
        flex-direction:column;
        gap: 6px;
        min-height: 86px;
      }
      .stv-direct-report .tile .pcode{ font-weight: 800; font-size: 14px; color: #111827; display:flex; align-items:baseline; gap:8px; }
      .stv-direct-report .tile .unit{ font-size: 11px; color: var(--muted); font-weight: 600; }
      .stv-direct-report .tile .pname{ font-size: 12px; color: #374151; font-weight: 500; margin-top: -2px; }
      .stv-direct-report .card{
        background: var(--card);
        border: 1px solid rgba(229,231,235,.9);
        border-radius: 12px;
        padding: 12px 12px;
        min-height: 86px;
      }
      .stv-direct-report .mid{
        display:grid;
        grid-template-columns: 42px 1fr;
        gap: 10px;
        align-items:center;
      }
      .stv-direct-report .icon{
        width: 34px; height: 34px;
        border-radius: 50%;
        background: rgba(47,107,58,.10);
        border: 1px solid rgba(47,107,58,.18);
        display:grid; place-items:center;
        font-size: 16px;
        color: var(--brand);
        user-select:none;
      }
      .stv-direct-report .value-line{
        display:flex;
        align-items:baseline;
        gap: 10px;
        margin-bottom: 10px;
      }
      .stv-direct-report .val{ font-size: 26px; font-weight: 800; color: #111827; line-height:1; }
      .stv-direct-report .rating{ font-size: 14px; font-weight: 600; color: #111827; opacity: .92; }
      .stv-direct-report .bar-wrap{ position: relative; margin-top: 2px; }
      .stv-direct-report .bar-cont{
        height: 8px;
        border-radius: 999px;
        background: linear-gradient(90deg,var(--seg1) 0%,var(--seg2) 20%,var(--seg3) 40%,var(--seg4) 60%,var(--seg5) 80%,var(--seg6) 100%);
        border: 1px solid rgba(229,231,235,.8);
        overflow:hidden;
      }
      .stv-direct-report .marker{
        position:absolute;
        top: -6px;
        width: 4px;
        height: 22px;
        background: #111827;
        border-radius: 3px;
        transform: translateX(-2px);
        box-shadow: 0 2px 8px rgba(0,0,0,.18);
        pointer-events: none;
      }
      .stv-direct-report .ticks{
        margin-top: 8px;
        display:flex;
        justify-content: space-between;
        font-size: 12px;
        font-weight: 600;
        color: #4b5563;
        white-space: nowrap;
      }
      .stv-direct-report .explain{
        font-size: 12px;
        color: #374151;
        line-height: 1.35;
        display:flex;
        flex-direction:column;
        justify-content:center;
      }
      .stv-direct-report .subhead{ margin-top: 14px; font-weight: 700; font-size: 13px; color: #1f2937; }
      .stv-direct-report .muted{ color: var(--muted); }
      .stv-direct-report .rec-card{
        border: 1px solid rgba(229,231,235,.9);
        border-radius: 12px;
        background: #fff;
        margin: 12px 0;
        overflow: hidden;
      }
      .stv-direct-report .rec-head{
        display:flex;
        align-items:center;
        justify-content: space-between;
        padding: 10px 12px;
        background: rgba(243,244,238,.7);
        border-bottom: 1px solid var(--line);
        gap: 12px;
      }
      .stv-direct-report .rec-head h3{
        margin: 0;
        font-size: 12px;
        font-weight: 700;
        color: #111827;
      }
      .stv-direct-report .rec-head .sub{
        font-size: 11px;
        color: var(--muted);
        font-weight: 600;
      }
      .stv-direct-report .rec-note{
        padding: 10px 12px;
        font-size: 12px;
        color: #374151;
        border-bottom: 1px solid var(--line);
      }
      .stv-direct-report .note-block{ padding: 10px 18px 16px; border-top: 1px solid rgba(229,231,235,.7); }
      .stv-direct-report .bullet{ font-size: 12px; color: #374151; line-height: 1.55; margin: 0; padding-left: 16px; }
      .stv-direct-report .bullet li{ margin: 4px 0; }
      .stv-direct-report .recap{ padding: 14px 18px 4px; }
      .stv-direct-report .recap h2{ margin:0 0 6px; font-size: 14px; font-weight: 800; color:#111827; }
      .stv-direct-report .alert{ font-size: 12px; color: #374151; margin: 8px 0 10px; }
      .stv-direct-report table{ width:100%; border-collapse: separate; border-spacing: 0; overflow:hidden; border-radius: 12px; border: 1px solid rgba(229,231,235,.9); background:#fff; }
      .stv-direct-report thead th{ background: #2b1f1a; color:#fff; font-size: 12px; font-weight: 700; padding: 10px 10px; text-align:left; border-right: 1px solid rgba(255,255,255,.15); }
      .stv-direct-report thead th:last-child{ border-right: none; }
      .stv-direct-report tbody td{ font-size: 12px; color:#111827; padding: 10px 10px; vertical-align: top; border-top: 1px solid rgba(229,231,235,.9); border-right: 1px solid rgba(229,231,235,.9); background:#fff; }
      .stv-direct-report tbody td:last-child{ border-right:none; }
      .stv-direct-report .daycell{ width: 190px; font-weight: 700; color:#111827; }
      .stv-direct-report .daybox{ display:flex; align-items:center; gap: 10px; }
      .stv-direct-report .dayicon{
        width: 34px; height: 34px;
        border-radius: 50%;
        border: 1px solid rgba(47,107,58,.25);
        background: rgba(47,107,58,.08);
        display:grid; place-items:center;
        color: var(--brand);
        font-weight: 900;
        user-select:none;
      }
      .stv-direct-report .footer{ padding: 10px 18px 14px; border-top: 1px solid rgba(229,231,235,.9); }
      .stv-direct-report .disclaimer{ font-size: 10.5px; color: #374151; line-height: 1.35; }
      .stv-direct-report .hr{ height:1px; background: rgba(17,24,39,.55); margin: 18px 18px 0; opacity: .5; }
      @media (max-width: 1040px){
        .stv-direct-report{ width: 100%; }
        .stv-direct-report .sheet{ border-radius: 0; }
      }
      @media (max-width: 860px){
        .stv-direct-report .section-head, .stv-direct-report .param-row{ grid-template-columns: 1fr; }
        .stv-direct-report .top-strip{ grid-template-columns: 1fr; }
      }
    </style>
    <div class="page">
      <div class="sheet" id="page1">
        <div class="hero" id="hero">
          <div class="hero-inner">
            <div class="brand-lockup">
              <div class="logo-row">
                <img class="logo" id="logo" alt="Insoil logo" />
                <div class="powered">Powered by<br><b>upaj</b></div>
              </div>
            </div>
            <div class="hero-title">
              <div class="sprout">🌱</div>
              <div>Soil Analysis Report</div>
            </div>
          </div>
        </div>
        <div class="top-strip" id="topStrip"></div>
        <div class="section">
          <div class="section-head">
            <div class="h-left">Physico-chemical<br>properties</div>
            <div class="h-mid">Result Value (<span class="legend-ideal"></span> Ideal Range)</div>
            <div class="h-right">What It Means? <span class="muted">|</span> Function</div>
          </div>
          <div id="physchem"></div>
          <div class="subhead">Macronutrients</div>
          <div id="macro"></div>
        </div>
        <div class="hr"></div>
        <div class="footer">
          <div class="disclaimer" id="disclaimer1"></div>
        </div>
      </div>
      <div class="sheet pb" id="page2">
        <div class="section">
          <div class="section-head" style="margin-top:14px;">
            <div class="h-left">Micronutrients</div>
            <div class="h-mid">Result Value (<span class="legend-ideal"></span> Ideal Range)</div>
            <div class="h-right">What It Means? <span class="muted">|</span> Function</div>
          </div>
          <div id="micro"></div>
        </div>
        <div class="note-block">
          <div class="subhead" style="margin-top:0;">Testing Methodology</div>
          <ol class="bullet" id="methodology"></ol>
          <div class="subhead">Source/References</div>
          <div class="muted" style="font-size:12px; line-height:1.55;" id="sources"></div>
          <div class="muted" style="font-size:12px; margin-top:8px;" id="note2"></div>
        </div>
        <div class="hr"></div>
        <div class="footer">
          <div class="disclaimer" id="disclaimer2"></div>
        </div>
      </div>
      <div class="sheet pb" id="page3">
        <div class="recap">
          <div class="muted" style="font-size:12px; margin-bottom:6px;" id="note3"></div>
          <h2 id="recTitle"></h2>
          <p class="alert" id="ecAdvice"></p>
        </div>
        <div class="section" style="padding-top:0;">
          <div class="subhead" style="margin-top:6px;">Option 1 - Chemicals Fertilizers Recommendation</div>
          <div id="opt1"></div>
        </div>
        <div class="hr"></div>
        <div class="footer">
          <div class="disclaimer" id="disclaimer3"></div>
        </div>
      </div>
      <div class="sheet pb" id="page4">
        <div class="section" style="padding-top:16px;">
          <div class="subhead" style="margin-top:0;">Option 2 - Bio-Fertilizers with Chemical Fertilizers Recommendation</div>
          <div id="opt2"></div>
        </div>
        <div class="hr"></div>
        <div class="footer">
          <div class="disclaimer" id="disclaimer4"></div>
        </div>
      </div>
    </div>
  </div>
  `;
}

function applySoilRowToContainer(container, row) {
  const safeText = (value, fallback = '—') => {
    if (value == null) return fallback;
    const text = String(value).trim();
    return text ? text : fallback;
  };
  const formatNumber = (value, dp) => {
    const num = Number(value);
    if (!Number.isFinite(num)) return 'NA';
    return Number.isFinite(dp) ? num.toFixed(dp) : String(num);
  };
  const reportId = safeText(row.reportId);
  const generatedAt = safeText(row.generatedAt || row.reportDt);
  const farmerName = safeText(row.farmerName);

  const logoEl = container.querySelector('#logo');
  const appLogoEl = document.querySelector('.logo-img');
  if (logoEl && appLogoEl && appLogoEl.getAttribute('src')) {
    logoEl.src = appLogoEl.getAttribute('src');
  }

  const topStrip = container.querySelector('#topStrip');
  if (topStrip) {
    const buildKv = (label, value) => `
      <div class="kv">
        <div class="k">${label}</div>
        <div class="v">${value}</div>
      </div>
    `;
    topStrip.innerHTML = [
      buildKv('Report ID', reportId),
      buildKv('Report Generation Date & Time', generatedAt),
      buildKv('Name', farmerName)
    ].join('');
  }

  const microLabels = {
    Cu: ['Acute Deficient', 'Deficient', 'Latent Deficient', 'Marginal Sufficient', 'High', 'Very High'],
    Fe: ['Acute Deficient', 'Deficient', 'Latent Deficient', 'Marginal Sufficient', 'High', 'Very High'],
    Zn: ['Acute Deficient', 'Deficient', 'Latent Deficient', 'Marginal Sufficient', 'High', 'Very High'],
    Mn: ['Acute Deficient', 'Deficient', 'Latent Deficient', 'Marginal Sufficient', 'High', 'Very High'],
    B: ['Acute Deficient', 'Deficient', 'Latent Deficient', 'Marginal Sufficient', 'High', 'Very High']
  };
  const microTickLabels = {
    B: ['≤ 0.2', '0.2 – 0.4', '0.4 – 0.6', '0.6 – 0.8', '0.8 – 1.0', '> 1.0', ''],
    Cu: ['≤ 0.2', '0.2 – 0.4', '0.4 – 0.6', '0.6 – 0.8', '0.8 – 1.0', '> 1.0', ''],
    Fe: ['≤ 2.5', '2.5 – 4.5', '4.5 – 6.5', '6.5 – 8.5', '8.5 – 10.5', '> 10.5', ''],
    Mn: ['≤ 1.0', '1.0 – 3.0', '3.0 – 5.0', '5.0 – 7.0', '7.0 – 9.0', '> 9.0', ''],
    Zn: ['≤ 0.3', '0.3 – 0.6', '0.6 – 0.9', '0.9 – 1.2', '1.2 – 1.5', '> 1.5', '']
  };

  const paramDefs = {
    physchem: [
      {
        key: 'pH',
        code: 'pH',
        unit: '',
        name: 'Soil Reaction',
        icon: '🧪',
        type: 'cuts',
        min: 0,
        max: 10,
        cut1: 6.5,
        cut2: 7.5,
        dp: 2,
        meaning: 'pH affects nutrient absorption and promotes healthy root growth.'
      },
      {
        key: 'EC',
        code: 'EC',
        unit: 'dS/m',
        name: 'Salinity',
        icon: '💧',
        type: 'cuts',
        min: 0,
        max: 1.5,
        cut1: 0.5,
        cut2: 1.0,
        dp: 2,
        meaning: 'EC influences water and nutrient uptake, affecting growth and quality.'
      },
      {
        key: 'OC',
        code: 'OC',
        unit: 'w%',
        name: 'Organic Carbon',
        icon: '🌱',
        type: 'cuts',
        min: 0,
        max: 1.2,
        cut1: 0.5,
        cut2: 0.75,
        dp: 2,
        meaning: 'Organic carbon enriches soil, supports organisms, and improves fruit development.'
      }
    ],
    macro: [
      {
        key: 'N',
        code: 'N',
        unit: 'kg/ha',
        name: 'Available Nitrogen',
        icon: '🌿',
        type: 'cuts',
        min: 0,
        max: 800,
        cut1: 240,
        cut2: 480,
        cut1Label: 280,
        cut2Label: 560,
        dp: 0,
        meaning: 'Nitrogen promotes growth, photosynthesis, fruit size and vigor.'
      },
      {
        key: 'P',
        code: 'P',
        unit: 'kg/ha',
        name: 'Available Phosphorus',
        icon: '🌸',
        type: 'cuts',
        min: 0,
        max: 260,
        cut1: 11,
        cut2: 22,
        cut1Label: 12,
        cut2Label: 24,
        dp: 0,
        meaning: 'Phosphorus supports root and flower development, improving fruit quality.'
      },
      {
        key: 'K',
        code: 'K',
        unit: 'kg/ha',
        name: 'Available Potassium',
        icon: '🍃',
        type: 'cuts',
        min: 0,
        max: 400,
        cut1: 110,
        cut2: 280,
        cut1Label: 116,
        cut2Label: 234,
        dp: 0,
        meaning: 'Potassium regulates water usage, enhances disease resistance, and improves fruit.'
      },
      {
        key: 'S',
        code: 'S',
        unit: 'mg/kg',
        name: 'Available Sulphur',
        icon: '⚡',
        type: 'cuts',
        min: 0,
        max: 40,
        cut1: 10,
        cut2: 20,
        dp: 1,
        meaning: 'Sulphur contributes to amino acid production, photosynthesis, and enhances oil synthesis.'
      }
    ],
    micro: [
      {
        key: 'Cu',
        code: 'Cu',
        unit: 'mg/kg',
        name: 'Available Copper',
        icon: '🧲',
        type: 'bands',
        bands: [0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.01],
        dp: 1,
        meaning: 'Copper aids enzyme activity and influences pollen formation & fertilization.'
      },
      {
        key: 'Fe',
        code: 'Fe',
        unit: 'mg/kg',
        name: 'Available Iron',
        icon: '🩸',
        type: 'bands',
        bands: [0, 2.5, 4.5, 6.5, 8.5, 10.5, 10.51],
        dp: 1,
        meaning: 'Iron ensures healthy green leaves and improves photosynthesis and growth.'
      },
      {
        key: 'Zn',
        code: 'Zn',
        unit: 'mg/kg',
        name: 'Available Zinc',
        icon: '⚙️',
        type: 'bands',
        bands: [0, 0.3, 0.6, 0.9, 1.2, 1.5, 1.51],
        dp: 2,
        meaning: 'Zinc supports hormone production, growth, fruit development and yield.'
      },
      {
        key: 'Mn',
        code: 'Mn',
        unit: 'mg/kg',
        name: 'Available Manganese',
        icon: '🧪',
        type: 'bands',
        bands: [0, 1.0, 3.0, 5.0, 7.0, 9.0, 9.01],
        dp: 2,
        meaning: 'Manganese aids photosynthesis, nutrient absorption, and in the movement of iron.'
      },
      {
        key: 'B',
        code: 'B',
        unit: 'mg/kg',
        name: 'Available Boron',
        icon: '🌼',
        type: 'bands',
        bands: [0, 0.2, 0.4, 0.6, 0.8, 1.0, 1.01],
        dp: 2,
        meaning: 'Boron enhances pollen formation, pollen tube growth and flowering.'
      }
    ]
  };

  const buildParamRow = (def) => {
    const value = row[def.key];
    const valueText = formatNumber(value, def.dp);
    const ratingText = def.type === 'bands'
      ? ratingFromBands(value, def.bands, microLabels[def.key] || [])
      : ratingFromCuts(value, def.cut1, def.cut2, def.key === 'pH' ? ['Acidic', 'Neutral', 'Alkaline'] : ['Low', 'Medium', 'High']);
    const markerLeft = def.type === 'bands'
      ? markerPct(def.bands[0], def.bands[def.bands.length - 1], value)
      : markerPct(def.min, def.max, value);
    const tickLabels = def.type === 'bands'
      ? (microTickLabels[def.key] || [])
      : [def.min, def.cut1Label ?? def.cut1, def.cut2Label ?? def.cut2, def.max];

    const rowEl = document.createElement('div');
    rowEl.className = 'param-row';

    const tile = document.createElement('div');
    tile.className = 'tile';
    const pcode = document.createElement('div');
    pcode.className = 'pcode';
    pcode.textContent = def.code;
    if (def.unit) {
      const unitEl = document.createElement('span');
      unitEl.className = 'unit';
      unitEl.textContent = def.unit;
      pcode.appendChild(unitEl);
    }
    const pname = document.createElement('div');
    pname.className = 'pname';
    pname.textContent = def.name;
    tile.appendChild(pcode);
    tile.appendChild(pname);

    const card = document.createElement('div');
    card.className = 'card';
    const mid = document.createElement('div');
    mid.className = 'mid';
    const icon = document.createElement('div');
    icon.className = 'icon';
    icon.textContent = def.icon;
    const midContent = document.createElement('div');
    const valueLine = document.createElement('div');
    valueLine.className = 'value-line';
    const valEl = document.createElement('div');
    valEl.className = 'val';
    valEl.textContent = valueText;
    const ratingEl = document.createElement('div');
    ratingEl.className = 'rating';
    ratingEl.textContent = ratingText;
    valueLine.appendChild(valEl);
    valueLine.appendChild(ratingEl);
    const barWrap = document.createElement('div');
    barWrap.className = 'bar-wrap';
    const barCont = document.createElement('div');
    barCont.className = 'bar-cont';
    const marker = document.createElement('div');
    marker.className = 'marker';
    marker.style.left = markerLeft;
    barWrap.appendChild(barCont);
    barWrap.appendChild(marker);
    const ticks = document.createElement('div');
    ticks.className = 'ticks';
    tickLabels.forEach(label => {
      const tick = document.createElement('span');
      if (label == null) return;
      tick.textContent = typeof label === 'number' ? formatNumber(label, def.dp) : String(label);
      ticks.appendChild(tick);
    });
    midContent.appendChild(valueLine);
    midContent.appendChild(barWrap);
    if (tickLabels.length) {
      midContent.appendChild(ticks);
    }
    mid.appendChild(icon);
    mid.appendChild(midContent);
    card.appendChild(mid);

    const explain = document.createElement('div');
    explain.className = 'card explain';
    const explainTitle = document.createElement('div');
    explainTitle.className = 'rating';
    explainTitle.textContent = 'What It Means?';
    const explainText = document.createElement('div');
    explainText.textContent = def.meaning;
    explain.appendChild(explainTitle);
    explain.appendChild(explainText);

    rowEl.appendChild(tile);
    rowEl.appendChild(card);
    rowEl.appendChild(explain);
    return rowEl;
  };

  const applySection = (sectionId, defs) => {
    const section = container.querySelector(sectionId);
    if (!section) return;
    section.innerHTML = '';
    defs.forEach(def => section.appendChild(buildParamRow(def)));
  };

  applySection('#physchem', paramDefs.physchem);
  applySection('#macro', paramDefs.macro);
  applySection('#micro', paramDefs.micro);

  const methodologyEl = container.querySelector('#methodology');
  if (methodologyEl) {
    const items = [
      'Soil Sample Preparation is conducted using Chemical Extraction Methods.',
      'Macro and micro-nutrient parameters testing is conducted using Multiple-Photo spectrometry.'
    ];
    methodologyEl.innerHTML = '';
    items.forEach(item => {
      const li = document.createElement('li');
      li.textContent = item;
      methodologyEl.appendChild(li);
    });
  }

  const sourcesEl = container.querySelector('#sources');
  if (sourcesEl) {
    sourcesEl.textContent =
      'Fertilizer recommendations and their respective dosages are derived from Govt sources such as ICAR bodies/State Agriculture Universities/KVK and Agriculture departments.';
  }
  const note2El = container.querySelector('#note2');
  if (note2El) {
    note2El.textContent =
      'Note - Report users may peruse either chemical fertilizer recommendation (Option 1) or biofertilizer with chemical fertilizer recommendation (Option 2) as per their discretion';
  }

  const note3El = container.querySelector('#note3');
  if (note3El) {
    note3El.textContent =
      'Note: Report users may follow either chemical fertilizer recommendation (Option 1) or biofertilizer with chemical fertilizer recommendation (Option 2) as per their discretion.';
  }
  const recTitleEl = container.querySelector('#recTitle');
  if (recTitleEl) {
    recTitleEl.textContent = `Recommendation for 1 Acre Potato farm - Report ID - ${reportId}`;
  }
  const ecAdviceEl = container.querySelector('#ecAdvice');
  if (ecAdviceEl) {
    ecAdviceEl.textContent =
      'For High Electrical Conductivity (EC) - Use low EC water for irrigation. Improve drainage by creating slope, channels, to redirect excess water away from field.';
  }

  const opt1El = container.querySelector('#opt1');
  if (opt1El) {
    opt1El.innerHTML = `
      <div class="rec-card">
        <div class="rec-head">
          <div>
            <h3>Option 1 - Chemicals Fertilizers Recommendation</h3>
            <div class="sub">Dose Schedule</div>
          </div>
          <div class="sub"> </div>
        </div>
        <div class="rec-note">
          For High Electrical Conductivity (EC) - Use low EC water for irrigation. Improve drainage by creating slope, channels, to redirect excess water away from field.
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:190px;">Days</th>
              <th style="width:150px;">Nutrient</th>
              <th>Fertilizer</th>
              <th>Dose Rate</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="td-day" rowspan="3">0 day at land preparation</td>
              <td><strong>Soil Conditioner</strong></td>
              <td>FYM</td>
              <td>Ton/Acre</td>
            </tr>
            <tr>
              <td><strong>Macronutrient</strong></td>
              <td>00:16:00 (SSP)<br>46:00:00 (Urea)<br>00:00:60 (MOP)</td>
              <td>Reduce 25% extra Phosphorus from Recommended dose of fertilzer<br>Recommended dose of fertilizer<br>Recommended dose of fertilizer</td>
            </tr>
            <tr>
              <td><strong>Micronutrient</strong></td>
              <td>Zinc Sulphate<br>Ferrous Sulphate<br>Copper Sulphate<br>Manganese Sulphate<br>Borax</td>
              <td>
                1.28 Kg/acre Zinc Sulphate hepta hydrate each year<br>
                1 Kg/acre for each crop<br>
                20 Kg/acre for each crop<br>
                2 Kg/acre for each crop
              </td>
            </tr>
            <tr>
              <td class="td-day" rowspan="2">30 days after sowing / transplanting</td>
              <td><strong>Macronutrient</strong></td>
              <td>46:00:00 (Urea)</td>
              <td>Recommended dose of fertilizer</td>
            </tr>
            <tr>
              <td><strong>Micronutrient</strong></td>
              <td>Ferrous Sulphate<br>Copper Sulphate<br>Manganese Sulphate</td>
              <td>Foliar spray 1-2 grams/litre<br>Foliar spray 2-2.5 grams/litre</td>
            </tr>
            <tr>
              <td class="td-day">45 days after sowing / transplanting</td>
              <td><strong>Micronutrient</strong></td>
              <td>Ferrous Sulphate<br>Manganese Sulphate<br>Borax</td>
              <td>Foliar spray 2-2.5 grams/litre</td>
            </tr>
            <tr>
              <td class="td-day" rowspan="2">60 days after sowing / transplanting</td>
              <td><strong>Macronutrient</strong></td>
              <td>46:00:00 (Urea)<br>00:00:60 (MOP)</td>
              <td>Recommended dose of fertilizer<br>Recommended dose of fertilizer</td>
            </tr>
            <tr>
              <td><strong>Micronutrient</strong></td>
              <td>Ferrous Sulphate<br>Manganese Sulphate<br>Borax</td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="rec-card">
        <div class="rec-head">
          <div>
            <h3>Option 1 - Micronutrient Recommendations (Category-wise)</h3>
            <div class="sub">Copper (Cu)</div>
          </div>
          <div class="sub">Dose Schedule</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:190px;">Category</th>
              <th>At Basal/ Day 0</th>
              <th>Day 30</th>
              <th>Day 45</th>
              <th>Day 60</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="td-day">Acute deficient</td>
              <td>4 kg/acre</td>
              <td>Foliar sprays of 5 Gram/Litre CuSO4</td>
              <td>Foliar sprays of 5 Gram/Litre CuSO4</td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Deficient</td>
              <td>2 kg/acre</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Latent deficient</td>
              <td>1 kg/acre</td>
              <td>Foliar sprays of 1 - 2 Gram/Litre CuSO4.</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Marginal sufficient</td>
              <td></td>
              <td>Foliar sprays of 1 - 2 Gram/Litre CuSO4.</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">High</td>
              <td>No need to apply any copper fertilizer</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Very high</td>
              <td>No need to apply any copper fertilizer</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
        <div class="rec-head" style="border-top:1px solid var(--line);">
          <div>
            <h3 style="margin-top:12px;">Option 1 - Micronutrient Recommendations (Category-wise)</h3>
            <div class="sub">Zinc (Zn)</div>
          </div>
          <div class="sub">Dose Schedule</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:190px;">Category</th>
              <th>At Basal/ Day 0</th>
              <th>Day 30</th>
              <th>Day 45</th>
              <th>Day 60</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="td-day">Acute deficient</td>
              <td>14.5 kg/acre Zinc sulphate hepta hydrate each year</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Deficient</td>
              <td>5.5 kg/acre Zinc sulphate hepta hydrate each year</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Latent deficient</td>
              <td>4.6 kg/acre Zinc sulphate hepta hydrate each year</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Marginally sufficient</td>
              <td>3.8 kg/acre Zinc sulphate hepta hydrate each year</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">High</td>
              <td>1.28 kg/acre Zinc sulphate hepta hydrate per year</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Very high</td>
              <td>No need of application of zinc fertilizer</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
        <div class="rec-head" style="border-top:1px solid var(--line);">
          <div>
            <h3 style="margin-top:12px;">Option 1 - Micronutrient Recommendations (Category-wise)</h3>
            <div class="sub">Iron (Fe)</div>
          </div>
          <div class="sub">Dose Schedule</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:190px;">Category</th>
              <th>At Basal/ Day 0</th>
              <th>Day 30</th>
              <th>Day 45</th>
              <th>Day 60</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="td-day">Acute deficient</td>
              <td>20 kg/acre FeSO4 (Ferrous Sulphate) for each crop.</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
            </tr>
            <tr>
              <td class="td-day">Deficient</td>
              <td>20 kg/acre FeSO4 (Ferrous Sulphate) for each crop.</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Latent deficient</td>
              <td></td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
            </tr>
            <tr>
              <td class="td-day">Marginal sufficient</td>
              <td></td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td>Foliar sprays of 10 Gram/Litre FeSO4 (Ferrous Sulphate)</td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">High</td>
              <td>No need to apply any iron fertilizer.</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Very high</td>
              <td>No need to apply any iron fertilizer.</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
        <div class="rec-head" style="border-top:1px solid var(--line);">
          <div>
            <h3 style="margin-top:12px;">Option 1 - Micronutrient Recommendations (Category-wise)</h3>
            <div class="sub">Manganese (Mn)</div>
          </div>
          <div class="sub">Dose Schedule</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:190px;">Category</th>
              <th>At Basal/ Day 0</th>
              <th>Day 30</th>
              <th>Day 45</th>
              <th>Day 60</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="td-day">Acute deficient</td>
              <td>20 kg/acre MnSO4 (Manganese sulphate) for each crop.</td>
              <td>Foliar sprays of 2-2.5 Gram/Litre Mn-EDTA.</td>
              <td>Foliar sprays of Mn-EDTA 2-2.5 Gram/Litre.</td>
              <td>Foliar sprays of 2-2.5 Gram/Litre Mn-EDTA.</td>
            </tr>
            <tr>
              <td class="td-day">Deficient</td>
              <td>20 kg/acre MnSO4 (Manganese sulphate) for each crop.</td>
              <td>Foliar sprays of 2-2.5 Gram/Litre Mn-EDTA.</td>
              <td>Foliar sprays of 2-2.5 Gram/Litre Mn-EDTA.</td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Latent deficient</td>
              <td></td>
              <td>Foliar sprays of 2-2.5 Gram/Litre Mn-EDTA.</td>
              <td>Foliar sprays of 2-2.5 Gram/Litre Mn-EDTA.</td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Marginal sufficient</td>
              <td></td>
              <td>Foliar sprays of 2-2.5 Gram/Litre Mn-EDTA.</td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">High</td>
              <td>No need to apply any manganese fertilizer</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Very high</td>
              <td>No need to apply any manganese fertilizer</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
        <div class="rec-head" style="border-top:1px solid var(--line);">
          <div>
            <h3 style="margin-top:12px;">Option 1 - Micronutrient Recommendations (Category-wise)</h3>
            <div class="sub">Boron (B)</div>
          </div>
          <div class="sub">Dose Schedule</div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:190px;">Category</th>
              <th>At Basal/ Day 0</th>
              <th>Day 30</th>
              <th>Day 45</th>
              <th>Day 60</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="td-day">Acute deficient</td>
              <td>7.5 kg/acre Borax each crop cycle.</td>
              <td></td>
              <td>Foliar sprays of 3 Gram/Litre borax.</td>
              <td>Foliar sprays of 3 Gram/Litre borax.</td>
            </tr>
            <tr>
              <td class="td-day">Deficient</td>
              <td>5.6 kg/acre Borax each crop cycle.</td>
              <td></td>
              <td>Foliar sprays of 3 Gram/Litre borax.</td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Latent deficient</td>
              <td>4 kg/acre each crop cycle.</td>
              <td></td>
              <td>Foliar sprays of 3 Gram/Litre borax.</td>
              <td>Foliar sprays of 3 Gram/Litre borax.</td>
            </tr>
            <tr>
              <td class="td-day">Marginal sufficient</td>
              <td>2 kg/acre Borax as basal dose.</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">High</td>
              <td>No need to apply any Boron fertilizer</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td class="td-day">Very high</td>
              <td>No need to apply any Boron fertilizer</td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
    `;
  }

  const opt2El = container.querySelector('#opt2');
  if (opt2El) {
    opt2El.innerHTML = `
      <div class="rec-card">
        <div class="rec-head">
          <div>
            <h3>Option 2 - Bio-Fertilizers with Chemical Fertilizers Recommendation</h3>
            <div class="sub">Dose Schedule</div>
          </div>
          <div class="sub"> </div>
        </div>
        <table>
          <thead>
            <tr>
              <th style="width:190px;">Days</th>
              <th style="width:150px;">Nutrient</th>
              <th>Fertilizer</th>
              <th>Dose Rate</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="td-day" rowspan="7">0 day at land preparation</td>
              <td><strong>Soil Conditioner</strong></td>
              <td>FYM</td>
              <td>Ton/Acre</td>
            </tr>
            <tr>
              <td><strong>Bio NPK Consortium</strong></td>
              <td>It is a consortium of Rhizobium, Azotobactor, Phosphobacteria, and Potash Solubilizing biofertilizers</td>
              <td>
                <strong>For Liquid</strong> - Mix 300-400ml NPK consortium with 50-100 kg of soil/compost.<br>
                <strong>For Granular</strong> - Mix 4kg NPK consortium with 200-500kg FYM/Vermicompost.
                Spread this mix homogeneously in the field before the last ploughing or before 24 hours of sowing.
              </td>
            </tr>
            <tr>
              <td><strong>Bio Zinc</strong></td>
              <td>It is microbe of Bacillus endophyticus</td>
              <td></td>
            </tr>
            <tr>
              <td><strong>Mycorrhiza</strong></td>
              <td>Vesicular Arabuscular Mycorrhiza (VAM)bio fertilizer</td>
              <td>
                <strong>For Granular</strong> - Mix 4kg Mycorrhiza granular with 200-500kg FYM/Vermicompost.
                Spread this mix homogeneously in the field before the last ploughing or before 24 hours of sowing.
              </td>
            </tr>
            <tr>
              <td><strong>Macronutrient</strong></td>
              <td>00:16:00 (SSP)<br>46:00:00 (Urea)<br>00:00:60 (MOP)</td>
              <td>Reduce 25% extra Phosphorus from Recommended dose of fertilzer<br>Recommended dose of fertilizer<br>Recommended dose of fertilizer</td>
            </tr>
            <tr>
              <td><strong>Micronutrient</strong></td>
              <td>Zinc Sulphate<br>Ferrous Sulphate<br>Copper Sulphate<br>Manganese Sulphate<br>Borax</td>
              <td>
                No application required<br>
                1 Kg/acre for each crop<br>
                20 Kg/acre for each crop<br>
                2 Kg/acre for each crop
              </td>
            </tr>
            <tr>
              <td><strong>Macronutrient</strong></td>
              <td>46:00:00 (Urea)</td>
              <td>Recommended dose of fertilizer</td>
            </tr>
            <tr>
              <td class="td-day">30 days after sowing / transplanting</td>
              <td><strong>Micronutrient</strong></td>
              <td>Ferrous Sulphate<br>Copper Sulphate<br>Manganese Sulphate</td>
              <td>Foliar spray 1-2 grams/litre<br>Foliar spray 2-2.5 grams/litre</td>
            </tr>
            <tr>
              <td class="td-day">45 days after sowing / transplanting</td>
              <td><strong>Micronutrient</strong></td>
              <td>Ferrous Sulphate<br>Manganese Sulphate<br>Borax</td>
              <td>Foliar spray 2-2.5 grams/litre</td>
            </tr>
            <tr>
              <td class="td-day" rowspan="2">60 days after sowing / transplanting</td>
              <td><strong>Macronutrient</strong></td>
              <td>46:00:00 (Urea)<br>00:00:60 (MOP)</td>
              <td>Recommended dose of fertilizer<br>Recommended dose of fertilizer</td>
            </tr>
            <tr>
              <td><strong>Micronutrient</strong></td>
              <td>Ferrous Sulphate<br>Manganese Sulphate<br>Borax</td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
    `;
  }

  const disclaimerText =
    'Upaj and /its affiliates shall not be liable in any manner whatsoever in relation to the laboratory results and recommendations(included those derived from government sources) due to improper sample handling, testing procedures etc. The recommendations are on advisory basis only.';
  container.querySelectorAll('[id^="disclaimer"]').forEach(el => {
    el.textContent = disclaimerText;
  });
}

function clamp(value, min, max) {
  return Math.max(min, Math.min(max, value));
}

function parseBands(attr) {
  if (!attr) return null;
  const parts = String(attr).split(',').map(s => Number(s.trim()));
  if (parts.length < 2 || parts.some(x => !Number.isFinite(x))) return null;
  return parts;
}

function markerPct(min, max, value) {
  const val = Number(value);
  if (!Number.isFinite(val)) return '50%';
  const x = clamp(val, min, max);
  const pct = ((x - min) / ((max - min) || 1)) * 100;
  return clamp(pct, 0, 100).toFixed(2) + '%';
}

function ratingFromCuts(value, cut1, cut2, words) {
  const val = Number(value);
  if (!Number.isFinite(val)) return 'NA';
  if (val < cut1) return words[0] || 'Low';
  if (val <= cut2) return words[1] || 'Medium';
  return words[2] || 'High';
}

function ratingFromBands(value, bands, labels) {
  const val = Number(value);
  if (!Number.isFinite(val) || !bands || bands.length < 2) return 'NA';
  const min = bands[0];
  const max = bands[bands.length - 1];
  const x = clamp(val, min, max);
  let idx = bands.length - 2;
  for (let i = 0; i < bands.length - 1; i++) {
    if (x >= bands[i] && x <= bands[i + 1]) {
      idx = i;
      break;
    }
  }
  return labels[idx] || `Band ${idx + 1}`;
}

async function generateStvDirectPdfBlob(reportData) {
  const container = document.createElement('div');
  container.style.position = 'fixed';
  container.style.left = '0';
  container.style.top = '0';
  container.style.width = '1120px';
  container.style.opacity = '1';
  container.style.zIndex = '9999';
  container.style.pointerEvents = 'none';
  container.style.background = '#ffffff';
  container.innerHTML = getStvDirectReportTemplate();
  applySoilRowToContainer(container, reportData);
  document.body.appendChild(container);
  const styleNodes = Array.from(container.querySelectorAll('style'));
  const injectedStyles = styleNodes.map((styleNode, idx) => {
    const injected = document.createElement('style');
    injected.setAttribute('data-stv-report-style', String(idx));
    injected.textContent = styleNode.textContent || '';
    document.head.appendChild(injected);
    styleNode.remove();
    return injected;
  });
  if (document.fonts && document.fonts.ready) {
    await document.fonts.ready;
  }
  await new Promise(resolve => requestAnimationFrame(() => requestAnimationFrame(resolve)));
  if (!window.html2canvas) {
    throw new Error('html2canvas is not available.');
  }
  const JsPDF = (window.jspdf && window.jspdf.jsPDF) ? window.jspdf.jsPDF : window.jsPDF;
  if (!JsPDF) {
    throw new Error('jsPDF is not available.');
  }
  const canvas = await html2canvas(container, {
    scale: 1.35,
    useCORS: true,
    allowTaint: true,
    backgroundColor: '#ffffff',
    windowWidth: 1120,
    windowHeight: Math.max(container.scrollHeight, 1120)
  });
  const imgData = canvas.toDataURL('image/jpeg', 0.78);
  const pdf = new JsPDF({ unit: 'pt', format: 'a4', orientation: 'portrait', compress: true });
  const pdfWidth = pdf.internal.pageSize.getWidth();
  const pdfHeight = pdf.internal.pageSize.getHeight();
  const imgWidth = pdfWidth;
  const imgHeight = (canvas.height * pdfWidth) / canvas.width;
  let heightLeft = imgHeight;
  let position = 0;
  pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
  heightLeft -= pdfHeight;
  while (heightLeft > 0) {
    position -= pdfHeight;
    pdf.addPage();
    pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
    heightLeft -= pdfHeight;
  }
  const blob = pdf.output('blob');
  injectedStyles.forEach(styleNode => styleNode.remove());
  document.body.removeChild(container);
  return blob;
}

function lvParseCsv(text){
  // Minimal CSV parser (handles quotes)
  const rows = [];
  let row = [];
  let cur = '';
  let inQ = false;

  for (let i=0; i<text.length; i++){
    const ch = text[i];
    const nx = text[i+1];

    if (ch === '"' && inQ && nx === '"'){ cur += '"'; i++; continue; }
    if (ch === '"'){ inQ = !inQ; continue; }

    if (!inQ && (ch === '\n' || ch === '\r')){
      if (cur !== '' || row.length){
        row.push(cur); cur = '';
        rows.push(row); row = [];
      }
      continue;
    }

    if (!inQ && ch === ','){
      row.push(cur); cur = '';
      continue;
    }

    cur += ch;
  }
  if (cur !== '' || row.length){
    row.push(cur);
    rows.push(row);
  }

  // remove empty trailing rows
  return rows.filter(r => r.some(c => String(c || '').trim() !== ''));
}

/* ---------- Save Table to Lab_Validation_Data ---------- */

function lvSaveTable(){
  const labName = String(document.getElementById('lv-lab-name').value || '').trim();
  const labAddr = String(document.getElementById('lv-lab-address').value || '').trim();
  const labLoc  = String(document.getElementById('lv-lab-location').value || '').trim();
  const labGPS  = String(document.getElementById('lv-lab-gps').value || '').trim();

  const deviceId = String(document.getElementById('lv-device-id').value || '').trim();
  const testId   = String(document.getElementById('lv-test-id').value || '').trim();

  if (!labName){
    lvSetStatus(false, 'Lab name required');
    return;
  }
  if (!testId){
    lvSetStatus(false, 'Select a Test ID');
    return;
  }

  // Validate Lab values: must be +ve float only OR blank
  for (const r of lvTableRows){
    if (r.Lab_Value === '' || r.Lab_Value === null || r.Lab_Value === undefined) continue;
    const num = Number(r.Lab_Value);
    if (!Number.isFinite(num) || num < 0){
      lvSetStatus(false, `Invalid Lab value for: ${r.Parameter}`);
      return;
    }
  }

  const meta = {
    Device_ID: deviceId,
    Test_ID: testId,
    Lab_Name: labName,
    Lab_Address: labAddr,
    Lab_Location: labLoc,
    Lab_GPS: labGPS,
    Method_Notes: String(document.getElementById('lv-method-notes').value || '').trim(),
    // If you have a global currentUser from login, it will be used; else blank
    Entered_By: (window.currentUser && (currentUser.user || currentUser.empId || currentUser.email)) ? (currentUser.user || currentUser.empId || currentUser.email) : ''
  };

  const rows = lvTableRows.map(r => ({
    Parameter: r.Parameter,
    Unit: r.Unit,
    Lab_Value: (r.Lab_Value === '' ? '' : Number(r.Lab_Value)),
    Insoil_Value: (r.Insoil_Value === '' ? '' : r.Insoil_Value),
    Notes: r.Notes || ''
  }));

  google.script.run
    .withSuccessHandler(res => {
      lvSetStatus(!!res?.ok, res?.msg || 'Saved');
      // After save, refresh correlations
      lvRenderCorrelations();
    })
    .withFailureHandler(err => lvSetStatus(false, err?.message || 'Save failed'))
    .saveLabValidationRows({ meta, rows });
}

/* ---------- Correlations (Insoil x vs Lab y) ---------- */

function lvRefreshCorrelationData(){
  // Build per-parameter points from current table (live fetch from CSV/manual + insoil auto)
  lvCorrelationPoints = {};
  lvTableRows.forEach(r => {
    const x = Number(r.Insoil_Value);
    const y = Number(r.Lab_Value);
    if (!Number.isFinite(x) || !Number.isFinite(y)) return;
    const key = r.Parameter || 'Parameter';
    if (!lvCorrelationPoints[key]) lvCorrelationPoints[key] = [];
    lvCorrelationPoints[key].push({ x, y });
  });
}

function lvRenderCorrelations() {
  const grid = document.getElementById('lv-corr-grid');
  if (!grid) return;

  // cleanup old
  grid.innerHTML = '';
  lvCharts.forEach(c => { try { c.destroy(); } catch (e) {} });
  lvCharts = [];

  const removeOutliers = !!document.getElementById('lv-outliers')?.checked;

  // Load ALL rows from SHEET (no lab/device/test filtering)
  google.script.run
    .withSuccessHandler((res) => {
      if (!res || res.ok === false) {
        grid.innerHTML = '<div style="padding:12px; color:#6b7280;">' +
          escapeHtml(res?.msg || 'Failed to load Lab_Validation_Data') +
        '</div>';
        return;
      }

      // Rebuild lvCorrelationPoints from sheet rows
      lvCorrelationPoints = {};
      (res.rows || []).forEach(r => {
        const key = String(r.param || '').trim();
        const x = Number(r.x);
        const y = Number(r.y);
        if (!key || !Number.isFinite(x) || !Number.isFinite(y)) return;
        if (!lvCorrelationPoints[key]) lvCorrelationPoints[key] = [];
        lvCorrelationPoints[key].push({ x, y });
      });

      const keys = Object.keys(lvCorrelationPoints || {});
      if (!keys.length) {
        grid.innerHTML =
          '<div style="padding:12px; color:#6b7280;">No valid data in Lab_Validation_Data (need Parameter, Insoil_Value (auto), Lab_Value).</div>';
        return;
      }

      keys.forEach(param => {
        let pts = lvCorrelationPoints[param] || [];
        if (pts.length < 1) return;

        if (removeOutliers) {
          pts = lvOutlierFilter2D(pts);
          if (pts.length < 1) return;
        }

        const stats = (pts.length >= 2) ? lvRegression(pts) : null;

        const eqText = stats
          ? ('y=' + stats.slope + 'x ' + (stats.intercept >= 0 ? '+' : '') + stats.intercept + ' | R²=' + stats.r2)
          : 'Need ≥ 2 points';

        const card = document.createElement('div');
        card.className = 'lv-mini-card';

        card.innerHTML =
          '<div class="lv-mini-head">' +
            '<div style="display:flex; align-items:center; gap:10px;">' +
              '<span>' + escapeHtml(param) + ' (Lab vs Insoil)</span>' +
              '<span class="lv-eq">' + escapeHtml(eqText) + '</span>' +
            '</div>' +
            '<span class="lv-zoom" data-param="' + escapeHtml(param) + '">🔍</span>' +
          '</div>' +
          '<div style="height:220px;"><canvas></canvas></div>' +
          '<div class="lv-mini-stats">' + (stats ? ('Points: ' + pts.length) : ('Points: ' + pts.length)) + '</div>';

        grid.appendChild(card);

        const zoomEl = card.querySelector('.lv-zoom');
        if (zoomEl) zoomEl.addEventListener('click', () => lvOpenModal(param));

        const canvas = card.querySelector('canvas');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');

        const datasets = [{ label: 'Points', data: pts, pointRadius: 3 }];
        if (stats) datasets.push({ label: 'Fit', type: 'line', data: stats.line, pointRadius: 0, borderWidth: 2 });

        const chart = new Chart(ctx, {
          type: 'scatter',
          data: { datasets },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false }, tooltip: { enabled: true } },
            scales: {
              x: { title: { display: true, text: 'Insoil_Value (auto)' } },
              y: { title: { display: true, text: 'Lab_Value' } }
            }
          }
        });

        // Keep your modal logic working (it looks for chart.lvparam / chart.lvpts / chart.lvstats) [file:96]
        chart.lvparam = param;
        chart.lvpts = pts;
        chart.lvstats = stats;

        lvCharts.push(chart);
      });
    })
    .withFailureHandler((err) => {
      grid.innerHTML = '<div style="padding:12px; color:#6b7280;">' +
        escapeHtml(err?.message || 'Load failed') +
      '</div>';
    })
    .getLabValidationScatterData();
}



function lvRegression(pts){
  // simple linear regression y = a + b x
  const n = pts.length;
  let sx=0, sy=0, sxx=0, sxy=0;
  pts.forEach(p => { sx+=p.x; sy+=p.y; sxx+=p.x*p.x; sxy+=p.x*p.y; });

  const den = (n*sxx - sx*sx);
  const b = den === 0 ? 0 : (n*sxy - sx*sy)/den;
  const a = (sy - b*sx)/n;

  // r2
  const yMean = sy/n;
  let ssTot=0, ssRes=0;
  pts.forEach(p => {
    const yHat = a + b*p.x;
    ssTot += (p.y - yMean)*(p.y - yMean);
    ssRes += (p.y - yHat)*(p.y - yHat);
  });
  const r2 = ssTot === 0 ? 0 : (1 - ssRes/ssTot);

  // line segment across x-range
  const xs = pts.map(p => p.x).sort((x,y)=>x-y);
  const x1 = xs[0], x2 = xs[xs.length-1];
  const line = [
    { x: x1, y: a + b*x1 },
    { x: x2, y: a + b*x2 }
  ];

  return {
    slope: roundTo(b, 4),
    intercept: roundTo(a, 4),
    r2: roundTo(r2, 4),
    line
  };
}

function lvOutlierFilter2D(pts){
  // univariate outlier removal (1.5*IQR) applied to x and y independently, keep intersection
  const xs = pts.map(p=>p.x).sort((a,b)=>a-b);
  const ys = pts.map(p=>p.y).sort((a,b)=>a-b);

  const xb = lvIqrBounds(xs);
  const yb = lvIqrBounds(ys);

  return pts.filter(p => (p.x>=xb.lo && p.x<=xb.hi && p.y>=yb.lo && p.y<=yb.hi));
}

function lvIqrBounds(arr){
  const q1 = lvQuantile(arr, 0.25);
  const q3 = lvQuantile(arr, 0.75);
  const iqr = (q3 - q1);
  return { lo: q1 - 1.5*iqr, hi: q3 + 1.5*iqr };
}

function lvQuantile(sortedArr, q){
  const n = sortedArr.length;
  if (!n) return 0;
  const pos = (n - 1) * q;
  const base = Math.floor(pos);
  const rest = pos - base;
  if (sortedArr[base+1] !== undefined) return sortedArr[base] + rest*(sortedArr[base+1]-sortedArr[base]);
  return sortedArr[base];
}

/* ---------- Export Charts (grid to one PNG) ---------- */

function lvExportCharts(){
  if (!lvCharts.length){
    lvSetStatus(false, 'No charts to export');
    return;
  }

  // Build a combined canvas from each chart canvas in DOM order
  const canvases = Array.from(document.querySelectorAll('#lv-corr-grid canvas'));
  if (!canvases.length){
    lvSetStatus(false, 'No chart canvases found');
    return;
  }

  // Grid layout: use current CSS computed columns by approximating with 3 columns fallback
  const cols = Math.min(3, canvases.length);
  const rows = Math.ceil(canvases.length / cols);

  const w = canvases[0].width;
  const h = canvases[0].height;

  const out = document.createElement('canvas');
  out.width = cols * w;
  out.height = rows * h;

  const ctx = out.getContext('2d');
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0, 0, out.width, out.height);
  let i = 0;
  for (let r=0; r<rows; r++){
    for (let c=0; c<cols; c++){
      if (i >= canvases.length) break;
      ctx.drawImage(canvases[i], c*w, r*h);
      i++;
    }
  }

  const url = out.toDataURL('image/png');
  const a = document.createElement('a');
  a.href = url;
  a.download = 'Lab_Validation_Correlations.png';
  a.click();

  lvSetStatus(true, 'Exported correlations PNG');
}

/* ---------- Modal chart ---------- */

function lvOpenModal(param) {
  const modal = document.getElementById('lv-modal');
  const title = document.getElementById('lv-modal-title');
  const canvas = document.getElementById('lv-modal-canvas');
  if (!modal || !canvas) return;

  const p = String(param || '').trim().toLowerCase();

  const chart = (lvCharts || []).find(c =>
    String(c.lvparam || '').trim().toLowerCase() === p
  );

  if (!chart) {
    // quick debug (remove later)
    console.warn('lvOpenModal: chart not found for', param, 'available:', (lvCharts || []).map(c => c.lvparam));
    return;
  }

  title.textContent = chart.lvparam + ' (Lab vs Insoil)';

  if (lvModalChart) { try { lvModalChart.destroy(); } catch (e) {} lvModalChart = null; }

  const pts = chart.lvpts || [];
  const stats = chart.lvstats || (pts.length >= 2 ? lvRegression(pts) : null);

  lvModalChart = new Chart(canvas.getContext('2d'), {
    type: 'scatter',
    data: {
      datasets: [
        { label: 'Points', data: pts, pointRadius: 4 },
        ...(stats ? [{ label: 'Fit', type: 'line', data: stats.line, pointRadius: 0, borderWidth: 3 }] : [])
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: true } },
      scales: {
        x: { title: { display: true, text: 'Insoil (x)' } },
        y: { title: { display: true, text: 'Lab (y)' } }
      }
    }
  });

  modal.style.display = 'flex';
}


function lvCloseModal(){
  const modal = document.getElementById('lv-modal');
  if (modal) modal.style.display = 'none';
}

/* ---------- Utilities ---------- */

function roundTo(x, n){
  const p = Math.pow(10,n);
  return Math.round(x*p)/p;
}


// === MOVE CONCURRENCY + PENDING FILTER (global) ===
window.__moveBusy = window.__moveBusy || false;

// Keys of rows currently being moved (to prevent reload re-introducing them)
window.__pendingMove = window.__pendingMove || {
  rgbToQc: new Set(),  // keys removed from RGB but not yet confirmed server-side
  qcToRgb: new Set()   // keys removed from QC but not yet confirmed server-side
};

// Use did|tid because your backend delete functions use device_id + test_id only. :contentReference[oaicite:1]{index=1}
function makeRowKeyShort(r) {
  const did = String(r?.did ?? r?.device_id ?? '').trim();
  const tid = String(r?.tid ?? r?.test_id ?? '').trim();
  return `${did}|${tid}`;
}

function _filterOutPendingMovesRGB(rows) {
  const pend = window.__pendingMove?.rgbToQc;
  if (!pend || !pend.size) return rows;
  return (rows || []).filter(r => !pend.has(makeRowKeyShort(r)));
}

function _filterOutPendingMovesQC(rows) {
  const pend = window.__pendingMove?.qcToRgb;
  if (!pend || !pend.size) return rows;
  return (rows || []).filter(r => !pend.has(makeRowKeyShort(r)));
}

// Optional: generate a temp UI id for newly inserted rows (so checkbox + selection logic stays stable)
function _tempId(prefix) {
  return `${prefix}_${Date.now()}_${Math.floor(Math.random() * 1e6)}`;
}


function escapeHtml(s){
  return String(s || '')
    .replaceAll('&','&amp;')
    .replaceAll('<','&lt;')
    .replaceAll('>','&gt;')
    .replaceAll('"','&quot;')
    .replaceAll("'","&#039;");
}


function readQCBatch(row) {
  if (!row) return 'Default';
  const b = row.qcBatchId ?? row.QC_Batch ?? row.qcBatch ?? row.batch ?? 'Default';
  return String(b || 'Default').trim() || 'Default';
}


function escapeJs(s){
  return String(s || '').replaceAll('\\','\\\\').replaceAll("'","\\'");
}

/* ---------- Hook into navigation ---------- */
/* Your existing nav(id,e) activates modules. Add ONE line:
   if (id === 'labval') lvInitIfNeeded();
*/
const _origNav = window.nav;
window.nav = function(id, e){
  if (typeof _origNav === 'function') _origNav(id, e);
  if (id === 'labval') lvInitIfNeeded();
};

//---------------- Lab validation module end -------------------


//---------------- Impact module start -------------------


// ============================
// IMPACT ASSESSMENT UI (UI-only)
// ============================
(function initImpactUIOnce(){
  if (window.__impact_ui_inited) return;
  window.__impact_ui_inited = true;

  document.addEventListener('DOMContentLoaded', () => {
    // Tab switching
    document.querySelectorAll('#mod-impact .ia-tab').forEach(btn => {
      btn.addEventListener('click', () => iaSelectTab(btn.getAttribute('data-ia-tab')));
    });

    // Panel collapse buttons
    document.querySelectorAll('#mod-impact .ia-collapse').forEach(btn => {
      btn.addEventListener('click', () => iaTogglePanel(btn.getAttribute('data-target')));
    });

    // Filter controls (UI-only)
    const apply = document.getElementById('ia-apply');
    const clear = document.getElementById('ia-clear');
    const refresh = document.getElementById('ia-refresh');
    const exp = document.getElementById('ia-export');

    if (apply) apply.addEventListener('click', () => iaSetStatus('Filters applied (UI-only)'));
    if (clear) clear.addEventListener('click', iaClearFilters);
    if (refresh) refresh.addEventListener('click', () => iaSetStatus('Refresh requested (UI-only)'));
    if (exp) exp.addEventListener('click', () => iaSetStatus('Export requested (UI-only)'));

    // Initialize with Dashboard
    iaSelectTab('dash');

    // Fill placeholders with mock values so the UI looks “alive”
    iaMockDashboard();
  });

  function iaSelectTab(key){
    document.querySelectorAll('#mod-impact .ia-tab').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('#mod-impact .ia-tabpage').forEach(p => p.classList.remove('active'));

    const tabBtn = document.querySelector(`#mod-impact .ia-tab[data-ia-tab="${key}"]`);
    const page = document.getElementById(`ia-tab-${key}`);

    if (tabBtn) tabBtn.classList.add('active');
    if (page) page.classList.add('active');
  }

  function iaTogglePanel(panelId){
    const panel = document.getElementById(panelId);
    if (!panel) return;

    panel.classList.toggle('collapsed');

    // Button toggle: Minimize (orange) <-> Maximize (green)
    const btn = panel.querySelector(`.ia-collapse[data-target="${panelId}"]`);
    if (!btn) return;

    const collapsed = panel.classList.contains('collapsed');
    if (collapsed){
      btn.textContent = 'Maximize';
      btn.classList.remove('btn-orange');
      btn.classList.add('btn-green');
    } else {
      btn.textContent = 'Minimize';
      btn.classList.remove('btn-green');
      btn.classList.add('btn-orange');
    }
  }

  function iaClearFilters(){
    const ids = ['ia-season','ia-crop','ia-client','ia-state','ia-district','ia-block','ia-farm','ia-device','ia-test'];
    ids.forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      if (el.tagName === 'SELECT') el.value = el.options[0]?.value || '';
      else el.value = '';
    });
    iaSetStatus('Filters cleared');
  }

  function iaSetStatus(msg){
    const el = document.getElementById('ia-status');
    if (el) el.textContent = msg;
  }

  function iaMockDashboard(){
    // KPI placeholders
    setTxt('ia-kpi-farms', '—');
    setTxt('ia-kpi-area', '—');
    setTxt('ia-kpi-tests', '—');
    setTxt('ia-kpi-repeat', '—');
    setTxt('ia-kpi-fert', '—');
    setTxt('ia-kpi-yield', '—');

    // Econ placeholders
    setTxt('ia-econ-cb', '—');
    setTxt('ia-econ-cf', '—');
    setTxt('ia-econ-dc', '—');
    setTxt('ia-econ-tc', '—');
    setTxt('ia-econ-y', '—');
    setTxt('ia-econ-dy', '—');
    setTxt('ia-econ-dr', '—');
    setTxt('ia-econ-net', '—');

    // Empty tables already show UI-only rows
    iaSetStatus('Dashboard ready (UI-only)');
  }

  function setTxt(id, v){
    const el = document.getElementById(id);
    if (el) el.textContent = String(v);
  }
})();


  // ============================
// IMPACT INFO (ⓘ) SYSTEM
// Paste inside your Impact JS block (only once)
// ============================

// 1) All help text lives here.
// You can freely edit/expand these bodies later without touching HTML.
const IA_INFO_TEXT = {
  // ---------- TAB HELP ----------
  "tab-dashboard": {
    title: "Dashboard (Impact Overview)",
    body:
`TECHNICAL:
This view aggregates program data across the selected filters (season/crop/geography/farm) and presents a consolidated snapshot of:
• Coverage (how many farms/tests are included)
• Inputs (fertilizer usage, derived nutrient load and cost)
• Outcomes (yield metrics where available)
• Change signals (baseline vs follow-up comparisons)

STRATEGIC:
This is the executive view for client onboarding and review meetings. It answers:
• Are we covering enough farms and area?
• Is advisory adoption happening (fertilizer/yield entries)?
• Is there measurable cost reduction or yield improvement?
• Where are the hotspots by geography/crop?`
  },

  "tab-fertilizer": {
    title: "Fertilizer Usage",
    body:
`TECHNICAL:
Captures farmer fertilizer inputs as line items (stage, source, quantity). Nutrient loads (N, P2O5, K2O, etc.) and cost can be derived using the NutrientSources table (grade + price).
Records are linked to Farm/Device/Test for traceability and baseline vs follow-up comparisons.

STRATEGIC:
This is the input-adoption and nutrient-efficiency layer. It supports:
• Baseline vs post-advisory nutrient intensity comparison
• Cost per acre estimates and savings computation
• Evidence-based tracking of advisory implementation`
  },

  "tab-yield": {
    title: "Yield Records",
    body:
`TECHNICAL:
Stores yield outcome values (kg/acre) along with method/source metadata. Area enables normalization. Price (optional) enables revenue impact calculation.
Yield method indicates confidence and audit strength.

STRATEGIC:
This is the primary outcome layer. For enterprise clients, yield impact is often the most important KPI, but it must be accompanied by method/evidence to remain defensible.`
  },

  "tab-soil": {
    title: "Soil Change",
    body:
`TECHNICAL:
Compares baseline and follow-up soil tests (pairing logic defined in Pairing Rule). Generates parameter-wise class transitions (Low→Medium→High) and improvement summaries.

STRATEGIC:
This supports sustainability narratives (soil health improvement) and long-term program outcomes beyond yield alone. Useful for ESG / regenerative agriculture reporting.`
  },

  "tab-coverage": {
    title: "Coverage",
    body:
`TECHNICAL:
Summarizes footprint (states/districts/farms/tests/devices/area) and allows geographic rollups.

STRATEGIC:
This is the scale story. It is used to demonstrate deployment breadth, targeting efficiency, and scalability to stakeholders.`
  },

  // ---------- PANEL HELP ----------
  "panel-economic": {
    title: "Economic Impact (₹)",
    body:
`TECHNICAL:
Computes cost and outcome metrics normalized per acre:
• Fertilizer cost/acre (baseline vs follow-up)
• Yield and yield change (kg/acre)
• Revenue change/acre (if priced)
• Net benefit/acre (if priced)

STRATEGIC:
This panel converts agronomy into business language: ROI. This is typically the slide that leadership and procurement will focus on.`
  },

  "panel-nutrient": {
    title: "Nutrient Use Impact",
    body:
`TECHNICAL:
Derives nutrient application rates (kg/acre) from recorded fertilizer line items using nutrient grades:
• N, P2O5, K2O (and optional S, Zn, B)
Shows baseline vs follow-up differences and farm/area coverage.

STRATEGIC:
Supports nutrient-use efficiency, reduction of excess application, and alignment with recommendations. Useful for sustainability and cost control.`
  },

  "panel-yieldimpact": {
    title: "Yield Impact",
    body:
`TECHNICAL:
Summarizes yield outcomes and yield change distribution for the selected scope. Includes farm counts and whether price-based impact can be computed.

STRATEGIC:
Yield is the most intuitive impact KPI for clients. This panel is strongest when paired with fertilizer usage adoption and a defined measurement method.`
  },

  "panel-recent": {
    title: "Recent Tests",
    body:
`TECHNICAL:
Displays the latest soil test activity within the selected scope for quick verification and monitoring.

STRATEGIC:
Useful for operational review, field monitoring, and troubleshooting “what happened last week” questions during program execution.`
  },

  "panel-fert-entry": {
    title: "Fertilizer Usage Entry",
    body:
`TECHNICAL:
Defines the context for fertilizer line items:
• Farm/Device/Test linkage
• Season/Crop/Area normalization
• Baseline vs Follow-up classification
• Method / evidence metadata

STRATEGIC:
Ensures records are defensible for enterprise reporting and audits by capturing context and evidence.`
  },

  "panel-fert-grid": {
    title: "Line Item Grid",
    body:
`TECHNICAL:
Each row captures a fertilizer application event:
• Stage (Basal/Vegetative/etc.)
• SourceID (linked to NutrientSources)
• Quantity + unit basis
Derived:
• Nutrient loads
• Cost

STRATEGIC:
Provides traceability and enables optimization analysis (stage-wise nutrient allocation, cost drivers).`
  },

  "panel-fert-table": {
    title: "Saved Fertilizer Usage Records",
    body:
`TECHNICAL:
A ledger of fertilizer usage entries for search, QC, and export.

STRATEGIC:
This is audit support. Enterprises often require downloadable, filterable records for internal validation.`
  },

  "panel-yield-entry": {
    title: "Yield Entry",
    body:
`TECHNICAL:
Captures yield (kg/acre), method (data confidence), price (optional), and context linkage to farm/program/season.

STRATEGIC:
Creates outcome evidence and supports ROI. High-confidence yield methods enable stronger client reporting.`
  },

  "panel-yield-table": {
    title: "Yield Records",
    body:
`TECHNICAL:
A searchable ledger of yield entries for export and review.

STRATEGIC:
Used to validate outcome coverage and measurement quality during client reviews.`
  },

  "panel-pairing": {
    title: "Pairing Rule",
    body:
`TECHNICAL:
Defines how baseline tests are matched to follow-up tests for soil-change computation (e.g., same farm within season, previous test for same device, etc.).

STRATEGIC:
Pairing logic controls the credibility of improvement claims. A clear rule reduces disputes during reviews.`
  },

  "panel-soil-summary": {
    title: "Soil Change Summary",
    body:
`TECHNICAL:
Aggregated changes in soil parameters and class movements based on the pairing rule.

STRATEGIC:
Supports soil health improvement narratives and long-term sustainability outcomes beyond yield.`
  },

  "panel-soil-transition": {
    title: "Class Transitions",
    body:
`TECHNICAL:
Shows Low→Medium→High transitions across key parameters.

STRATEGIC:
Used to communicate “movement toward optimal” outcomes in an interpretable way for non-technical stakeholders.`
  },

  "panel-soil-matrix": {
    title: "Parameter Transition Table",
    body:
`TECHNICAL:
Parameter-wise counts of improvement/no-change/worsening.

STRATEGIC:
A defensible, auditable summary used for reporting, KPI tracking, and identifying where intervention is needed.`
  },

  "panel-coverage-map": {
    title: "Coverage Map",
    body:
`TECHNICAL:
Geographic visualization of program footprint.

STRATEGIC:
Supports scale communication and regional targeting discussions during onboarding and quarterly reviews.`
  },

  "panel-coverage-table": {
    title: "Coverage by District",
    body:
`TECHNICAL:
District-level rollups (farms/tests/area and optional impact deltas).

STRATEGIC:
Used to identify high-performing regions and operational gaps, and to plan expansion.`
  },

  // ---------- FIELD HELP ----------
  "field-baseline-followup": {
    title: "Type: Baseline vs Follow-up",
    body:
`Baseline = farmer practice before advisory / intervention.
Follow-up = after advisory implementation / post-intervention practice.

This distinction is essential for impact calculations (Δ cost, Δ nutrient load, Δ yield).`
  },

  "field-evidence": {
    title: "Evidence",
    body:
`Evidence indicates the strength of the record:
• Farmer declaration (lowest audit strength)
• Bill / invoice (strong)
• FPO record / aggregator record (strong)

Capturing evidence improves enterprise defensibility and reporting confidence.`
  },

  "field-yield-method": {
    title: "Yield Method (Confidence)",
    body:
`The method indicates yield confidence:
• Weighment / verified record = high confidence
• Trader slip = medium confidence
• Farmer declaration = low confidence

For enterprise reporting, method is as important as the yield value itself.`
  },

  "field-pairing-compare": {
    title: "Compare (Pairing)",
    body:
`Pairing defines which tests are compared to compute soil change.
Example:
• Same Farm_ID within a season (recommended)
• Previous Test_ID for same Device_ID (alternative)

Choose a pairing rule that is stable, explainable, and defensible.`
  }
};


// 2) One delegated click handler for all ⓘ buttons.
// IMPORTANT: We stop propagation so tab clicks do not fire when clicking ⓘ.
(function initImpactInfoOnce(){
  if (window.__impact_info_inited) return;
  window.__impact_info_inited = true;

  document.addEventListener('click', (e) => {
    const infoBtn = e.target.closest('.ia-info');
    if (!infoBtn) return;

    // prevent tab click, button click, etc.
    e.preventDefault();
    e.stopPropagation();

    const key = infoBtn.dataset.info;
    const info = IA_INFO_TEXT[key];
    if (!info) {
      iaOpenInfo("Info", "No help text found for: " + key);
      return;
    }
    iaOpenInfo(info.title, info.body);
  });

  // Close on overlay click
  document.getElementById('ia-info-modal')?.addEventListener('click', (e) => {
    if (e.target && e.target.id === 'ia-info-modal') iaCloseInfo();
  });

  // Close on ESC
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') iaCloseInfo();
  });
})();

function iaOpenInfo(title, body){
  const modal = document.getElementById('ia-info-modal');
  const tEl = document.getElementById('ia-info-title');
  const bEl = document.getElementById('ia-info-body');
  if (!modal || !tEl || !bEl) return;

  tEl.textContent = title || 'Info';
  bEl.textContent = body || '';
  modal.classList.remove('hidden');
}

function iaCloseInfo(){
  const modal = document.getElementById('ia-info-modal');
  if (modal) modal.classList.add('hidden');
}



/* =========================================================
   IMPACT (Option C): Fertilizer -> Nutrient load + Cost
   Drop-in calculation helpers (no UI changes)
   ========================================================= */

// 1) Build a fast lookup from NutrientSources
// Expecting NutrientSources rows with columns:
// SourceID, GradeN, GradeP2O5, GradeK2O, GradeS, GradeZn, GradeB, PricePerUnit, UnitSize
function iaBuildNutrientSourceMap(nutrientSourcesRows){
  const map = {};
  (nutrientSourcesRows || []).forEach(r => {
    const id = String(r.SourceID || r.sourceId || r.sourceID || '').trim();
    if (!id) return;

    const num = (v) => {
      const x = Number(v);
      return Number.isFinite(x) ? x : 0;
    };

    map[id] = {
      id,
      name: r.SourceName || r.sourceName || id,
      // Grades are % in your table
      gradeN:   num(r.GradeN),
      gradeP:   num(r.GradeP2O5),
      gradeK:   num(r.GradeK2O),
      gradeS:   num(r.GradeS),
      gradeZn:  num(r.GradeZn),
      gradeB:   num(r.GradeB),

      // Pricing
      pricePerUnit: num(r.PricePerUnit),
      unitSize:     num(r.UnitSize) || 1,   // e.g., 50 kg bag
      unitBasis:    (r.UnitBasis || '').toLowerCase() // bag / kg / etc.
    };
  });
  return map;
}

// 2) Convert a line item quantity to kg of product
// Assumes your line items record quantity in "bags" OR "kg" depending on UI.
// You can adapt this safely without changing UI: we auto-detect.
function iaLineItemProductKg(line, src){
  const qty = Number(line.qty ?? line.Qty ?? line.Quantity ?? 0);
  if (!Number.isFinite(qty) || qty <= 0) return 0;

  // If line has unit provided, respect it
  const unit = String(line.unit || line.Unit || line.unitBasis || '').toLowerCase();

  // Case A: unit explicitly kg
  if (unit === 'kg' || unit === 'kilogram' || unit === 'kilograms') return qty;

  // Case B: unit explicitly bag
  if (unit === 'bag' || unit === 'bags') return qty * (src?.unitSize || 1);

  // Case C: no unit on line item — fallback:
  // If NutrientSources UnitBasis is "bag", treat qty as bags
  if ((src?.unitBasis || '') === 'bag') return qty * (src?.unitSize || 1);

  // Default: treat as kg
  return qty;
}

// 3) Compute nutrient kg + cost for one line item
function iaComputeLineImpact(line, srcMap){
  const sourceId = String(line.sourceId || line.SourceID || line.SourceId || '').trim();
  const src = srcMap[sourceId];

  // Unknown source → return zeros but keep trace
  if (!src){
    return {
      sourceId,
      productKg: 0,
      cost: 0,
      N:0, P2O5:0, K2O:0, S:0, Zn:0, B:0,
      _missingSource: true
    };
  }

  const productKg = iaLineItemProductKg(line, src);

  // grades are % → nutrient kg = productKg * (grade/100)
  const N   = productKg * (src.gradeN  / 100);
  const P2O5= productKg * (src.gradeP  / 100);
  const K2O = productKg * (src.gradeK  / 100);
  const S   = productKg * (src.gradeS  / 100);
  const Zn  = productKg * (src.gradeZn / 100);
  const B   = productKg * (src.gradeB  / 100);

  // Cost:
  // If line qty is bags and pricePerUnit is per bag → cost = qty * pricePerUnit
  // Else, if line qty is kg and price is per bag, approximate per-kg using unitSize
  const qty = Number(line.qty ?? line.Qty ?? line.Quantity ?? 0);
  const unit = String(line.unit || line.Unit || line.unitBasis || '').toLowerCase();

  let cost = 0;
  if (src.pricePerUnit > 0){
    if (unit === 'bag' || unit === 'bags' || src.unitBasis === 'bag'){
      cost = qty * src.pricePerUnit;
    } else {
      // assume qty is kg; pricePerUnit refers to one "unit" (bag) of unitSize kg
      cost = (productKg / (src.unitSize || 1)) * src.pricePerUnit;
    }
  }

  return { sourceId, productKg, cost, N, P2O5, K2O, S, Zn, B, _missingSource:false };
}

// 4) Aggregate totals for a fertilizer usage record
// `lines` = array of line items
// `areaAcre` optional for per-acre metrics
function iaAggregateUsageImpact(lines, nutrientSourcesRows, areaAcre){
  const srcMap = iaBuildNutrientSourceMap(nutrientSourcesRows);

  const totals = {
    productKg:0,
    cost:0,
    N:0, P2O5:0, K2O:0, S:0, Zn:0, B:0,
    missingSources: []
  };

  const computedLines = (lines || []).map(line => {
    const c = iaComputeLineImpact(line, srcMap);
    totals.productKg += c.productKg;
    totals.cost      += c.cost;
    totals.N         += c.N;
    totals.P2O5      += c.P2O5;
    totals.K2O       += c.K2O;
    totals.S         += c.S;
    totals.Zn        += c.Zn;
    totals.B         += c.B;
    if (c._missingSource && c.sourceId) totals.missingSources.push(c.sourceId);
    return { ...line, _impact: c };
  });

  const perAcre = {};
  const a = Number(areaAcre);
  if (Number.isFinite(a) && a > 0){
    perAcre.productKg = totals.productKg / a;
    perAcre.cost      = totals.cost / a;
    perAcre.N         = totals.N / a;
    perAcre.P2O5      = totals.P2O5 / a;
    perAcre.K2O       = totals.K2O / a;
    perAcre.S         = totals.S / a;
    perAcre.Zn        = totals.Zn / a;
    perAcre.B         = totals.B / a;
  }

  // round helper for display (do not mutate raw totals)
  const round2 = (x) => Number.isFinite(x) ? Math.round(x*100)/100 : 0;

  return {
    computedLines,
    totals: {
      productKg: round2(totals.productKg),
      cost: round2(totals.cost),
      N: round2(totals.N),
      P2O5: round2(totals.P2O5),
      K2O: round2(totals.K2O),
      S: round2(totals.S),
      Zn: round2(totals.Zn),
      B: round2(totals.B),
      missingSources: totals.missingSources
    },
    perAcre: {
      productKg: round2(perAcre.productKg),
      cost: round2(perAcre.cost),
      N: round2(perAcre.N),
      P2O5: round2(perAcre.P2O5),
      K2O: round2(perAcre.K2O),
      S: round2(perAcre.S),
      Zn: round2(perAcre.Zn),
      B: round2(perAcre.B)
    }
  };
}


function iaImportFromNMPlanSnapshot() {
  const mats = Array.isArray(window.nmCurrentFertMaterials) ? window.nmCurrentFertMaterials : [];
  const costs = Array.isArray(window.nmCurrentFertCosts) ? window.nmCurrentFertCosts : [];

  if (!mats.length) {
    console.warn('IA import: nmCurrentFertMaterials is empty. Generate a plan in NM first.');
    return null;
  }

  // Build a clean line-item list for Impact
  const costByName = {};
  costs.forEach(c => {
    const k = String(c.materialName || '').trim().toLowerCase();
    if (!k) return;
    costByName[k] = Number(c.totalCost || 0) || 0;
  });

  const lines = mats.map(m => {
    const nameRaw = String(m.materialName || '').trim();
    const key = nameRaw.toLowerCase();
    return {
      stage: m.stage || '',
      sourceName: nameRaw,
      qtyPerHa: Number(m.qtyPerHa || 0) || 0,
      costPerHa: costByName[key] || 0,
      details: m.nutrientContent || ''
    };
  });

  const totalCostHa = lines.reduce((a, x) => a + (Number(x.costPerHa) || 0), 0);

  const snapshot = {
    createdAt: new Date().toISOString(),
    lines,
    totalCostHa
  };

  // Store for reuse
  window.iaImportedNM = snapshot;
  console.log('IA imported NM snapshot:', snapshot);
  return snapshot;
}


// Impact module: wire Add/Remove row buttons (works even after re-render)
document.addEventListener('click', function(e) {
  const btn = e.target.closest('[data-ia-action]');
  if (!btn) return;

  const action = btn.getAttribute('data-ia-action');

  if (action === 'add-row') {
    e.preventDefault();
    iaAddImpactLineRow();
  }

  if (action === 'remove-row') {
    e.preventDefault();
    iaRemoveImpactLineRow();
  }
});


// ===== Impact module: Line Item Grid Select + Add/Remove Selected =====

function iaGetImpactLinesTbody() {
  return document.getElementById('ia-fert-lines'); // your tbody id
}

function iaCreateImpactLineRow() {
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td>
      <select class="ia-inp">
        <option>BASAL</option>
        <option>VEG</option>
        <option>FLOWERING</option>
        <option>FRUITING</option>
        <option>OTHER</option>
      </select>
    </td>
    <td><input class="ia-inp" placeholder="DAP" /></td>
    <td><input class="ia-inp" placeholder="auto later" disabled /></td>
    <td><input class="ia-inp" placeholder="0.0" /></td>
    <td>
      <select class="ia-inp">
        <option>bag</option>
        <option>kg</option>
      </select>
    </td>
    <td><input class="ia-inp" placeholder="50" disabled /></td>
    <td><input class="ia-inp" placeholder="1400" disabled /></td>
    <td><input class="ia-inp" placeholder="auto" disabled /></td>
    <td><input class="ia-inp" placeholder="..." /></td>
  `;
  return tr;
}

function iaClearImpactRowSelection() {
  const tbody = iaGetImpactLinesTbody();
  if (!tbody) return;
  tbody.querySelectorAll('tr.ia-row-selected').forEach(tr => tr.classList.remove('ia-row-selected'));
}

function iaSelectImpactRow(tr) {
  if (!tr) return;
  iaClearImpactRowSelection();
  tr.classList.add('ia-row-selected');
}

function iaGetSelectedImpactRow() {
  const tbody = iaGetImpactLinesTbody();
  if (!tbody) return null;
  return tbody.querySelector('tr.ia-row-selected');
}

function iaAddImpactLineRow() {
  const tbody = iaGetImpactLinesTbody();
  if (!tbody) {
    console.warn('Impact grid tbody not found: #ia-fert-lines');
    return;
  }
  const tr = iaCreateImpactLineRow();
  tbody.appendChild(tr);
  iaSelectImpactRow(tr); // select the newly added row
}

function iaRemoveSelectedImpactLineRow() {
  const tbody = iaGetImpactLinesTbody();
  if (!tbody) return;

  const rows = tbody.querySelectorAll('tr');
  if (rows.length <= 1) return; // keep at least one row

  const selected = iaGetSelectedImpactRow();
  if (!selected) {
    console.warn('No row selected to remove.');
    return;
  }

  // Select a neighbor row after removal (nice UX)
  const next = selected.nextElementSibling || selected.previousElementSibling;

  tbody.removeChild(selected);

  if (next) iaSelectImpactRow(next);
}

// Row click selection (delegated)
document.addEventListener('click', function(e){
  // Only within the impact fertilizer lines table body
  const tbody = iaGetImpactLinesTbody();
  if (!tbody) return;

  const tr = e.target.closest('#ia-fert-lines tr');
  if (tr) {
    iaSelectImpactRow(tr);
  }
});

// Button wiring (delegated; requires data-ia-action attributes)
document.addEventListener('click', function (e) {
  const btn = e.target.closest('[data-ia-action]');
  if (!btn) return;

  const action = btn.getAttribute('data-ia-action');

  if (action === 'add-row') {
    e.preventDefault();
    iaAddImpactLineRow();
  } else if (action === 'remove-row') {
    e.preventDefault();
    iaRemoveSelectedImpactLineRow();
  }
});



//---------------- Impact module end -------------------


/* ========================================
   TOAST NOTIFICATION SYSTEM
   ======================================== */
function showToast(message, type = 'success', duration = 3000) {
  // 1) Always target the existing container
  let container = document.getElementById('toast-container');

  // 2) If missing, create it at the document level
  if (!container) {
    container = document.createElement('div');
    container.id = 'toast-container';

    document.body.appendChild(container);

  }

  const icons = {
    success: '✅',
    error: '❌',
    warning: '⚠️',
    info: 'ℹ️'
  };

  const toast = document.createElement('div');
  toast.className = `toast toast-${type}`;
  toast.innerHTML = `${icons[type] || ''} ${message}`;

  container.appendChild(toast);

  setTimeout(() => {
    toast.style.animation = 'slideOutRight 0.3s ease';
    setTimeout(() => toast.remove(), 300);
  }, duration);
}


// Replace all your alert() calls with:
// showToast('Operation successful!', 'success');
// showToast('Error occurred', 'error');
// showToast('Please check input', 'warning');
// showToast('Data loaded', 'info');



/* ========================================
   AUTO-SAVE USER PREFERENCES
   ======================================== */
const UserPrefs = {
  KEY: 'insoil_user_prefs_v1',
  
  // Save current state
  save: function() {
    const prefs = {
      // RGB Module
      rgbDateFrom: document.getElementById('date-rgb-from')?.value || '',
      rgbDateTo: document.getElementById('date-rgb-to')?.value || '',
      rgbDeviceFilter: document.getElementById('search-rgb-dev')?.value || '',
      
      // QAQC Module
      qaqcBatch: window.currentQCBatchId || 'Default',
      qaqcDateFrom: document.getElementById('date-qaqc-from')?.value || '',
      qaqcDateTo: document.getElementById('date-qaqc-to')?.value || '',
      
      // Results Module
      resultsDateFrom: document.getElementById('date-results-from')?.value || '',
      resultsDateTo: document.getElementById('date-results-to')?.value || '',
      resultsLowerMode: document.getElementById('results-lower-mode')?.value || 'details',
      
      // Analytics Module
      analyticsDevice: document.getElementById('an-device')?.value || '',
      
      // Last active module
      lastModule: document.querySelector('.module-view.active')?.id || 'mod-rgb',
      
      // Timestamp
      savedAt: new Date().toISOString()
    };
    
    try {
      localStorage.setItem(this.KEY, JSON.stringify(prefs));
      console.log('💾 Preferences saved');
    } catch (e) {
      console.warn('Failed to save preferences:', e);
    }
  },
  
  // Load saved preferences
  load: function() {
    try {
      const saved = localStorage.getItem(this.KEY);
      if (!saved) return null;
      
      const prefs = JSON.parse(saved);
      console.log('📂 Preferences loaded from', prefs.savedAt);
      return prefs;
    } catch (e) {
      console.warn('Failed to load preferences:', e);
      return null;
    }
  },
  
  // Apply preferences to UI
  apply: function() {
    const prefs = this.load();
    if (!prefs) return;
    
    // RGB Module
    if (prefs.rgbDateFrom) document.getElementById('date-rgb-from').value = prefs.rgbDateFrom;
    if (prefs.rgbDateTo) document.getElementById('date-rgb-to').value = prefs.rgbDateTo;
    if (prefs.rgbDeviceFilter) document.getElementById('search-rgb-dev').value = prefs.rgbDeviceFilter;
    
    // QAQC Module
    if (prefs.qaqcBatch) window.currentQCBatchId = prefs.qaqcBatch;
    if (prefs.qaqcDateFrom) document.getElementById('date-qaqc-from').value = prefs.qaqcDateFrom;
    if (prefs.qaqcDateTo) document.getElementById('date-qaqc-to').value = prefs.qaqcDateTo;
    
    // Results Module
    if (prefs.resultsDateFrom) document.getElementById('date-results-from').value = prefs.resultsDateFrom;
    if (prefs.resultsDateTo) document.getElementById('date-results-to').value = prefs.resultsDateTo;
    if (prefs.resultsLowerMode) document.getElementById('results-lower-mode').value = prefs.resultsLowerMode;
    
    // Analytics Module
    if (prefs.analyticsDevice) document.getElementById('an-device').value = prefs.analyticsDevice;
    
    showToast('Preferences restored', 'info', 2000);
  },
  
  // Clear preferences
  clear: function() {
    localStorage.removeItem(this.KEY);
    showToast('Preferences cleared', 'warning');
  }
};

// Auto-save on input change (debounced)
let saveTimeout;
function autoSavePrefs() {
  clearTimeout(saveTimeout);
  saveTimeout = setTimeout(() => UserPrefs.save(), 1000);
}

// Apply to all inputs
document.addEventListener('DOMContentLoaded', function() {
  // Load preferences after 2 seconds (after data loads)
  setTimeout(() => UserPrefs.apply(), 2000);
  
  // Auto-save on change
  document.querySelectorAll('.date-input, .search-input, select').forEach(el => {
    el.addEventListener('change', autoSavePrefs);
    el.addEventListener('input', autoSavePrefs);
  });
  
  // Save on module switch
  document.querySelectorAll('.nav-item').forEach(el => {
    el.addEventListener('click', () => setTimeout(() => UserPrefs.save(), 500));
  });
});


/* ========================================
   CSV TEMPLATE DOWNLOAD
   ======================================== */
function downloadCSVTemplate() {
  // Build headers
  const headers = ['Device ID', 'Test ID', 'Date-Time'];
  
  // Add parameter columns (T and C for each)
  cols.forEach(c => {
    headers.push(`${c.n}_T`);
    headers.push(`${c.n}_C`);
  });
  
  // Sample row with placeholders
  const sampleRow = [
    'DEV001',
    'T12345',
    '01-01-2026 10:30 AM',
    ...Array(cols.length * 2).fill('0,0,0') // RGB format
  ];
  
  // Instructions row
  const instructions = [
    '# INSTRUCTIONS:',
    'Replace with your data',
    'Format: DD-MM-YYYY HH:MM AM/PM',
    ...Array(cols.length * 2).fill('RGB format: R,G,B')
  ];
  
  // Build CSV
  const csv = [
    headers.join(','),
    instructions.join(','),
    sampleRow.join(',')
  ].join('\n');
  
  // Download
  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const link = document.createElement('a');
  link.href = url;
  link.download = `Insoil_Import_Template_${new Date().toISOString().split('T')[0]}.csv`;
  link.click();
  URL.revokeObjectURL(url);
  
  showToast('📄 Template downloaded!', 'success');
}


/* ========================================
   GLOBAL SEARCH FUNCTION
   ======================================== */
function globalSearch(query) {
  if (!query || query.length < 3) {
    showToast('Please enter at least 3 characters', 'warning');
    return;
  }
  
  query = query.toLowerCase().trim();
  
  // Search in rgbData
  const matches = rgbData.filter(r => 
    (r.tid && r.tid.toLowerCase().includes(query)) ||
    (r.did && r.did.toLowerCase().includes(query))
  );
  
  if (matches.length === 0) {
    showToast(`❌ No results found for "${query}"`, 'error');
    return;
  }
  
  if (matches.length === 1) {
    // Single match - jump directly
    const match = matches[0];
    nav('rgb');
    document.getElementById('search-rgb-test').value = match.tid;
    document.getElementById('search-rgb-dev').value = match.did;
    renderTable('rgb');
    showToast(`✅ Found: ${match.tid} | ${match.did}`, 'success');
  } else {
    // Multiple matches - show in RGB with filters
    nav('rgb');
    document.getElementById('search-rgb-test').value = query;
    renderTable('rgb');
    showToast(`Found ${matches.length} results`, 'info');
  }
}

// Add keyboard shortcut (Ctrl+K)
document.addEventListener('keydown', function(e) {
  if (e.ctrlKey && e.key === 'k') {
    e.preventDefault();
    const query = prompt('🔍 Search Test ID or Device ID:');
    if (query) globalSearch(query);
  }
});




/* ========================================
   SESSION TIMEOUT (30 MINUTES)
   ======================================== */
const SessionManager = {
  TIMEOUT_DURATION: 30 * 60 * 1000, // 30 minutes
  WARNING_DURATION: 5 * 60 * 1000,  // 5 minutes before timeout
  timeoutId: null,
  warningId: null,
  
  start: function() {
    this.reset();
    console.log('🔐 Session timeout started (30 min)');
  },
  
  reset: function() {
    clearTimeout(this.timeoutId);
    clearTimeout(this.warningId);
    
    // Set warning timer (25 minutes)
    this.warningId = setTimeout(() => {
      showToast('⏱️ Session expires in 5 minutes', 'warning', 5000);
    }, this.TIMEOUT_DURATION - this.WARNING_DURATION);
    
    // Set logout timer (30 minutes)
    this.timeoutId = setTimeout(() => {
      showToast('🔒 Session expired. Logging out...', 'error', 3000);
      setTimeout(() => logout(), 3000);
    }, this.TIMEOUT_DURATION);
  },
  
  stop: function() {
    clearTimeout(this.timeoutId);
    clearTimeout(this.warningId);
  }
};

// Track user activity
['mousedown', 'keypress', 'scroll', 'touchstart'].forEach(event => {
  document.addEventListener(event, () => {
    if (currentUserRole) { // Only track if logged in
      SessionManager.reset();
    }
  }, { passive: true });
});

// Start timer after successful login
// Add this line to your attemptLogin function after login success:
// SessionManager.start();

// Stop timer on logout
// Add this line to your logout function:
// SessionManager.stop();



/* ========================================
   QUICK STATS DISPLAY
   ======================================== */
function updateQuickStats() {
  const stats = {
    totalTests: rgbData.length,
    successTests: rgbData.filter(r => r.status === 'SUCCESS').length,
    devices: new Set(rgbData.map(r => r.did)).size,
    today: rgbData.filter(r => {
      const testDate = new Date(r.time);
      const today = new Date();
      return testDate.toDateString() === today.toDateString();
    }).length
  };
  
  const successRate = ((stats.successTests / stats.totalTests) * 100).toFixed(1);
  
  return `
    📊 ${stats.totalTests} tests | 
    ✅ ${successRate}% success | 
    🔧 ${stats.devices} devices | 
    📅 ${stats.today} today
  `;
}

// Display in version info area (update every 30 seconds)
setInterval(() => {
  if (rgbData && rgbData.length > 0) {
    const versionInfo = document.getElementById('version-info');
    if (versionInfo) {
      versionInfo.innerHTML = updateQuickStats() + '<br>' + versionInfo.textContent.split('|')[0];
    }
  }
}, 30000);


/* ========================================
   LOADING SKELETON FOR TABLES
   ======================================== */
function showLoadingSkeleton(tableId, rows = 5) {
  const tbody = document.querySelector(`#${tableId} tbody`);
  if (!tbody) return;
  
  const cols = tbody.closest('table').querySelectorAll('thead th').length;
  
  let html = '';
  for (let i = 0; i < rows; i++) {
    html += '<tr class="skeleton-row">';
    for (let j = 0; j < cols; j++) {
      html += '<td><div class="skeleton-cell"></div></td>';
    }
    html += '</tr>';
  }
  
  tbody.innerHTML = html;
}

// Use before API calls:
// showLoadingSkeleton('tbl-rgb-metrics', 10);



/* ========================================
   AUTO-REFRESH DATA
   ======================================== */
const AutoRefresh = {
  intervalId: null,
  isEnabled: false,
  intervalMinutes: 5,

  start: function () {
    if (this.intervalId) return;

    this.intervalId = setInterval(() => {
      console.log('🔄 Auto-refreshing data (single-flight)...');

      fetchOperationalDataOnce({
        reason: 'auto-5min',
        onSuccess: function () {
          // If your loadOperationalData() does more than fetch, keep it,
          // but do NOT call google.script.run again inside it.
          // Prefer: rerender only what needs it.
          showToast('Data refreshed automatically', 'info', 2000);

          // Optional: refresh currently active view if needed
          const activeId = document.querySelector('.module-view.active')?.id;
          if (activeId === 'mod-results' && typeof renderResults === 'function') renderResults();
        }
      });
    }, this.intervalMinutes * 60 * 1000);

    this.isEnabled = true;
    showToast(`Auto-refresh enabled (${this.intervalMinutes} min)`, 'success');
  },

  stop: function () {
    clearInterval(this.intervalId);
    this.intervalId = null;
    this.isEnabled = false;
    showToast('Auto-refresh disabled', 'warning');
  },

  toggle: function () {
    if (this.isEnabled) this.stop();
    else this.start();
  }
};


/* ========================================
   COPY DATA TO CLIPBOARD
   ======================================== */
function copyToClipboard(text, message = 'Copied to clipboard!') {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(text)
      .then(() => showToast(message, 'success'))
      .catch(() => showToast('Copy failed', 'error'));
  } else {
    // Fallback for older browsers
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);
    showToast(message, 'success');
  }
}

// Use in tables - add copy icon to cells
// <td onclick="copyToClipboard('${row.tid}', 'Test ID copied!')">
//   ${row.tid} 📋
// </td>

function getQaqcSelectedCount() {
  // Primary source: QC checkbox selection
  if (window.checkedRows && Array.isArray(window.checkedRows.qaqc)) {
    return window.checkedRows.qaqc.length;
  }

  // Fallback: read from DOM if needed
  const tbl = document.getElementById('tbl-qaqc-metrics');
  if (!tbl) return 0;
  return tbl.querySelectorAll('tbody input[type="checkbox"].chk-mod:checked').length;
}



/**************************************
 * QC CERTIFICATE EXPORT (PDF + CSV)
 **************************************/

function getISTTimestampString(d = new Date()) {
  // your app is in IST; keep it simple and explicit
  const pad = (n) => String(n).padStart(2, '0');
  const yyyy = d.getFullYear();
  const mm = pad(d.getMonth() + 1);
  const dd = pad(d.getDate());
  const hh = pad(d.getHours());
  const mi = pad(d.getMinutes());
  return `${yyyy}-${mm}-${dd} ${hh}:${mi} IST`;
}

function makeCertificateId(row, batchId) {
  // Stable-ish, operator-friendly ID (no server call)
  // Example: QC-INS-862-A-TST-123-BATCH_2025_JAN-20260102-1734
  const now = new Date();
  const pad = (n) => String(n).padStart(2, '0');
  const stamp = `${now.getFullYear()}${pad(now.getMonth()+1)}${pad(now.getDate())}-${pad(now.getHours())}${pad(now.getMinutes())}`;
  const did = (row?.did || 'NA').toString().replace(/\s+/g,'');
  const tid = (row?.tid || 'NA').toString().replace(/\s+/g,'');
  const bid = (batchId || 'Default').toString().replace(/\s+/g,'');
  return `QC-${did}-${tid}-${bid}-${stamp}`;
}

function buildQCCertificateData(row) {
  if (!row) throw new Error('No QC row selected/available for certificate.');

  const batchId = (currentQCBatchId || row.qcBatchId || 'Default');
  const certId = makeCertificateId(row, batchId);

  // Manual override info
  const deviceId = row.did;
  const overrideEnabled = (window.qcManualOverrideEnabled && qcManualOverrideEnabled[deviceId] === true);
  const manualStatus = (window.qcManualStatus && qcManualStatus[deviceId])
    ? String(qcManualStatus[deviceId]).toUpperCase()
    : null;

  // Counts
  let passCount = 0, failCount = 0, naCount = 0;
  let computedOverall = 'PASS';

  // If getQCCriteriaForParam supports batchId, it will use it; otherwise ignores
  function getCriteria(paramKey) {
    try { return getQCCriteriaForParam(paramKey, batchId); }
    catch (e) { return getQCCriteriaForParam(paramKey); }
  }

  const paramRows = cols.map(c => {
    const val = getQCObservedValue(row, c.k);
    const criteria = getCriteria(c.k);

    const hasVal = Number.isFinite(val);
    const hasCriteria =
      criteria &&
      criteria.min != null && criteria.max != null &&
      criteria.min !== '' && criteria.max !== '';

    let status = 'NA';

    if (hasVal && hasCriteria) {
      status = (val < Number(criteria.min) || val > Number(criteria.max)) ? 'FAIL' : 'PASS';
    } else {
      status = 'NA';
    }

    if (status === 'PASS') passCount++;
    else if (status === 'FAIL') { failCount++; computedOverall = 'FAIL'; }
    else naCount++;

    // If you want strict behavior: treat NA as FAIL overall (uncomment)
    // if (status === 'NA') computedOverall = 'FAIL';

    return {
      paramKey: c.k,
      paramName: c.n || c.k,
      value: hasVal ? val : null,
      min: hasCriteria ? criteria.min : null,
      max: hasCriteria ? criteria.max : null,
      status,
      hasCriteria,
      hasValue: hasVal
    };
  });

  // If nothing was evaluable (all NA), mark computedOverall as NA (operator clarity)
  if (failCount === 0 && passCount === 0 && naCount > 0) computedOverall = 'NA';

  const finalOverall = (overrideEnabled && manualStatus) ? manualStatus : computedOverall;

  const generatedBy =
    (window.currentUserEmail || window.loggedInUserEmail || window.currentUser || 'Operator').toString();

  return {
    certId,
    batchId,
    generatedOn: getISTTimestampString(new Date()),
    generatedBy,
    systemName: 'Insoil Device QA/QC',
    deviceId: String(row.did || ''),
    testId: String(row.tid || ''),
    testTime: String(row.time || ''),
    computedOverall,
    overrideEnabled,
    manualStatus,
    finalOverall,
    passCount,
    failCount,
    naCount,
    totalParams: passCount + failCount + naCount,
    paramRows
  };
}


function exportQCCertificateCSV() {
  try {
    const row = window.currentQCRowForCert;
    if (!row) return alert('No QC row selected.');

    const cert = buildQCCertificateData(row);

    // CSV 1: Summary (single row)
    const summaryHeader = [
      'certificate_id','device_id','test_id','qc_batch','test_time',
      'overall_computed','override_used','overall_final',
      'pass_count','fail_count','total_params',
      'generated_on','generated_by','system'
    ];

    const summaryRow = [
      cert.certId, cert.deviceId, cert.testId, cert.batchId, cert.testTime,
      cert.computedOverall,
      cert.overrideEnabled ? 'YES' : 'NO',
      cert.finalOverall,
      cert.passCount, cert.failCount, cert.totalParams,
      cert.generatedOn, cert.generatedBy, cert.systemName
    ].map(v => `"${String(v ?? '').replaceAll('"','""')}"`);

    const summaryCsv = summaryHeader.join(',') + '\n' + summaryRow.join(',');

    // CSV 2: Parameter details
    const detailHeader = ['certificate_id','parameter','value','min','max','status','fail_reason'];

    const detailRows = (cert.paramRows || []).map(r => {
      const hasCriteria = (r.min != null && r.max != null && r.min !== '' && r.max !== '');
      const valueStr = (r.value == null || r.value === '') ? '' : String(r.value);
      const minStr   = hasCriteria ? String(r.min) : 'NA';
      const maxStr   = hasCriteria ? String(r.max) : 'NA';

      let status = (r.status || '').toUpperCase();
      if (!hasCriteria) status = 'NA';

      let failReason = '';
      const vNum = Number(r.value);
      const minNum = Number(r.min);
      const maxNum = Number(r.max);

      if (status === 'FAIL' && Number.isFinite(vNum) && hasCriteria && Number.isFinite(minNum) && Number.isFinite(maxNum)) {
        if (vNum < minNum) failReason = `Below MIN by ${(minNum - vNum).toFixed(3)}`;
        else if (vNum > maxNum) failReason = `Above MAX by ${(vNum - maxNum).toFixed(3)}`;
      } else if (status === 'NA') {
        failReason = 'Criteria missing';
      }

      return [
        cert.certId,
        r.paramName || '',
        valueStr,
        minStr,
        maxStr,
        status,
        failReason
      ].map(v => `"${String(v ?? '').replaceAll('"','""')}"`).join(',');
    });

    const detailsCsv = detailHeader.join(',') + '\n' + detailRows.join('\n');

    // Download as two files
    downloadTextFile(`${cert.certId}_QC_Summary.csv`, summaryCsv, 'text/csv');
    downloadTextFile(`${cert.certId}_QC_Parameters.csv`, detailsCsv, 'text/csv');

  } catch (e) {
    console.error(e);
    alert('QC CSV export failed: ' + (e.message || e));
  }
}


function downloadTextFile(filename, text, mime) {
  const blob = new Blob([text], { type: mime || 'text/plain' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

async function exportQCCertificatePDF() {
  try {
    const row = window.currentQCRowForCert;
    if (!row) return alert('No QC row selected.');

    const cert = buildQCCertificateData(row);

    // jsPDF availability
    const JsPDF = (window.jspdf && window.jspdf.jsPDF) ? window.jspdf.jsPDF : window.jsPDF;
    if (!JsPDF) {
      alert('jsPDF not found. Please include jsPDF + autoTable scripts.');
      return;
    }

    const doc = new JsPDF({ orientation: 'p', unit: 'mm', format: 'a4' });

    // Determine which parameter is currently selected on the histogram (if present)
    const paramSel = document.getElementById('qaqc-hist-param');
    const selectedParamKey = (paramSel && paramSel.value)
      ? paramSel.value
      : (window.currentQCParamKey || (cols && cols[0] ? cols[0].k : ''));
    const paramConf = (Array.isArray(cols) ? cols.find(c => c.k === selectedParamKey) : null);
    const selectedParamLabel = paramConf ? (paramConf.n || paramConf.k) : (selectedParamKey || 'NA');

    // Build FAIL reasons list
    const failItems = [];
    (cert.paramRows || []).forEach(r => {
      const hasCriteria = (r.min != null && r.max != null && r.min !== '' && r.max !== '');
      let status = (r.status || '').toUpperCase();
      if (!hasCriteria) status = 'NA';

      const vNum = Number(r.value);
      const minNum = Number(r.min);
      const maxNum = Number(r.max);

      if (status === 'FAIL' && Number.isFinite(vNum) && hasCriteria && Number.isFinite(minNum) && Number.isFinite(maxNum)) {
        if (vNum < minNum) {
          failItems.push(
            `${r.paramName}: Below MIN by ${(minNum - vNum).toFixed(3)} (obs ${vNum.toFixed(3)} < min ${minNum})`
          );
        } else if (vNum > maxNum) {
          failItems.push(
            `${r.paramName}: Above MAX by ${(vNum - maxNum).toFixed(3)} (obs ${vNum.toFixed(3)} > max ${maxNum})`
          );
        }
      } else if (status === 'NA') {
        // optional: include missing-criteria warnings
        // failItems.push(`${r.paramName}: Criteria missing`);
      }
    });

    // ----- PAGE 1: HEADER -----
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(14);
    doc.text('INSOIL™ – QUALITY CONTROL CERTIFICATE', 105, 14, { align: 'center' });

    doc.setFont('helvetica', 'normal');
    doc.setFontSize(9);
    doc.text(`Certificate ID: ${cert.certId}`, 14, 20);
    doc.text(`Generated on: ${cert.generatedOn}`, 14, 24);
    doc.text(`Generated by: ${cert.generatedBy}`, 14, 28);

    // Identity
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(11);
    doc.text('Device & Test Identification', 14, 36);

    doc.setFont('helvetica', 'normal');
    doc.setFontSize(10);
    const leftX = 14, rightX = 110;
    let y = 42;

    doc.text(`Device ID: ${cert.deviceId}`, leftX, y);
    doc.text(`Test ID: ${cert.testId}`, rightX, y); y += 6;

    doc.text(`QC Batch ID: ${cert.batchId}`, leftX, y);
    doc.text(`Test Date & Time: ${cert.testTime}`, rightX, y); y += 6;

    // ----- QC SUMMARY -----
    y += 4;
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(12);
    doc.text('QC Summary', 14, y); y += 7;

    doc.setFontSize(13);
    doc.setFont('helvetica', 'bold');
    doc.text(`OVERALL QC STATUS: ${cert.finalOverall}`, 14, y); y += 7;

    doc.setFont('helvetica', 'normal');
    doc.setFontSize(10);
    doc.text(
      `Total Parameters: ${cert.totalParams}    Passed: ${cert.passCount}    Failed: ${cert.failCount}`,
      14, y
    ); y += 6;

    if (cert.overrideEnabled && cert.manualStatus) {
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(10);
      doc.text('MANUAL OVERRIDE APPLIED: Final QC status was set by operator.', 14, y); y += 6;
      doc.setFont('helvetica', 'normal');
    }

    // ----- WHY FAIL (operator hint) -----
    if (cert.finalOverall === 'FAIL' && failItems.length) {
      y += 2;
      doc.setFont('helvetica', 'bold');
      doc.setFontSize(11);
      doc.text('Why FAIL?', 14, y); y += 5;

      doc.setFont('helvetica', 'normal');
      doc.setFontSize(9);

      const maxLines = 6; // keep page clean
      const shown = failItems.slice(0, maxLines);
      shown.forEach(line => {
        const wrapped = doc.splitTextToSize(line, 182);
        doc.text(wrapped, 14, y);
        y += (wrapped.length * 4);
      });

      if (failItems.length > maxLines) {
        doc.text(`…and ${failItems.length - maxLines} more failed checks. See CSV for full list.`, 14, y);
        y += 5;
      }
    }

    // ----- PARAMETER TABLE -----
    y += 3;
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(11);
    doc.text('Parameter-wise QC Results', 14, y); y += 4;

    const tableBody = (cert.paramRows || []).map(r => {
      const hasCriteria = (r.min != null && r.max != null && r.min !== '' && r.max !== '');
      const status = hasCriteria ? (String(r.status || 'NA').toUpperCase()) : 'NA';

      const vNum = Number(r.value);
      const valStr = Number.isFinite(vNum) ? vNum.toFixed(3) : 'NA';

      return [
        r.paramName || 'NA',
        valStr,
        hasCriteria ? String(r.min) : 'NA',
        hasCriteria ? String(r.max) : 'NA',
        status
      ];
    });

    doc.autoTable({
      startY: y,
      head: [['Parameter', 'Observed', 'Min', 'Max', 'Status']],
      body: tableBody,
      styles: { fontSize: 9, cellPadding: 2 },
      headStyles: { fillColor: [245, 245, 245], textColor: 20 },
      didParseCell: function (data) {
        if (data.section === 'body') {
          const status = data.row.raw[4];
          if (status === 'FAIL') data.cell.styles.fillColor = [255, 235, 235];
          if (status === 'NA') data.cell.styles.textColor = [120, 120, 120];
        }
      },
      margin: { left: 14, right: 14 }
    });

    let endY = doc.lastAutoTable.finalY || 250;
    endY += 6;

    // ----- DECLARATION -----
    doc.setFont('helvetica', 'normal');
    doc.setFontSize(9);
    const declaration =
      'This QC certificate is system-generated based on defined QC criteria and recorded measurements.\n' +
      'Manual overrides, if any, are explicitly indicated above.\n' +
      'This document does not replace statutory laboratory certification.';
    doc.text(declaration, 14, Math.min(endY, 272));

    // ===== HISTOGRAM PAGES (PAGE 2 & 3) =====

    // Small helper to wait 2 frames for Chart.js render (more robust than 1)
    // helper: wait N ms
function waitMs(ms) {
  return new Promise(res => setTimeout(res, ms));
}


    // Layout: 4 rows × 2 columns per page, narrow margins
    const PAGE_W = 210, PAGE_H = 297;
    const PAGE_MARGIN = 6;
    const GAP_X = 4;
    const GAP_Y = 4;
    const GRID_COLS = 2;
    const GRID_ROWS = 4;

    // leave a bit more room for header/footer
    const HEADER_H = 26;          // top header block
    const FOOTER_MARGIN = 4;      // safety at bottom

    const usableH = PAGE_H - HEADER_H - PAGE_MARGIN - FOOTER_MARGIN;

    const cellW = (PAGE_W - 2 * PAGE_MARGIN - (GRID_COLS - 1) * GAP_X) / GRID_COLS;
    const cellH = (usableH - (GRID_ROWS - 1) * GAP_Y) / GRID_ROWS;

    // More compact export canvas (reduces PDF size)
    const PX_W = 800;   // was 1100
    const PX_H = 500;   // was 700

    // Optional: hard cap on number of charts (13 = two pages full)
    const maxCharts = 13;
    const chartCols = Array.isArray(cols) ? cols.slice(0, maxCharts) : [];

    // PAGE 2 header
    doc.addPage();
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(12);
    doc.text('Statistical QC Evidence', PAGE_MARGIN, 12);

    doc.setFont('helvetica', 'normal');
    doc.setFontSize(9);
    doc.text(
      `Batch: ${cert.batchId}   Device: ${cert.deviceId}   Test: ${cert.testId}`,
      PAGE_MARGIN, 18
    );

    // All parameters: first 8 on page 2, remaining on page 3
    for (let i = 0; i < chartCols.length; i++) {

      let pageIndex, idxOnPage;
      if (i < 8) {
        pageIndex = 0;     // page 2
        idxOnPage = i;
      } else {
        pageIndex = 1;     // page 3
        idxOnPage = i - 8;
      }

      if (pageIndex === 1 && idxOnPage === 0) {
        // PAGE 3 header
        doc.addPage();
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(12);
        doc.text('Statistical QC Evidence (continued)', PAGE_MARGIN, 12);

        doc.setFont('helvetica', 'normal');
        doc.setFontSize(9);
        doc.text(
          `Batch: ${cert.batchId}   Device: ${cert.deviceId}   Test: ${cert.testId}`,
          PAGE_MARGIN, 18
        );
      }

      const rIdx = Math.floor(idxOnPage / GRID_COLS); // 0..3
      const cIdx = idxOnPage % GRID_COLS;             // 0..1

      const x = PAGE_MARGIN + cIdx * (cellW + GAP_X);
      const yGridTop = HEADER_H;    // instead of 24
      const yCell = yGridTop + rIdx * (cellH + GAP_Y);

      const paramKey = chartCols[i].k;

      // selected metric value for this parameter from this QC row
      let selectedVal = null;
      const observed = getQCObservedValue(row, paramKey);
      if (Number.isFinite(observed)) {
        selectedVal = observed;
      }

      const canvas = document.createElement('canvas');
canvas.width = PX_W;
canvas.height = PX_H;

const chart = renderQCHistogramToCanvas(canvas, paramKey, selectedVal, cert.batchId);
if (!chart) continue;

// ensure layout + draw
chart.update();

// give up to 5 seconds for rendering
// eslint-disable-next-line no-await-in-loop
await waitMs(500);

// optional but recommended: force white background
const ctx = canvas.getContext('2d');
ctx.save();
ctx.globalCompositeOperation = 'destination-over';
ctx.fillStyle = '#ffffff';
ctx.fillRect(0, 0, canvas.width, canvas.height);
ctx.restore();

// capture after full delay
const img = canvas.toDataURL('image/jpeg', 0.8);
chart.destroy();

doc.addImage(img, 'JPEG', x, yCell, cellW, cellH);


      // tiny delay between charts to reduce GPU/CPU spikes
      // eslint-disable-next-line no-await-in-loop
      await new Promise(res => setTimeout(res, 20));
    }

    // SAVE
    doc.save(`${cert.certId}_QC_Certificate.pdf`);

  } catch (e) {
    console.error(e);
    alert('QC PDF export failed: ' + (e.message || e));
  }
}

function getQCBatchIdFromRow(r) {
  const v =
    r?.QCBatch_ID ??
    r?.qcBatchId ??
    r?.QC_Batch ??
    r?.batch ??
    r?.raw?.QCBatch_ID ??
    r?.raw?.qcBatchId ??
    r?.raw?.QC_Batch ??
    'Default';

  return String(v || 'Default').trim() || 'Default';
}



function autoSuggestQCCriteriaUI() {
  try {
    // 1) Read selected QC batch
    const sel = document.getElementById("qc-criteria-batch");
    if (!sel) return alert("QC Criteria batch dropdown not found.");

    const target = String(sel.value || window.currentQCCriteriaBatchId || "Default").trim() || "Default";
    const sdToggle = document.getElementById("qc-criteria-sd-toggle");
    const sdMultiplier = sdToggle && !sdToggle.checked ? 1 : 2;

    // 2) QC data must be present
    const data = (Array.isArray(window.qcData) ? window.qcData : (Array.isArray(qcData) ? qcData : []));
    if (!data.length) return alert("QC data (qcData) not loaded yet.");

    const s = (v) => String(v ?? "").trim();

    // 2a) Robust batch reader (checks both r and r.raw)
    const getBatch = (typeof getQCBatchIdFromRow === "function")
      ? getQCBatchIdFromRow
      : function (r) {
          const raw = (r && r.raw && typeof r.raw === "object") ? r.raw : null;
          return (
            s(r?.QCBatch_ID) || s(raw?.QCBatch_ID) ||
            s(r?.QC_Batch)   || s(raw?.QC_Batch)   ||
            s(r?.qcBatchId)  || s(raw?.qcBatchId)  ||
            s(r?.QCBatchId)  || s(raw?.QCBatchId)  ||
            s(r?.batch)      || s(raw?.batch)      ||
            "Default"
          );
        };

    const batchRows = data.filter(r => getBatch(r) === target);

    if (!batchRows.length) {
      const present = Array.from(new Set(data.map(getBatch))).filter(Boolean).slice(0, 80);
      return alert(`No QC rows found for batch "${target}".\n\nBatches present in QC_Data: ${present.join(", ")}`);
    }

    // 3) cols[] must exist
    const colList =
      (Array.isArray(window.cols) && window.cols.length) ? window.cols :
      (typeof cols !== "undefined" && Array.isArray(cols) && cols.length) ? cols :
      null;

    if (!colList) return alert("cols[] not found (parameter list). Auto-suggest cannot proceed.");

    // Strict numeric parse: blanks => NaN (NOT 0)
    const toNum = (x) => {
      const t = String(x ?? "").trim();
      if (!t) return NaN;
      const n = Number(t);
      return Number.isFinite(n) ? n : NaN;
    };

    // Normalize keys for fuzzy matching (case-insensitive; remove non-alnum)
    const normKey = (k) => String(k ?? "").toLowerCase().replace(/[^a-z0-9]/g, "");

    // Parameter name -> identifiers + preferred suffix
    // (this matches your UI values: ammonium, phosphorus, oc, etc.)
    const PARAM_SPEC = {
      ammonium:   { needles: ["nh4n", "ammonium"],   suffix: "abs" },
      nitrate:    { needles: ["no3n", "nitrate"],    suffix: "abs" },
      phosphorus: { needles: ["p", "phosph"],        suffix: "abs" },
      potassium:  { needles: ["k", "potassium"],     suffix: "abs" },
      sulphur:    { needles: ["s", "sulph"],         suffix: "abs" },
      oc:         { needles: ["oc", "organiccarbon"],suffix: "abs" },
      boron:      { needles: ["b", "boron"],         suffix: "abs" },
      iron:       { needles: ["fe", "iron"],         suffix: "abs" },
      manganese:  { needles: ["mn", "manganese"],    suffix: "abs" },
      copper:     { needles: ["cu", "copper"],       suffix: "abs" },
      zinccopper: { needles: ["zncu", "zinccopper"], suffix: "abs" },
      ph:         { needles: ["ph"],                 suffix: "val" },
      ec:         { needles: ["ec"],                 suffix: "val" }
    };

    const aliasParam = (p) => {
      const t = String(p ?? "").trim().toLowerCase().replace(/\s+/g, "");
      // keep your exact values
      if (t === "zinc" || t === "zinc+copper" || t === "zinc-copper") return "zinccopper";
      if (t === "organiccarbon" || t === "organic_carbon") return "oc";
      return t;
    };

    // Find the best matching column key in a row object for a given param
    function findColumnKeyForParam(obj, paramName) {
      if (!obj || typeof obj !== "object") return "";
      const spec = PARAM_SPEC[paramName];
      if (!spec) return "";

      const keys = Object.keys(obj);
      const keysNorm = keys.map(k => ({ k, nk: normKey(k) }));

      // Prefer columns that contain the needle AND end with the desired suffix (abs/val)
      const suffix = spec.suffix; // "abs" or "val"
      const candidates = [];

      for (const it of keysNorm) {
        const nk = it.nk;
        const hasNeedle = spec.needles.some(nd => nk.includes(normKey(nd)));
        if (!hasNeedle) continue;

        const hasSuffix =
          (suffix === "abs" && (nk.endsWith("abs") || nk.includes("abs"))) ||
          (suffix === "val" && (nk.endsWith("val") || nk.includes("val")));

        // Heuristic scoring
        let score = 0;
        if (hasSuffix) score += 5;
        // prefer exact tokens like nh4nabs, no3nabs, zncuabs, phval, ecval
        if (suffix === "abs" && nk.endsWith("abs")) score += 2;
        if (suffix === "val" && nk.endsWith("val")) score += 2;

        candidates.push({ key: it.k, score });
      }

      if (!candidates.length) return "";

      candidates.sort((a, b) => b.score - a.score);
      return candidates[0].key;
    }

    // Resolve and cache the actual QC_Data column key per param by sampling the first row
    const sampleRow = batchRows[0];
    const sampleTop = (sampleRow && typeof sampleRow === "object") ? sampleRow : null;
    const sampleRaw = (sampleRow && sampleRow.raw && typeof sampleRow.raw === "object") ? sampleRow.raw : null;

    const resolvedColByParam = {};
    Object.keys(PARAM_SPEC).forEach(p => {
      // try top-level first, then .raw
      let k = findColumnKeyForParam(sampleTop, p);
      if (!k) k = findColumnKeyForParam(sampleRaw, p);
      resolvedColByParam[p] = k; // may be ""
    });

    // 4) Collect numeric arrays per UI key (c.k)
    const statsByKey = {};
    colList.forEach(c => { statsByKey[c.k] = []; });

    batchRows.forEach(r => {
      const top = (r && typeof r === "object") ? r : null;
      const raw = (r && r.raw && typeof r.raw === "object") ? r.raw : null;

      colList.forEach(c => {
        const uiKey = String(c.k ?? "").trim(); // later matches paramSel.value
        const param = aliasParam(uiKey);

        const colKey = resolvedColByParam[param];
        let v = NaN;

        // Prefer direct column read (top-level then raw)
        if (colKey && top) v = toNum(top[colKey]);
        if (!Number.isFinite(v) && colKey && raw) v = toNum(raw[colKey]);

        // Never force 0; only push finite
        if (Number.isFinite(v)) statsByKey[uiKey].push(v);
      });
    });

    // 5) Missing list (n < 2)
    const missing = colList
      .filter(c => (statsByKey[c.k] || []).length < 2)
      .map(c => `${c.n} (n=${(statsByKey[c.k] || []).length})`);

    const note = document.getElementById("qc-criteria-batch-note");
    if (note) {
      note.textContent = missing.length
        ? `Not enough rows (n≥2 needed) for: ${missing.join(", ")}`
        : "";
    }

    if (missing.length) {
      alert(
        "Not enough QC rows to compute sample SD (need n≥2) for:\n" +
        missing.join("\n") +
        "\n\nOther parameters (with n≥2) will still be auto-filled."
      );
    }

    // 6) Compute mean + sample SD; min/max = mean ± (selected SD)
    const out = {};
    colList.forEach(c => {
      const key = String(c.k ?? "").trim();
      const arr = statsByKey[key] || [];
      if (arr.length < 2) return;

      const mean = arr.reduce((a, b) => a + b, 0) / arr.length;
      const sumSq = arr.reduce((s0, v) => s0 + Math.pow(v - mean, 2), 0);
      const sd = Math.sqrt(sumSq / (arr.length - 1));

      out[key] = {
        n: arr.length,
        mean,
        min: mean - sdMultiplier * sd,
        max: mean + sdMultiplier * sd
      };
    });

    // 7) Ensure grid is on the selected batch, then fill UI
    window.currentQCCriteriaBatchId = target;
    if (typeof applyQCCriteriaBatchToRows === "function") applyQCCriteriaBatchToRows();

    const rows = document.querySelectorAll("#tbl-qc-criteria tbody tr");
    if (!rows.length) return alert("QC Criteria table is empty.");

    let updated = 0;
    rows.forEach(tr => {
      const paramSel = tr.querySelector("select.qc-param-select");
      const minInput = tr.querySelector("input.qc-abs-min");
      const maxInput = tr.querySelector("input.qc-abs-max");
      const meanInput = tr.querySelector("input.qc-abs-mean");
      const sdInput = tr.querySelector("input.qc-abs-sd");
      if (!paramSel || !minInput || !maxInput || !meanInput || !sdInput) return;

      const key = String(paramSel.value || "").trim();
      const st = out[key];
      if (!st) return; // do NOT write 0s

      meanInput.value = Number(st.mean).toFixed(6);
      minInput.value  = Number(st.min).toFixed(6);
      maxInput.value  = Number(st.max).toFixed(6);
      sdInput.value   = sdMultiplier === 1 ? '1' : '2';

      tr.classList.add("qc-autofilled");
      updated++;
    });

    // Diagnostic (optional) – shows which QC_Data columns were detected
    // Comment this alert once stable.
    const diag = Object.keys(PARAM_SPEC)
      .map(p => `${p}→${resolvedColByParam[p] || "NOT_FOUND"}`)
      .join("\n");

    alert(`Auto-suggest complete for batch "${target}". Updated ${updated} rows.\n\nDetected columns:\n${diag}`);
  } catch (e) {
    console.error("autoSuggestQCCriteriaUI failed:", e);
    alert("Auto-suggest failed: " + (e?.message || e));
  }
}








function computeBatchParamStats(batchId, k, minN) {
  const target = String(batchId || 'Default');

  const perKey = {};
  cols.forEach(c => { perKey[c.k] = []; });

  for (const r of qcData || []) {
    const b = getQCBatchIdFromRow(r);
    if (b !== target) continue;

    for (const c of cols) {
      const v = safeCalcMetric(r.raw, c.k);
      if (Number.isFinite(v)) perKey[c.k].push(v);
    }
  }

  const out = {};
  for (const c of cols) {
    const arr = perKey[c.k] || [];
    if (arr.length < minN) {
      out[c.k] = { n: arr.length, mean: null, sd: null, min: null, max: null };
      continue;
    }

    const mean = arr.reduce((a,b)=>a+b,0) / arr.length;
    const sd = Math.sqrt(arr.reduce((s,v)=>s + Math.pow(v-mean,2), 0) / arr.length);

    const eps = (sd > 0) ? 0 : 0.0005;

    out[c.k] = {
      n: arr.length,
      mean,
      sd,
      min: mean - k*(sd || eps),
      max: mean + k*(sd || eps)
    };
  }
  return out;
}


function readStoredQCValue(raw, key) {
  if (!raw || !raw[key]) return NaN;
  const obj = raw[key];
  const v = Number(obj.v ?? obj.val ?? obj.abs ?? obj.metric);
  return Number.isFinite(v) ? v : NaN;
}


// Uses your metric rules but DOES NOT treat missing raw as 0 (important for stats)
function safeCalcMetric(raw, key) {
  if (!raw || !raw[key]) return NaN;

  // ✅ 1) Prefer stored metric (your QC rows already store Abs or Val)
  const direct = readStoredQCValue(raw, key);
  if (Number.isFinite(direct)) return direct;

  // ✅ 2) Fallback: compute from t/c only if needed
  const cf = cols.find(c => c.k === key);
  if (!cf) return NaN;

  const obj = raw[key];
  const t = Number(obj.t);
  const c = Number(obj.c);
  if (!Number.isFinite(t)) return NaN;

  if (cf.t === 'Val') return t / 100;
  if (!Number.isFinite(c) || c === 0) return NaN;
  return 1 - (t / c);
}



function applyStatsToQCCriteriaGrid(batchId, statsByKey) {
  const rows = document.querySelectorAll('#tbl-qc-criteria tbody tr');
  if (!rows || rows.length === 0) return 0;

  let updated = 0;

  rows.forEach(tr => {
    const paramSel  = tr.querySelector('.qc-param-select');
    const minInput  = tr.querySelector('.qc-abs-min');
    const maxInput  = tr.querySelector('.qc-abs-max');
    const meanInput = tr.querySelector('.qc-abs-mean');
    if (!paramSel || !minInput || !maxInput || !meanInput) return;

    const key = String(paramSel.value || '');
    const st = statsByKey[key];
    if (!st || st.mean == null) return;

    meanInput.value = Number(st.mean).toFixed(6);
    minInput.value  = Number(st.min).toFixed(6);
    maxInput.value  = Number(st.max).toFixed(6);

    tr.classList.add('qc-autofilled');
    updated++;
  });

  return updated;
}



function applyStatsToQCCriteriaGrid(batchId, statsByKey) {
  const target = String(batchId || 'Default');

  // CHANGE THIS selector to your criteria table container
  // Examples you might have: '#tbl-qc-criteria tbody tr' OR '.qc-criteria-row'
  const rows = document.querySelectorAll('#tbl-qc-criteria tbody tr');
  if (!rows || !rows.length) {
    alert('Could not find QC Criteria table rows. Update selector in applyStatsToQCCriteriaGrid().');
    return 0;
  }

  let updated = 0;

  rows.forEach(tr => {
    // CHANGE these selectors to match your row inputs/select
    const batchInput = tr.querySelector('.qc-batch-id-input');
    const paramSel   = tr.querySelector('.qc-param-select');
    const minInput   = tr.querySelector('.qc-abs-min');
    const maxInput   = tr.querySelector('.qc-abs-max');
    const meanInput  = tr.querySelector('.qc-abs-mean');

    if (!batchInput || !paramSel || !minInput || !maxInput || !meanInput) return;

    const rowBatch = String(batchInput.value || 'Default');
    if (rowBatch !== target) return;

    const key = String(paramSel.value || '');
    const st = statsByKey[key];
    if (!st || st.mean == null) return;

    // Fill numeric fields
    meanInput.value = st.mean.toFixed(6);
    minInput.value  = st.min.toFixed(6);
    maxInput.value  = st.max.toFixed(6);

    // Optional: visually mark updated rows
    tr.classList.add('qc-autofilled');

    updated++;
  });

  return updated;
}

function getAllQCCriteriaBatchesFromCriteriaTable() {
  // Prefer existing qcCriteriaData (criteria sheet), fallback to qcData (operational QC history)
  const s = new Set();

  (Array.isArray(qcCriteriaData) ? qcCriteriaData : []).forEach(r => {
    const b = String(r.batch || r.qcBatchId || '').trim();
    if (b) s.add(b);
  });

  // If criteria sheet is empty, you can also pull from qcData history:
  (Array.isArray(qcData) ? qcData : []).forEach(r => {
    const b = String(r.qcBatchId || '').trim();
    if (b) s.add(b);
  });

  if (!s.size) s.add('Default');
  return Array.from(s).sort((a,b)=>a.localeCompare(b));
}

function populateQCCriteriaBatchDropdown() {
  const sel = document.getElementById("qc-criteria-batch");
  if (!sel) return;

  // temporary visible state
  sel.innerHTML = `<option value="Default">Loading...</option>`;

  google.script.run
    .withSuccessHandler(function (batches) {
      batches = Array.isArray(batches) && batches.length ? batches : ["Default"];

      sel.innerHTML = batches.map(b => {
        b = String(b).trim();
        return `<option value="${escapeHtml(b)}">${escapeHtml(b)}</option>`;
      }).join("");

      const pick =
        batches.includes(String(window.currentQCCriteriaBatchId || "").trim())
          ? String(window.currentQCCriteriaBatchId).trim()
          : (batches.includes("Default") ? "Default" : batches[0]);

      sel.value = pick;
      window.currentQCCriteriaBatchId = pick;

      // Make the first (read-only) QC Batch column show this selection
      if (typeof applyQCCriteriaBatchToRows === "function") applyQCCriteriaBatchToRows();
      else if (typeof renderQCCriteria === "function") renderQCCriteria();
    })
    .withFailureHandler(function (err) {
      console.error("getQCBatchOptions failed:", err);
      sel.innerHTML = `<option value="Default">Default</option>`;
      sel.value = "Default";
      window.currentQCCriteriaBatchId = "Default";
      if (typeof renderQCCriteria === "function") renderQCCriteria();
    })
    .getQCBatchOptions(); // QC_Data unique batches
}



function applyQCCriteriaBatchToRows() {
  const sel = document.getElementById('qc-criteria-batch');
  if (!sel) return;

  const batch = String(sel.value || 'Default').trim() || 'Default';

  // ✅ Keep QC-Criteria batch state separate & explicit
  window.currentQCCriteriaBatchId = batch;

  // ✅ If table is already rendered, update visible/hidden batch cells (compat)
  const hiddenCells = document.querySelectorAll('#body-qc-criteria .qc-batch-cell');
  const labelCells  = document.querySelectorAll('#body-qc-criteria .qc-batch-label');

  hiddenCells.forEach(inp => { inp.value = batch; });
  labelCells.forEach(sp => { sp.textContent = batch; });

  // ✅ Re-render criteria grid for this batch (so rows shown match selected batch)
  // This is the key behavior operators expect.
  if (typeof renderQCCriteria === 'function') {
    renderQCCriteria();
  }
}




function setQCBatchForQCDataRows(payloadJson) {
  const payload = JSON.parse(payloadJson || '[]'); 
  // expected: [{id:"123", qcBatchId:"Default"}, ...]

  const ss = SpreadsheetApp.getActive();
  const sh = ss.getSheetByName('QC_Data');
  if (!sh) throw new Error("Sheet 'QC_Data' not found.");

  const values = sh.getDataRange().getValues();
  if (values.length < 2) return { updated: 0 };

  const headers = values[0].map(h => String(h).trim());
  const idIdx = headers.indexOf('id');         // must match your QC_Data id column
  const batchIdx = headers.indexOf('QC_Batch'); // must match your QC_Data batch column

  if (idIdx === -1) throw new Error("Column 'id' not found in QC_Data.");
  if (batchIdx === -1) throw new Error("Column 'qcBatchId' not found in QC_Data.");

  const map = new Map();
  payload.forEach(r => {
    const id = String(r.id || '').trim();
    const b  = String(r.qcBatchId || '').trim();
    if (id && b) map.set(id, b);
  });

  if (!map.size) return { updated: 0 };

  let updated = 0;
  for (let i = 1; i < values.length; i++) {
    const id = String(values[i][idIdx] || '').trim();
    if (map.has(id)) {
      sh.getRange(i + 1, batchIdx + 1).setValue(map.get(id));
      updated++;
    }
  }

  return { updated };
}


function onQCBatchChange() {
  const sel = document.getElementById('qaqc-batch');
  if (!sel) return;

  currentQCBatchId = sel.value || 'Default';

  // If QC status view is active, refresh histogram/table
  if (document.getElementById('qaqc-status-panel') && !document.getElementById('qaqc-status-panel').hasAttribute('hidden')) {
    populateQaqcStatusFilters({ preserveSelection: true });
  } else {
    // If you want quarantine table to refilter too:
    renderTable('qaqc');
  }
}


// ======== AI FUNCTIONALITY =============//

// FRONTEND JS
function requestQcDiagnostics(qcRow) {
  try {
    if (!qcRow) {
      alert('Select a QC row first.');
      return;
    }
    // Minimal guard: need raw + id info
    if (!qcRow.raw || !qcRow.did || !qcRow.tid) {
      alert('QC row is missing raw or ID fields.');
      return;
    }

    // 1. Auto overall QC status from your existing logic
    const autoStatus = computeAutoQCStatus(qcRow); // already defined in your file

    // 2. Build failedParams list (only params that actually failed)
    const failedParams = [];
    const batchId = getQCBatchIdFromRow(qcRow) || window.currentQCBatchId || 'Default';

    cols.forEach(c => {
      const key = c.k;
      const val = parseFloat(calcMetric(qcRow.raw, key)); // your existing metric
      if (!Number.isFinite(val)) return;

      const criteria = getQCCriteriaForParam(key, batchId); // batch aware inside
      if (!criteria || criteria.min == null || criteria.max == null ||
          criteria.min === '' || criteria.max === '') return;

      const min = Number(criteria.min);
      const max = Number(criteria.max);
      if (!Number.isFinite(min) || !Number.isFinite(max)) return;

      if (val < min || val > max) {
        failedParams.push({
          paramKey: key,
          paramName: c.n || key,
          value: val,
          min,
          max,
          batchId
        });
      }
    });

    // 3. Optional: single-param stats for the currently selected histogram param
    let stats = null;
    try {
      const histParamKey = window.currentQCParamKey || (cols[0] && cols[0].k);
      if (histParamKey) {
        // reuse your batch stats utility if available
        if (typeof computeBatchParamStats === 'function') {
          const s = computeBatchParamStats(batchId, 2); // k=2 SD, minN=2
          const st = s && s[histParamKey];
          if (st && Number.isFinite(st.mean) && Number.isFinite(st.sd)) {
            stats = {
              batchId,
              paramKey: histParamKey,
              mean: st.mean,
              sd: st.sd,
              n: st.n
            };
          }
        }
      }
    } catch (e) {
      console.warn('AI QC stats build failed', e);
    }

    const payload = {
      deviceId: qcRow.did,
      testId: qcRow.tid,
      qcBatchId: batchId,
      autoStatus,
      failedParams,
      stats
    };

    // Show "loading" message in AI box
    const box = document.getElementById('qaqc-ai-content');
    if (box) {
      box.textContent = 'Running AI QC diagnostics...';
    }

    google.script.run
      .withSuccessHandler(function (res) {
        if (!res || !res.ok) {
          alert(res && res.message ? res.message : 'AI QC diagnostics failed.');
          if (box) box.textContent = 'AI diagnostics not available.';
          return;
        }
        renderQcAiPanel(res.diagnostics);
      })
      .withFailureHandler(function (err) {
        console.error(err);
        alert('AI QC error: ' + (err && err.message ? err.message : err));
        if (box) box.textContent = 'AI diagnostics not available.';
      })
      .aiQCDiagnoseMistral(JSON.stringify(payload));
  } catch (e) {
    console.error(e);
    alert('AI QC: frontend error ' + e.message);
  }
}




function renderQcAiPanel(diag) {
  const box = document.getElementById('qaqc-ai-content');
  if (!box) return;

  if (!diag) {
    box.textContent = 'AI diagnostics not available for this QC row.';
    return;
  }

  const summary = diag.summary || 'No summary.';
  const risk = (diag.riskLevel || 'medium').toString().toLowerCase();

  const causesArr = Array.isArray(diag.likelyCauses) ? diag.likelyCauses : [];
  const stepsArr = Array.isArray(diag.nextChecks) ? diag.nextChecks : [];

  const causesText = causesArr.length
    ? causesArr.map(c => '- ' + (c.cause || '') + (c.evidence ? ' (' + c.evidence + ')' : '')).join('\n')
    : '- Not enough information to infer likely causes.';

  const stepsText = stepsArr.length
    ? stepsArr
        .sort((a, b) => (a.priority || 0) - (b.priority || 0))
        .map(s => ((s.priority != null ? s.priority + '. ' : '- ') + (s.step || '')))
        .join('\n')
    : '- No additional checks recommended.';

  box.textContent =
    'Summary: ' + summary + '\n\n' +
    'Risk level: ' + risk + '\n\n' +
    'Likely causes:\n' + causesText + '\n\n' +
    'Next checks:\n' + stepsText;
}



function getRecipeForParam(paramCode) {
  if (!window.recipeConfig) return null;
  return window.recipeConfig[paramCode] || null;
}
/* =========================
   DB Masters: FINAL DROPINS
   ========================= */

/**
 * One state object to prevent repeated calls.
 */
window.__dbMastersState = window.__dbMastersState || {
  lastLoadAt: 0,
  inFlight: false,
  minGapMs: 20000 // 20 seconds throttle
};

window.dbMasters = window.dbMasters || {
  qc: {
    headers: ['QCBatch_ID','PrepDate_QCBatch','QCBatch_recipe','QCBatch_totalQty','QCBatch_madeby','Notes'],
    rows: []
  },
  prod: {
    headers: ['ProdBatch_ID','ProdBatch_totaldevices','Manufacturer_name','Manufactured_fromDate','Manufactured_tillDate','Delivery_date','PO_number','Notes'],
    rows: []
  }
};

/**
 * Show QC vs Prod panel and render.
 * Safe even if masters are not yet loaded.
 */
function dbShowMasterTab(kind) {
  const qcPanel = document.getElementById('db-panel-qc');
  const prPanel = document.getElementById('db-panel-prod');
  const bQC = document.getElementById('btn-dbtab-qc');
  const bPR = document.getElementById('btn-dbtab-prod');

  if (!qcPanel || !prPanel || !bQC || !bPR) return;

  const isQC = kind === 'qc';
  qcPanel.style.display = isQC ? 'block' : 'none';
  prPanel.style.display = isQC ? 'none' : 'block';

  bQC.classList.toggle('active', isQC);
  bPR.classList.toggle('active', !isQC);

  // Render immediately from current memory
  dbRenderMaster(kind);

  // If not loaded yet, load once (throttled + single-flight)
  if (!Array.isArray(window.dbMasters?.qc?.rows) || !window.dbMasters.qc.rows.length ||
      !Array.isArray(window.dbMasters?.prod?.rows) || !window.dbMasters.prod.rows.length) {
    dbLoadMasters({ force: false, silent: true });
  }
}

/**
 * Load both master sheets.
 * - SINGLE-FLIGHT: no parallel runs
 * - THROTTLE: avoids repeated calls when other parts of UI invoke dbLoadMasters()
 * - Refresh dropdowns from memory (NO extra server calls)
 */
function dbLoadMasters(opts = {}) {
  const { force = false, silent = true } = opts;

  const hasServer = (typeof google !== "undefined" && google.script?.run);
  if (!hasServer) return;

  const st = window.__dbMastersState || (window.__dbMastersState = {});
  const now = Date.now();

  if (!force && st.lastLoadAt && (now - st.lastLoadAt) < (st.minGapMs || 20000)) {
    if (!silent) console.log('dbLoadMasters: throttled, using existing memory.');
    // Still refresh dropdowns from memory (cheap)
    dbRefreshDropdownsFromMasters_();
    return;
  }

  if (st.inFlight) {
    if (!silent) console.log('dbLoadMasters: already in-flight, skipping.');
    return;
  }
  st.inFlight = true;

  // Helper to end flight safely
  const done = () => {
    st.inFlight = false;
    st.lastLoadAt = Date.now();
  };

  // Prefer a bundled server call if you later add it; otherwise fall back to two reads.
  try {
    if (typeof google.script.run.srvrReadMastersBundle === 'function') {
      google.script.run
        .withSuccessHandler((bundle) => {
          // expected shape: { qcRows:[], prodRows:[] }
          window.dbMasters.qc.rows = Array.isArray(bundle?.qcRows) ? bundle.qcRows : [];
          window.dbMasters.prod.rows = Array.isArray(bundle?.prodRows) ? bundle.prodRows : [];

          // Normalize and ensure at least one editable row
          _dbEnsureEditableRow_('qc');
          _dbEnsureEditableRow_('prod');

          // Re-render both panels (ensures data is visible on first load)
          dbRenderMaster('qc');
          dbRenderMaster('prod');

          // Refresh dropdowns from loaded masters (no extra server calls)
          dbRefreshDropdownsFromMasters_();

          done();
        })
        .withFailureHandler((err) => {
          console.error('srvrReadMastersBundle failed:', err);
          done();
        })
        .srvrReadMastersBundle();
      return;
    }
  } catch (e) {
    // continue to fallback
  }

  // Fallback: sequential two reads (not parallel) to reduce concurrency load
  google.script.run
    .withSuccessHandler(function (qcRows) {
      window.dbMasters.qc.rows = Array.isArray(qcRows) ? qcRows : [];
      _dbEnsureEditableRow_('qc');

      // render QC panel after load
      dbRenderMaster('qc');

      // then load prod
      google.script.run
        .withSuccessHandler(function (prRows) {
          window.dbMasters.prod.rows = Array.isArray(prRows) ? prRows : [];
          _dbEnsureEditableRow_('prod');

          dbRenderMaster('prod');

          // Refresh dropdowns once, after both loads
          dbRefreshDropdownsFromMasters_();

          done();
        })
        .withFailureHandler((err) => {
          console.error('srvrReadProdBatchMaster failed:', err);
          // still refresh dropdowns from QC if possible
          dbRefreshDropdownsFromMasters_();
          done();
        })
        .srvrReadProdBatchMaster();
    })
    .withFailureHandler((err) => {
      console.error('srvrReadQCBatchMaster failed:', err);
      done();
    })
    .srvrReadQCBatchMaster();
}

/**
 * Render one master table ("qc" or "prod") with editable inputs.
 */
function dbRenderMaster(kind) {
  const cfg = window.dbMasters?.[kind];
  if (!cfg) return;

  const tableId = (kind === 'qc') ? 'tbl-db-qc-batch' : 'tbl-db-prod-batch';
  const table = document.getElementById(tableId);
  if (!table) return;

  const thead = table.querySelector('thead');
  const tbody = table.querySelector('tbody');
  if (!thead || !tbody) return;

  const headers = cfg.headers || [];
  const dateColumns = new Set(['PrepDate_QCBatch', 'Manufactured_fromDate', 'Manufactured_tillDate', 'Delivery_date']);

  thead.innerHTML = `<tr>
    <th style="width:44px;">Sel</th>
    ${headers.map(h => `<th>${escapeHtml(String(h))}</th>`).join('')}
  </tr>`;

  tbody.innerHTML = '';

  cfg.rows = Array.isArray(cfg.rows) ? cfg.rows : [];
  if (!cfg.rows.length) cfg.rows = [ {} ];

  cfg.rows.forEach((r, idx) => {
    const tr = document.createElement('tr');

    const tdSel = document.createElement('td');
    tdSel.innerHTML = `<input type="checkbox" data-idx="${idx}">`;
    tr.appendChild(tdSel);

    headers.forEach(h => {
      const td = document.createElement('td');
      const v = (r && r[h] !== undefined) ? r[h] : '';
      if (dateColumns.has(h)) {
        const displayValue = formatInventoryDateTimeDisplay(parseInventoryDateTime(v));
        td.innerHTML = `<input class="db-input master-input" type="text"
          value="${escapeHtml(String(displayValue ?? ''))}"
          data-format="datetime"
          data-kind="${escapeHtml(String(kind))}" data-idx="${idx}" data-col="${escapeHtml(String(h))}"
          onfocus="dbMasterDateTimeFocus(this)"
          onchange="dbMasterDateTimeChange(this)"
          onblur="dbMasterDateTimeBlur(this)">`;
      } else {
        td.innerHTML = `<input class="db-input master-input" type="text"
          value="${escapeHtml(String(v ?? ''))}"
          data-kind="${escapeHtml(String(kind))}" data-idx="${idx}" data-col="${escapeHtml(String(h))}">`;
      }
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });

  // write-through memory update
  tbody.querySelectorAll('input.master-input').forEach(inp => {
    inp.addEventListener('input', () => {
      if (inp.dataset.format === 'datetime') return;
      const k = inp.dataset.kind;
      const i = Number(inp.dataset.idx);
      const col = inp.dataset.col;
      if (!window.dbMasters?.[k]) return;
      if (!window.dbMasters[k].rows[i]) window.dbMasters[k].rows[i] = {};
      window.dbMasters[k].rows[i][col] = inp.value;
    });
  });

  const tabId = kind === 'qc' ? 'qc-batch' : 'prod-batch';
  applyDbEditState(tabId);
}

function updateDbMasterField(input, value) {
  if (!input) return;
  const k = input.dataset.kind;
  const i = Number(input.dataset.idx);
  const col = input.dataset.col;
  if (!window.dbMasters?.[k]) return;
  if (!window.dbMasters[k].rows[i]) window.dbMasters[k].rows[i] = {};
  window.dbMasters[k].rows[i][col] = value;
}

function dbMasterDateTimeFocus(input) {
  if (!input || input.readOnly || input.disabled) return;
  const k = input.dataset.kind;
  const i = Number(input.dataset.idx);
  const col = input.dataset.col;
  const value = window.dbMasters?.[k]?.rows?.[i]?.[col];
  input.type = 'datetime-local';
  input.value = formatInventoryDateTimeForInput(parseInventoryDateTime(value));
}

function dbMasterDateTimeChange(input) {
  if (!input) return;
  const dateValue = input.value ? String(input.value).split('T')[0] : '';
  if (!dateValue) return;
  const isoValue = combineDateWithCurrentIstTime(dateValue);
  updateDbMasterField(input, isoValue);
  input.type = 'text';
  input.value = formatInventoryDateTimeDisplay(isoValue);
}

function dbMasterDateTimeBlur(input) {
  if (!input) return;
  if (input.type === 'datetime-local' && input.value) {
    dbMasterDateTimeChange(input);
    return;
  }
  if (input.type === 'datetime-local') {
    input.type = 'text';
  }
  const k = input.dataset.kind;
  const i = Number(input.dataset.idx);
  const col = input.dataset.col;
  const value = window.dbMasters?.[k]?.rows?.[i]?.[col];
  input.value = formatInventoryDateTimeDisplay(parseInventoryDateTime(value));
}

function toggleDbEdit(tabId, enabled) {
  const tab = document.getElementById(`tab-${tabId}`) || document.getElementById(`inv-tab-${tabId}`);
  if (!tab) return;
  tab.dataset.dbEditEnabled = enabled ? 'true' : 'false';
  applyDbEditState(tabId);
}

function applyDbEditState(tabId) {
  const tab = document.getElementById(`tab-${tabId}`) || document.getElementById(`inv-tab-${tabId}`);
  if (!tab) return;
  const isEnabled = tab.dataset.dbEditEnabled === 'true';
  tab.classList.toggle('db-readonly', !isEnabled);
  tab.querySelectorAll('input, select, textarea').forEach(el => {
    if (el.dataset.dbEditToggle === 'true') return;
    const isSelect = el.tagName === 'SELECT';
    const isCheckbox = el.type === 'checkbox' || el.type === 'radio';
    const isFile = el.type === 'file';
    if (isSelect || isCheckbox || isFile) {
      el.disabled = !isEnabled;
    } else {
      el.readOnly = !isEnabled;
      el.disabled = false;
    }
    el.style.color = '#111';
    el.classList.toggle('inv-readonly', !isEnabled);
  });
}

document.addEventListener('DOMContentLoaded', () => {
  const dbTabs = ['criteria', 'stv', 'qc-criteria', 'blanks', 'qc-batch', 'prod-batch'];
  dbTabs.forEach(tabId => {
    const tab = document.getElementById(`tab-${tabId}`) || document.getElementById(`inv-tab-${tabId}`);
    if (tab) {
      tab.dataset.dbEditEnabled = 'false';
      const observer = new MutationObserver(() => applyDbEditState(tabId));
      observer.observe(tab, { childList: true, subtree: true });
    }
    toggleDbEdit(tabId, false);
  });
});

/**
 * Add an empty row to selected master.
 */
function dbAddRow(kind) {
  const cfg = window.dbMasters?.[kind];
  if (!cfg) return;
  cfg.rows = Array.isArray(cfg.rows) ? cfg.rows : [];
  cfg.rows.push({});
  dbRenderMaster(kind);
}

/**
 * Remove checked rows; keep at least one blank editable row.
 */
function dbRemoveRows(kind) {
  const tableId = (kind === 'qc') ? 'tbl-db-qc-batch' : 'tbl-db-prod-batch';
  const table = document.getElementById(tableId);
  if (!table) return;

  const checks = Array.from(table.querySelectorAll('tbody input[type="checkbox"][data-idx]'));
  const toRemove = new Set(checks.filter(c => c.checked).map(c => Number(c.dataset.idx)));
  if (!toRemove.size) return;

  const cfg = window.dbMasters?.[kind];
  if (!cfg) return;

  cfg.rows = (cfg.rows || []).filter((_, idx) => !toRemove.has(idx));
  if (!cfg.rows.length) cfg.rows = [{}];

  dbRenderMaster(kind);
}

/**
 * Save master rows to sheet via server.
 * - Prunes fully empty rows
 * - Prevents spamming server by forcing reload only once after save
 * - Refreshes dropdowns from memory + triggers your global list refresh (optional)
 */
function dbSaveMaster(kind) {
  const hasServer = typeof google !== "undefined" && google.script?.run;
  if (!hasServer) return;

  const cfg = window.dbMasters?.[kind];
  if (!cfg) return;

  const headers = cfg.headers || [];
  const idCol = (kind === 'qc') ? 'QCBatch_ID' : 'ProdBatch_ID';

  // prune empty rows before save
  const cleaned = _dbPruneRows_(cfg.rows, headers);

  const fn = (kind === 'qc') ? 'srvrSaveQCBatchMaster' : 'srvrSaveProdBatchMaster';
  if (typeof google.script.run[fn] !== 'function') {
    alert('Server function not found: ' + fn);
    return;
  }

  google.script.run
    .withSuccessHandler(function (res) {
      console.log('Saved master', kind, res);

      // Update local memory to what we saved (so dropdowns work immediately)
      window.dbMasters[kind].rows = cleaned.length ? cleaned : [{}];
      dbRenderMaster(kind);
      dbRefreshDropdownsFromMasters_();

      // Refresh global master lists for other modules (your existing function)
      if (typeof loadMasterListsAndRerenderRGB === 'function') {
        // IMPORTANT: this likely calls server; don't spam it repeatedly elsewhere
        loadMasterListsAndRerenderRGB();
      }

      // Reload from sheets once (forced, but throttled state updated)
      dbLoadMasters({ force: true, silent: true });
    })
    .withFailureHandler(function (err) {
      console.error(fn + ' failed:', err);
      alert('Save failed: ' + (err?.message || err));
    })[fn](cleaned);
}

/* =========================
   Helpers (required)
   ========================= */

function _dbEnsureEditableRow_(kind) {
  const cfg = window.dbMasters?.[kind];
  if (!cfg) return;
  cfg.rows = Array.isArray(cfg.rows) ? cfg.rows : [];
  if (!cfg.rows.length) cfg.rows = [ {} ];
}

function _dbGetActiveMasterKind_() {
  const qcPanel = document.getElementById('db-panel-qc');
  if (qcPanel && qcPanel.style.display !== 'none') return 'qc';
  return 'prod';
}

/**
 * Remove rows that are fully empty across the configured headers.
 * Keeps only meaningful rows for saving.
 */
function _dbPruneRows_(rows, headers) {
  const arr = Array.isArray(rows) ? rows : [];
  const hs = Array.isArray(headers) ? headers : [];

  const pruned = arr
    .map(r => (r && typeof r === 'object') ? r : {})
    .filter(r => {
      // keep row if any header has a non-empty value
      return hs.some(h => {
        const v = r[h];
        return String(v ?? '').trim() !== '';
      });
    })
    .map(r => {
      // keep only known headers to avoid junk columns
      const o = {};
      hs.forEach(h => o[h] = (r[h] !== undefined) ? r[h] : '');
      return o;
    });

  return pruned;
}

/**
 * Refresh dropdowns using master rows already loaded into window.dbMasters.
 * This avoids repeated server calls to getQCBatchOptions/getProdBatchOptions.
 */
function dbRefreshDropdownsFromMasters_() {
  // QC IDs from master rows
  const qcIds = _dbExtractIds_(window.dbMasters?.qc?.rows, 'QCBatch_ID');
  const prIds = _dbExtractIds_(window.dbMasters?.prod?.rows, 'ProdBatch_ID');

  // Always include Default
  if (!qcIds.includes('Default')) qcIds.unshift('Default');
  if (!prIds.includes('Default')) prIds.unshift('Default');

  const qcList = _dbSortDefaultFirst_(_dbUniq_(qcIds));
  const prList = _dbSortDefaultFirst_(_dbUniq_(prIds));

  // 1) Database module QC criteria dropdown (you showed this exists)
  const selCrit = document.getElementById('qc-criteria-batch');
  if (selCrit) _dbFillSelectPreserve_(selCrit, qcList);

  // 2) If you have other selects, fill them here (only if present)
  const selQc = document.getElementById('qc-batch');       // optional
  if (selQc) _dbFillSelectPreserve_(selQc, qcList);

  const selProd = document.getElementById('prod-batch');   // optional
  if (selProd) _dbFillSelectPreserve_(selProd, prList);

  // If you want to keep your existing hook, call it ONLY if it is local-only
  // (many "refresh..." functions call server — which can re-trigger concurrency issues).
  // if (typeof refreshQCCriteriaBatchOptions === 'function') refreshQCCriteriaBatchOptions();
}

function _dbExtractIds_(rows, idCol) {
  const out = [];
  (Array.isArray(rows) ? rows : []).forEach(r => {
    const v = (r && r[idCol] !== undefined) ? String(r[idCol]).trim() : '';
    if (v) out.push(v);
  });
  return out;
}

function _dbFillSelectPreserve_(sel, values) {
  const prev = sel.value;
  sel.innerHTML = values.map(v => `<option value="${escapeHtml(String(v))}">${escapeHtml(String(v))}</option>`).join('');
  if (values.includes(prev)) sel.value = prev;
  else sel.value = values.includes('Default') ? 'Default' : (values[0] || '');
}

function _dbUniq_(arr) {
  const set = new Set();
  (arr || []).forEach(v => {
    const s = String(v || '').trim();
    if (s) set.add(s);
  });
  return Array.from(set);
}

function _dbSortDefaultFirst_(arr) {
  return (arr || []).slice().sort((a, b) => {
    if (a === 'Default') return -1;
    if (b === 'Default') return 1;
    return String(a).localeCompare(String(b));
  });
}

</script>



  <div id="chart-modal">
    <div class="modal-content">
      <div
        style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; border-bottom:1px solid #eee; padding-bottom:10px;">
        <h3 id="modal-chart-title" style="margin:0;">Detailed View</h3>

        <div class="zoom-controls">
          <span class="zoom-label">Zoom:</span>
          <button class="btn btn-zoom" onclick="zoomChart('modal', 'xy', 1.1)">+</button>
          <button class="btn btn-zoom" onclick="zoomChart('modal', 'xy', 0.9)">-</button>
          <button class="btn btn-zoom" onclick="resetZoom('modal')" style="width:auto; padding:0 6px;">Reset</button>
        </div>

        <span class="modal-close" onclick="closeChartModal()" style="position:static; margin-left:15px;">×</span>
      </div>
      <div style="flex:1; position:relative; width:100%;">
        <canvas id="c-modal"></canvas>
      </div>
    </div>
  </div>


</body>

</html>
